// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.32/esri/copyright.txt for details.
//>>built
require({cache:{"esri/layers/mixins/ArcGISCachedService":function(){define("exports ../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/SpatialReference ../support/TileInfo ../support/TileInfoTilemapCache ../support/TilemapCache".split(" "),function(l,e,r,w,n,u,q,g,t,D,M,L){l.ArcGISCachedService=z=>{z=class extends z{constructor(){super(...arguments);
this.copyright=null;this.maxScale=this.minScale=0;this.tilemapCache=this.tileInfo=this.spatialReference=null}destroy(){this.tilemapCache?.destroy?.()}readMinScale(H,p){return null!=p.minLOD&&null!=p.maxLOD?H:0}readMaxScale(H,p){return null!=p.minLOD&&null!=p.maxLOD?H:0}get supportsBlankTile(){return 10.2<=this.version}readTilemapCache(H,p,S){H=p.capabilities?.includes("Tilemap");let {minLOD:B,maxLOD:R,minScale:C,maxScale:b}=p;if(null==B&&null==R&&(0!==C||0!==b)){C=C?Math.round(1E4*C)/1E4:Math.round(1E4*
p.tileInfo.lods[0].scale)/1E4;b=b?Math.round(1E4*b)/1E4:Math.round(1E4*p.tileInfo.lods[p.tileInfo.lods.length-1].scale)/1E4;for(var c of p.tileInfo.lods){const h=Math.round(1E4*c.scale)/1E4;B=h>=C?c.level:B;R=h>=b?c.level:R}}return H?new L.TilemapCache({layer:this,minLOD:B,maxLOD:R}):p.tileInfo?(c=new D,c.read(p.tileInfo,S),new M(c,B,R)):null}};e.__decorate([r.property({json:{read:{source:"copyrightText"}}})],z.prototype,"copyright",void 0);e.__decorate([r.property()],z.prototype,"minScale",void 0);
e.__decorate([q.reader("service","minScale")],z.prototype,"readMinScale",null);e.__decorate([r.property()],z.prototype,"maxScale",void 0);e.__decorate([q.reader("service","maxScale")],z.prototype,"readMaxScale",null);e.__decorate([r.property({type:t})],z.prototype,"spatialReference",void 0);e.__decorate([r.property({readOnly:!0})],z.prototype,"supportsBlankTile",null);e.__decorate([r.property({type:D})],z.prototype,"tileInfo",void 0);e.__decorate([r.property()],z.prototype,"tilemapCache",void 0);
e.__decorate([q.reader("service","tilemapCache",["capabilities","tileInfo"])],z.prototype,"readTilemapCache",null);e.__decorate([r.property()],z.prototype,"version",void 0);return z=e.__decorate([g.subclass("esri.layers.mixins.ArcGISCachedService")],z)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfo":function(){define("../../chunks/tslib.es6 ../../core/jsonMap ../../core/JSONSupport ../../core/unitUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/aaBoundingRect ../../geometry/support/spatialReferenceUtils ../../geometry/support/webMercatorUtils ./LOD ./TileKey".split(" "),
function(l,e,r,w,n,u,q,g,t,D,M,L,z,H,p,S,B,R){var C;e=new e.JSONMap({PNG:"png",PNG8:"png8",PNG24:"png24",PNG32:"png32",JPEG:"jpg",JPG:"jpg",DIB:"dib",TIFF:"tiff",EMF:"emf",PS:"ps",PDF:"pdf",GIF:"gif",SVG:"svg",SVGZ:"svgz",Mixed:"mixed",MIXED:"mixed",LERC:"lerc",LERC2D:"lerc2d",RAW:"raw",pbf:"pbf"});r=C=class extends r{static create(b={}){const {resolutionFactor:c=1,scales:h,size:f=256,spatialReference:k=z.WebMercator,numLODs:v=24}=b;if(!p.isValid(k)){b=[];if(h)for(var x=0;x<h.length;x++){var A=h[x];
b.push(new B({level:x,scale:A,resolution:A}))}else for(x=5E-4,A=v-1;0<=A;A--)b.unshift(new B({level:A,scale:x,resolution:x})),x*=2;return new C({dpi:96,lods:b,origin:new L(0,0,k),size:[f,f],spatialReference:k})}x=p.getInfo(k);b=b.origin?new L({x:b.origin.x,y:b.origin.y,spatialReference:k}):x?new L({x:x.origin[0],y:x.origin[1],spatialReference:k}):new L({x:0,y:0,spatialReference:k});x=1/(39.37*w.getMetersPerUnitForSR(k)*96);A=[];if(h)for(var I=0;I<h.length;I++){var P=h[I];A.push(new B({level:I,scale:P,
resolution:P*x}))}else{var J=p.isGeographic(k)?512/f*5.916575275917094E8:256/f*5.91657527591555E8;I=Math.ceil(v/c);A.push(new B({level:0,scale:J,resolution:J*x}));for(P=1;P<I;P++)J/=2**c,A.push(new B({level:P,scale:J,resolution:J*x}))}return new C({dpi:96,lods:A,origin:b,size:[f,f],spatialReference:k})}constructor(b){super(b);this.dpi=96;this.spatialReference=this.size=this.origin=this.format=null}get isWrappable(){const {spatialReference:b,origin:c}=this;if(b&&c){const h=p.getInfo(b);return b.isWrappable&&
!!h&&Math.abs(h.origin[0]-c.x)<=h.dx}return!1}readOrigin(b,c){return L.fromJSON({spatialReference:c.spatialReference,...b})}set lods(b){const c=[],h=this._levelToLOD={};b&&b.forEach(f=>{c.push(f.scale);h[f.level]=f});this._set("scales",c);this._set("lods",b);this._initializeUpsampleLevels()}readSize(b,c){return[c.cols,c.rows]}writeSize(b,c){c.cols=b[0];c.rows=b[1]}zoomToScale(b){const c=this.scales;if(0>=b)return c[0];if(b>=c.length-1)return c[c.length-1];const h=Math.floor(b);return c[h]/(c[h]/c[h+
1])**(b-h)}scaleToZoom(b){const c=this.scales,h=c.length-1;let f=0;for(;f<h;f++){const k=c[f],v=c[f+1];if(k<=b)break;if(v===b)return f+1;if(k>b&&v<b)return f+Math.log(k/b)/Math.log(k/v)}return f}tileAt(b,c,h,f){var k=this.lodAt(b);if(!k)return null;let v;if("number"===typeof c)v=c,c=h;else{if(p.equals(c.spatialReference,this.spatialReference))v=c.x,c=c.y;else{f=S.project(c,this.spatialReference);if(null==f)return null;v=f.x;c=f.y}f=h}h=k.resolution*this.size[0];k=k.resolution*this.size[1];f||=new R.TileKey(null,
0,0,0,H.create());f.level=b;f.row=Math.floor((this.origin.y-c)/k+.001);f.col=Math.floor((v-this.origin.x)/h+.001);this.updateTileInfo(f);return f}updateTileInfo(b,c=C.ExtrapolateOptions.NONE){var h=this.lodAt(b.level);h||c!==C.ExtrapolateOptions.POWER_OF_TWO||(c=this.lods[this.lods.length-1],c.level<b.level&&(h=c));if(h){var f=b.level-h.level;c=h.resolution*this.size[0]/2**f;h=h.resolution*this.size[1]/2**f;b.id=`${b.level}/${b.row}/${b.col}`;b.extent||(b.extent=H.create());b.extent[0]=this.origin.x+
b.col*c;b.extent[1]=this.origin.y-(b.row+1)*h;b.extent[2]=b.extent[0]+c;b.extent[3]=b.extent[1]+h}}upsampleTile(b){const c=this._upsampleLevels[b.level];if(!c||-1===c.parentLevel)return!1;b.level=c.parentLevel;b.row=Math.floor(b.row/c.factor+.001);b.col=Math.floor(b.col/c.factor+.001);this.updateTileInfo(b);return!0}getTileBounds(b,c){var h=this.lodAt(c.level);if(null==h)return null;var {resolution:f}=h;h=f*this.size[0];f*=this.size[1];b[0]=this.origin.x+c.col*h;b[1]=this.origin.y-(c.row+1)*f;b[2]=
b[0]+h;b[3]=b[1]+f;return b}lodAt(b){return this._levelToLOD?.[b]??null}clone(){return C.fromJSON(this.write({}))}getCompatibleForVTL(b){if(this.size[0]!==this.size[1]||256===this.size[0]&&512===b)return null;const c=(512===this.size[0]&&256===b?-1:0)+(this.spatialReference.isGeographic?1:0);if(this.size[0]===b&&0===c)return this;const h=[],f=this.lods.length-c;for(let k=0;k<f;k++){const v=k+c,{scale:x,resolution:A}=0<=v?this.lods[v]:{scale:2*this.lods[0].scale,resolution:2*this.lods[0].resolution};
h.push(new B({level:k,scale:x,resolution:A}))}return new C({size:[b,b],dpi:this.dpi,format:this.format,compressionQuality:this.compressionQuality,origin:this.origin,spatialReference:this.spatialReference,lods:h})}_initializeUpsampleLevels(){const b=this.lods;this._upsampleLevels=[];let c=null;for(let h=0;h<b.length;h++){const f=b[h];this._upsampleLevels[f.level]={parentLevel:c?c.level:-1,factor:c?c.resolution/f.resolution:0};c=f}}};l.__decorate([n.property({type:Number,json:{write:!0}})],r.prototype,
"compressionQuality",void 0);l.__decorate([n.property({type:Number,json:{write:!0}})],r.prototype,"dpi",void 0);l.__decorate([n.property({type:String,json:{read:e.read,write:e.write,origins:{"web-scene":{read:!1,write:!1}}}})],r.prototype,"format",void 0);l.__decorate([n.property({readOnly:!0})],r.prototype,"isWrappable",null);l.__decorate([n.property({type:L,json:{write:!0}})],r.prototype,"origin",void 0);l.__decorate([t.reader("origin")],r.prototype,"readOrigin",null);l.__decorate([n.property({type:[B],
value:null,json:{write:!0}})],r.prototype,"lods",null);l.__decorate([n.property({readOnly:!0})],r.prototype,"scales",void 0);l.__decorate([n.property({cast:b=>Array.isArray(b)?b:"number"===typeof b?[b,b]:[256,256]})],r.prototype,"size",void 0);l.__decorate([t.reader("size",["rows","cols"])],r.prototype,"readSize",null);l.__decorate([M.writer("size",{cols:{type:u.Integer},rows:{type:u.Integer}})],r.prototype,"writeSize",null);l.__decorate([n.property({type:z,json:{write:!0}})],r.prototype,"spatialReference",
void 0);r=C=l.__decorate([D.subclass("esri.layers.support.TileInfo")],r);(function(b){b=b.ExtrapolateOptions||(b.ExtrapolateOptions={});b[b.NONE=0]="NONE";b[b.POWER_OF_TWO=1]="POWER_OF_TWO"})(r||={});return r})},"esri/layers/support/LOD":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(l,e,r,w,n,
u,q){var g;e=g=class extends e{constructor(t){super(t);this.cols=null;this.level=0;this.origin=this.levelValue=null;this.resolution=0;this.rows=null;this.scale=0}clone(){return new g({cols:this.cols,level:this.level,levelValue:this.levelValue,resolution:this.resolution,rows:this.rows,scale:this.scale})}};l.__decorate([r.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"cols",void 0);l.__decorate([r.property({type:w.Integer,json:{write:!0}})],
e.prototype,"level",void 0);l.__decorate([r.property({type:String,json:{write:!0}})],e.prototype,"levelValue",void 0);l.__decorate([r.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"origin",void 0);l.__decorate([r.property({type:Number,json:{write:!0}})],e.prototype,"resolution",void 0);l.__decorate([r.property({json:{write:!0,origins:{"web-document":{read:!1,write:!1},"portal-item":{read:!1,write:!1}}}})],e.prototype,"rows",void 0);
l.__decorate([r.property({type:Number,json:{write:!0}})],e.prototype,"scale",void 0);return e=g=l.__decorate([q.subclass("esri.layers.support.LOD")],e)})},"esri/layers/support/TileKey":function(){define(["exports"],function(l){class e{constructor(r,w,n,u,q){this.id=r;this.level=w;this.row=n;this.col=u;this.extent=q}}l.TileKey=e;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/TileInfoTilemapCache":function(){define(["../../core/Error","../../core/promiseUtils"],
function(l,e){class r{constructor(w,n=0,u=w.lods[w.lods.length-1].level){this.tileInfo=w;this.minLOD=n;this.maxLOD=u;w.lodAt(n)||(this.minLOD=w.lods[0].level);w.lodAt(u)||(this.maxLOD=w.lods[w.lods.length-1].level)}get effectiveMinLOD(){return this.minLOD??this.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.tileInfo.lods[this.tileInfo.lods.length-1].level}getAvailability(w,n,u){const q=this.tileInfo?.lodAt(w);return!q||w<this.minLOD||w>this.maxLOD?"unavailable":q.cols&&q.rows?
u>=q.cols[0]&&u<=q.cols[1]&&n>=q.rows[0]&&n<=q.rows[1]?"unknown":"unavailable":"unknown"}async fetchAvailability(w,n,u,q){await e.waitTick(q);q=this.getAvailability(w,n,u);if("unavailable"===q)throw new l("tile-map:tile-unavailable","Tile is not available",{level:w,row:n,col:u});return q}async fetchAvailabilityUpsample(w,n,u,q,g){await e.waitTick(g);q.level=w;q.row=n;q.col=u;const t=this.tileInfo;t.updateTileInfo(q);return this.fetchAvailability(w,n,u,g).catch(D=>{if(e.isAbortError(D))throw D;if(t.upsampleTile(q))return this.fetchAvailabilityUpsample(q.level,
q.row,q.col,q,g);throw D;})}}return r})},"esri/layers/support/TilemapCache":function(){define("exports ../../chunks/tslib.es6 ../../request ../../core/Accessor ../../core/ByteSizeUnit ../../core/Error ../../core/handleUtils ../../core/has ../../core/LRUCache ../../core/PooledArray ../../core/promiseUtils ../../core/reactiveUtils ../../core/scheduling ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./TileKey ./Tilemap".split(" "),
function(l,e,r,w,n,u,q,g,t,D,M,L,z,H,p,S,B,R,C,b){function c(f,k,v){return new u("tile-map:tile-unavailable","Tile is not available",{level:f,row:k,col:v})}var h;l.TilemapCache=h=class extends w{constructor(f){super(f);this._pendingTilemapRequests={};this.request=r;this.size=32;this._prefetchingEnabled=!0}initialize(){this._tilemapCache=new t.LRUCache(2*n.ByteSizeUnit.MEGABYTES);this.addHandles(L.watch(()=>{const {layer:f}=this;return[f?.parsedUrl,f?.tileServers,f?.apiKey,f?.customParameters]},()=>
this._initializeTilemapDefinition(),L.initial))}get effectiveMinLOD(){return this.minLOD??this.layer.tileInfo.lods[0].level}get effectiveMaxLOD(){return this.maxLOD??this.layer.tileInfo.lods[this.layer.tileInfo.lods.length-1].level}getAvailability(f,k,v){return!this.layer.tileInfo.lodAt(f)||f<this.effectiveMinLOD||f>this.effectiveMaxLOD?"unavailable":(f=this._tilemapFromCache(f,k,v,this._tmpTilemapDefinition))?f.getAvailability(k,v):"unknown"}fetchAvailability(f,k,v,x){return!this.layer.tileInfo.lodAt(f)||
f<this.effectiveMinLOD||f>this.effectiveMaxLOD?Promise.reject(c(f,k,v)):this._fetchTilemap(f,k,v,x).catch(A=>A).then(A=>{if(A instanceof b.Tilemap){A=A.getAvailability(k,v);if("unavailable"===A)throw c(f,k,v);return A}if(M.isAbortError(A))throw A;return"unknown"})}fetchAvailabilityUpsample(f,k,v,x,A){x.level=f;x.row=k;x.col=v;const I=this.layer.tileInfo;I.updateTileInfo(x);const P=this.fetchAvailability(f,k,v,A).catch(J=>{if(M.isAbortError(J))throw J;if(I.upsampleTile(x))return this.fetchAvailabilityUpsample(x.level,
x.row,x.col,x,A);throw J;});this._fetchAvailabilityUpsamplePrefetch(x.id,f,k,v,A,P);return P}async _fetchAvailabilityUpsamplePrefetch(f,k,v,x,A,I){if(this._prefetchingEnabled&&null!=f){var P=`prefetch-${f}`;if(!this.hasHandles(P)){var J=new AbortController;I.then(()=>J.abort(),()=>J.abort());var G=!1;I=q.makeHandle(()=>{G||(G=!0,J.abort())});this.addHandles(I,P);await z.waitTicks(10,J.signal).catch(()=>{});G||(G=!0,this.removeHandles(P));if(!M.isAborted(J))for(f=new C.TileKey(f,k,v,x),A={...A,signal:J.signal},
k=this.layer.tileInfo,v=0;h._prefetches.length<h._maxPrefetch&&k.upsampleTile(f);++v){const Q=this.fetchAvailability(f.level,f.row,f.col,A);h._prefetches.push(Q);x=()=>{h._prefetches.removeUnordered(Q)};Q.then(x,x)}}}}_fetchTilemap(f,k,v,x){if(!this.layer.tileInfo.lodAt(f)||f<this.effectiveMinLOD||f>this.effectiveMaxLOD)return Promise.reject(new u("tilemap-cache:level-unavailable",`Level ${f} is unavailable in the service`));const A=this._tmpTilemapDefinition;if(f=this._tilemapFromCache(f,k,v,A))return Promise.resolve(f);
const I=x?.signal;x={...x,signal:null};return new Promise((P,J)=>{M.onAbort(I,()=>J(M.createAbortError()));const G=b.tilemapDefinitionId(A);let Q=this._pendingTilemapRequests[G];if(!Q){Q=b.Tilemap.fromDefinition(A,x).then(X=>{this._tilemapCache.put(G,X,X.byteSize);return X});const V=()=>{delete this._pendingTilemapRequests[G]};this._pendingTilemapRequests[G]=Q;Q.then(V,V)}Q.then(P,J)})}_initializeTilemapDefinition(){if(this.layer.parsedUrl){var {parsedUrl:f,apiKey:k,customParameters:v}=this.layer;
this._tilemapCache.clear();this._tmpTilemapDefinition={service:{url:f.path,query:H.objectToQuery({...f.query,...v,token:k??f.query?.token}),tileServers:this.layer.tileServers,request:this.request},width:this.size,height:this.size,level:0,row:0,col:0}}}_tilemapFromCache(f,k,v,x){x.level=f;x.row=k-k%this.size;x.col=v-v%this.size;f=b.tilemapDefinitionId(x);return this._tilemapCache.get(f)}get test(){}};l.TilemapCache._maxPrefetch=4;l.TilemapCache._prefetches=new D({initialSize:h._maxPrefetch});e.__decorate([p.property({constructOnly:!0})],
l.TilemapCache.prototype,"layer",void 0);e.__decorate([p.property({constructOnly:!0})],l.TilemapCache.prototype,"minLOD",void 0);e.__decorate([p.property({constructOnly:!0})],l.TilemapCache.prototype,"maxLOD",void 0);e.__decorate([p.property({constructOnly:!0})],l.TilemapCache.prototype,"request",void 0);e.__decorate([p.property({constructOnly:!0})],l.TilemapCache.prototype,"size",void 0);l.TilemapCache=h=e.__decorate([R.subclass("esri.layers.support.TilemapCache")],l.TilemapCache);Object.defineProperty(l,
Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(l){l.ByteSizeUnit=void 0;var e=l.ByteSizeUnit||(l.ByteSizeUnit={});e[e.KILOBYTES=1024]="KILOBYTES";e[e.MEGABYTES=1048576]="MEGABYTES";e[e.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Tilemap":function(){define("exports ../../request ../../core/Error ../../core/lang ../../core/memoryEstimations ../../geometry/support/UintArray".split(" "),
function(l,e,r,w,n,u){function q(t){if(t.service.tileServers?.length){var D=t.service.tileServers;D=`${D&&D.length?D[t.row%D.length]:t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`}else D=`${t.service.url}/tilemap/${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`;(t=t.service.query)&&(D=`${D}?${t}`);return D}class g{constructor(t){if(!t?.location)throw new r("tilemap:missing-location","Location missing from tilemap response");if(!1===t.valid)throw new r("tilemap:invalid",
"Tilemap response was marked as invalid");if(!t.data)throw new r("tilemap:missing-data","Data missing from tilemap response");if(!Array.isArray(t.data))throw new r("tilemap:data-mismatch","Data must be an array of numbers");if(t.data.length!==t.location.width*t.location.height)throw new r("tilemap:data-mismatch","Number of data items does not match width/height of tilemap");const {location:D,data:M}=t;this.location=Object.freeze(w.clone(D));let L=t=!0;const z=u.newUintArray(Math.ceil(this.location.width*
this.location.height/32));let H=0;for(let p=0;p<M.length;p++){const S=p%32;M[p]?(L=!1,z[H]|=1<<S):t=!1;31===S&&++H}L?(this._availability="unavailable",this.byteSize=40):t?(this._availability="available",this.byteSize=40):(this._availability=z,this.byteSize=40+n.estimateNumberArrayMemory(z))}getAvailability(t,D){if("unavailable"===this._availability||"available"===this._availability)return this._availability;t=(t-this.location.top)*this.location.width+(D-this.location.left);D=t>>5;const M=this._availability;
return 0>D||D>M.length?"unknown":M[D]&1<<t%32?"available":"unavailable"}static fromDefinition(t,D){const M=t.service.request||e,{row:L,col:z,width:H,height:p}=t,S={query:{f:"json"}};D=D?{...S,...D}:S;return M(q(t),D).then(B=>B.data).catch(B=>{if(422===B?.details?.httpStatus)return{location:{top:L,left:z,width:H,height:p},valid:!0,data:Array(H*p).fill(0)};throw B;}).then(B=>{if(B.location&&(B.location.top!==L||B.location.left!==z||B.location.width!==H||B.location.height!==p))throw new r("tilemap:location-mismatch",
"Tilemap response for different location than requested",{response:B,definition:{top:L,left:z,width:H,height:p}});return g.fromJSON(B)})}static fromJSON(t){return Object.freeze(new g(t))}}l.Tilemap=g;l.tilemapDefinitionId=function(t){return`${t.level}/${t.row}/${t.col}/${t.width}/${t.height}`};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/geometry/support/UintArray":function(){define(["exports","../../core/typedArrayUtil"],function(l,e){l.newUintArray=function(r,w=!1){return r<=
e.nativeArrayMaxSize?w?Array(r).fill(0):Array(r):new Uint32Array(r)};l.uintSubArray=function(r,w,n){return Array.isArray(r)?r.slice(w,w+n):r.subarray(w,w+n)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/mixins/ArcGISMapService":function(){define("exports ../../chunks/tslib.es6 ../../request ../../core/MapUtils ../../core/promiseUtils ../../core/urlUtils ../../core/Version ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/PropertyOrigin ../../geometry/Extent ../../geometry/SpatialReference ../support/arcgisLayerUrl ../support/commonProperties ../../portal/support/portalItemUtils".split(" "),
function(l,e,r,w,n,u,q,g,t,D,M,L,z,H,p,S,B,R,C){l.ArcGISMapService=b=>{b=class extends b{constructor(){super(...arguments);this.capabilities=void 0;this.fullExtent=this.copyright=null;this.legendEnabled=!0;this.spatialReference=null;this.version=void 0;this._allLayersAndTablesMap=null}readCapabilities(c,h){var f=h.capabilities&&h.capabilities.split(",").map(X=>X.toLowerCase().trim());if(!f)return{operations:{supportsExportMap:!1,supportsExportTiles:!1,supportsIdentify:!1,supportsQuery:!1,supportsTileMap:!1},
exportMap:null,exportTiles:null};var k=this.type;c="tile"!==k&&!!h.supportsDynamicLayers;const v=f.includes("query"),x=f.includes("map"),A=!!h.exportTilesAllowed,I=f.includes("tilemap");f=f.includes("data");const P="tile"!==k&&(!h.tileInfo||c),J="tile"!==k&&(!h.tileInfo||c),G="tile"!==k;k="tile"!==k&&c&&11.1<=h.currentVersion;var Q=h.cimVersion?q.Version.parse(h.cimVersion):null;const V=Q?.greaterEqual(1,4)??!1;Q=Q?.greaterEqual(2,0)??!1;return{operations:{supportsExportMap:x,supportsExportTiles:A,
supportsIdentify:v,supportsQuery:f,supportsTileMap:I},exportMap:x?{supportsArcadeExpressionForLabeling:V,supportsCIMSymbols:Q,supportsDynamicLayers:c,supportsSublayerOrderBy:k,supportsSublayerDefinitionExpression:J,supportsSublayerVisibility:P,supportsSublayersChanges:G}:null,exportTiles:A?{maxExportTilesCount:+h.maxExportTilesCount}:null}}readVersion(c,h){(c=h.currentVersion)||(c=h.hasOwnProperty("capabilities")||h.hasOwnProperty("tables")?10:h.hasOwnProperty("supportedImageFormatTypes")?9.31:9.3);
return c}async fetchRelatedService(c){var h=this.portalItem;if(!h||!C.isHostedLayer(h))return null;this._relatedFeatureServicePromise||(this._relatedFeatureServicePromise=h.fetchRelatedItems({relationshipType:"Service2Service",direction:"reverse"},c).then(f=>f.find(k=>"Feature Service"===k.type)??null,()=>null));h=await this._relatedFeatureServicePromise;n.throwIfAborted(c);return h?{itemId:h.id,url:h.url}:null}async fetchSublayerInfo(c,h){const {source:f}=c;if(this?.portalItem&&"tile"===this.type&&
"map-layer"===f?.type&&C.isHostedLayer(this.portalItem)&&c.originIdOf("url")<H.OriginId.SERVICE){var k=await this.fetchRelatedService(h);k&&(c.url=u.join(k.url,f.mapLayerId.toString()),c.layerItemId=k.itemId)}({url:k}=c);let v;if("data-layer"===f.type)v=(await r(k,{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey},...h})).data;else if(k&&c.originIdOf("url")>H.OriginId.SERVICE)try{const x=await this._fetchAllLayersAndTablesFromService(k),A=B.parse(k)?.sublayer??f.mapLayerId;
v=x.get(A)}catch{}else{c=c.id;"map-layer"===f?.type&&(c=f.mapLayerId);try{v=(await this.fetchAllLayersAndTables(h)).get(c)}catch{}}return v}async fetchAllLayersAndTables(c){return this._fetchAllLayersAndTablesFromService(this.parsedUrl?.path,c)}async _fetchAllLayersAndTablesFromService(c,h){await this.load(h);this._allLayersAndTablesMap||(this._allLayersAndTablesMap=new Map);const f=B.parse(c);c=await w.getOrCreateMapValue(this._allLayersAndTablesMap,f?.url.path,()=>r(u.join(f?.url.path,"/layers"),
{responseType:"json",query:{f:"json",...this.customParameters,token:this.apiKey}}).then(k=>{const v=new Map,{layers:x,tables:A}=k.data;k=[...(x??[]),...(A??[])];for(const I of k)v.set(I.id,I);return{result:v}},k=>({error:k})));n.throwIfAborted(h);if("result"in c)return c.result;throw c.error;}};e.__decorate([g.property({readOnly:!0})],b.prototype,"capabilities",void 0);e.__decorate([L.reader("service","capabilities",["capabilities","exportTilesAllowed","maxExportTilesCount","supportsDynamicLayers",
"tileInfo"])],b.prototype,"readCapabilities",null);e.__decorate([g.property({json:{read:{source:"copyrightText"}}})],b.prototype,"copyright",void 0);e.__decorate([g.property({type:p})],b.prototype,"fullExtent",void 0);e.__decorate([g.property(R.id)],b.prototype,"id",void 0);e.__decorate([g.property({type:Boolean,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend"}}})],b.prototype,"legendEnabled",void 0);e.__decorate([g.property(R.popupEnabled)],b.prototype,
"popupEnabled",void 0);e.__decorate([g.property({type:S})],b.prototype,"spatialReference",void 0);e.__decorate([g.property({readOnly:!0})],b.prototype,"version",void 0);e.__decorate([L.reader("service","version",["currentVersion","capabilities","tables","supportedImageFormatTypes"])],b.prototype,"readVersion",null);return b=e.__decorate([z.subclass("esri.layers.mixins.ArcGISMapService")],b)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/mixins/SublayersOwner":function(){define("exports ../../chunks/tslib.es6 ../../core/Collection ../../core/CollectionFlattener ../../core/Error ../../core/Logger ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/RandomLCG ../../core/accessorSupport/utils ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/PropertyOrigin ../support/Sublayer ../support/sublayerUtils".split(" "),
function(l,e,r,w,n,u,q,g,t,D,M,L,z,H,p){function S(C,b){const c=[],h={};if(!C)return c;C.forEach(f=>{const k=new H;k.read(f,b);h[k.id]=k;null!=f.parentLayerId&&-1!==f.parentLayerId?(f=h[f.parentLayerId],f.sublayers||(f.sublayers=[]),f.sublayers.unshift(k)):c.unshift(k)});return c}function B(C,b){C&&C.forEach(c=>{b(c);c.sublayers&&c.sublayers.length&&B(c.sublayers,b)})}const R=r.ofType(H);l.SublayersOwner=C=>{C=class extends C{constructor(...b){super(...b);this.allSublayers=new w({getCollections:()=>
[this.sublayers],getChildrenFunction(c){return c.sublayers}});this.sublayersSourceJSON={[z.OriginId.SERVICE]:{},[z.OriginId.PORTAL_ITEM]:{},[z.OriginId.WEB_SCENE]:{},[z.OriginId.WEB_MAP]:{},[z.OriginId.LINK_CHART]:{}};this.subtables=null;this.addHandles([q.watch(()=>this.sublayers,(c,h)=>this._handleSublayersChange(c,h),q.sync),q.watch(()=>this.subtables,(c,h)=>this._handleSublayersChange(c,h),q.sync)])}destroy(){this.allSublayers.destroy()}readSublayers(b,c){if(c&&b){var {sublayersSourceJSON:h}=
this,f=z.nameToId(c.origin);if(!(f<z.OriginId.SERVICE||(h[f]={context:c,visibleLayers:b.visibleLayers||h[f].visibleLayers,layers:b.layers||h[f].layers},f>z.OriginId.SERVICE))){this._set("serviceSublayers",this.createSublayersForOrigin("service").sublayers);var {sublayers:k,origin:v}=this.createSublayersForOrigin("web-document");b=M.getProperties(this);b.setDefaultOrigin(v);this._set("sublayers",new R(k));b.setDefaultOrigin("user")}}}findSublayerById(b){return this.allSublayers.find(c=>c.id===b)}createServiceSublayers(){return this.createSublayersForOrigin("service").sublayers}createSublayersForOrigin(b){const c=
"web-document"===b?z.nameToId("web-map"):z.nameToId(b);let h=z.OriginId.SERVICE;b=this.sublayersSourceJSON[z.OriginId.SERVICE].layers;let f=this.sublayersSourceJSON[z.OriginId.SERVICE].context,k=null;var v=[z.OriginId.PORTAL_ITEM,z.OriginId.WEB_SCENE,z.OriginId.WEB_MAP].filter(G=>G<=c);for(var x of v)v=this.sublayersSourceJSON[x],p.isSublayerOverhaul(v.layers)&&(h=x,b=v.layers,f=v.context,v.visibleLayers&&(k={visibleLayers:v.visibleLayers,context:v.context}));x=[z.OriginId.PORTAL_ITEM,z.OriginId.WEB_SCENE,
z.OriginId.WEB_MAP].filter(G=>G>h&&G<=c);let A=null;for(var I of x){const {layers:G,visibleLayers:Q,context:V}=this.sublayersSourceJSON[I];G&&(A={layers:G,context:V});Q&&(k={visibleLayers:Q,context:V})}I=S(b,f);const P=new Map,J=new Set;if(A)for(const G of A.layers)P.set(G.id,G);if(k?.visibleLayers)for(const G of k.visibleLayers)J.add(G);B(I,G=>{A&&G.read(P.get(G.id),A.context);k&&G.read({defaultVisibility:J.has(G.id)},k.context)});return{origin:z.idToName(h),sublayers:new R({items:I})}}read(b,c){super.read(b,
c);this.readSublayers(b,c)}_handleSublayersChange(b,c){c&&(c.forEach(h=>{h.parent=null;h.layer=null}),this.removeHandles("sublayers-owner"));b&&(b.forEach(h=>{h.parent=this;h.layer=this}),this.addHandles([b.on("after-add",({item:h})=>{h.parent=this;h.layer=this}),b.on("after-remove",({item:h})=>{h.parent=null;h.layer=null})],"sublayers-owner"),"tile"===this.type&&this.addHandles(b.on("before-changes",h=>{u.getLogger("esri.layers.TileLayer").error(new n("tilelayer:sublayers-non-modifiable","ISublayer can't be added, moved, or removed from the layer's sublayers",
{layer:this}));h.preventDefault()}),"sublayers-owner"))}};e.__decorate([g.property({readOnly:!0})],C.prototype,"allSublayers",void 0);e.__decorate([g.property({readOnly:!0,type:r.ofType(H)})],C.prototype,"serviceSublayers",void 0);e.__decorate([g.property({value:null,type:R,json:{read:!1,write:{allowNull:!0,ignoreOrigin:!0}}})],C.prototype,"sublayers",void 0);e.__decorate([g.property({readOnly:!0})],C.prototype,"sublayersSourceJSON",void 0);e.__decorate([g.property({type:R,json:{read:{source:"tables"}}})],
C.prototype,"subtables",void 0);return C=e.__decorate([L.subclass("esri.layers.mixins.SublayersOwner")],C)};l.forEachSublayer=B;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/Sublayer":function(){define("require ../../chunks/tslib.es6 ../../PopupTemplate ../../request ../../core/Collection ../../core/Error ../../core/has ../../core/Identifiable ../../core/lang ../../core/Loadable ../../core/Logger ../../core/MultiOriginJSONSupport ../../core/sql ../../core/urlUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/decorators/writer ../../core/accessorSupport/ensureType ../../core/accessorSupport/PropertyOrigin ../../core/accessorSupport/utils ../../geometry/Extent ../../geometry/SpatialReference ../../geometry/support/typeUtils ../graphics/sources/support/QueryTask ../mixins/OrderedLayer ./featureLayerUtils ./FeatureType ./Field ./FieldsIndex ./fieldUtils ./LabelClass ./labelingInfo ./LayerFloorInfo ./OrderByInfo ./Relationship ./serviceCapabilitiesUtils ./source/DataLayerSource ./source/MapLayerSource ../../renderers/support/typeUtils ../../rest/utils ../../rest/support/AttachmentQuery ../../rest/support/Query ../../support/popupUtils ../../symbols/support/typeUtils".split(" "),
function(l,e,r,w,n,u,q,g,t,D,M,L,z,H,p,S,B,R,C,b,c,h,f,k,v,x,A,I,P,J,G,Q,V,X,y,F,K,N,T,aa,W,ka,la,ma,na,oa){function fa(a,d,m){a=this.originIdOf(d)>=c.nameToId(m.origin);return{ignoreOrigin:!0,allowNull:a,enabled:m?"map-image"===m.layer?.type&&(m.writeSublayerStructure||a):!1}}function ha(a,d,m){return{enabled:m?"tile"===m.layer?.type&&(m.origin&&this.originIdOf(d)>=c.nameToId(m.origin)||this._isOverridden(d)):!1}}function Y(a,d,m){return{ignoreOrigin:!0,enabled:m&&m.writeSublayerStructure||!1}}function ba(a,
d,m){return{ignoreOrigin:!0,enabled:m?.writeSublayerStructure?this.originIdOf(d)>c.OriginId.SERVICE:!1}}function ca(a,d,m){return{ignoreOrigin:!0,enabled:m?m.writeSublayerStructure||this.originIdOf(d)>=c.nameToId(m.origin):!1}}var da;let pa=0;const qa=new Set("layer parent loaded loadStatus loadError loadWarnings".split(" "));g=da=class extends L.MultiOriginJSONMixin(g.IdentifiableMixin(D)){constructor(a){super(a);this.capabilities=void 0;this.maxScaleRange={minScale:0,maxScale:0};this.globalIdField=
this.geometryType=this.fullExtent=this.fields=null;this.isTable=!1;this.legendEnabled=!0;this.parent=this.objectIdField=null;this.popupEnabled=!0;this.typeIdField=this.title=this.spatialReference=this.sourceJSON=this.relationships=this.popupTemplate=null;this.type="sublayer";this._lastParsedUrl=this.types=null}async load(a){this.addResolvingPromise((async()=>{const {layer:d,url:m}=this;if(!d&&!m)throw new u("sublayer:missing-layer","Sublayer can't be loaded without being part of a layer",{sublayer:this});
const E=d?await d.fetchSublayerInfo(this,a):(await w(m,{responseType:"json",query:{f:"json"},...a})).data;E&&(this.sourceJSON=E,this.read({layerDefinition:E},{origin:"service",layer:d,url:ka.parseUrl(m)}))})());return this}readCapabilities(a,d){d=d.layerDefinition||d;const {attachment:m,operations:{supportsQuery:E,supportsQueryAttachments:O},query:{supportsFormatPBF:U,supportsOrderBy:Z,supportsPagination:ia},data:{supportsAttachment:ja},queryRelated:ea}=N.getFeatureLayerCapabilities(d,this.url);return{attachment:{supportsOrderByFields:m?.supportsOrderByFields??
!1,supportsResize:m?.supportsResize??!1},exportMap:{supportsModification:!!d.canModifyLayer},operations:{supportsQuery:E,supportsQueryAttachments:O},data:{supportsAttachment:ja},query:{supportsFormatPBF:U,supportsOrderBy:Z,supportsPagination:ia},queryRelated:ea}}get defaultPopupTemplate(){return this.createPopupTemplate()}set definitionExpression(a){this._setAndNotifyLayer("definitionExpression",a)}get effectiveScaleRange(){const {minScale:a,maxScale:d}=this;return{minScale:a,maxScale:d}}readMaxScaleRange(a,
d){d=d.layerDefinition||d;return{minScale:d.minScale??0,maxScale:d.maxScale??0}}get fieldsIndex(){return new G(this.fields||[])}set floorInfo(a){this._setAndNotifyLayer("floorInfo",a)}readGlobalIdFieldFromService(a,d){d=d.layerDefinition||d;if(d.globalIdField)return d.globalIdField;if(d.fields)for(const m of d.fields)if("esriFieldTypeGlobalID"===m.type)return m.name}get id(){const a=this._get("id");return null==a?pa++:a}set id(a){this._get("id")!==a&&(!1===this.layer?.capabilities?.exportMap?.supportsDynamicLayers?
this._logLockedError("id","capability not available 'layer.capabilities.exportMap.supportsDynamicLayers'"):this._set("id",a))}readIsTable(a,d){return"Table"===d.type}set labelingInfo(a){this._setAndNotifyLayer("labelingInfo",a)}writeLabelingInfo(a,d,m,E){a&&a.length&&(d.layerDefinition={drawingInfo:{labelingInfo:a.map(O=>O.write({},E))}})}set labelsVisible(a){this._setAndNotifyLayer("labelsVisible",a)}set layer(a){this._set("layer",a);this.sublayers?.forEach(d=>d.layer=a)}set listMode(a){this._set("listMode",
a)}set minScale(a){this._setAndNotifyLayer("minScale",a)}readMinScale(a,d){return d.minScale||d.layerDefinition?.minScale||0}set maxScale(a){this._setAndNotifyLayer("maxScale",a)}readMaxScale(a,d){return d.maxScale||d.layerDefinition?.maxScale||0}readObjectIdFieldFromService(a,d){d=d.layerDefinition||d;return d.objectIdField?d.objectIdField:d.fields?.find(m=>"esriFieldTypeOID"===m.type)?.name}set opacity(a){this._setAndNotifyLayer("opacity",a)}readOpacity(a,d){({layerDefinition:a}=d);return 1-.01*
(a?.transparency??a?.drawingInfo?.transparency??0)}writeOpacity(a,d,m,E){d.layerDefinition={drawingInfo:{transparency:100-100*a}}}set orderBy(a){this._setAndNotifyLayer("orderBy",a)}writeParent(a,d){d.parentLayerId=this.parent&&this.parent!==this.layer?b.ensureInteger(this.parent.id):-1}get queryTask(){if(!this.layer)return null;const {capabilities:a,fieldsIndex:d,layer:m,url:E}=this,{spatialReference:O}=m,U="gdbVersion"in m?m.gdbVersion:void 0,Z=q("featurelayer-pbf")&&a?.query.supportsFormatPBF;
return new x({fieldsIndex:d,gdbVersion:U,pbfSupported:Z,queryAttachmentsSupported:a?.operations?.supportsQueryAttachments??!1,sourceSpatialReference:O,url:E})}set renderer(a){Q.fixRendererFields(a,this.fieldsIndex);if(a)for(const d of a.symbols)if(oa.isSymbol3D(d)){M.getLogger(this).warn("Sublayer renderer should use 2D symbols");break}this._setAndNotifyLayer("renderer",a)}get source(){return this._get("source")||new aa.MapLayerSource({mapLayerId:this.id})}set source(a){this._setAndNotifyLayer("source",
a)}set sublayers(a){this._handleSublayersChange(a,this._get("sublayers"));this._set("sublayers",a)}castSublayers(a){return b.ensureType(n.ofType(da),a)}writeSublayers(a,d,m){this.sublayers?.length&&(d[m]=this.sublayers.map(E=>E.id).toArray().reverse())}readTitle(a,d){return d.layerDefinition?.name??d.name}readTypeIdField(a,d){d=d.layerDefinition||d;let m=d.typeIdField;m&&d.fields&&(m=m.toLowerCase(),a=d.fields.find(E=>E.name.toLowerCase()===m))&&(m=a.name);return m}get url(){const a=this.layer?.parsedUrl??
this._lastParsedUrl;var d=this.source;if(!a)return null;this._lastParsedUrl=a;if("map-layer"===d?.type)return`${a.path}/${d.mapLayerId}`;d={layer:JSON.stringify({source:this.source})};return`${a.path}/dynamicLayer?${H.objectToQuery(d)}`}set url(a){this._overrideIfSome("url",a)}set visible(a){this._setAndNotifyLayer("visible",a)}writeVisible(a,d,m,E){d[m]=this.getAtOrigin("defaultVisibility","service")||a}clone(){const {store:a}=h.getProperties(this),d=new da;h.getProperties(d).store=a.clone(qa);this.commitProperty("url");
d._lastParsedUrl=this._lastParsedUrl;return d}createPopupTemplate(a){return na.createPopupTemplate(this,a)}createQuery(){return new ma({returnGeometry:!0,where:this.definitionExpression||"1\x3d1"})}async createFeatureLayer(){if(this.hasOwnProperty("sublayers"))return null;var a=(await new Promise((E,O)=>l(["../FeatureLayer"],U=>E(Object.freeze(Object.defineProperty({__proto__:null,default:U},Symbol.toStringTag,{value:"Module"}))),O))).default;const {layer:d,url:m}=this;if(m&&this.originIdOf("url")>
c.OriginId.SERVICE)a=new a({url:m});else if(d?.parsedUrl){const E=d.parsedUrl;a=new a({url:E.path});E&&this.source&&("map-layer"===this.source.type?a.layerId=this.source.mapLayerId:a.dynamicDataSource=this.source)}else throw new u("createFeatureLayer:missing-information","Cannot create a FeatureLayer without a url or a parent layer");null!=d?.refreshInterval&&(a.refreshInterval=d.refreshInterval);this.definitionExpression&&(a.definitionExpression=this.definitionExpression);this.floorInfo&&(a.floorInfo=
t.clone(this.floorInfo));this.originIdOf("labelingInfo")>c.OriginId.SERVICE&&(a.labelingInfo=t.clone(this.labelingInfo));this.originIdOf("labelsVisible")>c.OriginId.DEFAULTS&&(a.labelsVisible=this.labelsVisible);this.originIdOf("legendEnabled")>c.OriginId.DEFAULTS&&(a.legendEnabled=this.legendEnabled);this.originIdOf("visible")>c.OriginId.DEFAULTS&&(a.visible=this.visible);this.originIdOf("minScale")>c.OriginId.DEFAULTS&&(a.minScale=this.minScale);this.originIdOf("maxScale")>c.OriginId.DEFAULTS&&
(a.maxScale=this.maxScale);this.originIdOf("opacity")>c.OriginId.DEFAULTS&&(a.opacity=this.opacity);this.originIdOf("popupTemplate")>c.OriginId.DEFAULTS&&(a.popupTemplate=t.clone(this.popupTemplate));this.originIdOf("renderer")>c.OriginId.SERVICE&&(a.renderer=t.clone(this.renderer));"data-layer"===this.source?.type&&(a.dynamicDataSource=this.source.clone());this.originIdOf("title")>c.OriginId.DEFAULTS&&(a.title=this.title);"map-image"===d?.type&&d.originIdOf("customParameters")>c.OriginId.DEFAULTS&&
(a.customParameters=d.customParameters);"tile"===d?.type&&d.originIdOf("customParameters")>c.OriginId.DEFAULTS&&(a.customParameters=d.customParameters);return a}getField(a){return this.fieldsIndex.get(a)}getFeatureType(a){return I.getFeatureType(this.types,this.typeIdField,a)}getFieldDomain(a,d){return(d=this.getFeatureType(d?.feature))&&(d=d.domains&&d.domains[a])&&"inherited"!==d.type?d:this._getLayerDomain(a)}async queryAttachments(a,d){await this.load();a=la.from(a);const m=this.capabilities;
if(!m?.data?.supportsAttachment)throw new u("queryAttachments:not-supported","this layer doesn't support attachments");const {attachmentTypes:E,objectIds:O,globalIds:U,num:Z,size:ia,start:ja,where:ea}=a;if(!m?.operations?.supportsQueryAttachments&&(0<E?.length||0<U?.length||0<ia?.length||Z||ja||ea))throw new u("queryAttachments:option-not-supported","when 'capabilities.operations.supportsQueryAttachments' is false, only objectIds is supported",a);if(!(O?.length||U?.length||ea))throw new u("queryAttachments:invalid-query",
"'objectIds', 'globalIds', or 'where' are required to perform attachment query",a);!m?.attachment?.supportsOrderByFields&&a.orderByFields?.length&&(a=a.clone(),a.orderByFields=null);return this.queryTask.executeAttachmentQuery(a,d)}async queryFeatureCount(a=this.createQuery(),d){await this.load();if(!this.capabilities.operations.supportsQuery)throw new u("queryFeatureCount:not-supported","this layer doesn't support queries.");if(!this.url)throw new u("queryFeatureCount:not-supported","this layer has no url.");
return await this.queryTask.executeForCount(a,{...d,query:{...this.layer?.customParameters,token:this.layer?.apiKey}})}async queryFeatures(a=this.createQuery(),d){await this.load();if(!this.capabilities.operations.supportsQuery)throw new u("queryFeatures:not-supported","this layer doesn't support queries.");if(!this.url)throw new u("queryFeatures:not-supported","this layer has no url.");a=await this.queryTask.execute(a,{...d,query:{...this.layer?.customParameters,token:this.layer?.apiKey}});if(a?.features)for(const m of a.features)m.sourceLayer=
this;return a}async queryObjectIds(a=this.createQuery(),d){await this.load();if(!this.capabilities.operations.supportsQuery)throw new u("queryObjectIds:not-supported","this layer doesn't support queries.");if(!this.url)throw new u("queryObjectIds:not-supported","this layer has no url.");return await this.queryTask.executeForIds(a,{...d,query:{...this.layer?.customParameters,token:this.layer?.apiKey}})}async queryRelatedFeatures(a,d){await this.load();if(!this.capabilities.operations.supportsQuery)throw new u("queryRelatedFeatures:not-supported",
"this layer doesn't support queries.");if(!this.url)throw new u("queryRelatedFeatures:not-supported","this layer has no url.");return await this.queryTask.executeRelationshipQuery(a,{...d,query:{...this.layer?.customParameters,token:this.layer?.apiKey}})}async queryRelatedFeaturesCount(a,d){await this.load();if(!this.capabilities.operations.supportsQuery)throw new u("queryRelatedFeaturesCount:not-supported","this layer doesn't support queries.");if(!this.capabilities.queryRelated.supportsCount)throw new u("queryRelatedFeaturesCount:not-supported",
"this layer doesn't support query related counts.");if(!this.url)throw new u("queryRelatedFeaturesCount:not-supported","this layer has no url.");return await this.queryTask.executeRelationshipQueryForCount(a,{...d,query:{...this.layer?.customParameters,token:this.layer?.apiKey}})}toExportImageJSON(a){const d={id:this.id,source:this.source?.toJSON()||{mapLayerId:this.id,type:"mapLayer"}};a=z.sqlAnd(a,this.definitionExpression);null!=a&&(d.definitionExpression=a);const m=["renderer","labelingInfo",
"opacity","labelsVisible"].reduce((E,O)=>{E[O]=this.originIdOf(O);return E},{});if(Object.keys(m).some(E=>m[E]>c.OriginId.SERVICE)){a=d.drawingInfo={};m.renderer>c.OriginId.SERVICE&&(a.renderer=this.renderer?this.renderer.toJSON():null);m.labelsVisible>c.OriginId.SERVICE&&(a.showLabels=this.labelsVisible);if(this.labelsVisible&&m.labelingInfo>c.OriginId.SERVICE)if(this.labelingInfo){!this.loaded&&this.labelingInfo?.some(O=>!O.labelPlacement)&&M.getLogger(this).warnOnce(`A Sublayer (title: ${this.title}, id: ${this.id}) has an undefined 'labelPlacement' `+
"and so labels cannot be displayed. Either define a valid 'labelPlacement' or call Sublayer.load() to use a default value based on geometry type.",{sublayer:this});let E=this.labelingInfo;null!=this.geometryType&&(E=X.validateLabelingInfo(this.labelingInfo,v.featureGeometryTypeKebabDictionary.toJSON(this.geometryType)));a.showLabels=!0;a.labelingInfo=E.filter(O=>O.labelPlacement).map(O=>O.toJSON({origin:"service",layer:this.layer}))}else a.showLabels=!1;m.opacity>c.OriginId.SERVICE&&(a.transparency=
100-100*this.opacity);this._assignDefaultSymbolColors(a.renderer)}(this.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??!1)&&this.originIdOf("orderBy")>c.OriginId.SERVICE&&(d.orderBy=this.orderBy?.map(E=>E.toJSON())??null);return d}_assignDefaultSymbolColors(a){this._forEachSimpleMarkerSymbols(a,d=>{d.color||"esriSMSX"!==d.style&&"esriSMSCross"!==d.style||(d.color=d.outline?.color?d.outline.color:[0,0,0,0])})}_forEachSimpleMarkerSymbols(a,d){if(a){const m=("uniqueValueInfos"in a?a.uniqueValueInfos:
"classBreakInfos"in a?a.classBreakInfos:null)??[];for(const E of m)"esriSMS"===E.symbol?.type&&d(E.symbol);"symbol"in a&&"esriSMS"===a.symbol?.type&&d(a.symbol);"defaultSymbol"in a&&"esriSMS"===a.defaultSymbol?.type&&d(a.defaultSymbol)}}_setAndNotifyLayer(a,d){const m=this.layer,E=this._get(a);let O,U;switch(a){case "definitionExpression":case "floorInfo":O="supportsSublayerDefinitionExpression";break;case "minScale":case "maxScale":case "visible":O="supportsSublayerVisibility";break;case "labelingInfo":case "labelsVisible":case "opacity":case "renderer":case "source":O=
"supportsDynamicLayers";U="supportsModification";break;case "orderBy":O="supportsSublayerOrderBy",U="supportsModification"}const Z=h.getProperties(this).getDefaultOrigin();if("service"!==Z){if(O&&!1===this.layer?.capabilities?.exportMap?.[O]){this._logLockedError(a,`capability not available 'layer.capabilities.exportMap.${O}'`);return}if(U&&!1===this.capabilities?.exportMap[U]){this._logLockedError(a,`capability not available 'capabilities.exportMap.${U}'`);return}}"source"===a&&"not-loaded"!==this.loadStatus?
this._logLockedError(a,"'source' can't be changed after calling sublayer.load()"):(this._set(a,d),"service"!==Z&&E!==d&&m&&m.emit&&m.emit("sublayer-update",{propertyName:a,target:this}))}_handleSublayersChange(a,d){d&&(d.forEach(m=>{m.parent=null;m.layer=null}),this.removeAllHandles());a&&(a.forEach(m=>{m.parent=this;m.layer=this.layer}),this.addHandles([a.on("after-add",({item:m})=>{m.parent=this;m.layer=this.layer}),a.on("after-remove",({item:m})=>{m.parent=null;m.layer=null}),a.on("before-changes",
m=>{(this.layer?.capabilities?.exportMap?.supportsSublayersChanges??!0)||(M.getLogger(this).error(new u("sublayer:sublayers-non-modifiable","Sublayer can't be added, moved, or removed from the layer's sublayers",{sublayer:this,layer:this.layer})),m.preventDefault())})]))}_logLockedError(a,d){const {layer:m,declaredClass:E}=this;M.getLogger(E).error(new u("sublayer:locked",`Property '${String(a)}' can't be changed on Sublayer from the layer '${m?.id}'`,{reason:d,sublayer:this,layer:m}))}_getLayerDomain(a){return this.fieldsIndex.get(a)?.domain??
null}};g.test={isMapImageLayerOverridePolicy:a=>a===ba||a===Y||a===fa,isTileImageLayerOverridePolicy:a=>a===ha};e.__decorate([p.property({readOnly:!0})],g.prototype,"capabilities",void 0);e.__decorate([B.reader("service","capabilities",["layerDefinition.canModifyLayer","layerDefinition.capabilities"])],g.prototype,"readCapabilities",null);e.__decorate([p.property()],g.prototype,"defaultPopupTemplate",null);e.__decorate([p.property({type:String,value:null,json:{name:"layerDefinition.definitionExpression",
write:{allowNull:!0,overridePolicy:fa}}})],g.prototype,"definitionExpression",null);e.__decorate([p.property({readOnly:!0})],g.prototype,"effectiveScaleRange",null);e.__decorate([B.reader("service","maxScaleRange",["minScale","maxScale"])],g.prototype,"readMaxScaleRange",null);e.__decorate([p.property({type:[J],json:{origins:{service:{read:{source:"layerDefinition.fields"}}}}})],g.prototype,"fields",void 0);e.__decorate([p.property({readOnly:!0})],g.prototype,"fieldsIndex",null);e.__decorate([p.property({type:y,
value:null,json:{name:"layerDefinition.floorInfo",read:{source:"layerDefinition.floorInfo"},write:{target:"layerDefinition.floorInfo",overridePolicy:fa},origins:{"web-scene":{read:!1,write:!1}}}})],g.prototype,"floorInfo",null);e.__decorate([p.property({type:f,json:{read:{source:"layerDefinition.extent"}}})],g.prototype,"fullExtent",void 0);e.__decorate([p.property({type:v.featureGeometryTypeKebabDictionary.apiValues,json:{origins:{service:{name:"layerDefinition.geometryType",read:{reader:v.featureGeometryTypeKebabDictionary.read}}}}})],
g.prototype,"geometryType",void 0);e.__decorate([p.property({type:String})],g.prototype,"globalIdField",void 0);e.__decorate([B.reader("service","globalIdField",["layerDefinition.globalIdField","layerDefinition.fields"])],g.prototype,"readGlobalIdFieldFromService",null);e.__decorate([p.property({type:b.Integer,json:{write:{ignoreOrigin:!0}}})],g.prototype,"id",null);e.__decorate([p.property({readOnly:!0})],g.prototype,"isTable",void 0);e.__decorate([B.reader("service","isTable",["type"])],g.prototype,
"readIsTable",null);e.__decorate([p.property({value:null,type:[V],json:{read:{source:"layerDefinition.drawingInfo.labelingInfo"},write:{target:"layerDefinition.drawingInfo.labelingInfo",overridePolicy:ba}}})],g.prototype,"labelingInfo",null);e.__decorate([C.writer("labelingInfo")],g.prototype,"writeLabelingInfo",null);e.__decorate([p.property({type:Boolean,value:!0,json:{read:{source:"layerDefinition.drawingInfo.showLabels"},write:{target:"layerDefinition.drawingInfo.showLabels",overridePolicy:Y}}})],
g.prototype,"labelsVisible",null);e.__decorate([p.property({value:null})],g.prototype,"layer",null);e.__decorate([p.property({type:String,json:{write:{overridePolicy:ha}}})],g.prototype,"layerItemId",void 0);e.__decorate([p.property({type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},read:{source:"showLegend"},write:{target:"showLegend",overridePolicy:ca}}})],g.prototype,"legendEnabled",void 0);e.__decorate([p.property({type:["show","hide","hide-children"],value:"show",json:{read:!1,
write:!1,origins:{"web-scene":{read:!0,write:!0}}}})],g.prototype,"listMode",null);e.__decorate([p.property({type:Number,value:0,json:{write:{overridePolicy:Y}}})],g.prototype,"minScale",null);e.__decorate([B.reader("minScale",["minScale","layerDefinition.minScale"])],g.prototype,"readMinScale",null);e.__decorate([p.property({type:Number,value:0,json:{write:{overridePolicy:Y}}})],g.prototype,"maxScale",null);e.__decorate([B.reader("maxScale",["maxScale","layerDefinition.maxScale"])],g.prototype,"readMaxScale",
null);e.__decorate([p.property()],g.prototype,"objectIdField",void 0);e.__decorate([B.reader("service","objectIdField",["layerDefinition.objectIdField","layerDefinition.fields"])],g.prototype,"readObjectIdFieldFromService",null);e.__decorate([p.property({type:Number,value:1,json:{write:{target:"layerDefinition.drawingInfo.transparency",overridePolicy:Y}}})],g.prototype,"opacity",null);e.__decorate([B.reader("opacity",["layerDefinition.drawingInfo.transparency","layerDefinition.transparency"])],g.prototype,
"readOpacity",null);e.__decorate([C.writer("opacity")],g.prototype,"writeOpacity",null);e.__decorate([p.property({value:null,type:[F],json:{name:"layerDefinition.orderBy",read:{reader:A.readOrderByInfos}}})],g.prototype,"orderBy",null);e.__decorate([p.property({json:{type:b.Integer,write:{target:"parentLayerId",writerEnsuresNonNull:!0,overridePolicy:Y}}})],g.prototype,"parent",void 0);e.__decorate([C.writer("parent")],g.prototype,"writeParent",null);e.__decorate([p.property({type:Boolean,value:!0,
json:{read:{source:"disablePopup",reader(a,d){return!d.disablePopup}},write:{target:"disablePopup",overridePolicy:ca,writer(a,d,m){d[m]=!a}}}})],g.prototype,"popupEnabled",void 0);e.__decorate([p.property({type:r,json:{read:{source:"popupInfo"},write:{target:"popupInfo",overridePolicy:ca}}})],g.prototype,"popupTemplate",void 0);e.__decorate([p.property({readOnly:!0})],g.prototype,"queryTask",null);e.__decorate([p.property({type:[K],readOnly:!0,json:{origins:{service:{read:{source:"layerDefinition.relationships"}}}}})],
g.prototype,"relationships",void 0);e.__decorate([p.property({types:W.rendererTypes,value:null,json:{name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:ba},origins:{"web-scene":{types:W.webSceneRendererTypes,name:"layerDefinition.drawingInfo.renderer",write:{overridePolicy:ba}}}}})],g.prototype,"renderer",null);e.__decorate([p.property({types:{key:"type",base:null,typeMap:{"data-layer":T.DataLayerSource,"map-layer":aa.MapLayerSource}},cast(a){if(a){if("mapLayerId"in a)return b.ensureClass(aa.MapLayerSource,
a);if("dataSource"in a)return b.ensureClass(T.DataLayerSource,a)}return a},json:{name:"layerDefinition.source",write:{overridePolicy:Y}}})],g.prototype,"source",null);e.__decorate([p.property()],g.prototype,"sourceJSON",void 0);e.__decorate([p.property({type:k,json:{origins:{service:{read:{source:"layerDefinition.extent.spatialReference"}}}}})],g.prototype,"spatialReference",void 0);e.__decorate([p.property({value:null,json:{type:[b.Integer],write:{target:"subLayerIds",allowNull:!0,overridePolicy:Y}}})],
g.prototype,"sublayers",null);e.__decorate([S.cast("sublayers")],g.prototype,"castSublayers",null);e.__decorate([C.writer("sublayers")],g.prototype,"writeSublayers",null);e.__decorate([p.property({type:String,json:{name:"name",write:{overridePolicy:ca}}})],g.prototype,"title",void 0);e.__decorate([B.reader("service","title",["name","layerDefinition.name"])],g.prototype,"readTitle",null);e.__decorate([p.property({type:String})],g.prototype,"typeIdField",void 0);e.__decorate([p.property({json:{read:!1},
readOnly:!0,value:"sublayer"})],g.prototype,"type",void 0);e.__decorate([B.reader("typeIdField",["layerDefinition.typeIdField"])],g.prototype,"readTypeIdField",null);e.__decorate([p.property({type:[P],json:{origins:{service:{read:{source:"layerDefinition.types"}}}}})],g.prototype,"types",void 0);e.__decorate([p.property({type:String,json:{name:"layerUrl",write:{overridePolicy:ha}}})],g.prototype,"url",null);e.__decorate([p.property({type:Boolean,value:!0,json:{read:{source:"defaultVisibility"},write:{target:"defaultVisibility",
overridePolicy:Y}}})],g.prototype,"visible",null);e.__decorate([C.writer("visible")],g.prototype,"writeVisible",null);return g=da=e.__decorate([R.subclass("esri.layers.support.Sublayer")],g)})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(l,e){function r(w,n){if(!w?.length||null==n)return!0;n=n.slice().reverse().flatten(({sublayers:g})=>g&&g.toArray().reverse()).map(g=>g.id).toArray();if(w.length>n.length)return!1;let u=0;const q=
n.length;for(const {id:g}of w){for(;u<q&&n[u]!==g;)u++;if(u>=q)return!1}return!0}l.isExportDynamic=function(w,n,u){return w.some(q=>{var g=q.source;g=!g||"map-layer"===g.type&&g.mapLayerId===q.id&&(null==g.gdbVersion||g.gdbVersion===u);q.commitProperty("renderer");q.commitProperty("labelingInfo");q.commitProperty("opacity");q.commitProperty("labelsVisible");q.commitProperty("orderBy");const t=q.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??!1;return!g||q.originIdOf("renderer")>e.OriginId.SERVICE||
q.originIdOf("labelingInfo")>e.OriginId.SERVICE||q.originIdOf("opacity")>e.OriginId.SERVICE||q.originIdOf("labelsVisible")>e.OriginId.SERVICE||t&&q.originIdOf("orderBy")>e.OriginId.SERVICE})?!0:!r(w,n)};l.isSublayerOverhaul=function(w){return!!w&&w.some(n=>null!=n.minScale||null!=n.layerDefinition?.minScale)};l.shouldWriteSublayerStructure=function(w,n,u){return n.flatten(({sublayers:q})=>q).length!==w.length||w.some(q=>q.originIdOf("minScale")>u||q.originIdOf("maxScale")>u||q.originIdOf("renderer")>
u||q.originIdOf("labelingInfo")>u||q.originIdOf("opacity")>u||q.originIdOf("labelsVisible")>u||q.originIdOf("source")>u)?!0:!r(w,n)};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/imageBitmapUtils":function(){define(["exports","../../core/Error","../../core/promiseUtils"],function(l,e,r){l.createBitmap=async function(w,n,u){let q;try{q=await createImageBitmap(w)}catch(g){throw new e("request:server",`Unable to load ${n}`,{url:n,error:g});}r.throwIfAborted(u);
return q};l.createTileBitmap=async function(w,n,u,q,g){let t;try{t=await createImageBitmap(w)}catch(D){throw new e("request:server",`Unable to load tile ${n}/${u}/${q}`,{error:D,level:n,row:u,col:q});}r.throwIfAborted(g);return t};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("../chunks/tslib.es6 ../request ../core/Error ../core/loadAll ../core/MultiOriginJSONSupport ../core/promiseUtils ../core/urlUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/reader ../core/accessorSupport/decorators/subclass ../core/accessorSupport/decorators/writer ../geometry/SpatialReference ./Layer ./mixins/APIKeyMixin ./mixins/ArcGISCachedService ./mixins/ArcGISMapService ./mixins/ArcGISService ./mixins/BlendLayer ./mixins/CustomParametersMixin ./mixins/OperationalLayer ./mixins/PortalLayer ./mixins/RefreshableLayer ./mixins/ScaleRangeLayer ./mixins/SublayersOwner ./support/arcgisLayerUrl ./support/commonProperties ./support/imageBitmapUtils ./support/Sublayer".split(" "),function(l,
e,r,w,n,u,q,g,t,D,M,L,z,H,p,S,B,R,C,b,c,h,f,k,v,x,A,I,P,J,G){var Q;const V="Canvas/World_Dark_Gray_Base Canvas/World_Dark_Gray_Reference Canvas/World_Light_Gray_Base Canvas/World_Light_Gray_Reference Elevation/World_Hillshade Elevation/World_Hillshade_Dark Ocean/World_Ocean_Base Ocean/World_Ocean_Reference Ocean_Basemap Reference/World_Boundaries_and_Places Reference/World_Boundaries_and_Places_Alternate Reference/World_Transportation World_Imagery World_Street_Map World_Topo_Map".split(" ");n=Q=
class extends c.BlendLayer(x.ScaleRangeLayer(A.SublayersOwner(R.ArcGISCachedService(C.ArcGISMapService(f.OperationalLayer(k.PortalLayer(b.ArcGISService(n.MultiOriginJSONMixin(v.RefreshableLayer(B.APIKeyMixin(h.CustomParametersMixin(S)))))))))))){constructor(...y){super(...y);this.listMode="show";this.isReference=null;this.operationalLayerType="ArcGISTiledMapServiceLayer";this.resampling=!0;this.sublayers=this.path=this.spatialReference=this.sourceJSON=null;this.type="tile";this.url=null}normalizeCtorArgs(y,
F){return"string"===typeof y?{url:y,...F}:y}load(y){const F=null!=y?y.signal:null;this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Map Service"]},y).catch(u.throwIfAbortError).then(()=>this._fetchService(F)));return Promise.resolve(this)}get attributionDataUrl(){const y=this.parsedUrl?.path.toLowerCase();return y?this._getDefaultAttribution(this._getMapName(y)):null}readSpatialReference(y,F){return(y=y||F.tileInfo?.spatialReference)&&p.fromJSON(y)}writeSublayers(y,F,K,N){if(this.loaded&&
y){y=y.slice().reverse().flatten(({sublayers:W})=>W&&W.toArray().reverse()).toArray();var T=[],aa={writeSublayerStructure:!1,...N};y.forEach(W=>{W=W.write({},aa);T.push(W)});T.some(W=>1<Object.keys(W).length)&&(F.layers=T)}}get tileServers(){return this._getDefaultTileServers(this.parsedUrl?.path)}castTileServers(y){return Array.isArray(y)?y.map(F=>q.urlToObject(F).path):null}fetchTile(y,F,K,N={}){({signal:N}=N);y=this.getTileUrl(y,F,K);return e(y,{responseType:"image",signal:N,query:{...this.refreshParameters}}).then(T=>
T.data)}async fetchImageBitmapTile(y,F,K,N={}){const {signal:T}=N;if(this.fetchTile!==Q.prototype.fetchTile)return N=await this.fetchTile(y,F,K,N),J.createTileBitmap(N,y,F,K,T);N=this.getTileUrl(y,F,K);({data:N}=await e(N,{responseType:"blob",signal:T,query:{...this.refreshParameters}}));return J.createTileBitmap(N,y,F,K,T)}getTileUrl(y,F,K){const N=q.objectToQuery({...this.parsedUrl?.query,blankTile:!this.capabilities.operations.supportsTileMap&&this.supportsBlankTile?!1:null,...this.customParameters,
token:this.apiKey}),T=this.tileServers;return`${T&&T.length?T[F%T.length]:this.parsedUrl?.path}/tile/${y}/${F}/${K}${N?"?"+N:""}`}loadAll(){return w.loadAll(this,y=>{y(this.allSublayers)})}_fetchService(y){return(new Promise((F,K)=>{if(this.sourceJSON){if(null!=this.sourceJSON.bandCount&&null!=this.sourceJSON.pixelSizeX)throw new r("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");F({data:this.sourceJSON})}else{if(!this.parsedUrl)throw new r("tile-layer:undefined-url",
"layer's url is not defined");var N=I.parse(this.parsedUrl.path);if(null!=N&&"ImageServer"===N.serverType)throw new r("tile-layer:unsupported-url","use ImageryTileLayer to open a tiled image service");e(this.parsedUrl.path,{query:{f:"json",...this.parsedUrl.query,...this.customParameters,token:this.apiKey},responseType:"json",signal:y}).then(F,K)}})).then(F=>{let K=this.url;F.ssl&&(K=this.url=K.replace(/^http:/i,"https:"));this.sourceJSON=F.data;this.read(F.data,{origin:"service",url:this.parsedUrl});
if(10.1===this.version&&!I.isHostedAgolService(K))return this._fetchServerVersion(K,y).then(N=>{this.read({currentVersion:N})}).catch(()=>{})})}_fetchServerVersion(y,F){if(!I.isArcGISUrl(y))return Promise.reject();y=y.replace(/(.*\/rest)\/.*/i,"$1")+"/info";return e(y,{query:{f:"json",...this.customParameters,token:this.apiKey},responseType:"json",signal:F}).then(K=>{if(K.data&&K.data.currentVersion)return K.data.currentVersion;throw new r("tile-layer:version-not-available");})}_getMapName(y){return(y=
y.match(/^(?:https?:)?\/\/(server\.arcgisonline\.com|services\.arcgisonline\.com|ibasemaps-api\.arcgis\.com)\/arcgis\/rest\/services\/([^/]+(\/[^/]+)*)\/mapserver/i))?y[2]:void 0}_getDefaultAttribution(y){if(null==y)return null;let F;y=y.toLowerCase();for(let K=0,N=V.length;K<N;K++)if(F=V[K],F.toLowerCase().includes(y))return q.makeAbsolute("//static.arcgis.com/attribution/"+F);return null}_getDefaultTileServers(y){if(null==y)return[];const F=-1!==y.search(/^(?:https?:)?\/\/server\.arcgisonline\.com/i),
K=-1!==y.search(/^(?:https?:)?\/\/services\.arcgisonline\.com/i);return F||K?[y,y.replace(F?/server\.arcgisonline/i:/services\.arcgisonline/i,F?"services.arcgisonline":"server.arcgisonline")]:[]}get hasOverriddenFetchTile(){return!this.fetchTile[X]}};l.__decorate([g.property({readOnly:!0})],n.prototype,"attributionDataUrl",null);l.__decorate([g.property({type:["show","hide","hide-children"]})],n.prototype,"listMode",void 0);l.__decorate([g.property({json:{read:!0,write:!0}})],n.prototype,"blendMode",
void 0);l.__decorate([g.property({type:Boolean,json:{read:!1,write:{enabled:!0,overridePolicy:()=>({enabled:!1})}}})],n.prototype,"isReference",void 0);l.__decorate([g.property({readOnly:!0,type:["ArcGISTiledMapServiceLayer"]})],n.prototype,"operationalLayerType",void 0);l.__decorate([g.property({type:Boolean})],n.prototype,"resampling",void 0);l.__decorate([g.property()],n.prototype,"sourceJSON",void 0);l.__decorate([g.property({type:p})],n.prototype,"spatialReference",void 0);l.__decorate([L.reader("spatialReference",
["spatialReference","tileInfo"])],n.prototype,"readSpatialReference",null);l.__decorate([g.property({type:String,json:{origins:{"web-scene":{read:!0,write:!0}},read:!1}})],n.prototype,"path",void 0);l.__decorate([g.property({readOnly:!0})],n.prototype,"sublayers",void 0);l.__decorate([H.writer("sublayers",{layers:{type:[G]}})],n.prototype,"writeSublayers",null);l.__decorate([g.property({json:{read:!1,write:!1}})],n.prototype,"popupEnabled",void 0);l.__decorate([g.property()],n.prototype,"tileServers",
null);l.__decorate([t.cast("tileServers")],n.prototype,"castTileServers",null);l.__decorate([g.property({readOnly:!0,json:{read:!1}})],n.prototype,"type",void 0);l.__decorate([g.property(P.url)],n.prototype,"url",void 0);n=Q=l.__decorate([z.subclass("esri.layers.TileLayer")],n);const X=Symbol("default-fetch-tile");n.prototype.fetchTile[X]=!0;return n});