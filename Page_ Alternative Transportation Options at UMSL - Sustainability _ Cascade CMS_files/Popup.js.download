// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.32/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Features":function(){define("require ../chunks/tslib.es6 ../intl ../core/Collection ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/scheduling ../core/throttle ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../geometry/support/geometryUtils ../support/actions/actionUtils ./Feature ./Spinner ./Widget ./Feature/resources ./Feature/support/FeatureContentMixin ./Features/css ./Features/FeaturesDrillIn ./Features/FeaturesViewModel ./Features/FeaturesVisibleElements ./Popup/actions ./Popup/actionUtils ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute ../intl/number".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e,k,a,b,f,z,I,r,y,H,Q,A,N,G){g=class extends n.FeatureContentMixin(K){constructor(d,E){super(d,E);this._featureMenuIntersectionObserverCallback=([L])=>{L?.isIntersecting&&null!=this.viewModel.featurePage&&this.viewModel.featurePage++};this._featureMenuIntersectionObserver=new IntersectionObserver(this._featureMenuIntersectionObserverCallback,{root:window.document});this._focusAbortController=this._feature=this._spinner=this._featureMenuIntersectionObserverNode=
null;this._drillInFlowItems=new v;this._drillInWidget=new e({flowItems:this._drillInFlowItems});this._actionBarMenuNode=this._featureMenuViewportNode=this._rootFlowItemNode=this._rootNode=null;this.featureNavigationTop=this.collapsed=!1;this.headerActions=new b.ActionsCollection;this.headingLevel=2;this.messagesCommon=this.messages=null;this.responsiveActionsEnabled=!1;this.viewModel=new k;this.visibleElements=new a;this._renderAction=(L,R)=>{const U=this._getActionTitle(L),{type:V,active:X,uid:Y,
disabled:aa,indicator:W}=L;return L.visible?A.tsx("calcite-action",{active:"toggle"===V?L.value:!1,appearance:"solid",bind:this,"data-action-id":L.id,"data-action-uid":Y,disabled:aa,icon:this._getActionIcon(L),indicator:W,key:`action-${R}`,loading:X,onclick:this._triggerAction,scale:"s",text:U,textEnabled:!this._hideActionText,title:this._hideActionText?U:void 0},this._getFallbackIcon(L)):null};this._openFeatureMenu=()=>{this.featureMenuOpen=!0;this._focusFlowItemNode()};this._closeFeatureMenu=()=>
{this.featureMenuOpen=!1;this._focusFlowItemNode()};this._previousFeature=()=>{this.viewModel.previous()};this._nextFeature=()=>{this.viewModel.next()};this._handleFeatureBack=()=>{"list"===this.initialDisplayMode?(this.selectedFeatureIndex=-1,this._focusFlowItemNode()):this._openFeatureMenu()};this._handleFeatureMenuBack=()=>{"list"===this.initialDisplayMode?(this.selectedFeatureIndex=-1,this._focusFlowItemNode()):this.featureMenuOpen&&this._closeFeatureMenu()};this._storeRootNode=L=>{this._rootNode=
L};this._displaySpinnerThrottled=M.throttle(()=>this._displaySpinner(),0);this._addSelectedFeatureIndexHandle();this.addHandles([this._displaySpinnerThrottled,t.watch(()=>this.viewModel?.active,()=>this._toggleScreenLocationEnabled()),t.watch(()=>this.viewModel?.active,L=>this._drillInWidget.closed=!L),t.watch(()=>this.visibleElements?.closeButton,L=>this._drillInWidget.closable=L),t.watch(()=>this.visibleElements?.spinner,L=>this._spinnerEnabledChange(L)),t.watch(()=>this.viewModel?.view,(L,R)=>
this._viewChange(L,R)),t.watch(()=>this.viewModel?.view?.ready,(L,R)=>this._viewReadyChange(L??!1,R??!1)),t.watch(()=>[this.viewModel?.waitingForResult,this.viewModel?.location],()=>{this._hideSpinner();this._displaySpinnerThrottled()}),t.watch(()=>this.viewModel?.screenLocation,()=>this._closeOpenActionMenu()),t.watch(()=>this.selectedFeatureWidget,()=>this._destroyDrillInFlowItemWidgets()),t.watch(()=>{const L=this.selectedFeatureWidget?.viewModel;return[L?.title,L?.state]},()=>this._setTitleFromFeatureWidget()),
t.watch(()=>{const L=this.selectedFeatureWidget?.viewModel;return[L?.content,L?.state]},()=>this._setContentFromFeatureWidget()),t.watch(()=>this.viewModel?.featureViewModels,()=>this._featureMenuViewportScrollTop()),t.watch(()=>this._drillInFlowItems.length,()=>this._focusFlowItemNode()),this._drillInWidget.on("close",()=>this.close()),this._drillInWidget.on("exit",()=>this._destroyDrillInFlowItemWidgets()),this._drillInWidget.on("open-feature",({feature:L})=>this._openRelatedFeature(L)),this._drillInWidget.on("zoom-to-feature",
({featureWidget:L})=>f.zoomToLocation(this.viewModel,L))])}loadDependencies(){return z.loadCalciteComponents({action:()=>new Promise((d,E)=>c(["../chunks/index12"],d,E)),"action-bar":()=>new Promise((d,E)=>c(["../chunks/index56"],d,E)),"action-group":()=>(new Promise((d,E)=>c(["../chunks/index18"],d,E))).then(d=>d.index),button:()=>new Promise((d,E)=>c(["../chunks/index2"],d,E)),icon:()=>(new Promise((d,E)=>c(["../chunks/index7"],d,E))).then(d=>d.index),flow:()=>new Promise((d,E)=>c(["../chunks/index14"],
d,E)),"flow-item":()=>new Promise((d,E)=>c(["../chunks/index15"],d,E)),list:()=>new Promise((d,E)=>c(["../chunks/index16"],d,E)),"list-item":()=>new Promise((d,E)=>c(["../chunks/index20"],d,E)),"list-item-group":()=>new Promise((d,E)=>c(["../chunks/index59"],d,E)),loader:()=>new Promise((d,E)=>c(["../chunks/index32"],d,E))})}destroy(){this._destroyDrillInFlowItemWidgets();this._destroySelectedFeatureWidget();this._destroySpinner();this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver?.disconnect();
this._drillInWidget?.destroy();this._focusAbortController?.abort()}get _hideActionText(){if(!this.responsiveActionsEnabled)return!1;const d=this.view?.widthBreakpoint;return"xsmall"===d||"small"===d||"medium"===d}get _featureNavigationVisible(){return this.viewModel.active&&1<this.viewModel.featureCount&&!!this.viewModel.selectedFeature&&this.visibleElements.featureNavigation}get _isCollapsed(){return this._collapseEnabled&&this.collapsed}get _collapseEnabled(){return this.visibleElements.collapseButton&&
("list"===this.initialDisplayMode||!!this.title&&!!this.content)}get active(){return this.viewModel.active}get content(){return this.viewModel.content}set content(d){this.viewModel.content=d}get icon(){return null}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(d){this.viewModel.featureMenuOpen=d}get featureMenuTitle(){return this.viewModel.featureMenuTitle}set featureMenuTitle(d){this.viewModel.featureMenuTitle=d}get features(){return this.viewModel.features}set features(d){this.viewModel.features=
d}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(d){this.viewModel.goToOverride=d}get initialDisplayMode(){return this.viewModel.initialDisplayMode}set initialDisplayMode(d){this.viewModel.initialDisplayMode=d}get location(){return this.viewModel.location}set location(d){this.viewModel.location=d}get label(){return this.messages?.widgetLabel??""}set label(d){this._overrideIfSome("label",d)}get map(){return this.viewModel.map}set map(d){this.viewModel.map=d}get promises(){return this.viewModel.promises}set promises(d){this.viewModel.promises=
d}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){const d=Array.from(this._drillInFlowItems).at(-1);if(!d)return null;const {flowType:E}=d;return"feature-association"===E||"feature-relationship"===E?d.graphic??null:null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(d){this.viewModel.selectedFeatureIndex=d}get selectedFeatureWidget(){const {_feature:d,headingLevel:E,_drillInFlowItems:L,timeZone:R,spatialReference:U,
map:V}=this,{selectedFeatureViewModel:X}=this.viewModel,Y={title:!1};if(!X)return null;d?(d.viewModel=X,d.visibleElements=Y):this._feature=new B({flowItems:L,headingLevel:E+1,timeZone:R,spatialReference:U,map:V,viewModel:X,visibleElements:Y});return this._feature}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(d){this.viewModel.spatialReference=d}get title(){return this.viewModel.title}set title(d){this.viewModel.title=d}get timeZone(){return this.viewModel.timeZone}set timeZone(d){this.viewModel.timeZone=
d}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(d){this.viewModel.updateLocationEnabled=d}get view(){return this.viewModel.view}set view(d){this.viewModel.view=d}get visible(){return this.viewModel.visible}set visible(d){this.viewModel.visible=d}blur(){const {active:d}=this.viewModel;d?this._rootFlowItemNode?.blur():D.getLogger(this).warn("Features can only be blurred when currently active.")}clear(){return this.viewModel.clear()}close(){this.viewModel.visible=
!1}fetchFeatures(d,E){return this.viewModel.fetchFeatures(d,E)}focus(){const {active:d}=this.viewModel;d?this._focusFlowItemNode():D.getLogger(this).warn("Features can only be focused when currently active.")}next(){return this.viewModel.next()}open(d){this.removeHandles("selected-index");this.set({collapsed:d?.collapsed??!1});this.viewModel.open(d);this.addHandles(t.when(()=>!this.viewModel.waitingForResult,()=>this._addSelectedFeatureIndexHandle(),{once:!0}))}previous(){return this.viewModel.previous()}triggerAction(d){return this.viewModel.triggerAction(d)}render(){return A.tsx("div",
{afterCreate:this._storeRootNode,bind:this,class:this.classes(m.css.base,I.globalCss.widget,I.globalCss.panel),onkeydown:this._onMainKeydown},this._renderHeader(),this._renderContentContainer())}_renderFeatureNavigation(){return[this._renderPagination(),"list"===this.initialDisplayMode?this._renderFeaturePaginationText():this._renderFeatureMenuButton()]}_renderHeader(){return this.featureNavigationTop&&this._featureNavigationVisible?A.tsx("div",{class:m.css.header,key:"header-actions"},this._renderFeatureNavigation()):
null}_renderFooter(){return!this.featureNavigationTop&&this._featureNavigationVisible?A.tsx("div",{class:m.css.footer,key:"footer-actions",slot:"footer"},this._renderFeatureNavigation()):null}_renderFeaturePaginationText(){const {messages:d,viewModel:E}=this,{featureCount:L,selectedFeatureIndex:R}=E;return A.tsx("div",{class:m.css.paginationText,key:"feature-pagination-text"},N.substitute(d.pageText,{index:G.formatNumber(R+1),total:G.formatNumber(L)}))}_renderFeatureMenuButton(){const {messages:d,
viewModel:E}=this,{featureCount:L,selectedFeatureIndex:R,pendingPromisesCount:U}=E;return A.tsx("calcite-action",{appearance:"solid",bind:this,class:m.css.paginationMenuButton,icon:"list",key:"feature-menu-button",label:d.selectFeature,loading:0<U,onclick:this._openFeatureMenu,scale:"s",text:N.substitute(d.pageText,{index:G.formatNumber(R+1),total:G.formatNumber(L)}),textEnabled:!0,title:d.selectFeature})}_renderPagination(){const {previous:d,next:E}=this.messagesCommon.pagination;return A.tsx("calcite-action-bar",
{class:m.css.paginationActionBar,expandDisabled:!0,key:"pagination-action-bar",layout:"horizontal",overflowActionsDisabled:!0,scale:"s"},A.tsx("calcite-action-group",{scale:"s"},A.tsx("calcite-action",{appearance:"solid",class:m.css.paginationPrevious,icon:"chevron-left",iconFlipRtl:!0,label:d,onclick:this._previousFeature,scale:"s",text:d,title:d}),A.tsx("calcite-action",{appearance:"solid",icon:"chevron-right",iconFlipRtl:!0,label:E,onclick:this._nextFeature,scale:"s",text:E,title:E})))}_renderFeatureMenuItem(d){const {initialDisplayMode:E}=
this,{selectedFeatureViewModel:L,featureViewModels:R}=this.viewModel,U=d===L,V=R.indexOf(d);return A.tsx("calcite-list-item",{bind:this,"data-feature-index":V,key:`feature-menu-item-${d.uid}`,onblur:this._removeActiveFeature,onfocus:this._setActiveFeature,onmouseleave:this._removeActiveFeature,onmouseover:this._setActiveFeature,selected:U,onCalciteListItemSelect:this._selectFeature},A.tsx("span",{innerHTML:d.title||this.messagesCommon.untitled,slot:"content"}),"list"===E?A.tsx("calcite-icon",{flipRtl:!0,
icon:"chevron-right",scale:"s",slot:"content-end"}):null)}_groupResultsByLayer(){const {featureViewModels:d}=this.viewModel,E=new Map;d.forEach(L=>{var R=L?.graphic;if(R){var {layer:U,sourceLayer:V}=R;R=(U?.declaredClass.startsWith("esri.layers.")??!1?U:null)||(V?.declaredClass.startsWith("esri.layers.")??!1?V:null);var X=E.get(R)??[];E.set(R,[...X,L])}});return E}_renderFeatureMenu(){const {messages:d,viewModel:E}=this,L=this._groupResultsByLayer(),R="list"===this.initialDisplayMode?"none":"single";
return E.featureViewModels.length?A.tsx("calcite-list",{displayMode:"flat",label:d?.featuresList,selectionAppearance:"icon",selectionMode:R},Array.from(L.keys(),U=>{const V=L.get(U)?.map(Y=>this._renderFeatureMenuItem(Y)),X=U?U.title??this.messagesCommon.untitled:null;return this.visibleElements.featureListLayerTitle&&null!==X?A.tsx("calcite-list-item-group",{heading:X,key:U?.uid||"map-graphics"},V):V})):null}_renderHeaderAction(d,E){const L=d.title||"";return d.visible?A.tsx("calcite-action",{active:"toggle"===
d.type?d.value:!1,appearance:"solid",bind:this,"data-action-id":d.id,"data-action-uid":d.uid,disabled:d.disabled,icon:d.icon??void 0,indicator:d.indicator,key:`header-action-${E}`,loading:d.active,onclick:this._triggerHeaderAction,slot:"header-actions-end",text:L,title:L}):null}_renderHeaderActions(){return this.headerActions.map((d,E)=>this._renderHeaderAction(d,E)).toArray()}_renderContentFeature(){const {headingLevel:d,visibleElements:E,_isCollapsed:L,_collapseEnabled:R,featureNavigationTop:U,
_drillInFlowItems:V,initialDisplayMode:X,selectedFeature:Y,featureMenuOpen:aa}=this,{title:W,active:ca}=this.viewModel,fa=E.heading&&W?W:"";if("list"===X&&!Y)return null;const da=0===V.length&&("list"===X?!!Y:!aa);return A.tsx("calcite-flow-item",{afterCreate:this._storeRootFlowItemNode,bind:this,class:this.classes({[m.css.contentFeature]:!0,[m.css.flowItemCollapsed]:L}),closable:E.closeButton,closed:!ca,collapsed:L,collapseDirection:U?"down":"up",collapsible:R,headingLevel:d,key:"root-flow-item",
selected:da,onCalciteFlowItemBack:this._handleFeatureBack,onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},fa?A.tsx(r.Heading,{class:this.classes(m.css.featuresHeading,I.globalCss.heading),innerHTML:fa,key:"header-content",level:this.headingLevel,slot:"header-content"}):null,this._renderHeaderActions(),this._renderActionBar(),A.tsx("div",{class:this.classes(m.css.container,m.css.contentContainer)},this._renderContent()),this._renderFooter())}_renderFeatureMenuContainer(){const {viewModel:d,
visibleElements:E,featureMenuTitle:L,messages:R,messagesCommon:U,_drillInFlowItems:V,initialDisplayMode:X,featureMenuOpen:Y,selectedFeature:aa,_collapseEnabled:W,_isCollapsed:ca,featureNavigationTop:fa,headingLevel:da}=this,{active:O,featureViewModels:S,pendingPromisesCount:T}=d,{featureMenuHeading:Z}=E,ea=L??R.selectFeature;if("feature"===X&&!Y)return null;const ba=0===V.length&&("list"===X?!aa:Y);return A.tsx("calcite-flow-item",{afterCreate:this._storeFeatureMenuFlowItemNode,bind:this,class:this.classes({[m.css.flowItemCollapsed]:ca}),
closable:"list"===X&&E.closeButton,closed:!O,collapsed:"list"===X&&ca,collapseDirection:fa?"down":"up",collapsible:"list"===X&&W,description:Z?N.substitute(R.total,{total:S.length}):void 0,heading:Z?ea:void 0,headingLevel:da,key:"feature-menu",loading:d.waitingForContents,selected:ba,onCalciteFlowItemBack:ha=>{ha.preventDefault();this._handleFeatureMenuBack()},onCalciteFlowItemClose:this.close,onCalciteFlowItemToggle:this._handleCollapseToggle},"list"===X?this._renderHeaderActions():null,0<T?A.tsx("calcite-loader",
{class:m.css.loader,inline:!0,key:"feature-menu-loader",label:U.loading,slot:"header-actions-end"}):null,A.tsx("div",{class:m.css.container},this._renderFeatureMenu()),A.tsx("div",{afterCreate:this._featureMenuIntersectionObserverCreated,bind:this,class:m.css.featureMenuObserver}),"feature"===X?A.tsx("calcite-button",{appearance:"transparent",onclick:this._handleFeatureMenuBack,slot:"footer-actions",width:"full"},U.back):null)}_renderContentContainer(){const d="list"===this.initialDisplayMode?[this._renderFeatureMenuContainer(),
this._renderContentFeature(),this._drillInWidget.render()]:[this._renderContentFeature(),this._renderFeatureMenuContainer(),this._drillInWidget.render()];return this.visibleElements.flow?A.tsx("calcite-flow",{key:"content-container"},d):d}_getFallbackIcon(d){const {className:E,icon:L}=d;if(L)return null;d=u.substituteActionImage({action:d,feature:this.selectedFeature});const R={[m.css.icon]:!!E,[m.css.actionImage]:!!d};E&&(R[E]=!0);return d||E?A.tsx("span",{"aria-hidden":"true",class:this.classes(m.css.icon,
R),key:"icon",styles:u.getActionStyles(d)}):null}_renderActionBar(){return!this._isCollapsed&&this.visibleElements.actionBar&&this.viewModel.allActions?.length?A.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!this._hideActionText,key:"header-action-bar",scale:"s",slot:"action-bar"},A.tsx("calcite-action-group",{afterCreate:d=>this._actionBarMenuNode=d,overlayPositioning:"fixed",scale:"s"},this._renderActions())):null}_renderActions(){return this.viewModel.allActions.toArray().map(this._renderAction)}_renderContent(){const d=
this.viewModel?.content;return d?"string"===typeof d?A.tsx("div",{class:q.css.contentNode,innerHTML:d,key:d}):this.renderNodeContent(d):null}_handleCollapseToggle(){this.collapsed=!this.collapsed}async _openRelatedFeature(d){await d.viewModel.updateGeometry();d=d.graphic;var E=d?.geometry;null!=E&&null!=d&&(this._destroyDrillInFlowItemWidgets(),await this.viewModel.zoomTo({target:E}),E=C.getPointFromGeometry(E),this.open({features:[d],location:null!=E?E:void 0}),this._focusFlowItemNode())}async _focusFlowItemNode(){this._focusAbortController?.abort();
this._focusAbortController=new AbortController;await J.ignoreAbortErrors(F.waitAnimationFrame(this._focusAbortController.signal));const d=this._rootNode?.querySelector("calcite-flow-item[selected]");y.setFocus(d)}_storeRootFlowItemNode(d){this._rootFlowItemNode=d}_storeFeatureMenuFlowItemNode(d){this._featureMenuViewportNode=d}_setActiveFeature(d){const {viewModel:E}=this;d=d.currentTarget["data-feature-index"];E.activeFeature=E.features?.[d]||null}_removeActiveFeature(){this.viewModel.activeFeature=
null}_selectFeature(d){d=d.currentTarget["data-feature-index"];isNaN(d)||(this.viewModel.selectedFeatureIndex=d);"feature"===this.initialDisplayMode?this._handleFeatureMenuBack():this._focusFlowItemNode()}_unobserveFeatureMenuObserver(){this._featureMenuIntersectionObserverNode&&this._featureMenuIntersectionObserver.unobserve(this._featureMenuIntersectionObserverNode)}_featureMenuIntersectionObserverCreated(d){this._unobserveFeatureMenuObserver();this._featureMenuIntersectionObserver.observe(d);this._featureMenuIntersectionObserverNode=
d}_getActionIcon(d){if(d.icon)return d.icon;if(!d.image&&!d.className)return"question"}_getActionTitle(d){const {messages:E,selectedFeature:L,messagesCommon:R}=this,{id:U}=d,V=L?.attributes,X=d.title??"";return(d="zoom-to-feature"===U?N.substitute(X,{messages:E}):"remove-selected-feature"===U?N.substitute(X,{messages:R}):"zoom-to-clustered-features"===U?N.substitute(X,{messages:E}):"browse-clustered-features"===U?N.substitute(X,{messages:E}):d.title)&&V?N.substitute(d,V):d??""}_onMainKeydown(d){const {key:E}=
d;"ArrowLeft"===E&&(d.stopPropagation(),this._handleFeatureMenuBack(),this.previous());"ArrowRight"===E&&(d.stopPropagation(),this._handleFeatureMenuBack(),this.next())}_featureMenuViewportScrollTop(){this._featureMenuViewportNode&&this._featureMenuViewportNode.scrollContentTo({top:0})}_setContentFromFeatureWidget(){const {selectedFeatureWidget:d}=this;d&&(this.viewModel.content=d)}_setTitleFromFeatureWidget(){const {selectedFeatureWidget:d,messagesCommon:E}=this,L=d?.viewModel;d&&(this.viewModel.title=
"error"===L?.state?E?.errorMessage:L?.title||"")}_addSelectedFeatureIndexHandle(){const d=t.watch(()=>this.viewModel?.selectedFeatureIndex,(E,L)=>this._selectedFeatureIndexUpdated(E,L));this.addHandles(d,"selected-index")}_selectedFeatureIndexUpdated(d,E){const {featureCount:L}=this.viewModel;L&&d!==E&&-1!==d&&(this._destroyDrillInFlowItemWidgets(),this._rootFlowItemNode&&this._rootFlowItemNode.scrollContentTo({top:0}))}_triggerHeaderAction(d){d=d.currentTarget;if(!d.disabled){var E=d.dataset.actionUid;
(d=this.headerActions.find(({uid:L})=>L===E))&&!d.disabled&&("toggle"===d?.type&&(d.value=!d.value),this.emit("trigger-header-action",{action:d}))}}_triggerAction(d){d=d.currentTarget;if(!d.disabled){var E=d.dataset.actionUid,{allActions:L}=this.viewModel;d=L.findIndex(R=>R.uid===E);(L=L.at(d))&&"toggle"===L.type&&(L.value=!L.value);this.viewModel.triggerAction(d)}}_createSpinner(d){d&&(this._spinner=new P({view:d}),d.ui.add(this._spinner,{key:"features-spinner",position:"manual",internal:!0}))}_wireUpView(d){this._destroySpinner();
d&&this.visibleElements?.spinner&&this._createSpinner(d)}_hideSpinner(){const {_spinner:d}=this;d&&(d.location=null,d.hide())}_viewReadyChange(d,E){d?this._wireUpView(this.viewModel?.view):E&&this.viewModel.clear()}_viewChange(d,E){d&&E&&this.viewModel.clear()}_destroySelectedFeatureWidget(){const {_feature:d}=this;d&&(d.viewModel=null,!d.destroyed&&d.destroy());this._feature=null}_closeOpenActionMenu(){const {_actionBarMenuNode:d}=this;d&&(d.menuOpen=!1)}_destroyDrillInFlowItemWidgets(){this._drillInFlowItems.drain(d=>
{"showAllEnabled"in d.viewModel&&(d.viewModel.showAllEnabled=!1);"activeCategory"in d.viewModel&&(d.viewModel.activeCategory=null);d.viewModel=null;d.destroy()})}_toggleScreenLocationEnabled(){const {viewModel:d}=this;d&&(d.screenLocationEnabled=d.active)}_displaySpinner(){const {_spinner:d}=this;if(d){var {location:E,waitingForResult:L}=this.viewModel;L&&E?d.show({location:E}):d.hide()}}_destroySpinner(){const {_spinner:d}=this;d&&(d.view?.ui?.remove(d,"features-spinner"),d.destroy(),this._spinner=
null)}_spinnerEnabledChange(d){this._destroySpinner();d&&this._createSpinner(this.viewModel?.view)}};l.__decorate([p.property()],g.prototype,"_drillInFlowItems",void 0);l.__decorate([p.property()],g.prototype,"_hideActionText",null);l.__decorate([p.property()],g.prototype,"_featureNavigationVisible",null);l.__decorate([p.property()],g.prototype,"_isCollapsed",null);l.__decorate([p.property()],g.prototype,"_collapseEnabled",null);l.__decorate([p.property({readOnly:!0})],g.prototype,"active",null);
l.__decorate([p.property()],g.prototype,"collapsed",void 0);l.__decorate([p.property()],g.prototype,"content",null);l.__decorate([p.property()],g.prototype,"icon",null);l.__decorate([p.property()],g.prototype,"featureMenuOpen",null);l.__decorate([p.property()],g.prototype,"featureMenuTitle",null);l.__decorate([p.property()],g.prototype,"featureNavigationTop",void 0);l.__decorate([p.property()],g.prototype,"features",null);l.__decorate([p.property()],g.prototype,"goToOverride",null);l.__decorate([p.property({type:b.ActionsCollection})],
g.prototype,"headerActions",void 0);l.__decorate([p.property()],g.prototype,"headingLevel",void 0);l.__decorate([p.property()],g.prototype,"initialDisplayMode",null);l.__decorate([p.property()],g.prototype,"location",null);l.__decorate([p.property()],g.prototype,"label",null);l.__decorate([p.property()],g.prototype,"map",null);l.__decorate([p.property(),H.messageBundle("esri/widgets/Features/t9n/Features")],g.prototype,"messages",void 0);l.__decorate([p.property(),H.messageBundle("esri/t9n/common")],
g.prototype,"messagesCommon",void 0);l.__decorate([p.property()],g.prototype,"promises",null);l.__decorate([p.property()],g.prototype,"responsiveActionsEnabled",void 0);l.__decorate([p.property({readOnly:!0})],g.prototype,"selectedFeature",null);l.__decorate([p.property({readOnly:!0})],g.prototype,"selectedDrillInFeature",null);l.__decorate([p.property()],g.prototype,"selectedFeatureIndex",null);l.__decorate([p.property({readOnly:!0})],g.prototype,"selectedFeatureWidget",null);l.__decorate([p.property()],
g.prototype,"spatialReference",null);l.__decorate([p.property()],g.prototype,"title",null);l.__decorate([p.property()],g.prototype,"timeZone",null);l.__decorate([p.property()],g.prototype,"updateLocationEnabled",null);l.__decorate([p.property()],g.prototype,"view",null);l.__decorate([p.property({type:k}),Q.vmEvent(["triggerAction","trigger-action"])],g.prototype,"viewModel",void 0);l.__decorate([p.property({type:a,nonNullable:!0})],g.prototype,"visibleElements",void 0);l.__decorate([p.property()],
g.prototype,"visible",null);return g=l.__decorate([x.subclass("esri.widgets.Features")],g)})},"esri/core/throttle":function(){define(["exports"],function(c){c.throttle=function(l,g,v,D){let J=null,t=1E3;"number"===typeof g?(t=g,D=v):(J=g??null,t=v);let F=0,M;const p=()=>{F=0;l.apply(D,M)};g=(...w)=>{J&&J.apply(D,w);M=w;t?F||=setTimeout(p,t):p()};g.remove=()=>{F&&(clearTimeout(F),F=0)};g.forceUpdate=()=>{F&&(clearTimeout(F),p())};g.hasPendingUpdates=()=>!!F;return g};Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/geometry/support/geometryUtils":function(){define(["exports","../Extent","./scaleUtils"],function(c,l,g){function v(D,J,t){const F=D.hasZ?D.z:void 0;if(J?.map)return(null!=t?g.getExtentForScale(J,t):J.extent).clone().centerAt(D).set({zmax:F,zmin:F});const {x:M,y:p,spatialReference:w}=D;return new l({xmin:M-.25,ymin:p-.25,xmax:M+.25,ymax:p+.25,spatialReference:w,zmin:F,zmax:F})}c.createExtentFromGeometry=function(D,J,t){switch(D?.type){case "extent":return D;case "multipoint":case "polygon":case "polyline":return D.extent;
case "point":return v(D,J,t);default:return null}};c.createExtentFromPoint=v;c.getPointFromGeometry=function(D){switch(D?.type){case "point":return D;case "extent":return D.center;case "polygon":return D.centroid;case "multipoint":case "polyline":return D.extent?.center;default:return null}};c.getPointWithElevation=async function(D,J){if(D.hasZ||"2d"===J.type)return D;const t=J.map?.ground;if(!t?.layers.length)return D;({geometry:D}=await t.queryElevation(D,{cache:J.basemapTerrain?.elevationQueryCache}));
return D};c.scaleExtent=function(D,J,t){return v(D.center,J,t)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/support/actions/actionUtils":function(){define(["exports","../../intl","../../intl/substitute"],function(c,l,g){c.getActionIcon=function(v){if(v.icon)return v.icon;if(!("image"in v&&v.image||v.className))return"question"};c.getActionStyles=function(v){return v?{backgroundImage:`url(${v})`}:{}};c.substituteActionImage=function({action:v,feature:D}){D=D?.attributes;return(v=
"image"in v?v.image:void 0)&&D?g.substitute(v,D):v??""};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature":function(){define("require ../chunks/tslib.es6 ../intl ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Feature/FeatureAttachments ./Feature/FeatureContent ./Feature/FeatureExpression ./Feature/FeatureFields ./Feature/FeatureMedia ./Feature/FeatureRelationship ./Feature/FeatureUtilityNetworkAssociations ./Feature/FeatureViewModel ./Feature/resources ./Feature/support/FeatureContentMixin ../chunks/componentsUtils ./support/globalCss ./support/Heading ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory ../intl/substitute".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e,k,a,b,f,z){const I={title:!0,content:!0,lastEditedInfo:!0};g=class extends n.FeatureContentMixin(p){constructor(r,y){super(r,y);this._contentWidgets=[];this.flowType="feature";this.flowItems=null;this.headingLevel=2;this.messagesCommon=this.messages=null;this.visibleElements={...I};this.viewModel=new K}initialize(){this.addHandles(v.watch(()=>this.viewModel?.contentViewModels,()=>this._setupContentWidgets(),v.initial))}loadDependencies(){return m.loadCalciteComponents({notice:()=>
new Promise((r,y)=>c(["../chunks/index6"],r,y)),loader:()=>new Promise((r,y)=>c(["../chunks/index32"],r,y))})}destroy(){this._destroyContentWidgets()}get graphic(){return this.viewModel.graphic}set graphic(r){this.viewModel.graphic=r}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(r){this.viewModel.defaultPopupTemplateEnabled=r}get isTable(){return this.viewModel.isTable}get icon(){return"polygon"}set icon(r){this._overrideIfSome("icon",
r)}get label(){return this.messages?.widgetLabel??""}set label(r){this._overrideIfSome("label",r)}get location(){return this.viewModel.location}set location(r){this.viewModel.location=r}get spatialReference(){return this.viewModel.spatialReference}set spatialReference(r){this.viewModel.spatialReference=r}get timeZone(){return this.viewModel.timeZone}set timeZone(r){this.viewModel.timeZone=r}get title(){return this.viewModel.title}castVisibleElements(r){return{...I,...r}}get map(){return this.viewModel.map}set map(r){this.viewModel.map=
r}get view(){return this.viewModel.view}set view(r){this.viewModel.view=r}setActiveMedia(r,y){return this.viewModel.setActiveMedia(r,y)}nextMedia(r){return this.viewModel.nextMedia(r)}previousMedia(r){return this.viewModel.previousMedia(r)}render(){var {state:r}=this.viewModel;r=f.tsx("div",{class:q.css.container,key:"container"},this._renderTitle(),"error"===r?this._renderError():"loading"===r?this._renderLoading():this._renderContentContainer());return f.tsx("div",{class:this.classes(q.css.base,
e.globalCss.widget)},r)}_renderError(){const {messagesCommon:r,messages:y,visibleElements:H}=this;return f.tsx("calcite-notice",{icon:"exclamation-mark-circle",kind:"danger",open:!0,scale:"s"},H.title?f.tsx("div",{key:"error-title",slot:"title"},r.errorMessage):null,f.tsx("div",{key:"error-message",slot:"message"},y.loadingError))}_renderLoading(){return f.tsx("div",{class:q.css.loadingSpinnerContainer,key:"loading-container"},f.tsx("calcite-loader",{inline:!0,label:""}))}_renderContentContainer(){const {visibleElements:r}=
this;return r.content?f.tsx("div",{class:q.css.main},[this._renderContent(),this._renderLastEditInfo()]):null}_renderTitle(){const {visibleElements:r,title:y}=this;return r.title?f.tsx(k.Heading,{class:q.css.title,innerHTML:y,level:this.headingLevel}):null}_renderContent(){var r=this.viewModel.content;return r?Array.isArray(r)?r.length?f.tsx("div",{class:q.css.contentNode,key:"content-content-elements"},r.map(this._renderContentElement,this)):null:"string"===typeof r?(r=this._contentWidgets[0],!r||
r.destroyed?null:f.tsx("div",{class:this.classes(q.css.contentNode,q.css.contentNodeText),key:"content-content"},r.render())):this.renderNodeContent(r):null}_renderContentElement(r,y){const {visibleElements:H}=this;if("boolean"!==typeof H.content&&!H.content?.[r.type])return null;switch(r.type){case "attachments":return this._renderAttachments(y);case "custom":return this._renderCustom(r,y);case "fields":return this._renderFields(y);case "media":return this._renderMedia(y);case "text":return this._renderText(r,
y);case "expression":return this._renderExpression(y);case "relationship":return this._renderRelationship(y);case "utility-network-associations":return this._renderAssociation(y);default:return null}}_renderAttachments(r){const y=this._contentWidgets[r];if(!y||y.destroyed)return null;const {state:H,attachmentInfos:Q}=y.viewModel;return"loading"===H||0<Q.length?f.tsx("div",{class:this.classes(q.css.contentElement),key:this._buildKey("attachments-element",r)},y.render()):null}_renderRelationship(r){const y=
this._contentWidgets[r];return y&&!y.destroyed&&this.flowItems?f.tsx("div",{class:q.css.contentElement,key:this._buildKey("relationship-element",r)},y.render()):null}_renderAssociation(r){const y=this._contentWidgets[r];return y&&!y.destroyed&&this.flowItems?f.tsx("div",{class:q.css.contentElement,key:this._buildKey("utility-network-association-element",r)},y.render()):null}_renderExpression(r){const y=this._contentWidgets[r];return y&&!y.destroyed&&y.viewModel.contentElement?f.tsx("div",{class:q.css.contentElement,
key:this._buildKey("expression-element",r)},y.render()):null}_renderCustom(r,y){({creator:r}=r);const H=this._contentWidgets[y];return!H||H.destroyed?null:r?f.tsx("div",{class:q.css.contentElement,key:this._buildKey("custom-element",y)},H.render()):null}_renderFields(r){const y=this._contentWidgets[r];return!y||y.destroyed?null:f.tsx("div",{class:q.css.contentElement,key:this._buildKey("fields-element",r)},y.render())}_renderMedia(r){const y=this._contentWidgets[r];return!y||y.destroyed?null:f.tsx("div",
{class:q.css.contentElement,key:this._buildKey("media-element",r)},y.render())}_renderLastEditInfo(){const {visibleElements:r,messages:y}=this;var {lastEditInfo:H}=this.viewModel;if(!H||!r.lastEditedInfo)return null;const {date:Q,user:A}=H;H=z.substitute("edit"===H.type?A?y.lastEditedByUser:y.lastEdited:A?y.lastCreatedByUser:y.lastCreated,{date:Q,user:A});return f.tsx("div",{class:this.classes(q.css.lastEditedInfo,q.css.contentElement),key:"edit-info-element"},H)}_renderText(r,y){const H=this._contentWidgets[y];
return!H||H.destroyed?null:r.text?f.tsx("div",{class:this.classes(q.css.contentElement,q.css.text),key:this._buildKey("text-element",y)},H.render()):null}_buildKey(r,...y){const H=this.viewModel?.graphic?.uid||"0";y=y.join("-");return`${r}__${H}-${y}`}_destroyContentWidget(r){r&&(r.viewModel=null,!r.destroyed&&r.destroy())}_destroyContentWidgets(){this._contentWidgets.forEach(r=>this._destroyContentWidget(r));this._contentWidgets=[]}_setupContentWidgets(){this._destroyContentWidgets();const {headingLevel:r,
visibleElements:y,flowItems:H,viewModel:Q}=this;var A=Q?.content;const {contentViewModels:N}=Q;Array.isArray(A)?A.forEach((G,d)=>{"attachments"===G.type&&(this._contentWidgets[d]=new w({displayType:G.displayType,headingLevel:y.title&&6>r?r+1:r,viewModel:N[d]}));"fields"===G.type&&(this._contentWidgets[d]=new C({viewModel:N[d]}));"media"===G.type&&(this._contentWidgets[d]=new u({viewModel:N[d]}));"text"===G.type&&(this._contentWidgets[d]=new h({viewModel:N[d]}));"custom"===G.type&&(this._contentWidgets[d]=
new h({viewModel:N[d]}));"expression"===G.type&&(this._contentWidgets[d]=new x({viewModel:N[d]}));if("relationship"===G.type){const E=new B({flowItems:H,featureVisibleElements:y,viewModel:N[d]});this._contentWidgets[d]=E}"utility-network-associations"===G.type&&(G=new P({flowItems:H,onSelectAssociationType:async E=>{const {viewModel:L,listType:R,title:U}=E;H&&(L.activeAssociationType=R,{default:E}=await new Promise((V,X)=>c(["./Feature/FeatureUtilityNetworkAssociationList"],Y=>V(Object.freeze(Object.defineProperty({__proto__:null,
default:Y},Symbol.toStringTag,{value:"Module"}))),X)),E=new E({viewModel:L,parentFeatureViewModel:Q,listType:R,title:U,featureVisibleElements:y,description:Q.title,flowItems:H}),H.push(E))},parentFeatureViewModel:Q,featureVisibleElements:y,viewModel:N[d]}),this._contentWidgets[d]=G)},this):(A=N[0])&&!A.destroyed&&(this._contentWidgets[0]=new h({viewModel:A}));this.scheduleRender()}};l.__decorate([D.property()],g.prototype,"flowType",void 0);l.__decorate([D.property()],g.prototype,"graphic",null);
l.__decorate([D.property()],g.prototype,"defaultPopupTemplateEnabled",null);l.__decorate([D.property()],g.prototype,"flowItems",void 0);l.__decorate([D.property()],g.prototype,"headingLevel",void 0);l.__decorate([D.property({readOnly:!0})],g.prototype,"isTable",null);l.__decorate([D.property()],g.prototype,"icon",null);l.__decorate([D.property()],g.prototype,"label",null);l.__decorate([D.property()],g.prototype,"location",null);l.__decorate([D.property(),b.messageBundle("esri/widgets/Feature/t9n/Feature")],
g.prototype,"messages",void 0);l.__decorate([D.property(),b.messageBundle("esri/t9n/common")],g.prototype,"messagesCommon",void 0);l.__decorate([D.property()],g.prototype,"spatialReference",null);l.__decorate([D.property()],g.prototype,"timeZone",null);l.__decorate([D.property({readOnly:!0})],g.prototype,"title",null);l.__decorate([D.property()],g.prototype,"visibleElements",void 0);l.__decorate([J.cast("visibleElements")],g.prototype,"castVisibleElements",null);l.__decorate([D.property()],g.prototype,
"map",null);l.__decorate([D.property()],g.prototype,"view",null);l.__decorate([D.property({type:K})],g.prototype,"viewModel",void 0);return g=l.__decorate([M.subclass("esri.widgets.Feature")],g)})},"esri/widgets/Feature/FeatureAttachments":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Attachments ../Widget ./FeatureAttachments/FeatureAttachmentsViewModel ./support/FeatureElementInfo ../support/widgetUtils ../support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x){v=class extends M{constructor(C,u){super(C,u);this._featureElementInfo=null;this.attachmentsWidget=new F;this.headingLevel=2;this.viewModel=new p}initialize(){this._featureElementInfo=new w;this.addHandles([l.watch(()=>[this.viewModel?.description,this.viewModel?.title,this.headingLevel],()=>this._setupFeatureElementInfo(),l.initial),l.watch(()=>this.viewModel,C=>this.attachmentsWidget.viewModel=C,l.initial)])}destroy(){this.attachmentsWidget.viewModel=null;this.attachmentsWidget.destroy();
this._featureElementInfo?.destroy()}get description(){return this.viewModel.description}set description(C){this.viewModel.description=C}get displayType(){return this.attachmentsWidget.displayType}set displayType(C){this.attachmentsWidget.displayType=C}get graphic(){return this.viewModel.graphic}set graphic(C){this.viewModel.graphic=C}get title(){return this.viewModel.title}set title(C){this.viewModel.title=C}render(){const {attachmentsWidget:C}=this;return x.tsx("div",{class:"esri-feature-attachments"},
this._featureElementInfo?.render(),C?.render())}_setupFeatureElementInfo(){const {description:C,title:u,headingLevel:B}=this;this._featureElementInfo?.set({description:C,title:u,headingLevel:B})}};c.__decorate([g.property({readOnly:!0})],v.prototype,"attachmentsWidget",void 0);c.__decorate([g.property()],v.prototype,"description",null);c.__decorate([g.property()],v.prototype,"displayType",null);c.__decorate([g.property()],v.prototype,"graphic",null);c.__decorate([g.property()],v.prototype,"headingLevel",
void 0);c.__decorate([g.property()],v.prototype,"title",null);c.__decorate([g.property({type:p})],v.prototype,"viewModel",void 0);return v=c.__decorate([t.subclass("esri.widgets.Feature.FeatureAttachments")],v)})},"esri/widgets/Attachments":function(){define("require ../chunks/tslib.es6 ../core/Error ../core/reactiveUtils ../core/unitFormatUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Attachments/AttachmentsViewModel ./Attachments/support/attachmentUtils ../chunks/componentsUtils ./support/globalCss ./support/legacyIcon ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q){const n={addButton:!0,addSubmitButton:!0,cancelAddButton:!0,cancelUpdateButton:!0,deleteButton:!0,errorMessage:!0,progressBar:!0,updateButton:!0},m=window.CSS;F=class extends w{constructor(e,k){super(e,k);this.displayType="auto";this.selectedFile=this.messagesUnits=this.messages=null;this.submitting=!1;this.viewModel=null;this.visibleElements={...n};this._supportsImageOrientation=m&&m.supports&&m.supports("image-orientation","from-image");this._updateAttachmentForm=
this._addAttachmentForm=null}normalizeCtorArgs(e){e?.viewModel||(e={viewModel:new h,...e});return e}initialize(){this.addHandles([v.on(()=>this.viewModel?.attachmentInfos,"change",()=>this.scheduleRender()),v.on(()=>this.viewModel?.fileInfos,"change",()=>this.scheduleRender()),v.watch(()=>this.viewModel?.mode,()=>this._modeChanged(),v.initial)])}loadDependencies(){return C.loadCalciteComponents({icon:()=>(new Promise((e,k)=>c(["../chunks/index7"],e,k))).then(e=>e.index)})}get capabilities(){return this.viewModel.capabilities}set capabilities(e){this.viewModel.capabilities=
e}get effectiveDisplayType(){const {displayType:e}=this;return e&&"auto"!==e?e:this.viewModel.supportsResizeAttachments?"preview":"list"}get graphic(){return this.viewModel.graphic}set graphic(e){this.viewModel.graphic=e}get icon(){return"attachment"}set icon(e){this._overrideIfSome("icon",e)}get label(){return this.messages?.widgetLabel??""}set label(e){this._overrideIfSome("label",e)}castVisibleElements(e){return{...n,...e}}addAttachment(){const {_addAttachmentForm:e,viewModel:k}=this;this._set("submitting",
!0);this._set("error",null);return k.addAttachment(e).then(a=>{this._set("submitting",!1);this._set("error",null);k.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new g("attachments:add-attachment",this.messages.addErrorMessage,a));throw a;})}deleteAttachment(e){const {viewModel:k}=this;this._set("submitting",!0);this._set("error",null);return k.deleteAttachment(e).then(a=>{this._set("submitting",!1);this._set("error",null);k.mode="view";return a}).catch(a=>{this._set("submitting",
!1);this._set("error",new g("attachments:delete-attachment",this.messages.deleteErrorMessage,a));throw a;})}updateAttachment(){const {viewModel:e}=this,{_updateAttachmentForm:k}=this;this._set("submitting",!0);this._set("error",null);return e.updateAttachment(k).then(a=>{this._set("submitting",!1);this._set("error",null);e.mode="view";return a}).catch(a=>{this._set("submitting",!1);this._set("error",new g("attachments:update-attachment",this.messages.updateErrorMessage,a));throw a;})}addFile(){const e=
this.viewModel.addFile(this.selectedFile,this._addAttachmentForm);this.viewModel.mode="view";return e}updateFile(){const {viewModel:e}=this,k=e.updateFile(this.selectedFile,this._updateAttachmentForm,e.activeFileInfo);e.mode="view";return k}deleteFile(e){e=this.viewModel.deleteFile(e||this.viewModel.activeFileInfo?.file);this.viewModel.mode="view";return e}render(){const {submitting:e,viewModel:k}=this,{state:a}=k;return q.tsx("div",{class:this.classes("esri-attachments",u.globalCss.widget)},e?this._renderProgressBar():
null,"loading"===a?this._renderLoading():this._renderAttachments(),this._renderErrorMessage())}_renderErrorMessage(){const {error:e,visibleElements:k}=this;return e&&k.errorMessage?q.tsx("div",{class:"esri-attachments__error-message",key:"error-message"},e.message):null}_renderAttachments(){const {activeFileInfo:e,mode:k,activeAttachmentInfo:a}=this.viewModel;return"add"===k?this._renderAddForm():"edit"===k?this._renderDetailsForm(a||e):this._renderAttachmentContainer()}_renderLoading(){return q.tsx("div",
{class:"esri-attachments__loader-container",key:"loader"},q.tsx("div",{class:"esri-attachments__loader"}))}_renderProgressBar(){return this.visibleElements.progressBar?q.tsx("div",{class:"esri-attachments__progress-bar",key:"progress-bar"}):null}_renderAddForm(){const {submitting:e,selectedFile:k}=this;var a=e||!k,b=this.visibleElements.cancelAddButton?q.tsx("button",{bind:this,class:this.classes(u.globalCss.button,u.globalCss.buttonTertiary,u.globalCss.buttonSmall,u.globalCss.buttonHalf,e&&u.globalCss.buttonDisabled),
disabled:e,onclick:this._cancelForm,type:"button"},this.messages.cancel):null;a=this.visibleElements.addSubmitButton?q.tsx("button",{class:this.classes(u.globalCss.button,u.globalCss.buttonSecondary,u.globalCss.buttonSmall,u.globalCss.buttonHalf,{[u.globalCss.buttonDisabled]:a}),disabled:a,type:"submit"},this.messages.add):null;const f=k?q.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},k.name):null;b=q.tsx("form",{afterCreate:P.storeNode,afterRemoved:P.discardNode,bind:this,"data-node-ref":"_addAttachmentForm",
onsubmit:this._submitAddAttachment},q.tsx("fieldset",{class:"esri-attachments__file-fieldset"},f,q.tsx("label",{class:this.classes("esri-attachments__file-label",u.globalCss.button,u.globalCss.buttonSecondary)},k?this.messages.changeFile:this.messages.selectFile,q.tsx("input",{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))),a,b);return q.tsx("div",{class:"esri-attachments__form-node",key:"add-form-container"},b)}_renderDetailsForm(e){const {visibleElements:k,
viewModel:a,selectedFile:b,submitting:f}=this;var {capabilities:z}=a,I=f||!b;let r;if(b){var y=b.type;r=b.name;var H=b.size}else if(e&&"file"in e)y=e.file.type,r=e.file.name,H=e.file.size;else if(e&&"contentType"in e){y=e.contentType;r=e.name;H=e.size;var Q=e.url}var A=z.editing&&z.operations?.delete&&k.deleteButton?q.tsx("button",{bind:this,class:this.classes(u.globalCss.button,u.globalCss.buttonSmall,u.globalCss.buttonTertiary,"esri-attachments__delete-button",{[u.globalCss.buttonDisabled]:f}),
disabled:f,key:"delete-button",onclick:G=>this._submitDeleteAttachment(G,e),type:"button"},this.messages.delete):void 0;I=z.editing&&z.operations?.update&&k.updateButton?q.tsx("button",{class:this.classes(u.globalCss.button,u.globalCss.buttonSmall,u.globalCss.buttonThird,{[u.globalCss.buttonDisabled]:I}),disabled:I,key:"update-button",type:"submit"},this.messages.update):void 0;const N=this.visibleElements.cancelUpdateButton?q.tsx("button",{bind:this,class:this.classes(u.globalCss.button,u.globalCss.buttonSmall,
u.globalCss.buttonTertiary,u.globalCss.buttonThird,{[u.globalCss.buttonDisabled]:f}),disabled:f,key:"cancel-button",onclick:this._cancelForm,type:"button"},this.messages.cancel):void 0;z=z.editing&&z.operations?.update?q.tsx("fieldset",{class:"esri-attachments__file-fieldset",key:"file"},q.tsx("span",{class:"esri-attachments__file-name",key:"file-name"},r),q.tsx("label",{class:this.classes("esri-attachments__file-label",u.globalCss.button,u.globalCss.buttonSecondary)},this.messages.changeFile,q.tsx("input",
{bind:this,class:"esri-attachments__file-input",name:"attachment",onchange:this._handleFileInputChange,type:"file"}))):void 0;H=q.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"size"},q.tsx("label",null,D.formatFileSize(this.messagesUnits,H??0)));y=q.tsx("fieldset",{class:"esri-attachments__metadata-fieldset",key:"content-type"},q.tsx("label",null,y));Q=null!=Q?q.tsx("a",{class:"esri-attachments__item-link",href:Q,rel:"noreferrer",target:"_blank"},this._renderImageMask(e,400),q.tsx("div",
{class:"esri-attachments__item-link-overlay"},q.tsx("span",{class:"esri-attachments__item-link-overlay-icon"},q.tsx("calcite-icon",{icon:"launch"})))):this._renderImageMask(e,400);A=q.tsx("form",{afterCreate:P.storeNode,afterRemoved:P.discardNode,bind:this,"data-node-ref":"_updateAttachmentForm",onsubmit:G=>this._submitUpdateAttachment(G,e)},q.tsx("div",{class:"esri-attachments__metadata"},H,y),z,q.tsx("div",{class:"esri-attachments__actions"},A,N,I));return q.tsx("div",{class:"esri-attachments__form-node",
key:"edit-form-container"},Q,A)}_renderImageMask(e,k){return e?"file"in e?this._renderGenericImageMask(e.file.name,e.file.type):this._renderImageMaskForAttachment(e,k):null}_renderGenericImageMask(e,k){var {supportsResizeAttachments:a}=this.viewModel;k=x.getIconPath(k);a={["esri-attachments__image--resizable"]:a};return q.tsx("div",{class:this.classes("esri-attachments__item-mask--icon","esri-attachments__item-mask"),key:k},q.tsx("img",{alt:e,class:this.classes(a,"esri-attachments__image"),src:k,
title:e}))}_renderImageMaskForAttachment(e,k){var {supportsResizeAttachments:a}=this.viewModel;if(!e)return null;const {contentType:b,name:f,url:z}=e;if(!a||!x.isSupportedImage(b))return this._renderGenericImageMask(f,b);e=(e=this._getCSSTransform(e))?{transform:e,"image-orientation":"none"}:{};k=`${z}${z?.includes("?")?"\x26":"?"}w=${k}`;a={["esri-attachments__image--resizable"]:a};return q.tsx("div",{class:this.classes("esri-attachments__item-mask"),key:k},q.tsx("img",{alt:f,class:this.classes(a,
"esri-attachments__image"),src:k,styles:e,title:f}))}_renderFile(e){const {file:k}=e;return q.tsx("li",{class:"esri-attachments__item",key:k},q.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button",key:"details-button",onclick:()=>this._startEditFile(e),title:this.messages.attachmentDetails,type:"button"},this._renderImageMask(e),q.tsx("label",{class:"esri-attachments__label"},q.tsx("span",{class:"esri-attachments__filename"},k.name||this.messages.noTitle),
q.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",P.isRTL(this.container)?B.legacyIcon.left:B.legacyIcon.right)}))))}_renderAttachmentInfo({attachmentInfo:e,displayType:k}){const {viewModel:a,effectiveDisplayType:b}=this,{capabilities:f,supportsResizeAttachments:z}=a,{contentType:I,name:r,url:y}=e;k=this._renderImageMask(e,"list"===k?48:400);var H=f.editing?q.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-chevron-icon",P.isRTL(this.container)?
B.legacyIcon.left:B.legacyIcon.right)}):null;H="preview"===b&&z&&x.isSupportedImage(I)?null:q.tsx("label",{class:"esri-attachments__label"},q.tsx("span",{class:"esri-attachments__filename"},r||this.messages.noTitle),H);k=[k,H];k=f.editing?q.tsx("button",{"aria-label":this.messages.attachmentDetails,bind:this,class:"esri-attachments__item-button","data-attachment-info-id":e.id,key:"details-button",onclick:()=>this._startEditAttachment(e),title:this.messages.attachmentDetails,type:"button"},k):q.tsx("a",
{class:"esri-attachments__item-button",href:y??void 0,key:"details-link",rel:"noreferrer",target:"_blank"},k);return q.tsx("li",{class:"esri-attachments__item",key:e},k)}_renderAttachmentContainer(){const {effectiveDisplayType:e,viewModel:k,visibleElements:a}=this,{attachmentInfos:b,capabilities:f,fileInfos:z}=k;var I=!!b?.length;const r=!!z?.length,y={["esri-attachments__container--list"]:"preview"!==e,["esri-attachments__container--preview"]:"preview"===e},H=f.editing&&f.operations?.add&&a.addButton?
q.tsx("button",{bind:this,class:this.classes(u.globalCss.button,u.globalCss.buttonTertiary,"esri-attachments__add-attachment-button"),onclick:()=>this._startAddAttachment(),type:"button"},q.tsx("span",{"aria-hidden":"true",class:this.classes("esri-attachments__item-add-icon",B.legacyIcon.plus)}),this.messages.add):void 0,Q=I?q.tsx("ul",{class:"esri-attachments__items",key:"attachments-list"},b.toArray().map(N=>this._renderAttachmentInfo({attachmentInfo:N,displayType:e}))):void 0,A=r?q.tsx("ul",{class:"esri-attachments__items",
key:"file-list"},z.toArray().map(N=>this._renderFile(N))):void 0;I=r||I?void 0:q.tsx("div",{class:u.globalCss.empty},this.messages.noAttachments);return q.tsx("div",{class:this.classes("esri-attachments__container",y),key:"attachments-container"},Q,A,I,H)}_modeChanged(){this._set("error",null);this._set("selectedFile",null)}_handleFileInputChange(e){e=e.target.files?.item(0);this._set("selectedFile",e)}_submitDeleteAttachment(e,k){e.preventDefault();k&&("file"in k?this.deleteFile(k.file):k&&this.deleteAttachment(k))}_submitAddAttachment(e){e.preventDefault();
this.viewModel.filesEnabled?this.addFile():this.addAttachment()}_submitUpdateAttachment(e,k){e.preventDefault();k&&"file"in k?this.updateFile():this.updateAttachment()}_startEditAttachment(e){const {viewModel:k}=this;k.activeFileInfo=null;k.activeAttachmentInfo=e;k.mode="edit"}_startEditFile(e){const {viewModel:k}=this;k.activeAttachmentInfo=null;k.activeFileInfo=e;k.mode="edit"}_startAddAttachment(){this.viewModel.mode="add"}_cancelForm(e){e.preventDefault();this.viewModel.mode="view"}_getCSSTransform(e){({orientationInfo:e}=
e);return!this._supportsImageOrientation&&e?[e.rotation?`rotate(${e.rotation}deg)`:"",e.mirrored?"scaleX(-1)":""].join(" "):""}};l.__decorate([J.property()],F.prototype,"capabilities",null);l.__decorate([J.property()],F.prototype,"displayType",void 0);l.__decorate([J.property({readOnly:!0})],F.prototype,"effectiveDisplayType",null);l.__decorate([J.property()],F.prototype,"graphic",null);l.__decorate([J.property()],F.prototype,"icon",null);l.__decorate([J.property()],F.prototype,"label",null);l.__decorate([J.property(),
K.messageBundle("esri/widgets/Attachments/t9n/Attachments")],F.prototype,"messages",void 0);l.__decorate([J.property(),K.messageBundle("esri/core/t9n/Units")],F.prototype,"messagesUnits",void 0);l.__decorate([J.property({readOnly:!0})],F.prototype,"selectedFile",void 0);l.__decorate([J.property({readOnly:!0})],F.prototype,"submitting",void 0);l.__decorate([J.property({readOnly:!0})],F.prototype,"error",void 0);l.__decorate([J.property({type:h})],F.prototype,"viewModel",void 0);l.__decorate([J.property()],
F.prototype,"visibleElements",void 0);l.__decorate([t.cast("visibleElements")],F.prototype,"castVisibleElements",null);return F=l.__decorate([p.subclass("esri.widgets.Attachments")],F)})},"esri/core/unitFormatUtils":function(){define("exports ./ByteSizeUnit ./Cyclical ./mathUtils ./quantityUtils ./string ./unitUtils ../intl/number".split(" "),function(c,l,g,v,D,J,t,F){function M(u,B,P){return u.units[B][P]}function p(u,B,P,K=2,q="abbr"){return`${F.formatNumber(B,{minimumFractionDigits:K,maximumFractionDigits:K,
signDisplay:0<B?"never":"exceptZero"})} ${M(u,P,q)}`}function w(u,B,P,K=2,q="abbr"){return`${F.formatNumber(B,{minimumFractionDigits:K,maximumFractionDigits:K,signDisplay:"exceptZero"})} ${M(u,P,q)}`}function h(u,B){const P=JSON.stringify(B);let K=x.get(P);K||(K=new Intl.NumberFormat("en-US",B),x.set(P,K));return/^[-+]?360\.?0*\u00b0?$/.test(K.format(u))?0:u}const x=new Map,C=["B","kB","MB","GB","TB"];c.formatAngleDegrees=function(u,B,P,K,q,n=g.cyclicalDegrees,m=!0){u=n.normalize(D.convertRotationType(t.convertUnit(u,
B,"degrees"),P,K),0,m);q=q??2;q={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:q,minimumFractionDigits:q,signDisplay:0<u?"never":"exceptZero"};u=h(u,q);return F.formatNumber(u,q)};c.formatDMS=function(u,B,P=2){u=t.convertUnit(u,B,"degrees");B=u-Math.floor(u);u-=B;B*=60;let K=B-Math.floor(B);B-=K;K*=60;return`${u.toFixed()}\u00b0 ${B.toFixed()}' ${K.toFixed(P)}"`};c.formatDecimal=p;c.formatFileSize=function(u,B){B=Math.round(B);let P=0===B?0:Math.floor(Math.log(B)/Math.log(l.ByteSizeUnit.KILOBYTES));
P=v.clamp(P,0,C.length-1);B=F.formatNumber(B/l.ByteSizeUnit.KILOBYTES**P,{maximumFractionDigits:2});return J.replace(u.units.bytes[C[P]],{fileSize:B})};c.formatImperialArea=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveImperialAreaUnit(B,P);return p(u,t.convertUnit(B,P,n),n,K,q)};c.formatImperialLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveImperialLengthUnit(B,P);return p(u,t.convertUnit(B,P,n),n,K,q)};c.formatImperialRelativeLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveImperialLengthUnit(B,
P);return w(u,t.convertUnit(B,P,n),n,K,q)};c.formatImperialRelativeVerticalLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveImperialVerticalLengthUnit(B,P);return w(u,t.convertUnit(B,P,n),n,K,q)};c.formatImperialVerticalLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveImperialVerticalLengthUnit(B,P);return p(u,t.convertUnit(B,P,n),n,K,q)};c.formatMetricArea=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveMetricAreaUnit(B,P);return p(u,t.convertUnit(B,P,n),n,K,q)};c.formatMetricLength=function(u,
B,P,K=2,q="abbr"){const n=t.adaptiveMetricLengthUnit(B,P);return p(u,t.convertUnit(B,P,n),n,K,q)};c.formatMetricRelativeLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveMetricLengthUnit(B,P);return w(u,t.convertUnit(B,P,n),n,K,q)};c.formatMetricRelativeVerticalLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveMetricVerticalLengthUnit(B,P);return w(u,t.convertUnit(B,P,n),n,K,q)};c.formatMetricVerticalLength=function(u,B,P,K=2,q="abbr"){const n=t.adaptiveMetricVerticalLengthUnit(B,P);return p(u,
t.convertUnit(B,P,n),n,K,q)};c.formatRelativeAngleDegrees=function(u,B,P,K,q=2){P!==K&&(u=-u);P={style:"unit",unitDisplay:"narrow",unit:"degree",maximumFractionDigits:q,minimumFractionDigits:q,signDisplay:"exceptZero"};u=t.convertUnit(u,B,"degrees")%360;u=h(u,P);return F.formatNumber(u,P)};c.formatRelativeDecimal=w;c.unitName=M;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/ByteSizeUnit":function(){define(["exports"],function(c){c.ByteSizeUnit=void 0;var l=c.ByteSizeUnit||
(c.ByteSizeUnit={});l[l.KILOBYTES=1024]="KILOBYTES";l[l.MEGABYTES=1048576]="MEGABYTES";l[l.GIGABYTES=1073741824]="GIGABYTES";Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/quantityUtils":function(){define(["exports","./unitUtils"],function(c,l){function g(C,u){return{type:l.unitType(u),value:C,unit:u}}function v(C,u){return{type:l.unitType(u),value:C,unit:u}}function D(C,u){return{type:l.unitType(u),value:C,unit:u}}function J(C,u,B="arithmetic"){return{type:l.unitType(u),
value:C,unit:u,rotationType:B}}function t(C,u){const B=F(C,u);return"angle"===C.type?J(B,u,C.rotationType):g(B,u)}function F(C,u){return l.convertUnit(C.value,C.unit,u)}const M=v(0,"meters"),p=D(0,"square-meters"),w=J(0,"radians"),h=J(0,"degrees"),x=J(0,"degrees","geographic");c.convertRotationType=function(C,u,B){if(u===B)return C;switch(B){case "arithmetic":case "geographic":return-C+90}};c.createAngle=J;c.createArea=D;c.createLength=v;c.createQuantity=g;c.createScalar=function(C){return{value:C}};
c.isBaseUnit=function(C){return l.isBaseUnit(C.unit)};c.max=function(C,u){return null==C?u:null==u?C:C.value>l.convertUnit(u.value,u.unit,C.unit)?C:u};c.min=function(C,u){return null==C?u:null==u?C:C.value<l.convertUnit(u.value,u.unit,C.unit)?C:u};c.scale=function(C,u){return null==C?null:{...C,value:C.value*u}};c.toBaseUnit=function(C){return t(C,l.baseUnitForUnit(C.unit))};c.toUnit=t;c.valueInUnit=F;c.zeroDegrees=h;c.zeroDegreesGeographic=x;c.zeroMeters=M;c.zeroRadians=w;c.zeroSquareMeters=p;Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/AttachmentsViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../core/Accessor ../../core/Collection ../../core/Error ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../popup/support/AttachmentsOrderByInfo ../../rest/query/support/AttachmentInfo ../../rest/support/AttachmentQuery ../Feature/support/featureUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u){const B={editing:!1,operations:{add:!0,update:!0,delete:!0}},P=v.ofType(x);g=class extends g{constructor(K){super(K);this._attachmentLayer=this._getAttachmentsPromise=null;this.capabilities={...B};this.activeFileInfo=this.activeAttachmentInfo=null;this.attachmentInfos=new P;this.fileInfos=new v;this.graphic=null;this.mode="view";this.orderByFields=null;this.filesEnabled=!1;this.addHandles(J.watch(()=>this.graphic,()=>this._graphicChanged(),J.initial))}destroy(){this.graphic=
this._attachmentLayer=null}castCapabilities(K){return{...B,...K}}get state(){return this._getAttachmentsPromise?"loading":this.graphic?"ready":"disabled"}get supportsResizeAttachments(){var {graphic:K}=this;if(!K)return!1;K=K.layer||K.sourceLayer;return K?.loaded&&"capabilities"in K&&K.capabilities&&"attachment"in K.capabilities&&K.capabilities.attachment&&"supportsResize"in K.capabilities.attachment&&K.capabilities.attachment.supportsResize||!1}async getAttachments(){const {_attachmentLayer:K,attachmentInfos:q,
orderByFields:n}=this;if(!K||"function"!==typeof K.queryAttachments)throw new D("invalid-layer","getAttachments(): A valid layer is required.");const m=this._getObjectId();if("number"!==typeof m)throw new D("invalid-object-id","getAttachments(): Numeric object id is required");var e=n?.map(a=>`${a.field} ${"descending"===a.order?"DESC":"ASC"}`);e=new C({objectIds:[m],returnMetadata:!0,orderByFields:e});const k=[];this._getAttachmentsPromise=e=K.queryAttachments(e).then(a=>a[m]||k).catch(()=>k);this.notifyChange("state");
e=await e;q.destroyAll();e.length&&q.addMany(e);this._getAttachmentsPromise=null;this.notifyChange("state");return e}async addAttachment(K,q=this.graphic){const {_attachmentLayer:n,attachmentInfos:m,capabilities:e}=this;if(!q)throw new D("invalid-graphic","addAttachment(): A valid graphic is required.",{graphic:q});if(!K)throw new D("invalid-attachment","addAttachment(): An attachment is required.",{attachment:K});if(!e.operations?.add)throw new D("invalid-capabilities","addAttachment(): add capabilities are required.");
if(!n||"function"!==typeof n.addAttachment)throw new D("invalid-layer","addAttachment(): A valid layer is required.");K=await n.addAttachment(q,K).then(k=>this._queryAttachment(k.objectId,q));m.add(K);return K}async deleteAttachment(K){const {_attachmentLayer:q,attachmentInfos:n,graphic:m,capabilities:e}=this;if(!K)throw new D("invalid-attachment-info","deleteAttachment(): An attachmentInfo is required.",{attachmentInfo:K});if(!e.operations?.delete)throw new D("invalid-capabilities","deleteAttachment(): delete capabilities are required.");
if(!q||"function"!==typeof q.deleteAttachments)throw new D("invalid-layer","deleteAttachment(): A valid layer is required.");if(!m)throw new D("invalid-graphic","deleteAttachment(): A graphic is required.");const k=await q.deleteAttachments(m,[K.id]).then(()=>K);n.remove(k);k.destroy();return k}async updateAttachment(K,q=this.activeAttachmentInfo){const {_attachmentLayer:n,attachmentInfos:m,graphic:e,capabilities:k}=this;if(!K)throw new D("invalid-attachment","updateAttachment(): An attachment is required.",
{attachment:K});if(!q)throw new D("invalid-attachment-info","updateAttachment(): An attachmentInfo is required.",{attachmentInfo:q});if(!k.operations?.update)throw new D("invalid-capabilities","updateAttachment(): Update capabilities are required.");const a=m.indexOf(q);if(!n||"function"!==typeof n.updateAttachment)throw new D("invalid-layer","updateAttachment(): A valid layer is required.");if(!e)throw new D("invalid-graphic","updateAttachment(): A graphic is required.");K=await n.updateAttachment(e,
q.id,K).then(b=>this._queryAttachment(b.objectId));m.splice(a,1,K);return K}async commitFiles(){await Promise.all(this.fileInfos.items.map(K=>this.addAttachment(K.form)));this.fileInfos.removeAll();return this.getAttachments()}addFile(K,q){if(!K||!q)return null;K={file:K,form:q};this.fileInfos.add(K);return K}updateFile(K,q,n=this.activeFileInfo){if(!K||!q||!n)return null;n=this.fileInfos.indexOf(n);-1<n&&this.fileInfos.splice(n,1,{file:K,form:q});return this.fileInfos.items[n]}deleteFile(K){const q=
this.fileInfos.find(n=>n.file===K);return q?(this.fileInfos.remove(q),q):null}async _queryAttachment(K,q){const {_attachmentLayer:n}=this;if(!K||!n?.queryAttachments)throw new D("invalid-attachment-id","Could not query attachment.");const m=this._getObjectId(q);if("number"!==typeof m)throw new D("invalid-object-id","getAttachments(): Numeric object id is required");K=new C({objectIds:[m],attachmentsWhere:`AttachmentId=${K}`,returnMetadata:!0});return n.queryAttachments(K).then(e=>e[m][0])}_getObjectId(K=
this.graphic){return K?.getObjectId()??null}_graphicChanged(){this.graphic&&(this._setAttachmentLayer(),this.getAttachments().catch(()=>this.attachmentInfos.destroyAll()))}_setAttachmentLayer(){var {graphic:K}=this;this._attachmentLayer=(K=u.getSourceLayer(K))?"scene"===K.type&&null!=K.associatedLayer?K.associatedLayer:K:null}};c.__decorate([t.property()],g.prototype,"capabilities",void 0);c.__decorate([F.cast("capabilities")],g.prototype,"castCapabilities",null);c.__decorate([t.property()],g.prototype,
"activeAttachmentInfo",void 0);c.__decorate([t.property()],g.prototype,"activeFileInfo",void 0);c.__decorate([t.property({readOnly:!0,type:P})],g.prototype,"attachmentInfos",void 0);c.__decorate([t.property()],g.prototype,"fileInfos",void 0);c.__decorate([t.property({type:l})],g.prototype,"graphic",void 0);c.__decorate([t.property()],g.prototype,"mode",void 0);c.__decorate([t.property({type:[h]})],g.prototype,"orderByFields",void 0);c.__decorate([t.property({readOnly:!0})],g.prototype,"state",null);
c.__decorate([t.property()],g.prototype,"filesEnabled",void 0);c.__decorate([t.property({readOnly:!0})],g.prototype,"supportsResizeAttachments",null);return g=c.__decorate([w.subclass("esri.widgets.Attachments.AttachmentsViewModel")],g)})},"esri/rest/query/support/AttachmentInfo":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/ensureType ../../../core/has ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../layers/support/exifUtils".split(" "),
function(c,l,g,v,D,J,t,F){var M;const p={1:{id:1,rotation:0,mirrored:!1},2:{id:2,rotation:0,mirrored:!0},3:{id:3,rotation:180,mirrored:!1},4:{id:4,rotation:180,mirrored:!0},5:{id:5,rotation:-90,mirrored:!0},6:{id:6,rotation:90,mirrored:!1},7:{id:7,rotation:90,mirrored:!0},8:{id:8,rotation:-90,mirrored:!1}};l=M=class extends l{constructor(w){super(w);this.url=this.size=this.parentObjectId=this.parentGlobalId=this.name=this.keywords=this.globalId=this.id=this.exifInfo=this.contentType=null}get orientationInfo(){var {exifInfo:w}=
this;w=F.getExifValue({exifName:"Exif IFD0",tagName:"Orientation",exifInfo:w});return p[w]||null}clone(){return new M({contentType:this.contentType,exifInfo:this.exifInfo,id:this.id,globalId:this.globalId,keywords:this.keywords,name:this.name,parentGlobalId:this.parentGlobalId,parentObjectId:this.parentObjectId,size:this.size,url:this.url})}};c.__decorate([g.property({type:String})],l.prototype,"contentType",void 0);c.__decorate([g.property()],l.prototype,"exifInfo",void 0);c.__decorate([g.property({readOnly:!0})],
l.prototype,"orientationInfo",null);c.__decorate([g.property({type:v.Integer})],l.prototype,"id",void 0);c.__decorate([g.property({type:String})],l.prototype,"globalId",void 0);c.__decorate([g.property({type:String})],l.prototype,"keywords",void 0);c.__decorate([g.property({type:String})],l.prototype,"name",void 0);c.__decorate([g.property({json:{read:!1}})],l.prototype,"parentGlobalId",void 0);c.__decorate([g.property({json:{read:!1}})],l.prototype,"parentObjectId",void 0);c.__decorate([g.property({type:v.Integer})],
l.prototype,"size",void 0);c.__decorate([g.property({json:{read:!1}})],l.prototype,"url",void 0);return l=M=c.__decorate([t.subclass("esri.rest.query.support.AttachmentInfo")],l)})},"esri/layers/support/exifUtils":function(){define(["exports"],function(c){function l(g){const {tagName:v,tags:D}=g;return D&&v?D.find(J=>J.name===v)?.value||null:null}c.getExifValue=function(g){const {exifInfo:v,exifName:D,tagName:J}=g;return v&&D&&J?(g=v.find(t=>t.name===D))?l({tagName:J,tags:g.tags}):null:null};Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/featureUtils":function(){define("exports ../../../core/has ../../../core/Logger ../../../core/string ../../../intl/date ../../../intl/number ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../smartMapping/support/utils ../../../support/arcadeOnDemand ../../../time/timeZoneUtils".split(" "),function(c,l,g,v,D,J,t,F,M,p,w){function h(O){return O?V.test(O):!1}function x(O,S){if(S&&h(S)&&O){var T=S.replace(V,
"").toLowerCase();return O.find(({name:Z})=>Z.toLowerCase()===T)}}function C(O,S){return(S=u(S,O))?S.name:O}function u(O,S){return O&&"function"===typeof O.getField&&S?O.getField(S)??null:null}function B({formattedAttributes:O,template:S,fieldInfoMap:T}){return`${v.replace(v.replace(S,Z=>`{${T.get(Z.toLowerCase())?.fieldName||Z}}`),O).replaceAll(L,"")}`.trim()}function P(O,S,T=!1){const Z=S[O];"string"===typeof Z&&(T=(T?encodeURIComponent(Z):Z).replaceAll(U,"%27"),S[O]=T)}function K(O,S=!1){const T=
{...O};Object.keys(T).forEach(Z=>P(Z,T,S));return T}function q(O,S){return O.replaceAll(R,(T,Z,ea)=>(T=u(S,ea))?`{${T.name}}`:Z)}function n(O,S,T){return(O=q(O,T))?O.replaceAll(aa,(Z,ea,ba)=>{ea=`${ea||ba}`.trim();return v.replace(Z,K(S,ea&&"{"!==ea[0]||!1))}):O}function m(O){return null!=O&&"object"===typeof O&&"fieldsIndex"in O&&"geometryType"in O&&"getField"in O&&"load"in O&&"loaded"in O&&"objectIdField"in O&&"spatialReference"in O&&"type"in O&&("feature"===O.type||"scene"===O.type||"subtype-group"===
O.type||"subtype-sublayer"===O.type||"sublayer"===O.type)&&"when"in O}function e(O){return null!=O&&"object"===typeof O&&"createQuery"in O&&"queryFeatureCount"in O&&"queryObjectIds"in O&&"queryRelatedFeatures"in O&&"queryRelatedFeaturesCount"in O&&"relationships"in O}function k(O){return m(O)&&e(O)}function a(O,S){const {fieldInfos:T,fieldName:Z,preventPlacesFormatting:ea,layer:ba,timeZone:ha}=S;S=f(T,Z);var ia=u(ba,Z);if(S&&!t.isRasterPixelValueField(Z)){ia=ia?.type;const ja=S.format?.dateFormat;
if("date"===ia||"date-only"===ia||"time-only"===ia||"timestamp-offset"===ia||ja)return M.formatAnyDate(O,{format:ja,fieldType:ia,timeZoneOptions:{layerTimeZone:ba&&"preferredTimeZone"in ba?ba.preferredTimeZone:null,viewTimeZone:ha,datesInUnknownTimezone:ba&&"datesInUnknownTimezone"in ba?!!ba.datesInUnknownTimezone:!1}})}S=S?.format;if("string"===typeof O&&t.isRasterPixelValueField(Z)&&S)return O=O.trim(),/\d{2}-\d{2}/.test(O)?O:O.includes(",")?b(O,",",", ",S):O.includes(";")?b(O,";","; ",S):O.includes(" ")?
b(O," "," ",S):J.formatNumber(Number(O),J.convertNumberFormatToIntlOptions(S));"string"!==typeof O||!S||null!=S.dateFormat||null==S.places&&null==S.digitSeparator||(ia=Number(O),isNaN(ia)||(O=ia));return"string"===typeof O||null==O||null==S?r(O):ea?J.formatNumber(O,{...J.convertNumberFormatToIntlOptions(S),minimumFractionDigits:0,maximumFractionDigits:20}):J.formatNumber(O,J.convertNumberFormatToIntlOptions(S))}function b(O,S,T,Z){return O.trim().split(S).map(ea=>J.formatNumber(Number(ea),J.convertNumberFormatToIntlOptions(Z))).join(T)}
function f(O,S){if(O?.length&&S)return O.find(T=>T.fieldName?.toLowerCase()===S.toLowerCase())}function z({fieldName:O,graphic:S,layer:T}){if(A(O)||!T||"function"!==typeof T.getFeatureType)return null;const {typeIdField:Z}=T;return Z&&O===Z?(O=T.getFeatureType(S))?O.name:null:null}function I({fieldName:O,value:S,graphic:T,layer:Z}){return A(O)||!Z||"function"!==typeof Z.getFieldDomain?null:(O=T&&Z.getFieldDomain(O,{feature:T,excludeImpliedDomains:l("esri-widget-legacy-field-domain-calculation")}))&&
"coded-value"===O.type?O.getName(S):null}function r(O){return"string"===typeof O?O.replaceAll(X,'\x3cbr class\x3d"esri-text-new-line" /\x3e'):O}function y(O){const {value:S,fieldName:T,fieldInfos:Z,fieldInfoMap:ea,layer:ba,graphic:ha,timeZone:ia}=O;return null==S?"":(O=I({fieldName:T,value:S,graphic:ha,layer:ba}))||(O=z({fieldName:T,graphic:ha,layer:ba}))?O:ea.get(T.toLowerCase())?a(S,{fieldInfos:Z||Array.from(ea.values()),fieldName:T,layer:ba,timeZone:ia}):(O=ba?.fieldsIndex?.get(T))&&(M.isAnyDateField(O)||
t.isTimeOnlyField(O))?M.formatAnyDate(S,{fieldType:O.type,timeZoneOptions:{layerTimeZone:ba&&"preferredTimeZone"in ba?ba.preferredTimeZone:null,viewTimeZone:ia,datesInUnknownTimezone:ba&&"datesInUnknownTimezone"in ba?!!ba.datesInUnknownTimezone:!1}}):r(S)}async function H(O,S){const {layer:T,graphic:Z,outFields:ea,objectIds:ba,returnGeometry:ha,spatialReference:ia}=O;O=ba[0];if("number"!==typeof O&&"string"!==typeof O)return S={layer:T,graphic:Z,objectId:O,requiredFields:ea},g.getLogger("esri.widgets.Feature.support.featureUtils").warn("Could not query required fields for the specified feature. The feature's ID is invalid.",
S),null;if(!F.getEffectiveLayerCapabilities(T)?.operations?.supportsQuery)return S={layer:T,graphic:Z,requiredFields:ea,returnGeometry:ha},g.getLogger("esri.widgets.Feature.support.featureUtils").warn("The specified layer cannot be queried. The following fields will not be available.",S),null;O=T.createQuery();O.objectIds=ba;O.outFields=ea?.length?ea:[T.objectIdField];O.returnGeometry=!!ha;O.returnZ=!!ha;O.returnM=!!ha;O.outSpatialReference=ia;return(await T.queryFeatures(O,S)).features[0]}async function Q(O){if(!O.expressionInfos?.length)return!1;
var S=await p.loadArcade();({arcadeUtils:{hasGeometryFunctions:S}}=S);return S(O)}function A(O=""){return O?O.includes("relationships/"):!1}function N({attributes:O,graphic:S,relatedInfo:T,fieldInfos:Z,fieldInfoMap:ea,layer:ba,timeZone:ha}){O&&S&&T&&Object.keys(S.attributes).forEach(ia=>{var ja=`${"relationships/"}${T.relation.id.toString()}/${ia}`;O[ja]=y({fieldName:ja,fieldInfos:Z,fieldInfoMap:ea,layer:ba,value:S.attributes[ia],graphic:S,timeZone:ha})})}function G({attributes:O,relatedInfo:S,fieldInfoMap:T,
fieldInfos:Z,layer:ea,timeZone:ba}){O&&S&&(S.relatedFeatures?.forEach(ha=>N({attributes:O,graphic:ha,relatedInfo:S,fieldInfoMap:T,fieldInfos:Z,layer:ea,timeZone:ba})),S.relatedStatsFeatures?.forEach(ha=>N({attributes:O,graphic:ha,relatedInfo:S,fieldInfoMap:T,fieldInfos:Z,layer:ea,timeZone:ba})))}function d(O,S){return O?.allTables.find(T=>"feature"===T.type&&T.layerId===S.id&&T.url===S.layer?.url)}function E({map:O,relationship:S,relationship:{relatedTableId:T},relatedLayer:Z,layers:ea}){if(!ea)return null;
for(const ba of ea)if("map-image"===ba.type){if(ea=E({layers:ba.sublayers,map:O,relatedLayer:Z,relationship:S})||E({layers:ba.subtables,map:O,relatedLayer:Z,relationship:S}))return ea}else if(k(ba))if("sublayer"===Z.type){if(ba!==Z&&ba.id===T)return ba.isTable?d(O,ba):ba}else{ea="scene"===Z.type&&Z.associatedLayer?Z.associatedLayer.url:Z.url;if(!ea)break;if("sublayer"===ba.type){if(ba!==Z&&ba.layer?.url===ea&&ba.id===T)return ba.isTable?d(O,ba):ba}else if(ba!==Z&&ba.url===ea&&ba.layerId===T)return ba}return null}
const L=/href=(""|'')/gi,R=/(\{([^{\r\n]+)\})/g,U=/'/g,V=/^\s*expression\//i,X=/(\n)/gi,Y=/[\u00A0-\u9999<>&]/gim,aa=/href\s*=\s*(?:"([^"]+)"|'([^']+)')/gi,W=/^(?:mailto:|tel:)/,ca=D.convertDateFormatToIntlOptions("short-date-short-time"),fa=O=>{if(!O)return!1;O=O.toUpperCase();return O.includes("CURRENT_TIMESTAMP")||O.includes("CURRENT_DATE")||O.includes("CURRENT_TIME")},da=({layer:O,method:S,query:T,definitionExpression:Z})=>{O.capabilities?.query?.supportsCacheHint&&"attachments"!==S&&(O=null!=
T.where?T.where:null,S=null!=T.geometry?T.geometry:null,fa(Z)||fa(O)||"extent"===S?.type||"tile"===T.resultType||(T.cacheHint=!0))};c.applyTextFormattingHTML=r;c.createFieldInfoMap=function(O,S){const T=new Map;if(!O)return T;for(const Z of O)Z.fieldName&&(O=C(Z.fieldName,S),Z.fieldName=O,T.set(O.toLowerCase(),Z));return T};c.findRelatedLayer=function(O,S,T){return O&&S&&T?"sublayer"===S.type?E({layers:S.layer?.sublayers,map:O,relatedLayer:S,relationship:T})||E({layers:S.layer?.subtables,map:O,relatedLayer:S,
relationship:T}):E({layers:O.allLayers,map:O,relatedLayer:S,relationship:T})||E({layers:O.allTables,map:O,relatedLayer:S,relationship:T}):null};c.findUtilityNetwork=function(O,S){return O&&"utilityNetworks"in O&&S?O.utilityNetworks?.find(T=>T.isUtilityLayer(S)):null};c.fixTokens=q;c.formatAttributes=function({fieldInfos:O,attributes:S,layer:T,graphic:Z,fieldInfoMap:ea,relatedInfos:ba,timeZone:ha}){const ia={};ba?.forEach(ja=>G({attributes:ia,relatedInfo:ja,fieldInfoMap:ea,fieldInfos:O,layer:T,timeZone:ha}));
S&&Object.keys(S).forEach(ja=>{ia[ja]=y({fieldName:ja,fieldInfos:O,fieldInfoMap:ea,layer:T,value:S[ja],graphic:Z,timeZone:ha})});return ia};c.formatEditInfo=function(O,S,T,Z){const {creatorField:ea,creationDateField:ba,editorField:ha,editDateField:ia}=O;if(S){O=w.getTimeZoneFormattingOptions(Z&&"preferredTimeZone"in Z?Z.preferredTimeZone:null,Z&&"datesInUnknownTimezone"in Z?!!Z.datesInUnknownTimezone:!1,T,ca,"date");O={...ca,...O};T=S[ia];if("number"===typeof T)return S=S[ha],{type:"edit",date:D.formatDate(T,
O),user:S};T=S[ba];return"number"===typeof T?(S=S[ea],{type:"create",date:D.formatDate(T,O),user:S}):null}};c.formatValueToFieldInfo=a;c.getAllFieldInfos=function(O){const S=[];if(!O)return S;const {fieldInfos:T,content:Z}=O;T&&S.push(...T);if(!Z||!Array.isArray(Z))return S;Z.forEach(ea=>{"fields"===ea.type&&(ea=ea?.fieldInfos)&&S.push(...ea)});return S};c.getFieldInfo=f;c.getFieldInfoLabel=function(O,S){return(S=x(S,O?.fieldName))?S.title||null:O?O.label||O.fieldName:null};c.getFixedFieldName=C;
c.getFixedFieldNames=function(O,S){return O&&O.map(T=>C(T,S))};c.getHighlightKeyForFeature=function(O){const S=O.getObjectId();return null!=S?`oid:${S}`:`uid:${O.uid}`};c.getSourceLayer=function(O){if(null!=O)return(O.sourceLayer||O.layer)??void 0};c.graphicCallback=async function({type:O,value:S,event:T}){try{return"function"===typeof S?S(T):await S}catch(Z){g.getLogger("esri.widgets.Feature.support.featureUtils").error("error",`An error occurred when calling the "${O}" function`,{error:Z,graphic:T.graphic,
value:S})}};c.htmlEntities=function(O){return O.replaceAll(Y,S=>`&#${S.charCodeAt(0)};`)};c.isAssociatedFeatureSupportedLayer=function(O){return O&&"object"===typeof O&&"createQuery"in O&&"getField"in O&&"queryFeatureCount"in O&&"queryFeatures"in O&&"queryObjectIds"in O&&"capabilities"in O&&"fields"in O&&"fieldsIndex"in O&&"type"in O&&("feature"===O.type||"subtype-group"===O.type||"subtype-sublayer"===O.type||"sublayer"===O.type)&&"when"in O?"subtype-sublayer"===O.type&&"parent"in O&&O.parent&&"object"===
typeof O.parent?"globalIdField"in O.parent:"globalIdField"in O:!1};c.isExpressionField=h;c.isFeatureSupportedLayer=m;c.isGraphicForRelatableFeatureSupportedLayer=function(O){return!!O&&"object"===typeof O&&"sourceLayer"in O&&k(O.sourceLayer)};c.isRelatableFeatureSupportedLayer=k;c.isRelatableLayer=e;c.isRelatedField=A;c.preLayerQueryCallback=({query:O,layer:S,method:T})=>{da({layer:S,method:T,query:O,definitionExpression:`${S.definitionExpression} ${S.serviceDefinitionExpression??""}`})};c.preRequestCallback=
({queryPayload:O,layer:S,method:T})=>{da({layer:S,method:T,query:O,definitionExpression:`${S.definitionExpression} ${S.serviceDefinitionExpression??""}`})};c.querySourceLayer=H;c.queryUpdatedFeature=async function({graphic:O,popupTemplate:S,layer:T,spatialReference:Z},ea){if(T&&S&&("function"===typeof T.load&&await T.load(ea),O.attributes)){var ba=T.objectIdField,ha=O.attributes[ba];if(null!=ha){ha=[ha];var ia=await S.getRequiredFields(T.fieldsIndex),ja=t.featureHasFields(ia,O);ba=ja?[]:ia.includes(ba)?
ia:[...ia,ba];S=S.returnGeometry||await Q(S);if(!ja||S)if(T=await H({layer:T,graphic:O,outFields:ba,objectIds:ha,returnGeometry:S,spatialReference:Z},ea))T.geometry&&(O.geometry=T.geometry),T.attributes&&(O.attributes={...O.attributes,...T.attributes})}}};c.shouldOpenInNewTab=function(O=""){if(O)return!W.test(O.trim().toLowerCase())};c.substituteAttributes=B;c.substituteFieldsInLinksAndAttributes=function({attributes:O,globalAttributes:S,layer:T,text:Z,expressionAttributes:ea,fieldInfoMap:ba}){return Z?
B({formattedAttributes:S,template:n(Z,{...S,...ea,...O},T),fieldInfoMap:ba}):""};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/constants ../../time/timeZoneUtils".split(" "),function(c,l,g,v,D,J,t){function F(u){return String(u).padStart(2,"0")}function M(u,B,P){if("date"===B||"number"===B){"number"===B&&(u=
new Date(u));B=P?u.getFullYear():u.getUTCFullYear();const K=F((P?u.getMonth():u.getUTCMonth())+1),q=F(P?u.getDate():u.getUTCDate()),n=F(P?u.getHours():u.getUTCHours()),m=F(P?u.getMinutes():u.getUTCMinutes());u=F(P?u.getSeconds():u.getUTCSeconds());u=`TIMESTAMP'${B}-${K}-${q} ${n}:${m}:${u}'`}return u}function p(u,B){if(B instanceof Date)return"date";if("number"===typeof B)return"number";if("string"===typeof B&&(u=u.getField(B),"\x3cnow\x3e"!==B.toLowerCase()&&g.isDateField(u)))return"field"}const w=
{light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d".split(" "),dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d".split(" ")},h={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},x=new Set(["integer","small-integer"]);let C=null;c.castIntegerFieldToFloat=function(u){return`cast(${u} as float)`};
c.dateTypes=["date","date-only","timestamp-offset"];c.defaultBasemapGroups=w;c.defaultStatisticTypes={exclude:["median"]};c.fieldDelimiter=",";c.formatAnyDate=function(u,B){const {format:P,timeZoneOptions:K,fieldType:q}=B??{};let n;K&&({timeZone:m,timeZoneName:n}=t.getTimeZoneFormattingOptions(K.layerTimeZone,K.datesInUnknownTimezone,K.viewTimeZone,l.convertDateFormatToIntlOptions(P||"short-date-short-time"),q));if("string"===typeof u&&isNaN(Date.parse("time-only"===q?`1970-01-01T${u}Z`:u)))return u;
switch(q){case "date-only":var m=l.convertDateFormatToIntlOptions(P||"short-date");return"string"===typeof u?l.formatDateOnly(u,{...m}):l.formatDate(u,{...m,timeZone:J.utc});case "time-only":return m=l.convertDateFormatToIntlOptions(P||"short-time"),"string"===typeof u?l.formatTimeOnly(u,m):l.formatDate(u,{...m,timeZone:J.utc});case "timestamp-offset":if(!m&&"string"===typeof u&&(new Date(u)).toISOString()!==u)return u;m=(B=P||K?l.convertDateFormatToIntlOptions(P||"short-date-short-time"):void 0)?
{...B,timeZone:m,timeZoneName:n}:void 0;return"string"===typeof u?l.formatTimestamp(u,m):l.formatDate(u,m);default:return B=P||K?l.convertDateFormatToIntlOptions(P||"short-date-short-time"):void 0,l.formatDate("string"===typeof u?new Date(u):u,B?{...B,timeZone:m,timeZoneName:n}:void 0)}};c.getBasemapGroup=function(u,B=w){for(const P in B)if(B[P].includes(u))return P};c.getBasemapId=function(u,B,P=!0){let K=null;u&&("string"===typeof u?B.includes(u)&&(K=u):K=D.getWellKnownBasemapId(u));return P?K||
"gray":K};c.getDateDiffSQL=function(u,B,P,K){const {hasQueryEngine:q}=u;P=M(P,p(u,P),q);u=M(B,p(u,B),q);u=`(${P} - ${u})`;K=h[K];B="/";1>K&&(K=1/K,B="*");return{sqlExpression:1===K?u:`(${u} ${B} ${K})`,sqlWhere:null}};c.getDateType=p;c.getFieldsList=async function(u){const {field:B,field2:P,field3:K,normalizationField:q,valueExpression:n}=u;u=[];n&&(C||({arcadeUtils:u}=await v.loadArcade(),C=u),u=C.extractFieldNames(n));B&&u.push(B);P&&u.push(P);K&&u.push(K);q&&u.push(q);return u};c.getNormalizationType=
function(u){let B=u.normalizationType;B||(u.normalizationField?B="field":null!=u.normalizationTotal&&(B="percent-of-total"));return B??void 0};c.isAnyDateField=function(u){return g.isDateField(u)||g.isDateOnlyField(u)||g.isTimestampOffsetField(u)};c.isIntegerField=function(u,B){u=B&&u.getField(B);return!!u&&x.has(u.type)};c.unitValueInDays=h;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Attachments/support/attachmentUtils":function(){define(["exports","../../../assets"],
function(c,l){c.getCalciteIconForAttachment=function(g){return g?"text/plain"===g?"file-text":"application/pdf"===g?"file-pdf":"text/csv"===g?"file-csv":"application/gpx+xml"===g?"file-gpx":"application/x-dwf"===g?"file-cad":"application/postscript"===g||"application/json"===g||"text/xml"===g||"model/vrml"===g?"file-code":"application/x-zip-compressed"===g||"application/x-7z-compressed"===g||"application/x-gzip"===g||"application/x-tar"===g||"application/x-gtar"===g||"application/x-bzip2"===g||"application/gzip"===
g||"application/x-compress"===g||"application/x-apple-diskimage"===g||"application/x-rar-compressed"===g||"application/zip"===g?"file-zip":g.includes("image/")?"file-image":g.includes("audio/")?"file-sound":g.includes("video/")?"file-video":g.includes("msexcel")||g.includes("ms-excel")||g.includes("spreadsheetml")?"file-excel":g.includes("msword")||g.includes("ms-word")||g.includes("wordprocessingml")?"file-word":g.includes("powerpoint")||g.includes("presentationml")?"file-ppt":"file":"file"};c.getIconPath=
function(g){const v=l.getAssetUrl("esri/themes/base/images/files/");return g?"text/plain"===g?`${v}text-32.svg`:"application/pdf"===g?`${v}pdf-32.svg`:"text/csv"===g?`${v}csv-32.svg`:"application/gpx+xml"===g?`${v}gpx-32.svg`:"application/x-dwf"===g?`${v}cad-32.svg`:"application/postscript"===g||"application/json"===g||"text/xml"===g||"model/vrml"===g?`${v}code-32.svg`:"application/x-zip-compressed"===g||"application/x-7z-compressed"===g||"application/x-gzip"===g||"application/x-tar"===g||"application/x-gtar"===
g||"application/x-bzip2"===g||"application/gzip"===g||"application/x-compress"===g||"application/x-apple-diskimage"===g||"application/x-rar-compressed"===g||"application/zip"===g?`${v}zip-32.svg`:g.includes("image/")?`${v}image-32.svg`:g.includes("audio/")?`${v}sound-32.svg`:g.includes("video/")?`${v}video-32.svg`:g.includes("msexcel")||g.includes("ms-excel")||g.includes("spreadsheetml")?`${v}excel-32.svg`:g.includes("msword")||g.includes("ms-word")||g.includes("wordprocessingml")?`${v}word-32.svg`:
g.includes("powerpoint")||g.includes("presentationml")?`${v}report-32.svg`:`${v}generic-32.svg`:`${v}generic-32.svg`};c.isSupportedImage=function(g){g=g.toLowerCase();return"image/bmp"===g||"image/emf"===g||"image/exif"===g||"image/gif"===g||"image/x-icon"===g||"image/jpeg"===g||"image/png"===g||"image/tiff"===g||"image/x-wmf"===g};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(c){c.globalCss={anchor:"esri-widget__anchor",
anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",
loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",
secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/legacyIcon":function(){define(["exports"],function(c){c.legacyIcon={close:"esri-icon-close",collapse:"esri-icon-collapse",down:"esri-icon-down",downArrow:"esri-icon-down-arrow",dragHorizontal:"esri-icon-drag-horizontal",
dragVertical:"esri-icon-drag-vertical",duplicate:"esri-icon-duplicate",expand:"esri-icon-expand",fontFallbackText:"esri-icon-font-fallback-text",forward:"esri-icon-forward",handleVertical:"esri-icon-handle-vertical",icon:"esri-icon",left:"esri-icon-left",locateCircled:"esri-icon-locate-circled",noticeTriangle:"esri-icon-notice-triangle",pause:"esri-icon-pause",play:"esri-icon-play",plus:"esri-icon-plus",radioChecked:"esri-icon-radio-checked",radioUnchecked:"esri-icon-radio-unchecked",refresh:"esri-icon-refresh",
reverse:"esri-icon-reverse",right:"esri-icon-right",search:"esri-icon-search",swap:"esri-icon-swap",table:"esri-icon-table",trash:"esri-icon-trash",up:"esri-icon-up",upArrow:"esri-icon-up-arrow",upDownArrows:"esri-icon-up-down-arrows",urbanModel:"esri-icon-urban-model",zoomInMagnifyingGlass:"esri-icon-zoom-in-magnifying-glass",zoomToObject:"esri-icon-zoom-to-object"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureAttachments/FeatureAttachmentsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Attachments/AttachmentsViewModel".split(" "),
function(c,l,g,v,D,J,t){g=class extends t{constructor(F){super(F);this.title=this.description=null}};c.__decorate([l.property()],g.prototype,"description",void 0);c.__decorate([l.property()],g.prototype,"title",void 0);return g=c.__decorate([J.subclass("esri.widgets.Feature.FeatureAttachments.FeatureAttachmentsViewModel")],g)})},"esri/widgets/Feature/support/FeatureElementInfo":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../Widget ../../support/Heading ../../support/widgetUtils ../../support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p){g=class extends t{constructor(w,h){super(w,h);this.description=null;this.headingLevel=2;this.title=null}render(){return p.tsx("div",{class:"esri-feature-element-info"},this._renderTitle(),this._renderDescription())}_renderTitle(){const {title:w}=this;return w?p.tsx(F.Heading,{class:"esri-feature-element-info__title",innerHTML:w,level:this.headingLevel}):null}_renderDescription(){const {description:w}=this;return w?p.tsx("div",{class:"esri-feature-element-info__description",
innerHTML:w,key:"description"}):null}};c.__decorate([l.property()],g.prototype,"description",void 0);c.__decorate([l.property()],g.prototype,"headingLevel",void 0);c.__decorate([l.property()],g.prototype,"title",void 0);return g=c.__decorate([J.subclass("esri.widgets.Feature.support.FeatureElementInfo")],g)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(c,l,g,v,D){c.Heading=function({level:J,class:t,...F},
M){J=l.clamp(Math.ceil(J),1,6);return D.tsx(`h${J}`,{...F,"aria-level":String(J),class:v.classes(g.globalCss.heading,t),role:"heading"},M)};c.incrementHeadingLevel=function(J,t=1){return l.clamp(Math.ceil(J+t),1,6)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureContent":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent/FeatureContentViewModel ./support/featureUtils ../support/widget ../support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w){g=class extends t{constructor(h,x){super(h,x);this.viewModel=null;this._addTargetToAnchors=C=>{Array.from(C.querySelectorAll("a")).forEach(u=>{M.shouldOpenInNewTab(u.href)&&!u.hasAttribute("target")&&u.setAttribute("target","_blank")})}}get creator(){return this.viewModel?.creator}set creator(h){this.viewModel&&(this.viewModel.creator=h)}get graphic(){return this.viewModel?.graphic}set graphic(h){this.viewModel&&(this.viewModel.graphic=h)}render(){return w.tsx("div",
{class:"esri-feature-content"},"loading"===this.viewModel?.state?this._renderLoading():this._renderCreated())}_renderLoading(){return w.tsx("div",{class:"esri-feature-content__loader-container",key:"loader"},w.tsx("div",{class:"esri-feature-content__loader"}))}_renderCreated(){const h=this.viewModel?.created;return h?h instanceof HTMLElement?w.tsx("div",{afterCreate:this._attachToNode,bind:h,key:h}):p.isWidget(h)?w.tsx("div",{key:h},!h.destroyed&&h.render()):w.tsx("div",{afterCreate:this._addTargetToAnchors,
innerHTML:h,key:h}):null}_attachToNode(h){h.appendChild(this)}};c.__decorate([l.property()],g.prototype,"creator",null);c.__decorate([l.property()],g.prototype,"graphic",null);c.__decorate([l.property({type:F})],g.prototype,"viewModel",void 0);return g=c.__decorate([J.subclass("esri.widgets.Feature.FeatureContent")],g)})},"esri/widgets/Feature/FeatureContent/FeatureContentViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../support/featureUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p){g=class extends g{constructor(w){super(w);this.graphic=this.destroyer=this.creator=this.created=this._loadingPromise=null;this.addHandles(v.watch(()=>this.creator,h=>{this._destroyContent();this._createContent(h)},v.initial))}destroy(){this._destroyContent()}get state(){return this._loadingPromise?"loading":"ready"}_destroyContent(){const {created:w,graphic:h,destroyer:x}=this;w&&h&&(p.graphicCallback({type:"content",value:x,event:{graphic:h}}),this._set("created",null))}async _createContent(w){var h=
this.graphic;h&&w&&(this._loadingPromise=w=p.graphicCallback({type:"content",value:w,event:{graphic:h}}),this.notifyChange("state"),h=await w,w===this._loadingPromise&&(this._loadingPromise=null,this.notifyChange("state"),this._set("created",h)))}};c.__decorate([D.property({readOnly:!0})],g.prototype,"created",void 0);c.__decorate([D.property()],g.prototype,"creator",void 0);c.__decorate([D.property()],g.prototype,"destroyer",void 0);c.__decorate([D.property({type:l})],g.prototype,"graphic",void 0);
c.__decorate([D.property({readOnly:!0})],g.prototype,"state",null);return g=c.__decorate([M.subclass("esri.widgets.Feature.FeatureContent.FeatureContentViewModel")],g)})},"esri/widgets/Feature/FeatureExpression":function(){define("require ../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureContent ./FeatureFields ./FeatureMedia ./FeatureExpression/FeatureExpressionViewModel ../../chunks/componentsUtils ../support/widgetUtils ../support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B){D=class extends M{constructor(P,K){super(P,K);this._contentWidget=null;this.viewModel=new x}initialize(){this.addHandles(g.watch(()=>this.viewModel?.contentElementViewModel,()=>this._setupExpressionWidget(),g.initial))}loadDependencies(){return C.loadCalciteComponents({loader:()=>new Promise((P,K)=>c(["../../chunks/index32"],P,K))})}destroy(){this._destroyContentWidget()}render(){const {state:P}=this.viewModel;return B.tsx("div",{class:"esri-feature-expression"},
"loading"===P?this._renderLoading():"disabled"===P?null:this._contentWidget?.render())}_renderLoading(){return B.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},B.tsx("calcite-loader",{inline:!0,label:""}))}_destroyContentWidget(){const {_contentWidget:P}=this;P&&(P.viewModel=null,P.destroy());this._contentWidget=null}_setupExpressionWidget(){const {contentElementViewModel:P,contentElement:K}=this.viewModel,q=K?.type;this._destroyContentWidget();this._contentWidget=P?"fields"===
q?new w({viewModel:P}):"media"===q?new h({viewModel:P}):"text"===q?new p({viewModel:P}):null:null;this.scheduleRender()}};l.__decorate([v.property({type:x})],D.prototype,"viewModel",void 0);return D=l.__decorate([F.subclass("esri.widgets.Feature.FeatureExpression")],D)})},"esri/widgets/Feature/FeatureFields":function(){define("../../chunks/tslib.es6 ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureFields/FeatureFieldsViewModel ./support/FeatureElementInfo ../support/globalCss ../support/uriUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u){v=class extends F{constructor(B,P){super(B,P);this._featureElementInfo=null;this.viewModel=new M;this.messagesURIUtils=this.messages=null}initialize(){this._featureElementInfo=new p;this.addHandles(l.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),l.initial))}destroy(){this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(B){this.viewModel.attributes=B}get description(){return this.viewModel.description}set description(B){this.viewModel.description=
B}get expressionInfos(){return this.viewModel.expressionInfos}set expressionInfos(B){this.viewModel.expressionInfos=B}get fieldInfos(){return this.viewModel.fieldInfos}set fieldInfos(B){this.viewModel.fieldInfos=B}get title(){return this.viewModel.title}set title(B){this.viewModel.title=B}render(){return u.tsx("div",{class:"esri-feature-fields"},this._featureElementInfo?.render(),this._renderFields())}_renderFieldInfo(B,P){var {attributes:K}=this.viewModel;const q=B.fieldName||"",n=B.label||q;K=K?
null==K[q]?"":K[q]:"";B=!!B.format?.dateFormat;K="number"!==typeof K||B?h.autoLink(this.messagesURIUtils,K):this._forceLTR(K);B={["esri-feature-fields__field-data--date"]:B};return u.tsx("tr",{key:`fields-element-info-row-${q}-${P}`},u.tsx("th",{class:"esri-feature-fields__field-header",innerHTML:n,key:`fields-element-info-row-header-${q}-${P}`}),u.tsx("td",{class:this.classes("esri-feature-fields__field-data",B),innerHTML:K,key:`fields-element-info-row-data-${q}-${P}`}))}_renderFields(){const {formattedFieldInfos:B}=
this.viewModel;return B?.length?u.tsx("table",{class:w.globalCss.table,summary:this.messages.fieldsSummary},u.tsx("tbody",null,B.map((P,K)=>this._renderFieldInfo(P,K)))):null}_setupFeatureElementInfo(){const {description:B,title:P}=this;this._featureElementInfo?.set({description:B,title:P})}_forceLTR(B){return`&lrm;${B}`}};c.__decorate([g.property()],v.prototype,"attributes",null);c.__decorate([g.property()],v.prototype,"description",null);c.__decorate([g.property()],v.prototype,"expressionInfos",
null);c.__decorate([g.property()],v.prototype,"fieldInfos",null);c.__decorate([g.property()],v.prototype,"title",null);c.__decorate([g.property({type:M,nonNullable:!0})],v.prototype,"viewModel",void 0);c.__decorate([g.property(),C.messageBundle("esri/widgets/Feature/t9n/Feature")],v.prototype,"messages",void 0);c.__decorate([g.property(),C.messageBundle("esri/widgets/support/t9n/uriUtils")],v.prototype,"messagesURIUtils",void 0);return v=c.__decorate([t.subclass("esri.widgets.Feature.FeatureFields")],
v)})},"esri/widgets/Feature/FeatureFields/FeatureFieldsViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../popup/ExpressionInfo ../../../popup/FieldInfo ../support/featureUtils".split(" "),function(c,l,g,v,D,J,t,F,M,p){l=class extends l{constructor(w){super(w);this.title=this.fieldInfos=this.description=
this.expressionInfos=this.attributes=null}get formattedFieldInfos(){const {expressionInfos:w,fieldInfos:h}=this,x=[];h?.forEach(C=>{if(!C.hasOwnProperty("visible")||C.visible)C=C.clone(),C.label=p.getFieldInfoLabel(C,w),x.push(C)});return x}};c.__decorate([g.property()],l.prototype,"attributes",void 0);c.__decorate([g.property({type:[F]})],l.prototype,"expressionInfos",void 0);c.__decorate([g.property()],l.prototype,"description",void 0);c.__decorate([g.property({type:[M]})],l.prototype,"fieldInfos",
void 0);c.__decorate([g.property({readOnly:!0})],l.prototype,"formattedFieldInfos",null);c.__decorate([g.property()],l.prototype,"title",void 0);return l=c.__decorate([t.subclass("esri.widgets.Feature.FeatureFields.FeatureFieldsViewModel")],l)})},"esri/widgets/support/uriUtils":function(){define(["exports","../../core/string"],function(c,l){const g=[{pattern:/^\s*(https?:\/\/([^\s]+))\s*$/i,target:"_blank",label:"{messages.view}"},{pattern:/^\s*(tel:([^\s]+))\s*$/i,label:"{hierPart}"},{pattern:/^\s*(mailto:([^\s]+))\s*$/i,
label:"{hierPart}"},{pattern:/^\s*(arcgis-appstudio-player:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"App Studio Player"},{pattern:/^\s*(arcgis-collector:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Collector"},{pattern:/^\s*(arcgis-explorer:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Explorer"},{pattern:/^\s*(arcgis-navigator:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Navigator"},{pattern:/^\s*(arcgis-survey123:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",
appName:"Survey123"},{pattern:/^\s*(arcgis-trek2there:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Trek2There"},{pattern:/^\s*(arcgis-workforce:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Workforce"},{pattern:/^\s*(iform:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"iForm"},{pattern:/^\s*(flow:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"FlowFinity"},{pattern:/^\s*(lfmobile:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Laserfische"},
{pattern:/^\s*(mspbi:\/\/([^\s]+))\s*$/i,label:"{messages.openInApp}",appName:"Microsoft Power Bi"}];c.autoLink=function(v,D){if("string"!==typeof D||!D)return D;const J=g.find(F=>F.pattern.test(D));if(!J)return D;const t=D.match(J.pattern);v=l.replace(l.replace(J.label,{messages:v,hierPart:t?.[2]}),{appName:J.appName});return D.replace(J.pattern,`<a${J.target?` target="${J.target}"`:""} href="$1"${"_blank"===J.target?' rel\x3d"noreferrer"':""}>${v}</a>`)};Object.defineProperty(c,Symbol.toStringTag,
{value:"Module"})})},"esri/widgets/Feature/FeatureMedia":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/a11yUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../renderers/support/utils ../Widget ./FeatureMedia/FeatureMediaViewModel ./support/FeatureElementInfo ./support/featureUtils ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../support/themeUtils ../../intl/substitute".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m){g=class extends h{constructor(e,k){super(e,k);this._featureElementInfo=this._refreshIntervalInfo=this._refreshTimer=null;this._chartRootMap=new WeakMap;this.viewModel=new x;this.messages=null;this._disposeChart=a=>{this._chartRootMap.get(a)?.dispose();this._chartRootMap.delete(a)};this._createChart=async a=>{const {destroyed:b,viewModel:f}=this;if(!b&&f&&a){var {createRoot:z}=await new Promise((I,r)=>c(["../support/chartUtilsAm5"],I,r));z=await z(a);
this._chartRootMap.set(a,z);this._renderChart({mediaInfo:f.activeMediaInfo,root:z})}}}initialize(){this._featureElementInfo=new C;this.addHandles([D.watch(()=>[this.viewModel?.activeMediaInfo,this.viewModel?.activeMediaInfoIndex],()=>this._setupMediaRefreshTimer(),D.initial),D.watch(()=>[this.viewModel?.description,this.viewModel?.title],()=>this._setupFeatureElementInfo(),D.initial)])}loadDependencies(){return B.loadCalciteComponents({icon:()=>(new Promise((e,k)=>c(["../../chunks/index7"],e,k))).then(e=>
e.index)})}destroy(){this._clearMediaRefreshTimer();this._featureElementInfo?.destroy()}get attributes(){return this.viewModel.attributes}set attributes(e){this.viewModel.attributes=e}get activeMediaInfoIndex(){return this.viewModel.activeMediaInfoIndex}set activeMediaInfoIndex(e){this.viewModel.activeMediaInfoIndex=e}get description(){return this.viewModel.description}set description(e){this.viewModel.description=e}get fieldInfoMap(){return this.viewModel.fieldInfoMap}set fieldInfoMap(e){this.viewModel.fieldInfoMap=
e}get layer(){return this.viewModel.layer}set layer(e){this.viewModel.layer=e}get mediaInfos(){return this.viewModel.mediaInfos}set mediaInfos(e){this.viewModel.mediaInfos=e}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(e){this.viewModel.popupTemplate=e}get relatedInfos(){return this.viewModel.relatedInfos}set relatedInfos(e){this.viewModel.relatedInfos=e}get title(){return this.viewModel.title}set title(e){this.viewModel.title=e}render(){return q.tsx("div",{bind:this,
class:"esri-feature-media",onkeyup:this._handleMediaKeyup},this._featureElementInfo?.render(),this._renderMedia())}_renderMedia(){const {formattedMediaInfoCount:e,activeMediaInfoIndex:k}=this.viewModel,a=this._renderMediaText();return e?q.tsx("div",{class:"esri-feature-media__container",key:"media-element-container"},this._renderMediaInfo(),q.tsx("div",{class:"esri-feature-media__item-navigation"},a,1<e?q.tsx("div",{class:"esri-feature-media__pagination"},this._renderMediaPageButton("previous"),q.tsx("span",
{class:"esri-feature-media__pagination-text"},m.substitute(this.messages.pageText,{index:k+1,total:e})),this._renderMediaPageButton("next")):null)):null}_renderMediaText(){var {activeMediaInfo:e}=this.viewModel;if(!e)return null;const k=e&&e.title?q.tsx("div",{class:"esri-feature-media__item-title",innerHTML:e.title,key:"media-title"}):null;e=e&&e.caption?q.tsx("div",{class:"esri-feature-media__item-caption",innerHTML:e.caption,key:"media-caption"}):null;return k||e?q.tsx("div",{class:"esri-feature-media__item-text",
key:"media-text"},k,e):null}_renderImageMediaInfo(e){if(!e.value)return null;var {_refreshIntervalInfo:k}=this;const {activeMediaInfoIndex:a,formattedMediaInfoCount:b}=this.viewModel,{value:f,refreshInterval:z,altText:I,title:r,type:y}=e,{sourceURL:H,linkURL:Q}=f;e=u.shouldOpenInNewTab(Q??void 0)?"_blank":"_self";const A="_blank"===e?"noreferrer":"";k=z?k:null;k=q.tsx("img",{alt:I||r,key:`media-${y}-${a}-${b}-${k?k.timestamp:0}`,src:(k?k.sourceURL:H)??void 0});return(Q?q.tsx("a",{href:Q,rel:A,target:e,
title:r},k):null)??k}_renderChartMediaInfo(e){const {activeMediaInfoIndex:k,formattedMediaInfoCount:a}=this.viewModel;return q.tsx("div",{afterCreate:this._createChart,afterRemoved:this._disposeChart,bind:this,class:"esri-feature-media__chart",key:`media-${e.type}-${k}-${a}`})}_renderMediaInfoType(){const {activeMediaInfo:e}=this.viewModel;return e?"image"===e.type?this._renderImageMediaInfo(e):e.type.includes("chart")?this._renderChartMediaInfo(e):null:null}_renderMediaInfo(){const {activeMediaInfo:e}=
this.viewModel;return e?q.tsx("div",{class:"esri-feature-media__item-container",key:"media-container"},q.tsx("div",{class:"esri-feature-media__item",key:"media-item-container"},this._renderMediaInfoType())):null}_renderMediaPageButton(e){if(2>this.viewModel.formattedMediaInfoCount)return null;const k=(e="previous"===e)?this.messages.previous:this.messages.next;return q.tsx("button",{"aria-label":k,bind:this,class:"esri-feature-media__pagination-button",key:e?"media-previous":"media-next",onclick:e?
this._previous:this._next,tabIndex:0,title:k,type:"button"},q.tsx("calcite-icon",{class:"esri-feature-media__pagination-icon",icon:e?"chevron-left":"chevron-right",scale:"s"}))}_setupFeatureElementInfo(){const {description:e,title:k}=this;this._featureElementInfo?.set({description:e,title:k})}_next(){this.viewModel.next()}_previous(){this.viewModel.previous()}_getRenderer(){if(this.viewModel){var {isAggregate:e,layer:k}=this.viewModel;return e&&k?.featureReduction&&"renderer"in k.featureReduction?
k.featureReduction.renderer:k?.renderer}}async _getSeriesColors(e){const {colorAm5:k}=await new Promise((b,f)=>c(["./FeatureMedia/chartCommon"],b,f)),a=new Map;e.forEach(b=>{b.color&&a.set(b,k(b.color.toCss(!0)))});return a}async _getRendererColors(){const {colorAm5:e}=await new Promise((f,z)=>c(["./FeatureMedia/chartCommon"],f,z)),k=new Map,a=this._getRenderer();if(!a)return k;const b=await w.getColorsFromRenderer(a);b.delete("default");if(!Array.from(b.values()).every(f=>1===f?.length))return k;
Array.from(b.keys()).forEach(f=>{const z=b.get(f)?.[0]?.toCss(!0);z&&k.set(f,e(z))});return k}_handleMediaKeyup(e){const {key:k}=e;"ArrowLeft"===k&&(e.stopPropagation(),this.viewModel.previous());"ArrowRight"===k&&(e.stopPropagation(),this.viewModel.next())}_canAnimateChart(){return this.viewModel?!!this.viewModel.abilities.chartAnimation&&!v.prefersReducedMotion():!1}_getChartAnimationMS(){return this._canAnimateChart()?250:0}_getChartSeriesAnimationMS(){return this._canAnimateChart()?500:0}async _renderChart(e){const {root:k,
mediaInfo:a}=e,{value:b,type:f}=a,{ResponsiveThemeAm5:z,DarkThemeAm5:I,AnimatedThemeAm5:r,ColorSetAm5:y,ThemeAm5:H,esriChartColorSet:Q}=await new Promise((L,R)=>c(["./FeatureMedia/chartCommon"],L,R));var A=H.new(k);A.rule("ColorSet").set("colors",Q);A.rule("ColorSet").set("reuse",!0);A=[z.new(k),A];n.isDarkTheme()&&A.push(I.new(k));this._canAnimateChart()&&A.push(r.new(k));k.setThemes(A);const N=await this._getRendererColors(),G=await this._getSeriesColors(b.series),d=y.new(k,{}),E=(A=G.get(b.series[0]))?
{lineSettings:{stroke:A}}:void 0;A=b.series.map((L,R)=>{R=G.get(L)||N.get(L.fieldName)||d.getIndex(R);return{category:L.tooltip,value:L.value,columnSettings:{fill:R,stroke:R},...E}}).filter(L=>"pie-chart"===f?null!=L.value&&0<L.value:!0);"pie-chart"===f?this._createPieChart(e,A):this._createXYChart(e,A)}_getDirection(){return P.isRTL(this.container)?"rtl":"ltr"}async _customizeChartTooltip(e,k="horizontal"){const {colorAm5:a}=await new Promise((b,f)=>c(["./FeatureMedia/chartCommon"],b,f));e.setAll({pointerOrientation:k});
e.get("background")?.setAll({stroke:a("rgba(50, 50, 50, 1)")});e.label.setAll({direction:this._getDirection(),oversizedBehavior:"wrap",maxWidth:200})}async _createPieChart(e,k){var {TooltipAm5:a}=await new Promise((y,H)=>c(["./FeatureMedia/chartCommon"],y,H));const {PieChartAm5:b,PieSeriesAm5:f}=await new Promise((y,H)=>c(["./FeatureMedia/pieChart"],y,H)),{mediaInfo:z,root:I}=e;var {title:r}=z;e=I.container.children.push(b.new(I,{ariaLabel:z?.altText||z?.title||"",focusable:!0,paddingBottom:5,paddingTop:5,
paddingLeft:5,paddingRight:5}));a=a.new(I,{labelText:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})"});r=e.series.push(f.new(I,{name:r,valueField:"value",categoryField:"category",tooltip:a}));r.ticks.template.set("forceHidden",!0);r.labels.template.set("forceHidden",!0);r.slices.template.states.create("active",{shiftRadius:5});this._customizeChartTooltip(a);r.slices.template.setAll({ariaLabel:"{category}: {valuePercentTotal.formatNumber('0.00')}%\n ({value})",focusable:!0,templateField:"columnSettings"});
r.data.setAll(k);r.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS());e.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_getMinSeriesValue(e){let k=0;e.forEach(a=>k=Math.min(a.value,k));return k}async _createColumnChart(e,k,a){const {TooltipAm5:b,ScrollbarAm5:f}=await new Promise((L,R)=>c(["./FeatureMedia/chartCommon"],L,R)),{CategoryAxisAm5:z,AxisRendererXAm5:I,ValueAxisAm5:r,AxisRendererYAm5:y,ColumnSeriesAm5:H}=await new Promise((L,R)=>c(["./FeatureMedia/xyChart"],
L,R)),{mediaInfo:Q,root:A}=k,{value:N,title:G}=Q;e.setAll({wheelX:"panX",wheelY:"zoomX"});k=e.xAxes.push(z.new(A,{renderer:I.new(A,{inversed:P.isRTL(this.container)}),categoryField:"category"}));k.get("renderer").labels.template.setAll({forceHidden:!0});var d=e.yAxes.push(r.new(A,{renderer:y.new(A,{inside:!1}),min:this._getMinSeriesValue(N.series)}));d.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=b.new(A,{labelText:"{categoryX}"});d=e.series.push(H.new(A,{name:G,
xAxis:k,yAxis:d,valueYField:"value",categoryXField:"category",tooltip:E}));this._customizeChartTooltip(E);d.columns.template.setAll({ariaLabel:"{categoryX}",focusable:!0,templateField:"columnSettings"});15<N.series.length&&e.set("scrollbarX",f.new(A,{orientation:"horizontal"}));k.data.setAll(a);d.data.setAll(a);d.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createBarChart(e,k,a){const {TooltipAm5:b,ScrollbarAm5:f}=await new Promise((L,R)=>c(["./FeatureMedia/chartCommon"],
L,R)),{CategoryAxisAm5:z,AxisRendererXAm5:I,ValueAxisAm5:r,AxisRendererYAm5:y,ColumnSeriesAm5:H}=await new Promise((L,R)=>c(["./FeatureMedia/xyChart"],L,R)),{mediaInfo:Q,root:A}=k,{value:N,title:G}=Q;e.setAll({wheelX:"panY",wheelY:"zoomY"});k=e.yAxes.push(z.new(A,{renderer:y.new(A,{inversed:!0}),categoryField:"category"}));k.get("renderer").labels.template.setAll({forceHidden:!0});var d=e.xAxes.push(r.new(A,{renderer:I.new(A,{inside:!1,inversed:P.isRTL(this.container)}),min:this._getMinSeriesValue(N.series)}));
d.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=b.new(A,{labelText:"{categoryY}"});d=e.series.push(H.new(A,{name:G,xAxis:d,yAxis:k,valueXField:"value",categoryYField:"category",tooltip:E}));this._customizeChartTooltip(E,"vertical");d.columns.template.setAll({ariaLabel:"{categoryY}",focusable:!0,templateField:"columnSettings"});15<N.series.length&&e.set("scrollbarY",f.new(A,{orientation:"vertical"}));k.data.setAll(a);d.data.setAll(a);d.appear(this._getChartSeriesAnimationMS());
e.appear(this._getChartAnimationMS())}async _createLineChart(e,k,a){const {TooltipAm5:b,ScrollbarAm5:f}=await new Promise((R,U)=>c(["./FeatureMedia/chartCommon"],R,U)),{CategoryAxisAm5:z,AxisRendererXAm5:I,ValueAxisAm5:r,AxisRendererYAm5:y,LineSeriesAm5:H}=await new Promise((R,U)=>c(["./FeatureMedia/xyChart"],R,U)),{root:Q,mediaInfo:A}=k,{value:N,title:G}=A;e.setAll({wheelX:"panX",wheelY:"zoomX"});k=e.xAxes.push(z.new(Q,{renderer:I.new(Q,{inversed:P.isRTL(this.container)}),categoryField:"category"}));
k.get("renderer").labels.template.setAll({forceHidden:!0});var d=e.yAxes.push(r.new(Q,{renderer:y.new(Q,{inside:!1}),min:this._getMinSeriesValue(N.series)}));d.get("renderer").labels.template.setAll({direction:this._getDirection()});const E=a[0]?.lineSettings?.stroke,L=b.new(Q,{getFillFromSprite:!E,labelText:"{categoryX}"});E&&L.get("background")?.setAll({fill:E});d=e.series.push(H.new(Q,{name:G,xAxis:k,yAxis:d,valueYField:"value",categoryXField:"category",tooltip:L}));d.strokes.template.setAll({templateField:"lineSettings"});
this._customizeChartTooltip(L,"vertical");15<N.series.length&&e.set("scrollbarX",f.new(Q,{orientation:"horizontal"}));k.data.setAll(a);d.data.setAll(a);d.appear(this._getChartSeriesAnimationMS());e.appear(this._getChartAnimationMS())}async _createXYChart(e,k){const {XYChartAm5:a,XYCursorAm5:b}=await new Promise((y,H)=>c(["./FeatureMedia/xyChart"],y,H)),{root:f,mediaInfo:z}=e,{type:I}=z,r=f.container.children.push(a.new(f,{ariaLabel:z?.altText||z?.title||"",focusable:!0,panX:!0,panY:!0}));r.set("cursor",
b.new(f,{}));"column-chart"===I&&await this._createColumnChart(r,e,k);"bar-chart"===I&&await this._createBarChart(r,e,k);"line-chart"===I&&await this._createLineChart(r,e,k);r.root.dom.classList.toggle("esri-feature-media__chart--rendered",!0)}_clearMediaRefreshTimer(){const {_refreshTimer:e}=this;e&&(clearTimeout(e),this._refreshTimer=null)}_updateMediaInfoTimestamp(e){const k=Date.now();this._refreshIntervalInfo={timestamp:k,sourceURL:e&&this._getImageSource(e,k)}}_setupMediaRefreshTimer(){this._clearMediaRefreshTimer();
const {activeMediaInfo:e}=this.viewModel;"image"===e?.type&&0<e?.refreshInterval&&this._setRefreshTimeout(e)}_setRefreshTimeout(e){const {refreshInterval:k,value:a}=e;e=6E4*k;this._updateMediaInfoTimestamp(a.sourceURL);this._refreshTimer=setInterval(()=>{this._updateMediaInfoTimestamp(a.sourceURL)},e)}_getImageSource(e,k){const a=e.includes("?")?"\x26":"?",[b,f=""]=e.split("#");return`${b}${a}timestamp=${k}${f?"#":""}${f}`}};l.__decorate([J.property()],g.prototype,"_refreshIntervalInfo",void 0);l.__decorate([J.property()],
g.prototype,"attributes",null);l.__decorate([J.property()],g.prototype,"activeMediaInfoIndex",null);l.__decorate([J.property()],g.prototype,"description",null);l.__decorate([J.property()],g.prototype,"fieldInfoMap",null);l.__decorate([J.property()],g.prototype,"layer",null);l.__decorate([J.property()],g.prototype,"mediaInfos",null);l.__decorate([J.property()],g.prototype,"popupTemplate",null);l.__decorate([J.property()],g.prototype,"relatedInfos",null);l.__decorate([J.property()],g.prototype,"title",
null);l.__decorate([J.property({type:x})],g.prototype,"viewModel",void 0);l.__decorate([J.property(),K.messageBundle("esri/widgets/Feature/t9n/Feature")],g.prototype,"messages",void 0);return g=l.__decorate([p.subclass("esri.widgets.Feature.FeatureMedia")],g)})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h){async function x(n,m,e){v.getOrCreateMapValue(n,m,()=>[]).push(...e)}async function C(n,m,e){n=v.getOrCreateMapValue(n,m,()=>new Map);for(const k of e)n.set(k.value,k.color)}function u(n){let m=n.minValue,e=n.maxValue;const k=n.isFirstBreak?"":P.gt+" ";n="percent-of-total"===n.normalizationType?P.pct:"";m=null==m?"":t.format(m);e=null==e?"":t.format(e);return k+m+n+" "+P.ld+" "+e+n}function B(n,m){return"normalizationField"in n&&n.normalizationField?{type:"normalized-field",
field:n.field,normalizationField:n.normalizationField}:"field"in n&&n.field?{type:"field",field:n.field}:"valueExpression"in n&&n.valueExpression?{type:"expression",expression:n.valueExpression,title:n.valueExpressionTitle,returnType:m}:null}const P={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},K={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},q=D.convertDateFormatToIntlOptions("short-date");c.calculateDateFormatInterval=function(n){n=n.map(b=>new Date(b));
const m=n.length;let e=Infinity,k=null;for(let b=0;b<m-1;b++){const f=n[b];let z=Infinity,I=null;for(let r=b+1;r<m;r++){var a=n[r];a=f.getFullYear()!==a.getFullYear()&&"year"||f.getMonth()!==a.getMonth()&&"month"||f.getDate()!==a.getDate()&&"day"||f.getHours()!==a.getHours()&&"hour"||f.getMinutes()!==a.getMinutes()&&"minute"||f.getSeconds()!==a.getSeconds()&&"second"||"millisecond";const y=K[a];y<z&&(z=y,I=a)}z<e&&(e=z,k=I)}return k};c.createClassBreakLabel=u;c.createColorStops=function(n){const {values:m,
colors:e,labelIndexes:k,isDate:a}=n;return m.map((b,f)=>{var z=null;if(!k||k.includes(f)){const I=a?D.formatDate(b):t.format(b);I&&(z="",0===f?z=P.lt+" ":f===m.length-1&&(z=P.gt+" "),z+=I)}return new F({value:b,color:e[f],label:z})})};c.createUniqueValueLabel=function(n){const {value:m,domain:e,fieldInfo:k,dateFormatOptions:a}=n;n=String(m);const b=e&&"codedValues"in e&&e.codedValues?e.getName(m):null;b?n=b:null!=m&&k&&(M.isAnyDateField(k)||J.isTimeOnlyField(k))?n=M.formatAnyDate(m,a??{fieldType:k.type}):
"number"===typeof m&&(n=t.format(m));return n};c.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};c.getAttribute=B;c.getAttributes=function(n,m){const e=[];if("class-breaks"===n.type||"heatmap"===n.type)e.push(B(n,"number"));else if("unique-value"===n.type){var k=n.authoringInfo;if(k&&"relationship"===
k.type){if(k.field1&&k.field2){var a=k.field2.field;const b=k.field2.normalizationField;e.push(B({field:k.field1.field,normalizationField:k.field1.normalizationField}));e.push(B({field:a,normalizationField:b}))}}else a=n.uniqueValueInfos?.[0],k=null,a?.value&&(a=typeof a.value,"string"===a||"number"===a)&&(k=a),e.push(B(n,k)),[n.field2,n.field3].forEach(b=>b&&e.push({type:"field",field:b}))}else"attributes"in n&&n.attributes?.forEach(b=>e.push(B(b,"number")));(n=m?m(n):"visualVariables"in n?n.visualVariables:
null)&&n.forEach(b=>e.push(B(b,"number")));return l.unique(e.filter(l.isSome),(b,f)=>"field"===b.type&&"field"===f.type?b.field===f.field:"normalized-field"===b.type&&"normalized-field"===f.type?b.field===f.field&&b.normalizationField===f.normalizationField:"expression"===b.type&&"expression"===f.type?b.expression===f.expression:!1)};c.getColorsForRendererValues=async function(n){const m=new Map;if(!n)return m;if("unique-value"!==n.type||n.authoringInfo?.type)if("class-breaks"===n.type){var e=n.classBreakInfos.map(b=>
({value:b.minValue,color:p.getColorFromSymbol(b.symbol,null)})).reverse();const {field:k,valueExpression:a}=n;await C(m,k??a,e)}else"simple"===n.type&&await C(m,"default",[{value:"default",color:p.getColorFromSymbol(n.symbol,null)}]);else{e=(n.uniqueValueInfos??[]).map(r=>({value:r.value,color:p.getColorFromSymbol(r.symbol,null)}));const {field:k,field2:a,field3:b,valueExpression:f,fieldDelimiter:z}=n,I=[k,a,b].filter(Boolean).join(z||"");(I||f)&&await C(m,I||f,e)}"defaultSymbol"in n&&n.defaultSymbol&&
await C(m,"default",[{value:"default",color:p.getColorFromSymbol(n.defaultSymbol,null)}]);if("visualVariables"in n&&n.visualVariables){n=n.visualVariables.filter(k=>"color"===k.type);for(const k of n)n=await w.getRampStops(k)??[],await C(m,k.field||k.valueExpression,n)}return m};c.getColorsFromRenderer=async function(n){const m=new Map;if(!n)return m;if("visualVariables"in n&&n.visualVariables)for(var e of n.visualVariables)if("color"===e.type){const k=(await w.getRampStops(e)??[]).map(a=>a.color);
await x(m,e.field||e.valueExpression,k)}if("heatmap"===n.type)e=h.getHeatmapRampStops(n).map(k=>k.color),await x(m,n.field||n.valueExpression,e);else if("pie-chart"===n.type){for(const k of n.attributes)await x(m,k.field||k.valueExpression,[k.color]);await x(m,"default",[n?.othersCategory?.color,p.getColorFromSymbol(n.backgroundFillSymbol,null)])}else if("dot-density"===n.type){for(const k of n.attributes)await x(m,k.field||k.valueExpression,[k.color]);await x(m,"default",[n.backgroundColor])}else if("unique-value"===
n.type)if("predominance"===n.authoringInfo?.type)for(const k of n.uniqueValueInfos??[])await x(m,k.value.toString(),[p.getColorFromSymbol(k.symbol,null)]);else{e=(n.uniqueValueInfos??[]).map(z=>p.getColorFromSymbol(z.symbol,null));const {field:k,field2:a,field3:b,valueExpression:f}=n;(k||f)&&await x(m,k||f,e);a&&await x(m,a,e);b&&await x(m,b,e)}else if("class-breaks"===n.type){e=n.classBreakInfos.map(b=>p.getColorFromSymbol(b.symbol,null));const {field:k,valueExpression:a}=n;await x(m,k??a,e)}else"simple"===
n.type&&await x(m,"default",[p.getColorFromSymbol(n.symbol,null)]);"defaultSymbol"in n&&n.defaultSymbol&&await x(m,"default",[p.getColorFromSymbol(n.defaultSymbol,null)]);m.forEach((k,a)=>{k=l.unique(k.filter(Boolean),(b,f)=>JSON.stringify(b)===JSON.stringify(f));m.set(a,k)});return m};c.setLabelsForClassBreaks=function(n){const m=n.classBreakInfos,e=n.normalizationType;let k=[];if(m?.length)if("standard-deviation"===n.classificationMethod)g.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks",
"cannot set labels for class breaks generated using 'standard-deviation' method.");else if(n.round){k.push(m[0].minValue);for(const a of m)k.push(a.maxValue);k=t.round(k);m.forEach((a,b)=>{a.label=u({minValue:0===b?k[0]:k[b],maxValue:k[b+1],isFirstBreak:0===b,normalizationType:e})})}else m.forEach((a,b)=>{a.label=u({minValue:a.minValue,maxValue:a.maxValue,isFirstBreak:0===b,normalizationType:e})})};c.timelineDateFormatOptions=q;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports",
"../../intl","../../intl/number"],function(c,l,g){function v(w,h){return w-h}function D(w,h){let x;x=Number(w.toFixed(h));x<w?w=x+1/10**h:(w=x,x-=1/10**h);x=Number(x.toFixed(h));w=Number(w.toFixed(h));return[x,w]}function J(w,h,x,C,u){w=F(w,h,x,C);h=null==w.next||w.next<=u;return(null==w.previous||w.previous<=u)&&h||w.previous+w.next<=2*u}function t(w){w=String(w);var h=w.match(M);if(h?.[1])return{integer:h[1].split("").length,fractional:h[3]?h[3].split("").length:0};if(w.toLowerCase().includes("e")&&
(h=w.split("e"),w=h[0],h=h[1],w&&h)){w=Number(w);h=Number(h);const x=0<h;x||(h=Math.abs(h));w=t(w);x?(w.integer+=h,w.fractional=h>w.fractional?0:w.fractional-h):(w.fractional+=h,w.integer=h>w.integer?1:w.integer-h);return w}return{integer:0,fractional:0}}function F(w,h,x,C){const u={previous:null,next:null};if(null!=x){const B=w-x;u.previous=Math.floor(Math.abs(100*(h-x-B)/B))}null!=C&&(w=C-w,u.next=Math.floor(Math.abs(100*(C-h-w)/w)));return u}const M=/^-?(\d+)(\.(\d+))?$/i,p={maximumFractionDigits:20};
c.format=function(w){return g.formatNumber(w,p)};c.numDigits=t;c.percentChange=F;c.round=function(w,h={}){w=w.slice();const {tolerance:x=2,strictBounds:C=!1,indexes:u=w.map((P,K)=>K)}=h;u.sort(v);for(h=0;h<u.length;h++){const P=u[h],K=w[P],q=0===P?null:w[P-1],n=P===w.length-1?null:w[P+1],m=t(K).fractional;if(m){let e=0,k=!1;for(var B=void 0;e<=m&&!k;)B=D(K,e),B=C&&0===h?B[1]:B[0],k=J(K,B,q,n,x),e++;k&&(w[P]=B)}}return w};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial ./typeUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h){function x(a){a=a.symbolLayers;if(!a)return null;let b=null;a.forEach(f=>{"object"===f.type&&f.resource?.href||(b="water"===f.type?f.color:f.material?f.material.color:null)});return b?new g(b):null}function C(a,b){if(null==b||null==a)return a;a=a.toRgba();a[3]*=b;return new g(a)}function u(a,b,f){if(a=a.symbolLayers){var z=I=>{b=b??I??(null!=f?k:null);return C(b,f)};a.forEach(I=>{if("object"!==I.type||!I.resource?.href||b)if("water"===I.type)I.color=z(I.color);else{const r=
z(null!=I.material?I.material.color:null);null==I.material?I.material=new w.Symbol3DMaterial({color:r}):I.material.color=r;null!=f&&"outline"in I&&null!=I.outline?.color&&(I.outline.color=C(I.outline.color,f))}})}}async function B(a,b){(a=a.symbolLayers)&&await v.forEach(a,async f=>P(f,b))}async function P(a,b){switch(a.type){case "extrude":a.size="number"===typeof b[2]?b[2]:0;break;case "icon":case "line":case "text":b=K(b);null!=b&&(a.size=b);break;case "path":const f=n(b,t.ONES,[a.width,void 0,
a.height]);a.width=e(b[0],a.width,1,f);a.height=e(b[2],a.height,1,f);break;case "object":await q(a,b)}}function K(a){for(const b of a)if("number"===typeof b)return b;return null}async function q(a,b){const {resourceSize:f,symbolSize:z}=await m(a),I=n(b,f,z);a.width=e(b[0],z[0],f[0],I);a.depth=e(b[1],z[1],f[1],I);a.height=e(b[2],z[2],f[2],I)}function n(a,b,f){for(let z=0;3>z;z++){const I=a[z];switch(I){case "symbol-value":return a=f[z],null!=a?a/b[z]:1;case "proportional":break;default:if(I&&b[z])return I/
b[z]}}return 1}async function m(a){var {computeObjectLayerResourceSize:b}=await new Promise((H,Q)=>c(["./symbolLayerUtils"],H,Q));b=await b(a,10);const {width:f,height:z,depth:I}=a;a=[f,I,z];let r=1;for(var y=0;3>y;y++){const H=a[y];if(null!=H){r=H/b[y];break}}for(y=0;3>y;y++)null==a[y]&&(a[y]=b[y]*r);return{resourceSize:b,symbolSize:a}}function e(a,b,f,z){switch(a){case "proportional":return f*z;case "symbol-value":return null!=b?b:f;default:return a}}const k=new g("white");l.applyColorToSymbol=
function(a,b,f){if(a&&(b||null!=f))if(b&&=new g(b),h.isSymbol3D(a))u(a,b,f);else if(h.isSymbol2D(a)){if(b=b??a.color)a.color=C(b,f);null!=f&&"outline"in a&&a.outline?.color&&(a.outline.color=C(a.outline.color,f))}};l.applyOpacityToColor=C;l.applyRotationToSymbol=function(a,b,f){a&&null!=b&&(h.isSymbol3D(a)?(a=a.symbolLayers)&&a.forEach(z=>{if("object"===z.type)switch(f){case "tilt":z.tilt=(z.tilt??0)+b;break;case "roll":z.roll=(z.roll??0)+b;break;default:z.heading=(z.heading??0)+b}"icon"===z.type&&
(z.angle+=b)}):!h.isSymbol2D(a)||"simple-marker"!==a.type&&"picture-marker"!==a.type&&"text"!==a.type||(a.angle+=b))};l.applySizesToSymbol=async function(a,b){if(a&&b){if(h.isSymbol3D(a))return B(a,b);if(h.isSymbol2D(a)&&(b=K(b),null!=b))switch(a.type){case "simple-marker":a.size=b;break;case "picture-marker":const f=a.width/a.height;1<f?(a.width=b,a.height=b*f):(a.width=b*f,a.height=b);break;case "simple-line":a.width=b;break;case "text":a.font.size=b}}};l.getCSSFilterFromEffectList=function(a){if(!a)return null;
a=a.effects.filter(b=>"bloom"!==b.type).map(b=>b.toJSON());return F.effectFunctionsFromJSON(a)};l.getColorFromSymbol=function(a,b){if(!a)return null;let f=null;h.isSymbol3D(a)?f=x(a):h.isSymbol2D(a)&&(f="cim"===a.type?M.getCIMSymbolColor(a):a.color?new g(a.color):null);return f?C(f,b):null};l.getIconHref=function(a){return a.resource?.href??""};l.getSymbolOutlineSize=function(a){return a?h.isSymbol3D(a)?(a=(a=a.symbolLayers?.at(-1))&&"outline"in a?a?.outline?.size:void 0,null!=a?a:0):J.px2pt(p.getStroke(a)?.width):
0};l.isVolumetricSymbol=function(a){if(null==a||!("symbolLayers"in a)||null==a.symbolLayers)return!1;switch(a.type){case "point-3d":return a.symbolLayers.some(b=>"object"===b.type);case "line-3d":return a.symbolLayers.some(b=>"path"===b.type);case "polygon-3d":return a.symbolLayers.some(b=>"object"===b.type||"extrude"===b.type);default:return!1}};l.symbolHasExtrudeSymbolLayer=function(a){return null!=a&&"polygon-3d"===a.type&&a.symbolLayers.some(b=>"extrude"===b.type)};Object.defineProperty(l,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(c,l,g){function v(h){h=g.toCIMSymbolJSON(h);if("CIMTextSymbol"===h?.type)return h.height??0;let x=0;if(h?.symbolLayers)for(const C of h.symbolLayers)g.isCIMMarker(C)&&null!=C.size&&C.size>x?x=C.size:g.isCIMStroke(C)&&null!=C.width&&C.width>x?x=C.width:g.isCIMFill(C);return x}function D(h,x,C,u){if(h)if("CIMTextSymbol"===h.type)null!=h.height&&(h.height*=x);else{if(C&&h.effects)for(const B of h.effects)F(B,
x);if(h.symbolLayers)for(const B of h.symbolLayers){switch(B.type){case "CIMPictureMarker":case "CIMVectorMarker":J(B,x,u);break;case "CIMPictureStroke":case "CIMSolidStroke":case "CIMGradientStroke":!u?.preserveOutlineWidth&&B.width&&(B.width*=x);break;case "CIMPictureFill":B.height&&(B.height*=x);B.offsetX&&(B.offsetX*=x);B.offsetY&&(B.offsetY*=x);break;case "CIMHatchFill":D(B.lineSymbol,x,!0,{...u,preserveOutlineWidth:!1}),B.offsetX&&(B.offsetX*=x),B.offsetY&&(B.offsetY*=x),B.separation&&(B.separation*=
x)}if(B.effects)for(const P of B.effects)F(P,x)}}}function J(h,x,C){if(h&&(h.markerPlacement&&t(h.markerPlacement,x),h.offsetX&&(h.offsetX*=x),h.offsetY&&(h.offsetY*=x),h.anchorPoint&&"Absolute"===h.anchorPointUnits&&(h.anchorPoint={x:h.anchorPoint.x*x,y:h.anchorPoint.y*x}),h.size=null!=h.size?h.size*x:0,"CIMVectorMarker"===h.type&&h.markerGraphics))for(const u of h.markerGraphics)h.scaleSymbolsProportionally||D(u.symbol,x,!0,C)}function t(h,x){g.isCIMMarkerStrokePlacement(h)&&h.offset&&(h.offset*=
x);switch(h.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":h.customEndingOffset&&(h.customEndingOffset*=x);h.offsetAlongLine&&(h.offsetAlongLine*=x);if(h.placementTemplate&&h.placementTemplate.length){var C=h.placementTemplate.map(u=>u*x);h.placementTemplate=C}break;case "CIMMarkerPlacementAlongLineVariableSize":h.maxRandomOffset&&(h.maxRandomOffset*=x);h.placementTemplate&&h.placementTemplate.length&&(C=h.placementTemplate.map(u=>u*x),h.placementTemplate=
C);break;case "CIMMarkerPlacementOnLine":h.startPointOffset&&(h.startPointOffset*=x);break;case "CIMMarkerPlacementAtExtremities":h.offsetAlongLine&&(h.offsetAlongLine*=x);break;case "CIMMarkerPlacementAtRatioPositions":h.beginPosition&&(h.beginPosition*=x);h.endPosition&&(h.endPosition*=x);break;case "CIMMarkerPlacementPolygonCenter":h.offsetX&&(h.offsetX*=x);h.offsetY&&(h.offsetY*=x);break;case "CIMMarkerPlacementInsidePolygon":h.offsetX&&(h.offsetX*=x),h.offsetY&&(h.offsetY*=x),h.stepX&&(h.stepX*=
x),h.stepY&&(h.stepY*=x)}}function F(h,x){switch(h.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":h.width&&(h.width*=x);break;case "CIMGeometricEffectBuffer":h.size&&(h.size*=x);break;case "CIMGeometricEffectCut":h.beginCut&&(h.beginCut*=x);h.endCut&&(h.endCut*=x);h.middleCut&&(h.middleCut*=x);break;case "CIMGeometricEffectDashes":h.customEndingOffset&&(h.customEndingOffset*=x);h.offsetAlongLine&&(h.offsetAlongLine*=x);if(h.dashTemplate&&h.dashTemplate.length){const C=h.dashTemplate.map(u=>
u*x);h.dashTemplate=C}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":h.length&&(h.length*=x);break;case "CIMGeometricEffectMove":h.offsetX&&(h.offsetX*=x);h.offsetY&&(h.offsetY*=x);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":h.offset&&(h.offset*=x);break;case "CIMGeometricEffectRegularPolygon":h.radius&&(h.radius*=x);break;case "CIMGeometricEffectTaperedPolygon":h.fromWidth&&(h.fromWidth*=x);h.length&&(h.length*=
x);h.toWidth&&(h.toWidth*=x);break;case "CIMGeometricEffectWave":h.amplitude&&(h.amplitude*=x),h.period&&(h.period*=x)}}function M(h,x){if(h){var C="CIMTextSymbol"===h.type?h.symbol:h;h="CIMPolygonSymbol"===h.type;if(C?.symbolLayers)for(const u of C.symbolLayers)if(!(u.colorLocked||h&&(g.isCIMStroke(u)||g.isCIMMarker(u)&&u.markerPlacement&&g.isCIMMarkerStrokePlacement(u.markerPlacement))))switch(u.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":u.tintColor&&p(x,u.tintColor);
break;case "CIMVectorMarker":u.markerGraphics?.forEach(B=>{M(B.symbol,x)});break;case "CIMSolidStroke":case "CIMSolidFill":p(x,u.color);break;case "CIMHatchFill":M(u.lineSymbol,x)}}}function p(h,x){for(const C of h)if(C.join(".")===x.join("."))return;h.push(x)}function w(h,x,C){if(h){var u="CIMTextSymbol"===h.type?h.symbol:h;h="CIMPolygonSymbol"===u?.type;if(u?.symbolLayers)for(const B of u.symbolLayers)if(!B.colorLocked){if(h)if(C){if({layersToColor:u}=C,(g.isCIMStroke(B)||g.isCIMMarker(B)&&B.markerPlacement&&
g.isCIMMarkerStrokePlacement(B.markerPlacement))&&"fill"===u||g.isCIMFill(B)&&"outline"===u)continue}else if(g.isCIMStroke(B)||g.isCIMMarker(B)&&B.markerPlacement&&g.isCIMMarkerStrokePlacement(B.markerPlacement))continue;u=x.toArray();switch(B.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":B.tintColor=u;break;case "CIMVectorMarker":B.markerGraphics?.forEach(P=>{w(P.symbol,x,C)});break;case "CIMSolidStroke":case "CIMSolidFill":B.color=u;break;case "CIMHatchFill":w(B.lineSymbol,
x,C)}}}}c.applyCIMSymbolColor=function(h,x,C){x instanceof l||(x=new l(x));(h=g.toCIMSymbolJSON(h))&&w(h,x,C)};c.applyCIMSymbolRotation=function(h,x,C=!1){h=g.toCIMSymbolJSON(h);C&&(x=360-x);if("CIMTextSymbol"===h?.type)h.angle=x;else if("CIMPointSymbol"===h?.type&&h.symbolLayers){C=x-(h.angle||0);for(const u of h.symbolLayers)if(g.isCIMMarker(u)){let B=u.rotation||0;B=u.rotateClockwise?B-C:B+C;u.rotation=B}h.angle=x}};c.getCIMSymbolColor=function(h){h=g.toCIMSymbolJSON(h);const x=[];M(h,x);return x.length?
new l(g.normalizeAlpha(x[0])):null};c.getCIMSymbolRotation=function(h,x=!1){h=g.toCIMSymbolJSON(h);return"CIMTextSymbol"===h?.type||"CIMPointSymbol"===h?.type?(h=h.angle,null!=h&&x?360-h:h??0):0};c.getCIMSymbolSize=v;c.getCIMSymbolType=function(h){h=g.toCIMSymbolJSON(h);if(!h)return null;switch(h.type){case "CIMPointSymbol":return"CIMPointSymbol";case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";
default:return null}};c.scaleCIMMarker=J;c.scaleCIMSymbol=D;c.scaleCIMSymbolTo=function(h,x,C){if(h){var u=g.toCIMSymbolJSON(h);h=v(h);if(0===h){if(u)if("CIMTextSymbol"===u.type)u.height=x;else if(u.symbolLayers)for(const B of u.symbolLayers)switch(B.type){case "CIMPictureMarker":case "CIMVectorMarker":B.size=x;break;case "CIMPictureStroke":case "CIMSolidStroke":case "CIMGradientStroke":B.width=x}}else D(u,x/h,!1,C)}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),
function(c,l,g,v,D,J,t){function F(x){if(!x)return null;let C=null;switch(x.type){case "simple-fill":case "picture-fill":case "simple-marker":C=F(x.outline);break;case "simple-line":const u=J.pt2px(x.width);null!=x.style&&"none"!==x.style&&0!==u&&(C={color:x.color,style:h(x.style),width:u,cap:x.cap,join:"miter"===x.join?J.pt2px(x.miterLimit):x.join},C.dashArray=M(C).join(",")||"none");break;default:C=null}return C}function M(x){if(!x?.style)return[];const {dashArray:C,style:u,width:B}=x;if("string"===
typeof C&&"none"!==C)return C.split(",").map(q=>Number(q));const P=B??0,K=p.has(u)?p.get(u).map(q=>q*P):[];if("butt"!==x.cap)for(const [q,n]of K.entries())K[q]=1===q%2?n+P:Math.max(n-P,1);return K}const p=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),w=new D.LRUCache(1E3),h=(()=>{const x={};return C=>
{if(x[C])return x[C];const u=C.replaceAll("-","");return x[C]=u}})();g=new g([128,128,128]);c.defaultThematicColor=g;c.dekebabifyLineStyle=h;c.getDashArray=M;c.getFill=function(x){const C=x.style;let u=null;if(x)switch(x.type){case "simple-marker":"cross"!==C&&"x"!==C&&(u=x.color);break;case "simple-fill":C&&"solid"!==C?"none"!==C&&(u={type:"pattern",x:0,y:0,src:l.getAssetUrl(`esri/symbols/patterns/${C}.png`),width:5,height:5}):u=x.color;break;case "picture-fill":u={type:"pattern",src:x.url,width:J.pt2px(x.width)*
x.xscale,height:J.pt2px(x.height)*x.yscale,x:J.pt2px(x.xoffset),y:J.pt2px(x.yoffset)};break;case "text":u=x.color;break;case "cim":u=t.getCIMSymbolColor(x)}return u};c.getPatternUrlWithColor=function(x,C){const u=x+"-"+C;return void 0!==w.get(u)?Promise.resolve(w.get(u)):v(x,{responseType:"image"}).then(B=>{B=B.data;const P=B.naturalWidth,K=B.naturalHeight,q=document.createElement("canvas");q.width=P;q.height=K;const n=q.getContext("2d");n.fillStyle=C;n.fillRect(0,0,P,K);n.globalCompositeOperation=
"destination-in";n.drawImage(B,0,0);B=q.toDataURL();w.put(u,B);return B})};c.getStroke=F;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(c,l,g,v){function D(p,w){const h=[],x=p.length-1;5===p.length?h.push(0,2,4):h.push(0,x);return p.map((C,u)=>h.includes(u)?v.createStopLabel(C,u,x,w):null)}async function J(p,w,h){h=new g(h??M);p=(await new Promise((x,C)=>c(["../../../renderers/visualVariables/support/visualVariableUtils"],
x,C))).getOpacity(w,p);null!=p&&(h.a=p);return h}function t(p,w){const {startIndex:h,endIndex:x,weight:C}=F(p,w);if(h===x)return w[h].color;p=g.blendColors(w[h].color,w[x].color,C);return new g(p)}function F(p,w){let h=0,x=w.length-1;w.some((C,u)=>{if(p<C.value)return x=u,!0;h=u;return!1});return{startIndex:h,endIndex:x,weight:(p-w[h].value)/(w[x].value-w[h].value)}}const M=new g([64,64,64]);l.getColorFromPointCloudStops=t;l.getRampStops=async function(p,w,h){let x=!1,C=[],u=[];if(p.stops){var B=
p.stops;C=B.map(K=>K.value);(x=B.some(K=>!!K.label))&&(u=B.map(K=>K.label))}B=C[C.length-1];if(null==C[0]&&null==B)return null;const P=x?null:D(C,h);return(await Promise.all(C.map(async(K,q)=>{const n="opacity"===p.type?await J(K,p,w):(await new Promise((m,e)=>c(["../../../renderers/visualVariables/support/visualVariableUtils"],m,e))).getColor(p,K);return{value:K,color:n,label:x?u[q]:P?.[q]??""}}))).reverse()};l.getRampStopsForPointCloud=function(p){let w=!1,h=[],x=[];h=p.map(B=>B.value);(w=p.some(B=>
!!B.label))&&(x=p.map(B=>B.label??""));const C=h[h.length-1];if(null==h[0]&&null==C)return null;const u=w?null:D(h);return h.map((B,P)=>{const K=t(B,p);return{value:B,color:K,label:w?x[P]:u?.[P]??""}}).reverse()};l.getStretchRampStops=function(p,w){let h=[];if(p&&"multipart"===p.type)p.colorRamps.reverse().forEach((x,C)=>{0===C?h.push({value:w.max,color:new g(x.toColor),label:"high"}):h.push({value:null,color:new g(x.toColor),label:""});C===p.colorRamps.length-1?h.push({value:w.min,color:new g(x.fromColor),
label:"low"}):h.push({value:null,color:new g(x.fromColor),label:""})});else{let x,C;p&&"algorithmic"===p.type?(x=p.fromColor,C=p.toColor):(x=[0,0,0,1],C=[255,255,255,1]);h=[{value:w.max,color:new g(C),label:"high"},{value:w.min,color:new g(x),label:"low"}]}return h};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../core/timeUtils ../../../layers/support/fieldUtils ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(c,l,g,v,D,J,t){async function F(w){if(!("visualVariables"in w&&w.visualVariables))return null;w=w.visualVariables.find(C=>"color"===C.type);if(!w)return null;var h=null,x=null;if(w.stops){if(1===w.stops.length)return w.stops[0].color;h=w.stops[0].value;x=w.stops[w.stops.length-1].value}h=null!=h&&null!=x?h+(x-h)/2:0;({getColor:x}=await new Promise((C,u)=>c(["../../../renderers/visualVariables/support/visualVariableUtils"],C,u)));return x(w,h)??null}function M(w,h){if(!h.field)return null;
if("featureReduction"in w)switch(w.featureReduction?.type){case "cluster":case "binning":const x=w.featureReduction.fields.find(({name:C})=>C.toLowerCase()===h.field.toLowerCase());return x&&"getField"in w?w.getField(x.onStatisticField):null}return"getField"in w?w.getField?.(h.field):null}function p(w,h){w="popupTemplate"in w?w.popupTemplate?.fieldInfos:null;if(w?.length&&h)return w.find(x=>x.fieldName?.toLowerCase()===h.toLowerCase())?.format?.dateFormat}l.createStopLabel=function(w,h,x,C){let u=
"";0===h?u="\x3c ":h===x&&(u="\x3e ");w=C?J.formatAnyDate(w,C):D.format(w);return u+w};l.getDateFormatOptions=function(w,h,x){const C=M(w,h);if(!C||!J.isAnyDateField(C)&&!v.isTimeOnlyField(C))return null;var u=p(w,C.name);if(!u&&"date"===C.type){let B=u=0;h.stops?(u=h.stops?.at(0)?.value??u,B=h.stops?.at(-1)?.value??B):"minDataValue"in h&&"maxDataValue"in h&&(u=h.minDataValue??u,B=h.maxDataValue??B);u=B-u>2*g.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:C.type,
format:u,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in w?w.preferredTimeZone:null,viewTimeZone:x,datesInUnknownTimezone:"datesInUnknownTimezone"in w&&w.datesInUnknownTimezone}}};l.getMedianColor=F;l.getReferenceSizeAuthoringInfoVisualVariable=function(w){if("authoringInfo"in w)return w.authoringInfo?.visualVariables?.find(({theme:h})=>"reference-size"===h)};l.getSymbolForFlowRenderer=async function(w,h){const x=w.trailCap,C=w.trailWidth||1;w=h||await F(w)||w.color;return new t({cap:x,color:w,
width:C})};l.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
l.specialCharsGreaterThan="\x3e";l.specialCharsLessThan="\x3c";Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],function(c,l){c.getHeatmapRampStops=function(g){if(!g.colorStops)return[];const v=[...g.colorStops].filter(J=>0<J.color?.a);let D=v.length-1;if(v[0]){const J=v[D];J&&1!==J.ratio&&(v.push(new l({ratio:1,color:J.color})),D++)}return v.map((J,t)=>{let F=
"";0===t?F=g.legendOptions?.minLabel||"low":t===D&&(F=g.legendOptions?.maxLabel||"high");return{color:J.color,label:F,ratio:J.ratio}}).reverse()};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureMedia/FeatureMediaViewModel":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/arrayUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/cast ../../../core/has ../../../core/accessorSupport/decorators/subclass ../../../popup/FieldInfo ../../../popup/content/support/ChartMediaInfoValueSeries ../support/featureUtils ../support/relatedFeatureUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w){const h={chartAnimation:!0};l=class extends l{constructor(x){super(x);this.abilities={...h};this.activeMediaInfoIndex=0;this.expressionAttributes=this.formattedAttributes=this.fieldInfoMap=this.description=this.attributes=null;this.isAggregate=!1;this.title=this.relatedInfos=this.popupTemplate=this.mediaInfos=this.layer=null}castAbilities(x){return{...h,...x}}get activeMediaInfo(){return this.formattedMediaInfos[this.activeMediaInfoIndex]||null}get formattedMediaInfos(){return this._formatMediaInfos()||
[]}get formattedMediaInfoCount(){return this.formattedMediaInfos.length}setActiveMedia(x){this._setContentElementMedia(x)}next(){this._pageContentElementMedia(1)}previous(){this._pageContentElementMedia(-1)}_setContentElementMedia(x){const {formattedMediaInfoCount:C}=this;this.activeMediaInfoIndex=(x+C)%C}_pageContentElementMedia(x){const {activeMediaInfoIndex:C}=this;this._setContentElementMedia(C+x)}_formatMediaInfos(){const {mediaInfos:x,layer:C}=this,u=this.attributes??{},B=this.formattedAttributes??
{},P=this.expressionAttributes??{},K=this.fieldInfoMap??new Map;return x?.map(q=>{q=q?.clone();if(!q)return null;q.title=p.substituteFieldsInLinksAndAttributes({attributes:u,fieldInfoMap:K,globalAttributes:B,expressionAttributes:P,layer:C,text:q.title});q.caption=p.substituteFieldsInLinksAndAttributes({attributes:u,fieldInfoMap:K,globalAttributes:B,expressionAttributes:P,layer:C,text:q.caption});q.altText=p.substituteFieldsInLinksAndAttributes({attributes:u,fieldInfoMap:K,globalAttributes:B,expressionAttributes:P,
layer:C,text:q.altText});if("image"===q.type){if(!q.value)return;this._setImageValue({value:q.value,formattedAttributes:B,layer:C});return q.value.sourceURL?q:void 0}if("pie-chart"===q.type||"line-chart"===q.type||"column-chart"===q.type||"bar-chart"===q.type){if(!q.value)return;this._setChartValue({value:q.value,chartType:q.type,attributes:u,formattedAttributes:B,layer:C,expressionAttributes:P});return q}return null}).filter(g.isSome)??[]}_setImageValue(x){const C=this.fieldInfoMap??new Map,{value:u,
formattedAttributes:B,layer:P}=x,{linkURL:K,sourceURL:q}=u;q&&(x=p.fixTokens(q,P),u.sourceURL=p.substituteAttributes({formattedAttributes:B,template:x,fieldInfoMap:C}));K&&(x=p.fixTokens(K,P),u.linkURL=p.substituteAttributes({formattedAttributes:B,template:x,fieldInfoMap:C}))}_setChartValue(x){const {value:C,attributes:u,formattedAttributes:B,chartType:P,layer:K,expressionAttributes:q}=x,{popupTemplate:n,relatedInfos:m}=this,{fields:e,normalizeField:k}=C;C.fields=p.getFixedFieldNames(e,K);k&&(C.normalizeField=
p.getFixedFieldName(k,K));if(e.some(b=>!!(null!=B[b]||p.isRelatedField(b)&&m?.size))){var a=n?.fieldInfos??[];e.forEach((b,f)=>{f=C.colors?.[f];p.isRelatedField(b)?C.series=[...C.series,...this._getRelatedChartInfos({fieldInfos:a,fieldName:b,formattedAttributes:B,chartType:P,value:C,color:f})]:(b=this._getChartOption({value:C,attributes:u,chartType:P,formattedAttributes:B,expressionAttributes:q,fieldName:b,fieldInfos:a,color:f}),C.series.push(b))})}}_getRelatedChartInfos(x){const {fieldInfos:C,fieldName:u,
formattedAttributes:B,chartType:P,value:K,color:q}=x,n=[],m=w.getRelatedFieldInfo(u);x=m&&this.relatedInfos?.get(m.layerId.toString());if(!x)return n;const {relatedFeatures:e,relation:k}=x;if(!k||!e)return n;({cardinality:x}=k);e.forEach(a=>{const {attributes:b}=a;b&&Object.keys(b).forEach(f=>{f===m.fieldName&&n.push(this._getChartOption({value:K,attributes:b,formattedAttributes:B,fieldName:u,chartType:P,relatedFieldName:f,hasMultipleRelatedFeatures:1<e?.length,fieldInfos:C,color:q}))})});return"one-to-many"===
x||"many-to-many"===x?n:[n[0]]}_getTooltip({label:x,value:C,chartType:u}){return"pie-chart"===u?`${x}`:`${x}: ${C}`}_getChartOption(x){const {value:C,attributes:u,formattedAttributes:B,expressionAttributes:P,fieldName:K,relatedFieldName:q,fieldInfos:n,chartType:m,hasMultipleRelatedFeatures:e,color:k}=x;var a=this.layer,b=this.fieldInfoMap??new Map;const {normalizeField:f,tooltipField:z}=C;x=f?p.isRelatedField(f)?u[w.getRelatedFieldInfo(f).fieldName]:u[f]:null;var I=p.isExpressionField(K)&&P&&void 0!==
P[K]?P[K]:q&&void 0!==u[q]?u[q]:void 0!==u[K]?u[K]:B[K];x=new M({fieldName:K,color:k,value:void 0===I?null:I&&x?I/x:I});if(p.isRelatedField(K))return a=b.get(K.toLowerCase()),I=z&&b.get(z.toLowerCase()),b=a?.fieldName??K,I=e&&z?w.getRelatedFieldInfo(z).fieldName:I?.fieldName??z,x.tooltip=this._getTooltip({label:e&&I?u[I]:B[I]??a?.label??a?.fieldName??q,value:e&&q?u[q]:B[b],chartType:m}),x;b=p.getFieldInfo(n,K);a=p.getFixedFieldName(K,a);b=z&&void 0!==B[z]?B[z]:p.getFieldInfoLabel(b||new F({fieldName:a}),
this.popupTemplate?.expressionInfos);x.tooltip=this._getTooltip({label:b,value:B[a],chartType:m});return x}};c.__decorate([v.property()],l.prototype,"abilities",void 0);c.__decorate([D.cast("abilities")],l.prototype,"castAbilities",null);c.__decorate([v.property()],l.prototype,"activeMediaInfoIndex",void 0);c.__decorate([v.property({readOnly:!0})],l.prototype,"activeMediaInfo",null);c.__decorate([v.property()],l.prototype,"attributes",void 0);c.__decorate([v.property()],l.prototype,"description",
void 0);c.__decorate([v.property()],l.prototype,"fieldInfoMap",void 0);c.__decorate([v.property()],l.prototype,"formattedAttributes",void 0);c.__decorate([v.property()],l.prototype,"expressionAttributes",void 0);c.__decorate([v.property({readOnly:!0})],l.prototype,"formattedMediaInfos",null);c.__decorate([v.property()],l.prototype,"isAggregate",void 0);c.__decorate([v.property()],l.prototype,"layer",void 0);c.__decorate([v.property({readOnly:!0})],l.prototype,"formattedMediaInfoCount",null);c.__decorate([v.property()],
l.prototype,"mediaInfos",void 0);c.__decorate([v.property()],l.prototype,"popupTemplate",void 0);c.__decorate([v.property()],l.prototype,"relatedInfos",void 0);c.__decorate([v.property()],l.prototype,"title",void 0);return l=c.__decorate([t.subclass("esri.widgets.Feature.FeatureMedia.FeatureMediaViewModel")],l)})},"esri/widgets/Feature/support/relatedFeatureUtils":function(){define("exports ../../../request ../../../core/arrayUtils ../../../core/Error ../../../core/Logger ../../../core/promiseUtils ../../../layers/support/fieldUtils ../../../rest/query/executeQueryJSON ../../../rest/support/Query ../../../rest/support/RelationshipQuery ../../../rest/support/StatisticDefinition ./featureUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h){function x(k,a){if(!a.relationships)return null;let b=null;({relationships:a}=a);a.some(f=>f.id===parseInt(k,10)?(b=f,!0):!1);return b}function C({originRelationship:k,relationships:a,layerId:b}){return a.find(({relatedTableId:f,id:z})=>`${f}`===b&&z===k?.id)??null}function u(k,a){a=a.toLowerCase();for(const b in k)if(b.toLowerCase()===a)return k[b];return null}function B(k,a,b,f){const z=new p;z.outFields=["*"];z.relationshipId="number"===typeof a.id?a.id:parseInt(a.id,
10);z.objectIds=[k.attributes[b.objectIdField]];z.gdbVersion=b.gdbVersion??null;z.historicMoment=b.historicMoment??null;return b.queryRelatedFeatures?.(z,f)??Promise.resolve({})}function P(k,a,b){let f=0;const z=[];for(;f<a.length;)z.push(`${k} IN (${a.slice(f,b+f)})`),f+=b;return z.join(" OR ")}function K(k){return k?g.unique(k):void 0}function q(k){return k?g.unique(k,(a,b)=>JSON.stringify(a.toJSON())===JSON.stringify(b.toJSON())):void 0}async function n(k,a,b,f){var z=b.layerId.toString();const {layerInfo:I,
relation:r,relatedFields:y,outStatistics:H,url:Q,sourceSpatialReference:A}=a;a=K(y);const N=q(H);if(!I||!r)return null;const G=C({originRelationship:r,relationships:I.relationships,layerId:z});if(G?.relationshipTableId&&G.keyFieldInRelationshipTable){z=(await B(k,G,b,f))[k.attributes[b.objectIdField]];if(!z)return null;var d=z.features.map(E=>E.attributes[I.objectIdField]);if(N?.length&&I.supportsStatistics)return f=new M,f.where=P(I.objectIdField,d,1E3),f.outFields=a,f.outStatistics=N,f.sourceSpatialReference=
A,f={features:Promise.resolve(z),statsFeatures:F.executeQueryJSON(Q,f)},J.eachAlways(f)}return(z=G?.keyField)?(d=t.isNumericField(m(I.fields,z)),k=u(k.attributes,r.keyField),k=d?`${z}=${k}`:`${z}='${k}'`,b=F.executeQueryJSON(Q,new M({where:k,outFields:a,sourceSpatialReference:A,historicMoment:b.historicMoment,gdbVersion:b.gdbVersion}),f),f=N?.length&&I.supportsStatistics?F.executeQueryJSON(Q,new M({where:k,outFields:a,outStatistics:N,sourceSpatialReference:A}),f):null,a={features:b},f&&(a.statsFeatures=
f),J.eachAlways(a)):null}function m(k,a){if(null!=k){a=a.toLowerCase();for(const b of k)if(b&&b.name.toLowerCase()===a)return b}return null}const e=new Map;c.createRelatedInfo=function(k,a){if(k=x(k,a))return{url:`${a.url}/${k.relatedTableId}`,sourceSpatialReference:a.spatialReference,relation:k,relatedFields:[],outStatistics:[]}};c.getDestinationRelation=C;c.getRelatedFieldInfo=function(k){if(!h.isRelatedField(k))return null;const [a,b]=k.split("/").slice(1);return{layerId:a,fieldName:b}};c.getUniqueOutFields=
K;c.getUniqueOutStatistics=q;c.queryLayerInfos=function({relatedInfos:k,layer:a},b){const f={};k.forEach((z,I)=>{({relation:z}=z);if(!z)throw I=new v("relation-required","A relation is required on a layer to retrieve related records."),D.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(I),I;({relatedTableId:z}=z);if("number"!==typeof z)throw I=new v("A related table ID is required on a layer to retrieve related records."),D.getLogger("esri.widgets.Feature.support.relatedFeatureUtils").error(I),
I;z=`${a.url}/${z}`;const r=e.get(z),y=r??l(z,{query:{f:"json"},signal:(void 0)?.signal});r||e.set(z,y);f[I]=y});return J.whenOrAbort(J.eachAlways(f),b)};c.queryRelatedFeatures=function({graphic:k,relatedInfos:a,layer:b},f){const z={};a.forEach((I,r)=>{I.layerInfo&&(z[r]=n(k,I,b,f))});return J.eachAlways(z)};c.setRelatedFeatures=function(k,a){if(a&&k){var {features:b,statsFeatures:f}=k;k=b?.value;a.relatedFeatures=k?k.features:[];k=f?.value;a.relatedStatsFeatures=k?k.features:[]}};c.updateRelatedInfo=
function({relatedInfo:k,fieldName:a,fieldInfo:b}){k.relatedFields?.push(a);b.statisticType&&(a=new w({statisticType:b.statisticType,onStatisticField:a,outStatisticFieldName:a}),k.outStatistics?.push(a))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureExpression/FeatureExpressionViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/asyncUtils ../../../core/maybe ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/throttle ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/Point ../../../popup/content/AttachmentsContent ../../../popup/content/Content ../../../popup/content/CustomContent ../../../popup/content/ExpressionContent ../../../popup/content/FieldsContent ../../../popup/content/MediaContent ../../../popup/content/RelationshipContent ../../../popup/content/TextContent ../../../popup/content/UtilityNetworkAssociationsContent ../../../popup/ElementExpressionInfo ../FeatureContent/FeatureContentViewModel ../FeatureFields/FeatureFieldsViewModel ../FeatureMedia/FeatureMediaViewModel ../support/arcadeFeatureUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e,k,a,b,f,z,I){g=class extends g{constructor(r){super(r);this.view=this.location=this.interceptor=this.contentElementViewModel=this.graphic=this.expressionInfo=this._evaluateTask=this._compileTask=null;this._createVM=()=>{var y=this.contentElement?.type;this.contentElementViewModel?.destroy();y="fields"===y?new f:"media"===y?new z:"text"===y?new b:null;this._set("contentElementViewModel",y)};this._compileThrottled=F.throttle(this._startCompile,()=>
this.notifyChange("state"),1,this);this._evaluateThrottled=F.throttle(this._startEvaluate,()=>this.notifyChange("state"),1,this);this.addHandles([t.watch(()=>[this.expressionInfo,this.graphic],()=>this._compileThrottled(),t.initial),t.watch(()=>[this.contentElement],()=>this._createVM(),t.initial),t.when(()=>{if(!this._compileTask?.finished)return null;const y=this._compileTask.value,H=y?.dependencies;return[y,this.spatialReference,this.map,this.view,H?.has("view-scale")?this.view?.scale:null,H?.has("view-time-extent")?
this.view?.timeExtent?.start:null,H?.has("view-time-extent")?this.view?.timeExtent?.end:null]},([y])=>this._evaluateThrottled(y))])}initialize(){this.addHandles([this._compileThrottled,this._evaluateThrottled])}destroy(){this._compileTask=D.abortMaybe(this._compileTask);this._evaluateTask=D.abortMaybe(this._evaluateTask);this.contentElementViewModel?.destroy();this._set("contentElementViewModel",null)}get contentElement(){return this._evaluateTask?.value}get spatialReference(){return this.view?.spatialReference??
null}set spatialReference(r){this._override("spatialReference",r)}get state(){const {contentElement:r,contentElementViewModel:y}=this;return this._compileThrottled.hasPendingUpdates()||this._evaluateThrottled.hasPendingUpdates()||!this._compileTask?.finished||!this._evaluateTask?.finished?"loading":r||y?"ready":"disabled"}get map(){return this.view?.map??null}set map(r){this._override("map",r)}_startCompile(){this._evaluateTask=D.abortMaybe(this._evaluateTask);this._compileTask=D.abortMaybe(this._compileTask);
this._compileTask=v.createTask(async r=>{const {expressionInfo:y,graphic:H}=this;if(!y||!H)return null;var Q=await I.loadArcade();J.throwIfAborted(r);Q=await I.compileExpression({expressionInfo:y,arcade:Q,graphic:H});J.throwIfAborted(r);return Q})}_startEvaluate(r){this._evaluateTask=D.abortMaybe(this._evaluateTask);this._evaluateTask=v.createTask(async y=>{var {graphic:H}=this;if(!r||!H)return null;const {interceptor:Q,spatialReference:A,map:N,location:G,view:d}=this;H=await r.evaluate({graphic:H,
interceptor:Q,location:G,map:N,options:{signal:y},spatialReference:A,view:d});J.throwIfAborted(y);if(!H||"esri.arcade.Dictionary"!==H.declaredClass)return null;H=await H.castAsJsonAsync(y);J.throwIfAborted(y);y=H?.type;y="media"===y?n.fromJSON(H):"text"===y?e.fromJSON(H):"fields"===y?q.fromJSON(H):null;return"media"===y.type&&!y.mediaInfos||"fields"===y.type&&!y.fieldInfos||"text"===y.type&&!y.text?null:y})}};c.__decorate([M.property()],g.prototype,"_compileTask",void 0);c.__decorate([M.property()],
g.prototype,"_evaluateTask",void 0);c.__decorate([M.property({type:a})],g.prototype,"expressionInfo",void 0);c.__decorate([M.property({type:l})],g.prototype,"graphic",void 0);c.__decorate([M.property({readOnly:!0})],g.prototype,"contentElement",null);c.__decorate([M.property({readOnly:!0})],g.prototype,"contentElementViewModel",void 0);c.__decorate([M.property()],g.prototype,"interceptor",void 0);c.__decorate([M.property({type:C})],g.prototype,"location",void 0);c.__decorate([M.property()],g.prototype,
"spatialReference",null);c.__decorate([M.property({readOnly:!0})],g.prototype,"state",null);c.__decorate([M.property()],g.prototype,"map",null);c.__decorate([M.property()],g.prototype,"view",void 0);return g=c.__decorate([x.subclass("esri.widgets.Feature.FeatureExpression.FeatureExpressionViewModel")],g)})},"esri/widgets/Feature/support/arcadeFeatureUtils":function(){define("require exports ../../../arcade/featureset/support/shared ../../../core/Logger ../../../layers/FeatureLayer ./featureUtils ../../support/globalCss".split(" "),
function(c,l,g,v,D,J,t){function F(q){return`<ul class="esri-widget__list">${q.map(n=>`<li>${"string"===typeof n?J.applyTextFormattingHTML(J.htmlEntities(n)):n}</li>`).join("")}</ul>`}function M(q){const n=q.keys().map(m=>{var e=q.field(m);e="string"===typeof e?J.applyTextFormattingHTML(J.htmlEntities(e)):e;return`<tr><th>${m}</th><td>${e}</td></tr>`}).join("");return`<table class="${t.globalCss.table}">${n}</table>`}async function p(){const [q,n]=await Promise.all([new Promise((m,e)=>c(["../../../arcade"],
m,e)),new Promise((m,e)=>c(["../../../arcade/arcade"],m,e))]);return{executor:q,syntaxUtils:n}}async function w({graphic:q,view:n,options:m}){const {isAggregate:e,layer:k}=q;if(!e||!k||"2d"!==n?.type)return[];n=await n.whenLayerView(k);if(!("createQuery"in n&&"queryFeatures"in n))return[];const a=n.createQuery();q=q.getObjectId();a.aggregateIds=null!=q?[q]:[];({features:m}=await n.queryFeatures(a,m));return m}function h({layer:q,aggregatedFeatures:n,interceptor:m}){const {fields:e,objectIdField:k,
geometryType:a,spatialReference:b,displayField:f}=q;return new D({fields:e,objectIdField:k,geometryType:a,spatialReference:b,displayField:f,interceptor:m,...("feature"===q.type?{templates:q.templates,typeIdField:q.typeIdField,types:q.types}:null),source:n})}function x(q){const n="esri.views.3d.layers.VoxelGraphic"===q.declaredClass;return q.isAggregate?"popup-feature-reduction":n?"popup-voxel":"popup"}function C(q){return{scale:q?.scale,timeProperties:{currentStart:q?.timeExtent?.start,currentEnd:q?.timeExtent?.end,
startIncluded:!0,endIncluded:!0}}}async function u(q,n,m,e,k){let a=null;k.has("$aggregatedfeatures")&&(m=await w({graphic:q,view:n,options:m}),a=h({layer:q.sourceLayer||q.layer,aggregatedFeatures:m,interceptor:e}));return{vars:{$feature:q,$aggregatedFeatures:a,$view:C(n)},[Symbol.dispose]:()=>a?.[Symbol.dispose]()}}function B(q,n,m,e){const k=(q.sourceLayer||q.layer)??void 0;return{$feature:q,$layer:null!=k&&g.isSupportedLayer(k)?k:"scene"===k?.type&&null!=k.associatedLayer?k.associatedLayer:void 0,
$map:n,$datastore:k?.url,$userInput:m,$graph:"knowledge-graph-sublayer"===k?.type?k?.parentCompositeLayer?.knowledgeGraph:void 0,$view:C(e)}}async function P(q,{graphic:n,map:m,location:e,view:k,options:a,interceptor:b,arcadeExecutor:f}){switch(q){case "popup":return{vars:B(n,m,e,k),[Symbol.dispose](){}};case "popup-feature-reduction":return q=new Set(f.variablesUsed),await u(n,k,a,b,q);case "popup-voxel":return{vars:{$voxel:n},[Symbol.dispose](){}};default:throw Error(`Unexpected profile name ${q}`);
}}async function K({expressionInfo:q,arcade:{executor:n,syntaxUtils:m},graphic:e}){const k=q?.expression;if(!k)return null;const a=x(e);e=n.createArcadeProfile(a);let b;try{b=await n.createArcadeExecutor(k,e)}catch(f){return v.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-executor-error",{error:f,expressionInfo:q}),null}n=new Set;b.variablesUsed.includes("$view")&&(m.scriptUsesViewProperties(b.syntaxTree,["scale"])&&n.add("view-scale"),m.scriptUsesViewProperties(b.syntaxTree,
["timeProperties"])&&n.add("view-time-extent"));return{dependencies:n,async evaluate({graphic:f,interceptor:z,location:I,map:r,options:y,spatialReference:H,view:Q}){I=await P(a,{graphic:f,map:r,location:I,view:Q,options:y,interceptor:z,arcadeExecutor:b});z={abortSignal:y?.signal??void 0,interceptor:z??void 0,rawOutput:!0,spatialReference:H??void 0,timeZone:Q?.timeZone,console(...A){v.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").info(...A)}};try{return await b.executeAsync(I.vars,z)}catch(A){v.getLogger("esri.widgets.Feature.support.arcadeFeatureUtils").error("arcade-execution-error",
{error:A,graphic:f,expressionInfo:q})}finally{I[Symbol.dispose]()}}}}l.compileExpression=K;l.compileExpressionInfos=async function(q,n){if(!q?.length)return{dependencies:new Set,expressions:new Map};const m=await p(),e=new Set,k=new Map;for(const a of q)q=await K({expressionInfo:a,arcade:m,graphic:n}),k.set(`expression/${a.name}`,q),q?.dependencies.forEach(b=>e.add(b));return{dependencies:e,expressions:k}};l.formatArcadeValue=function(q){return"string"===typeof q?J.applyTextFormattingHTML(J.htmlEntities(q)):
Array.isArray(q)?F(q):"esri.arcade.Dictionary"===q?.declaredClass?M(q):q};l.loadArcade=p;Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/featureset/support/shared":function(){define("exports ../../ArcadeDate ../../../core/sql/DateOnly ../../../core/sql/TimeOnly ../../../layers/support/Field ../../../chunks/datetime".split(" "),function(c,l,g,v,D,J){function t(p){return p instanceof Date}function F(p){return p instanceof l.ArcadeDate}function M(p){switch(p.type){case "catalog":case "csv":case "feature":case "geojson":case "knowledge-graph-sublayer":case "oriented-imagery":case "subtype-group":case "wfs":return!0;
default:return!1}}c.FeatureServiceDatabaseType=void 0;(function(p){p[p.Standardised=0]="Standardised";p[p.StandardisedNoInterval=1]="StandardisedNoInterval";p[p.SqlServer=2]="SqlServer";p[p.Oracle=3]="Oracle";p[p.Postgres=4]="Postgres";p[p.PGDB=5]="PGDB";p[p.FILEGDB=6]="FILEGDB";p[p.NotEvaluated=7]="NotEvaluated"})(c.FeatureServiceDatabaseType||(c.FeatureServiceDatabaseType={}));c.IdState=void 0;(function(p){p[p.InFeatureSet=0]="InFeatureSet";p[p.NotInFeatureSet=1]="NotInFeatureSet";p[p.Unknown=2]=
"Unknown"})(c.IdState||(c.IdState={}));c.callback=function(p,w){return function(){try{p.apply(null,arguments)}catch(h){w.reject(h)}}};c.cloneAttributes=function(p){const w={};for(const h in p)w[h]=p[h];return w};c.cloneField=function(p){return D.fromJSON(p.toJSON())};c.defaultMaxRecords=1E3;c.equalityTest=function(p,w){return p===w?!0:(t(p)||F(p))&&(t(w)||F(w))?p.getTime()===w.getTime():!1};c.errback=function(p){return function(w){p.reject(w)}};c.esriFieldToJson=function(p){return p.toJSON?p.toJSON():
p};c.extractServiceUrl=function(p){if(void 0===p)return"";p=p.replace(/\/featureserver\/[0-9]*/i,"/FeatureServer");p=p.replace(/\/mapserver\/[0-9]*/i,"/MapServer");return p=p.split("?")[0]};c.isArcadeDate=F;c.isArcadeDateOnly=function(p){return p instanceof g.DateOnly};c.isArcadeTime=function(p){return p instanceof v.TimeOnly};c.isArray=function(p){return Array.isArray(p)};c.isBoolean=function(p){return"boolean"===typeof p};c.isDate=t;c.isLuxonDate=function(p){return p instanceof J.DateTime};c.isNumber=
function(p){return"number"===typeof p};c.isString=function(p){return"string"===typeof p||p instanceof String};c.isSupportedLayer=function(p){switch(p.type){case "catalog-footprint":case "subtype-sublayer":return!0;default:return M(p)}};c.isSupportedSourceLayer=M;c.layerFieldEsriConstants={"small-integer":"esriFieldTypeSmallInteger",integer:"esriFieldTypeInteger",long:"esriFieldTypeLong",single:"esriFieldTypeSingle",double:"esriFieldTypeDouble",string:"esriFieldTypeString",date:"esriFieldTypeDate",
"date-only":"esriFieldTypeDateOnly","time-only":"esriFieldTypeTimeOnly","timestamp-offset":"esriFieldTypeTimestampOffset",oid:"esriFieldTypeOID",geometry:"esriFieldTypeGeometry",blob:"esriFieldTypeBlob",raster:"esriFieldTypeRaster",guid:"esriFieldTypeGUID","global-id":"esriFieldTypeGlobalID",xml:"esriFieldTypeXML","big-integer":"esriFieldTypeBigInteger",esriFieldTypeSmallInteger:"esriFieldTypeSmallInteger",esriFieldTypeInteger:"esriFieldTypeInteger",esriFieldTypeLong:"esriFieldTypeLong",esriFieldTypeSingle:"esriFieldTypeSingle",
esriFieldTypeDouble:"esriFieldTypeDouble",esriFieldTypeString:"esriFieldTypeString",esriFieldTypeDate:"esriFieldTypeDate",esriFieldTypeDateOnly:"esriFieldTypeDateOnly",esriFieldTypeTimeOnly:"esriFieldTypeTimeOnly",esriFieldTypeTimestampOffset:"esriFieldTypeTimestampOffset",esriFieldTypeOID:"esriFieldTypeOID",esriFieldTypeGeometry:"esriFieldTypeGeometry",esriFieldTypeBlob:"esriFieldTypeBlob",esriFieldTypeRaster:"esriFieldTypeRaster",esriFieldTypeGUID:"esriFieldTypeGUID",esriFieldTypeGlobalID:"esriFieldTypeGlobalID",
esriFieldTypeXML:"esriFieldTypeXML",esriFieldTypeBigInteger:"esriFieldTypeBigInteger"};c.layerGeometryEsriConstants={point:"point",polygon:"polygon",polyline:"polyline",multipoint:"multipoint",extent:"extent",esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint",esriGeometryEnvelope:"extent",envelope:"extent"};c.layerGeometryEsriRestConstants={point:"esriGeometryPoint",polygon:"esriGeometryPolygon",polyline:"esriGeometryPolyline",
multipoint:"esriGeometryMultipoint",extent:"esriGeometryEnvelope",esriGeometryPoint:"esriGeometryPoint",esriGeometryPolygon:"esriGeometryPolygon",esriGeometryPolyline:"esriGeometryPolyline",esriGeometryMultipoint:"esriGeometryMultipoint",esriGeometryEnvelope:"esriGeometryEnvelope",envelope:"esriGeometryEnvelope"};c.sameGeomType=function(p,w){return p===w||"point"===p&&"esriGeometryPoint"===w||"polyline"===p&&"esriGeometryPolyline"===w||"polygon"===p&&"esriGeometryPolygon"===w||"extent"===p&&"esriGeometryEnvelope"===
w||"multipoint"===p&&"esriGeometryMultipoint"===w||"point"===w&&"esriGeometryPoint"===p||"polyline"===w&&"esriGeometryPolyline"===p||"polygon"===w&&"esriGeometryPolygon"===p||"extent"===w&&"esriGeometryEnvelope"===p||"multipoint"===w&&"esriGeometryMultipoint"===p?!0:!1};c.stableStringify=function(p,w){w||={};"function"===typeof w&&(w={cmp:w});const h="boolean"===typeof w.cycles?w.cycles:!1,x=w.cmp&&function(u){return function(B){return function(P,K){return u({key:P,value:B[P]},{key:K,value:B[K]})}}}(w.cmp),
C=[];return function P(B){B?.toJSON&&"function"===typeof B.toJSON&&(B=B.toJSON());if(void 0!==B){if("number"===typeof B)return isFinite(B)?""+B:"null";if("object"!==typeof B)return JSON.stringify(B);var K;if(Array.isArray(B)){var q="[";for(K=0;K<B.length;K++)K&&(q+=","),q+=P(B[K])||"null";return q+"]"}if(null===B)return"null";if(C.includes(B)){if(h)return JSON.stringify("__cycle__");throw new TypeError("Converting circular structure to JSON");}var n=C.push(B)-1,m=Object.keys(B).sort(x?.(B));q="";
for(K=0;K<m.length;K++){const e=m[K],k=P(B[e]);k&&(q&&(q+=","),q+=JSON.stringify(e)+":"+k)}C.splice(n,1);return"{"+q+"}"}}(p)};c.toEsriGeometryType=function(p){switch(p){case "point":return"esriGeometryPoint";case "polygon":return"esriGeometryPolygon";case "multipoint":return"esriGeometryMultipoint";case "polyline":return"esriGeometryPolyline";default:return"esriGeometryPoint"}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/DateOnly":function(){define(["exports","../../arcade/ArcadeDate",
"../../intl/locale","../../chunks/datetime"],function(c,l,g,v){function D(t){t=t.replaceAll(/LTS|LT|L{1,4}|l{1,4}/g,"[$\x26]");let F="";const M=/(\[[^[]*\])|(\\)?([Hh]mm(ss)?|Mo|M{1,4}|Do|DDDo|D{1,4}|d{2,4}|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g;for(const p of t.match(M)||[])switch(p){case "D":F+="d";break;case "DD":F+="dd";break;case "DDD":F+="o";break;case "d":F+="c";break;case "ddd":F+="ccc";break;case "dddd":F+=
"cccc";break;case "M":F+="L";break;case "MM":F+="LL";break;case "MMM":F+="LLL";break;case "MMMM":F+="LLLL";break;case "YY":F+="yy";break;case "Y":case "YYYY":F+="yyyy";break;case "Q":F+="q";break;case "X":case "x":F+=p;break;default:F=2<=p.length&&"["===p.slice(0,1)&&"]"===p.slice(-1)?F+`'${p.slice(1,-1)}'`:F+`'${p}'`}return F}class J{constructor(t,F,M){this._year=t;this._month=F;this._day=M;this.declaredRootClass="esri.core.sql.dateonly"}static isDateOnly(t){return"object"===typeof t&&null!=t&&"declaredRootClass"in
t&&"esri.core.sql.dateonly"===t.declaredRootClass}get month(){return this._month}get monthJS(){return this._month-1}get year(){return this._year}get day(){return this._day}get isValid(){return this.toDateTime("unknown").isValid}equals(t){return J.isDateOnly(t)&&t.day===this.day&&t.month===this.month&&t.year===this.year}clone(){return new J(this._year,this._month,this._day)}toDateTime(t){return v.DateTime.fromObject({day:this.day,month:this.month,year:this.year},{zone:l.createDateTimeZone(t)})}toDateTimeLuxon(t){return v.DateTime.fromObject({day:this.day,
month:this.month,year:this.year},{zone:l.createDateTimeZone(t)})}toString(){return`${this.year.toString().padStart(4,"0")}-${this.month.toString().padStart(2,"0")}-${this.day.toString().padStart(2,"0")}`}toFormat(t=null,F=!0){if(null===t||""===t)return this.toString();F&&(t=D(t));if(!t)return"";F=this.toDateTime("unknown");return l.ArcadeDate.dateTimeToArcadeDate(F).toFormat(t,{locale:g.getLocale(),numberingSystem:"latn"})}toArcadeDate(){const t=this.toDateTime("unknown");return l.ArcadeDate.dateTimeToArcadeDate(t)}toNumber(){return this.toDateTime("unknown").toMillis()}toJSDate(){return this.toDateTime("unknown").toJSDate()}toStorageFormat(){return this.toFormat("yyyy-LL-dd",
!1)}toSQLValue(){return this.toFormat("yyyy-LL-dd",!1)}toSQLWithKeyword(){return"date '"+this.toFormat("yyyy-LL-dd",!1)+"'"}plus(t,F){return J.fromDateTime(this.toUTCDateTime().plus({[t]:F}))}toUTCDateTime(){return v.DateTime.utc(this.year,this.month,this.day,0,0,0,0)}difference(t,F){switch(F.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(t.toUTCDateTime(),"days").days;case "months":case "month":return this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===
F?this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(t.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(t.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds;case "hours":case "hour":case "h":return this.toUTCDateTime().diff(t.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(t.toUTCDateTime(),
"years").years;default:return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds}}static fromMilliseconds(t){t=v.DateTime.fromMillis(t,{zone:v.FixedOffsetZone.utcInstance});return t.isValid?J.fromParts(t.year,t.month,t.day):null}static fromSeconds(t){t=v.DateTime.fromSeconds(t,{zone:v.FixedOffsetZone.utcInstance});return t.isValid?J.fromParts(t.year,t.month,t.day):null}static fromReader(t){if(!t)return null;t=t.split("-");return 3!==t.length?null:new J(parseInt(t[0],10),parseInt(t[1],
10),parseInt(t[2],10))}static fromParts(t,F,M){t=new J(t,F,M);return!1===t.isValid?null:t}static fromDateJS(t){return J.fromParts(t.getFullYear(),t.getMonth()+1,t.getDay())}static fromDateTime(t){return J.fromParts(t.year,t.month,t.day)}static fromSqlTimeStampOffset(t){return this.fromDateTime(t.toDateTime())}static fromString(t,F=null){if(""===t||null===t)return null;var M=[];if(F)(F=D(F))&&M.push(F);else if(null===F||""===F)return t=v.DateTime.fromISO(t,{setZone:!0}),t.isValid?J.fromParts(t.year,
t.month,t.day):null;for(const p of M)if(M=v.DateTime.fromFormat(t,F??p),M.isValid)return new J(M.year,M.month,M.day);return null}static fromNow(t="system"){t=v.DateTime.fromJSDate(new Date).setZone(l.createDateTimeZone(t));return new J(t.year,t.month,t.day)}}c.DateOnly=J;c.standardizeDateOnlyFormat=D;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/sql/TimeOnly":function(){define(["exports","../../arcade/kernel","../../intl/locale","../../chunks/datetime"],function(c,l,g,
v){function D(t){if(!t)return"";const F=/(a|A|hh?|HH?|mm?|ss?|SSS|S|.)/g;let M="";for(const p of t.match(F)||[])switch(p){case "SSS":M+=p;break;case "A":case "a":M+="a";break;case "m":case "mm":case "h":case "hh":case "H":case "HH":case "s":case "ss":M+=p;break;default:M+=`'${p}'`}return M}class J{constructor(t,F,M,p){this._hour=t;this._minute=F;this._second=M;this._millisecond=p;this.declaredRootClass="esri.core.sql.timeonly"}static isTimeOnly(t){return"object"===typeof t&&null!=t&&"declaredRootClass"in
t&&"esri.core.sql.timeonly"===t.declaredRootClass}get hour(){return this._hour}get minute(){return this._minute}get second(){return this._second}get millisecond(){return this._millisecond}equals(t){return J.isTimeOnly(t)&&t.hour===this.hour&&t.minute===this.minute&&t.second===this.second&&t.millisecond===this.millisecond}clone(){return new J(this.hour,this.minute,this.second,this.millisecond)}isValid(){return l.isInteger(this.hour)&&l.isInteger(this.minute)&&l.isInteger(this.second)&&l.isInteger(this.millisecond)&&
0<=this.hour&&24>this.hour&&0<=this.minute&&60>this.minute&&0<=this.second&&60>this.second&&0<=this.millisecond&&1E3>this.millisecond}toString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`+(0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):"")}toSQLValue(){return this.toString()}toSQLWithKeyword(){return`time '${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,
"0")}${0<this.millisecond?"."+this.millisecond.toString().padStart(3,"0"):""}'`}toStorageString(){return`${this.hour.toString().padStart(2,"0")}:${this.minute.toString().padStart(2,"0")}:${this.second.toString().padStart(2,"0")}`}toFormat(t=null){return null===t||""===t?this.toString():(t=D(t))?v.DateTime.local(1970,1,1,this._hour,this._minute,this._second,this._millisecond).toFormat(t,{locale:g.getLocale(),numberingSystem:"latn"}):""}toNumber(){return this.millisecond+1E3*this.second+6E4*this.minute+
36E5*this.hour}static fromParts(t,F,M,p){t=new J(t,F,M,p);return t.isValid()?t:null}static fromReader(t){if(!t)return null;t=t.split(":");return 3!==t.length?null:new J(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10),0)}static fromMilliseconds(t){return 864E5<t||0>t?null:new J(Math.floor(t/36E5%24),Math.floor(t/6E4%60),Math.floor(t/1E3%60),Math.floor(t%1E3))}static fromDateJS(t){return new J(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds())}static fromDateTime(t){return new J(t.hour,
t.minute,t.second,t.millisecond)}static fromSqlTimeStampOffset(t){return this.fromDateTime(t.toDateTime())}static fromString(t,F=null){if(""===t||null===t)return null;const M=[];if(F)(F=D(F))&&M.push(F);else if(null===F||""===F)M.push("HH:mm:ss"),M.push("HH:mm:ss.SSS"),M.push("hh:mm:ss a"),M.push("hh:mm:ss.SSS a"),M.push("HH:mm"),M.push("hh:mm a"),M.push("H:mm"),M.push("h:mm a"),M.push("H:mm:ss"),M.push("h:mm:ss a"),M.push("H:mm:ss.SSS"),M.push("h:mm:ss.SSS a");for(const p of M)if(F=v.DateTime.fromFormat(t,
p),F.isValid)return new J(F.hour,F.minute,F.second,F.millisecond);return null}plus(t,F){switch(t){case "days":case "years":case "months":return this.clone();case "hours":case "minutes":case "seconds":case "milliseconds":return J.fromDateTime(this.toUTCDateTime().plus({[t]:F}))}return null}toUTCDateTime(){return v.DateTime.utc(1970,1,1,this.hour,this.minute,this.second,this.millisecond)}difference(t,F){switch(F.toLowerCase()){case "days":case "day":case "d":return this.toUTCDateTime().diff(t.toUTCDateTime(),
"days").days;case "months":case "month":return this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months;case "minutes":case "minute":case "m":return"M"===F?this.toUTCDateTime().diff(t.toUTCDateTime(),"months").months:this.toUTCDateTime().diff(t.toUTCDateTime(),"minutes").minutes;case "seconds":case "second":case "s":return this.toUTCDateTime().diff(t.toUTCDateTime(),"seconds").seconds;case "milliseconds":case "millisecond":case "ms":return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds;
case "hours":case "hour":case "h":return this.toUTCDateTime().diff(t.toUTCDateTime(),"hours").hours;case "years":case "year":case "y":return this.toUTCDateTime().diff(t.toUTCDateTime(),"years").years;default:return this.toUTCDateTime().diff(t.toUTCDateTime(),"milliseconds").milliseconds}}}c.TimeOnly=J;c.standardizeTimeFormat=D;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/arcade/kernel":function(){define(["exports","../geometry/Extent"],function(c,l){c.cloneGeometry=function(g){if(null==
g)return null;const v=g.clone();void 0!==g.cache._geVersion&&(v.cache._geVersion=g.cache._geVersion);return v};c.isInteger=function(g){return"number"===typeof g&&isFinite(g)&&Math.floor(g)===g};c.sameGeomType=function(g,v){return g===v||"point"===g&&"esriGeometryPoint"===v||"polyline"===g&&"esriGeometryPolyline"===v||"polygon"===g&&"esriGeometryPolygon"===v||"extent"===g&&"esriGeometryEnvelope"===v||"multipoint"===g&&"esriGeometryMultipoint"===v||"point"===v&&"esriGeometryPoint"===g||"polyline"===
v&&"esriGeometryPolyline"===g||"polygon"===v&&"esriGeometryPolygon"===g||"extent"===v&&"esriGeometryEnvelope"===g||"multipoint"===v&&"esriGeometryMultipoint"===g?!0:!1};c.shapeExtent=function(g){if(null==g)return null;switch(g.type){case "polygon":case "multipoint":case "polyline":return g.extent;case "point":return new l({xmin:g.x,ymin:g.y,xmax:g.x,ymax:g.y,spatialReference:g.spatialReference});case "extent":return g}return null};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureRelationship":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureRelationship/FeatureRelationshipViewModel ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute ../../intl/number".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e){var k;const a={title:!0,description:!0};g=k=class extends x{constructor(b,f){super(b,f);this._relatedFeatureIntersectionObserverNode=this._featureElementInfo=null;this._relatedFeatureIntersectionObserver=new IntersectionObserver(([z])=>{z?.isIntersecting&&this._increaseFeaturePage()},{root:window.document});this.flowItems=null;this.flowType="feature-relationship";this.headingLevel=2;this.viewModel=new C;this.messagesCommon=this.messages=null;this.visibleElements=
{...a};this._increaseFeaturePage=()=>{const {state:z,showAllEnabled:I,relatedFeatures:r,featuresPerPage:y,featurePage:H}=this.viewModel;"ready"===z&&I&&r.length>=y*H&&this.viewModel.featurePage++}}initialize(){this._featureElementInfo=new u;this.addHandles([J.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],()=>this._setupFeatureElementInfo(),J.initial),J.watch(()=>[this.viewModel.state,this.viewModel.showAllEnabled,this._relatedFeatureIntersectionObserverNode],()=>this._handleRelatedFeatureObserverChange()),
J.on(()=>this.viewModel.relatedFeatureViewModels,"change",()=>this._setupRelatedFeatureViewModels())])}loadDependencies(){return B.loadCalciteComponents({chip:()=>new Promise((b,f)=>c(["../../chunks/index11"],b,f)),icon:()=>(new Promise((b,f)=>c(["../../chunks/index7"],b,f))).then(b=>b.index),list:()=>new Promise((b,f)=>c(["../../chunks/index16"],b,f)),"list-item":()=>new Promise((b,f)=>c(["../../chunks/index20"],b,f)),loader:()=>new Promise((b,f)=>c(["../../chunks/index32"],b,f)),notice:()=>new Promise((b,
f)=>c(["../../chunks/index6"],b,f))})}destroy(){this._unobserveRelatedFeatureObserver();this._featureElementInfo=v.destroyMaybe(this._featureElementInfo)}get displayShowAllButton(){const {showAllEnabled:b,featureCount:f,displayCount:z,state:I,allCategoriesCount:r}=this.viewModel;return!b&&"ready"===I&&(!!r&&(r>z||0===z)||!!f&&(f>z||0===z))}get displayListItems(){const {relatedFeatureViewModels:b,allCategoriesCount:f}=this.viewModel;return this.displayShowAllButton||!!b.length||!!f}get allItemsDescription(){const {messages:b}=
this,{featureCount:f,allCategories:z,allCategoriesCount:I}=this.viewModel;return m.substitute(b?.numberRecords,{number:e.formatNumber(z?I:f)})}get description(){return this.viewModel.description}set description(b){this.viewModel.description=b}get title(){const {activeCategory:b,title:f}=this.viewModel;return b?.name??f}set title(b){this.viewModel.title=b}castVisibleElements(b){return{...a,...b}}render(){const {state:b}=this.viewModel;return n.tsx("div",{class:this.classes("esri-feature-relationship",
P.globalCss.widget)},this._featureElementInfo?.render(),"loading"===b?this._renderLoading():"disabled"===b?this._renderRelationshipNotFound():this._renderRelatedFeatures())}async _selectCategory(b){const {flowItems:f,featureVisibleElements:z,viewModel:I}=this;f&&(I.activeCategory=b,I.showAllEnabled=!0,f.push(new k({flowItems:f,featureVisibleElements:z,visibleElements:{title:!1,description:!1},viewModel:I})))}async _selectRecord(b){const {flowItems:f,featureVisibleElements:z}=this;if(f){b.abilities=
{relationshipContent:!0};var {default:I}=await new Promise((r,y)=>c(["../Feature"],H=>r(Object.freeze(Object.defineProperty({__proto__:null,default:H},Symbol.toStringTag,{value:"Module"}))),y));f.push(new I({flowItems:f,flowType:this.flowType,viewModel:b,visibleElements:z}))}}_showAllRecords(){const {flowItems:b}=this;if(b){var {viewModel:f,featureVisibleElements:z}=this;f.showAllEnabled=!0;var I=new k({flowItems:b,featureVisibleElements:z,visibleElements:{title:!1,description:!1},viewModel:f});b.push(I)}}_renderStickyLoading(){return"querying"===
this.viewModel.state?n.tsx("div",{class:"esri-feature__sticky-loading-container",key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return n.tsx("calcite-loader",{inline:!0,label:""})}_renderLoading(){return n.tsx("div",{class:"esri-feature__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderShowAllIconNode(){return n.tsx("calcite-icon",{icon:"list",scale:"s",slot:"content-end"})}_renderChevronIconNode(){const b=K.isRTL(this.container)?"chevron-left":
"chevron-right";return n.tsx("calcite-icon",{icon:b,scale:"s",slot:"content-end"})}_renderCategory(b){const {count:f,name:z,value:I}=b,r=e.formatNumber(f);return n.tsx("calcite-list-item",{class:"esri-feature-relationship__list-item",disabled:!f,key:I,label:z,onCalciteListItemSelect:()=>this._selectCategory(b)},n.tsx("calcite-chip",{label:r,scale:"s",slot:"content-end"},r),this._renderChevronIconNode())}_renderRelatedFeature(b){const {itemDescriptionFieldName:f}=this.viewModel,z=b.title;b.description=
f&&b.formattedAttributes?.global[f];return n.tsx("calcite-list-item",{class:this.classes("esri-feature-relationship__list-item",{["esri-feature-relationship__list-item--hidden"]:"loading"===b.state}),description:t.stripHTML(b.description??""),key:b.uid,label:t.stripHTML(z),onCalciteListItemSelect:()=>this._selectRecord(b)},this._renderChevronIconNode())}_renderShowAllListItem(){return this.displayShowAllButton?n.tsx("calcite-list-item",{description:this.allItemsDescription,key:"show-all-item",label:this.messages?.showAll,
onCalciteListItemSelect:()=>this._showAllRecords()},this._renderShowAllIconNode()):null}_renderNoRelatedFeaturesMessage(){return n.tsx("calcite-notice",{icon:"information",key:"no-related-features-message",kind:"brand",open:!0,scale:"s",width:"full"},n.tsx("div",{slot:"message"},this.messages?.noRelatedFeatures))}_renderFeatureObserver(){return n.tsx("div",{afterCreate:this._relatedFeatureIntersectionObserverCreated,bind:this,class:"esri-feature__feature-observer",key:"feature-observer"})}_renderList(){const {relatedFeatureViewModels:b,
categories:f}=this.viewModel;return n.tsx("calcite-list",{displayMode:"flat",label:this.messages?.relatedFeaturesList},f?.map(z=>this._renderCategory(z))??b.toArray().map(z=>this._renderRelatedFeature(z)),this._renderShowAllListItem())}_renderRelatedFeatures(){const {displayListItems:b}=this,{state:f}=this.viewModel;return n.tsx("div",{class:this.classes("esri-feature-relationship__list",{["esri-feature-relationship__list--querying"]:"querying"===f}),key:"list-container"},b?this._renderList():"ready"===
f?this._renderNoRelatedFeaturesMessage():null,this._renderStickyLoading(),this._renderFeatureObserver())}_renderRelationshipNotFound(){return n.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"relationship-not-found",kind:"danger",open:!0,scale:"s",width:"full"},n.tsx("div",{slot:"message"},this.messages?.relationshipNotFound))}_setupRelatedFeatureViewModels(){const {relatedFeatureViewModels:b}=this.viewModel;this.removeHandles("related-feature-viewmodels");b?.forEach(f=>{this.addHandles(J.watch(()=>
[f.title,f.state],()=>this.scheduleRender(),J.initial),"related-feature-viewmodels")});this.scheduleRender()}_setupFeatureElementInfo(){const {headingLevel:b,visibleElements:f}=this,z=f.description&&this.description,I=f.title&&this.title;this._featureElementInfo?.set({description:z,title:I,headingLevel:b})}async _handleRelatedFeatureObserverChange(){this._unobserveRelatedFeatureObserver();const {state:b,showAllEnabled:f}=this.viewModel;await D.after(0);this._relatedFeatureIntersectionObserverNode&&
"ready"===b&&f&&this._relatedFeatureIntersectionObserver.observe(this._relatedFeatureIntersectionObserverNode)}_relatedFeatureIntersectionObserverCreated(b){this._relatedFeatureIntersectionObserverNode=b}_unobserveRelatedFeatureObserver(){this._relatedFeatureIntersectionObserverNode&&this._relatedFeatureIntersectionObserver.unobserve(this._relatedFeatureIntersectionObserverNode)}};l.__decorate([F.property()],g.prototype,"_relatedFeatureIntersectionObserverNode",void 0);l.__decorate([F.property({readOnly:!0})],
g.prototype,"displayShowAllButton",null);l.__decorate([F.property({readOnly:!0})],g.prototype,"displayListItems",null);l.__decorate([F.property({readOnly:!0})],g.prototype,"allItemsDescription",null);l.__decorate([F.property()],g.prototype,"description",null);l.__decorate([F.property()],g.prototype,"featureVisibleElements",void 0);l.__decorate([F.property()],g.prototype,"flowItems",void 0);l.__decorate([F.property()],g.prototype,"flowType",void 0);l.__decorate([F.property()],g.prototype,"headingLevel",
void 0);l.__decorate([F.property()],g.prototype,"title",null);l.__decorate([F.property({type:C})],g.prototype,"viewModel",void 0);l.__decorate([F.property(),q.messageBundle("esri/widgets/Feature/t9n/Feature")],g.prototype,"messages",void 0);l.__decorate([F.property(),q.messageBundle("esri/t9n/common")],g.prototype,"messagesCommon",void 0);l.__decorate([F.property()],g.prototype,"visibleElements",void 0);l.__decorate([M.cast("visibleElements")],g.prototype,"castVisibleElements",null);return g=k=l.__decorate([h.subclass("esri.widgets.Feature.FeatureRelationship")],
g)})},"esri/widgets/Feature/FeatureRelationship/FeatureRelationshipViewModel":function(){define("require ../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/arrayUtils ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/accessorSupport/decorators/subclass ../../../rest/support/RelationshipQuery ../support/featureUtils ../../FeatureForm/featureFormUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P){function K(q){return null!=q&&""!==q}v=class extends J.ClonableMixin(F.IdentifiableMixin(v)){constructor(q){super(q);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.featuresPerPage=10;this.orderByFields=this.map=this.layer=this.graphic=this.description=this.allCategories=this.activeCategory=null;this.featureCount=0;this.relationshipId=null;this.showAllEnabled=!1;this.title=null;this._cancelQuery=
()=>{const {_queryAbortController:n}=this;n&&n.abort();this._queryAbortController=null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:n}=this;n&&n.abort();this._queryFeatureCountAbortController=null};this._cancelQueryPage=()=>{const {_queryPageAbortController:n}=this;n&&n.abort();this._queryPageAbortController=null};this._queryController=async()=>{this._cancelQuery();const n=new AbortController;this._queryAbortController=n;await M.ignoreAbortErrors(this._query());this._queryAbortController===
n&&(this._queryAbortController=null)};this._queryFeatureCountController=async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const n=new AbortController;this._queryFeatureCountAbortController=n;await M.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===n&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryPageController=async()=>{const n=new AbortController;this._queryPageAbortController=n;await M.ignoreAbortErrors(this._queryPage());
this._queryPageAbortController===n&&(this._queryPageAbortController=null)};this._queryDebounced=M.debounce(this._queryController,100);this._queryFeatureCountDebounced=M.debounce(this._queryFeatureCountController,100);this._queryPageDebounced=M.debounce(this._queryPageController,100);this._query=async()=>{const {_queryAbortController:n,relatedFeatures:m}=this;this.featureCount&&("subtype-group"!==this.relatedLayer?.type||this.activeCategory)&&(this._destroyRelatedFeatureViewModels(),this.featurePage=
1,m.destroyAll(),this.destroyed||m.addMany(this._sliceFeatures(await this._queryRelatedFeatures({signal:n?.signal}))))};this.addHandles([p.watch(()=>[this.displayCount,this.graphic,this.layer,this.layer?.loaded,this.map,this.orderByFields,this.relationshipId,this.featuresPerPage,this.showAllEnabled,this.canQuery,this.featureCount,this.activeCategory],()=>this._queryDebounced(),p.initial),p.watch(()=>[this.featurePage,this.showAllEnabled],()=>this._queryPageDebounced()),p.watch(()=>[this.layer,this.relationshipId,
this.objectId,this.canQuery,this.activeCategory],()=>this._queryFeatureCountDebounced())])}destroy(){this._destroyRelatedFeatureViewModels();this.relatedFeatures.destroyAll();this._cancelQuery();this._cancelQueryFeatureCount();this._cancelQueryPage()}set featurePage(q){const {featuresPerPage:n,featureCount:m}=this;this._set("featurePage",Math.min(Math.max(q,1),Math.ceil(m/n)||1))}get featurePage(){return this._get("featurePage")}get orderByFieldsFixedCasing(){const {orderByFields:q,relatedLayer:n}=
this;return q&&n?.loaded?q.map(m=>{const e=m.clone();e.field=B.getFixedFieldName(m.field,n);return e}):q??[]}get supportsCacheHint(){return!!this.layer?.capabilities?.queryRelated?.supportsCacheHint}get canLoad(){return!!this.map&&null!=this.relationshipId&&"number"===typeof this.objectId}get canQuery(){const q=this.layer?.capabilities?.queryRelated;return!!this.relatedLayer&&!!this.relationship&&null!=this.relationshipId&&null!=this.objectId&&!!q?.supportsCount&&!!q?.supportsPagination}get allCategoriesCount(){return this.allCategories?.length??
0}get categories(){const {allCategories:q}=this;return this.showAllEnabled?q:q?.slice(0,this.displayCount)??null}set displayCount(q){this._set("displayCount",Math.min(Math.max(q??3,0),10))}get displayCount(){return this._get("displayCount")}get itemDescriptionFieldName(){return this.orderByFieldsFixedCasing[0]?.field||null}get objectId(){return(this.objectIdField&&this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get relatedFeatures(){return this._get("relatedFeatures")||
new t}get relatedLayer(){const {layer:q,map:n,relationship:m}=this;if(!q?.loaded||!n||!m)return null;const e="subtype-sublayer"===q.type&&q.parent&&B.isRelatableFeatureSupportedLayer(q.parent)?q.parent:q;return B.findRelatedLayer(n,e,m)??null}get relatedLayerKeyField(){const {relatedLayer:q,relationshipId:n}=this;return q?.loaded&&null!=n?q.relationships?.find(m=>m.id===n)?.keyField:null}get relatedLayerKeyFields(){const {relatedLayer:q}=this;return q?.loaded?q.relationships?.map(n=>n.keyField).filter(D.isSome)??
[]:[]}get relationship(){const {relationshipId:q,layer:n}=this;return null!=q&&n?.loaded?n.relationships?.find(({id:m})=>m===q)??null:null}get relationshipKey(){const {relationshipKeyField:q}=this;return(q&&this.graphic?.attributes?.[q])??null}get relationshipKeyField(){return this.relationship?.keyField||null}get relatedFeatureViewModels(){return this._get("relatedFeatureViewModels")||new t}get state(){const {_queryAbortController:q,_queryFeatureCountAbortController:n,_queryPageAbortController:m,
canQuery:e,_loaded:k,canLoad:a}=this;return n||a&&!k?"loading":q||m?"querying":e?"ready":"disabled"}getRelatedFeatureByObjectId(q){return this.relatedFeatures.find(n=>n.getObjectId()===q)}refresh(){this._queryFeatureCountDebounced()}_destroyRelatedFeatureViewModels(){this.relatedFeatureViewModels?.destroyAll()}async _queryFeatureCount(){const {layer:q,relatedLayer:n}=this;await q?.load();await n?.load();const {_queryFeatureCountAbortController:m,activeCategory:e,canQuery:k,objectId:a,relatedLayerKeyField:b,
relationshipId:f,relationshipKey:z,supportsCacheHint:I}=this;if(k&&q&&n&&null!=a)if("subtype-group"!==n?.type||e){var {historicMoment:r,gdbVersion:y}=q,H=new u({cacheHint:I,gdbVersion:y,historicMoment:r,relationshipId:f,returnGeometry:!1,objectIds:[a],where:this._getRelationshipWhereClause(n)});H=await q.queryRelatedFeaturesCount(H,{signal:m?.signal});this._set("allCategories",null);this._set("featureCount",H[a]||0)}else this._set("featureCount",0),this._destroyRelatedFeatureViewModels(),this.featurePage=
1,this.relatedFeatures.destroyAll(),b&&null!=z&&({default:H}=await new Promise((Q,A)=>c(["../../../smartMapping/statistics/uniqueValues"],N=>Q(Object.freeze(Object.defineProperty({__proto__:null,default:N},Symbol.toStringTag,{value:"Module"}))),A)),{uniqueValueInfos:H}=await H({layer:n,sqlWhere:`${b} = '${z}'`,field:n.subtypeField,signal:m?.signal}),H=H.map(({count:Q,value:A})=>{const N=n.subtypes?.find(G=>G.code===A)?.name;return null!=A&&N?{count:Q,value:A,name:N}:void 0}).filter(D.isSome),this._set("allCategories",
H));else this._set("featureCount",0),this._set("allCategories",null)}_getRelationshipWhereClause(q){var {activeCategory:n}=this,m=q.createQuery();q="subtypeField"in q?q.subtypeField:void 0;n=n&&q?`${q} = ${n.value}`:void 0;return(m=m.where)&&n?`(${m}) AND (${n})`:m??n}_sliceFeatures(q){const {showAllEnabled:n,displayCount:m}=this;return n?q:m?q.slice(0,m):[]}async _queryPage(){const {relatedFeatures:q,featurePage:n,showAllEnabled:m,_queryPageAbortController:e,featureCount:k}=this;!m||2>n||!k||"subtype-group"===
this.relatedLayer?.type&&!this.activeCategory||q.addMany(await this._queryRelatedFeatures({signal:e?.signal}))}async _queryRelatedFeatures(q){const {displayCount:n,featureCount:m,featurePage:e,featuresPerPage:k,layer:a,orderByFieldsFixedCasing:b,relatedLayer:f,relatedLayerKeyFields:z,relationshipId:I,showAllEnabled:r,supportsCacheHint:y}=this,{canQuery:H,objectId:Q}=this;if(!H||!a||!f||null==Q)return[];var A=r?((e-1)*k+m)%m:0;const N=r?k:n;var G=f.objectIdField;const d="subtypeField"in f?f.subtypeField:
void 0;G=[...b.map(U=>U.field),...P.getFieldsInTitleAndDesc(f),...z,G,d].filter(K);const E=b.map(U=>`${U.field} ${U.order}`),{historicMoment:L,gdbVersion:R}=a;A=new u({orderByFields:E,start:A,num:N,outFields:G,cacheHint:y,historicMoment:L,gdbVersion:R,relationshipId:I,returnGeometry:!1,objectIds:[Q],where:this._getRelationshipWhereClause(f)});q=(await a.queryRelatedFeatures(A,{signal:q?.signal}))[Q]?.features||[];"subtype-group"===f.type&&d?q.forEach(U=>{var V=U.attributes[d];V=f.findSublayerForSubtypeCode?.(V);
U.sourceLayer=V;U.layer=V}):q.forEach(U=>{U.sourceLayer=f;U.layer=f});return q}};l.__decorate([w.property()],v.prototype,"_loaded",void 0);l.__decorate([w.property()],v.prototype,"_queryAbortController",void 0);l.__decorate([w.property()],v.prototype,"_queryPageAbortController",void 0);l.__decorate([w.property()],v.prototype,"_queryFeatureCountAbortController",void 0);l.__decorate([w.property({value:1})],v.prototype,"featurePage",null);l.__decorate([w.property()],v.prototype,"featuresPerPage",void 0);
l.__decorate([w.property({readOnly:!0})],v.prototype,"orderByFieldsFixedCasing",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"supportsCacheHint",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"canLoad",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"canQuery",null);l.__decorate([w.property()],v.prototype,"activeCategory",void 0);l.__decorate([w.property({readOnly:!0})],v.prototype,"allCategories",void 0);l.__decorate([w.property({readOnly:!0})],v.prototype,"allCategoriesCount",
null);l.__decorate([w.property({readOnly:!0})],v.prototype,"categories",null);l.__decorate([w.property()],v.prototype,"description",void 0);l.__decorate([w.property({value:3})],v.prototype,"displayCount",null);l.__decorate([w.property({type:g})],v.prototype,"graphic",void 0);l.__decorate([w.property({readOnly:!0})],v.prototype,"itemDescriptionFieldName",null);l.__decorate([w.property()],v.prototype,"layer",void 0);l.__decorate([w.property()],v.prototype,"map",void 0);l.__decorate([w.property({readOnly:!0})],
v.prototype,"objectId",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"objectIdField",null);l.__decorate([w.property()],v.prototype,"orderByFields",void 0);l.__decorate([w.property({readOnly:!0})],v.prototype,"relatedFeatures",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"relatedLayer",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"relatedLayerKeyField",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"relatedLayerKeyFields",null);l.__decorate([w.property({readOnly:!0})],
v.prototype,"relationship",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"relationshipKey",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"relationshipKeyField",null);l.__decorate([w.property({readOnly:!0})],v.prototype,"featureCount",void 0);l.__decorate([w.property({readOnly:!0})],v.prototype,"relatedFeatureViewModels",null);l.__decorate([w.property()],v.prototype,"relationshipId",void 0);l.__decorate([w.property()],v.prototype,"showAllEnabled",void 0);l.__decorate([w.property()],
v.prototype,"state",null);l.__decorate([w.property()],v.prototype,"title",void 0);return v=l.__decorate([C.subclass("esri.widgets.Feature.FeatureRelationship.FeatureRelationshipViewModel")],v)})},"esri/widgets/FeatureForm/featureFormUtils":function(){define("exports ../../intl ../../core/arrayUtils ../../core/compilerUtils ../../core/lang ../../core/Logger ../../core/string ../../form/support/formUtils ../../layers/support/domainUtils ../../layers/support/fieldUtils ../../layers/support/layerUtils ../../smartMapping/support/utils ../support/dateUtils ../support/forms/formUtils ../support/UtilityNetworkAssociations/utils/getFeatureTitle ../../intl/substitute".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B){function P(a){const {fields:b,values:f}=a,z=a.timeZone??void 0;a=b.map((I,r)=>{let y=f[r];I.domain&&"coded-value"===I.domain.type&&(r=I.domain.codedValues.find(H=>H.code===y),r?.name&&(y=r.name));if(h.isAnyDateField(I)||p.isTimeOnlyField(I))y=x.getLabelForDateFieldValue(I,y,{timeZone:z,...x.getIntlOptionsForField(I)});return[I.name,y]});return Object.fromEntries(a)}function K(a,b){return t.replace(t.replace(a,f=>`{${f.toLowerCase()}}`),Object.fromEntries(Object.entries(b).map(([f,
z])=>[f.toLowerCase(),z])))}const q=a=>"field"===a?.type,n=a=>"relationship"===a?.type,m=a=>"utilityNetworkAssociations"===a.type,e=a=>a.reduce((b,f)=>"group"===f?.type?[...b,...f.inputs]:[...b,f],[]),k=(a,b)=>null!=a&&a.input?.type===b;c.extractExpressionNameFromString=function(a){const [b,f]=a.split("expression/");return""===b&&f?f:(J.getLogger("esri.widgets.FeatureForm/featureFormUtils").error("extractExpressionNameFromString:invalid-input",`The string ${a} is not a valid expression reference of the form '${"expression/"}/expressionName'`),
"")};c.flattenAssociationInputs=a=>e(a).filter(m);c.flattenFieldInputs=a=>e(a).filter(q);c.flattenInputs=e;c.flattenRelationshipInputs=a=>e(a).filter(n);c.formTemplateHasInvalidFields=function(a,b){return(b=b??("formTemplate"in a&&a.formTemplate))?(b.elements?.filter(F.isFieldElement)??[]).some(({fieldName:f})=>!a.fieldsIndex.get(f)):!1};c.getComputedAttributes=P;c.getErrorMessageForFieldInput=(a,b,f)=>{const {dataType:z,error:I,minLength:r}=a;b=b?.validationErrors;if(!b||!I)return null;if(I===C.InputValidationError.CANNOT_BE_EMPTY)return b.cannotBeNull;
if(I===M.DomainValidationError.VALUE_OUT_OF_RANGE||I===p.NumericRangeValidationError.OUT_OF_RANGE){const {field:y,range:H}=a;a={type:"date",intlOptions:{timeZone:"date"===y.type&&f?f:void 0,...x.getIntlOptionsForField(y)}};f=C.getRangeErrorMessage(H,b);return B.substitute(f,H,{format:{max:"date"===z?a:null!=H.max&&C.shouldUseScientificNotation(H.max)?C.scientificNumberFormatOptions:C.numberFormatOptions,min:"date"===z?a:null!=H.min&&C.shouldUseScientificNotation(H.min)?C.scientificNumberFormatOptions:
C.numberFormatOptions}})}return I===M.DomainValidationError.INVALID_CODED_VALUE?b.invalidCodedValue:I===p.TypeValidationError.INVALID_TYPE?b.invalidType:I===C.InputValidationError.TOO_SHORT?B.substitute(b.tooShort,{min:r}):null};c.getFeatureFormTitle=function(a,b){const {title:f,feature:z}=a??{};return f||(z?u.getFeatureTitle(z):null)||b||""};c.getFieldsInTitleAndDesc=a=>{const b=[];if(a.formTemplate){const {description:f,title:z}=a.formTemplate;a.fields?.forEach(I=>{const r=z&&t.templateHasKey(z,
I.name),y=f&&t.templateHasKey(f,I.name);(r||y)&&b.push(I.name)})}return b};c.getIconForFeature=a=>{if(a){var b=a.layer;b=b&&"geometryType"in b?b.geometryType:void 0;a=a.geometry?.type;return"polyline"===a||"polyline"===b?"line":"mesh"===a||"mesh"===b||"multipatch"===b?"cube":"multipoint"===a||"multipoint"===b?"point":a||b||"table"}};c.getNormalizedFeatureTypeInfo=a=>{const b={typeFieldName:null,types:[]};if(!a)return b;w.isSubtypeSublayer(a)?(b.typeFieldName=a.parent?.subtypeField,b.types=a.parent?.subtypes??
[]):"subtype-group"===a.type||"feature"===a.type&&a.subtypes?.length?(b.typeFieldName=a.subtypeField,b.types=a.subtypes??[]):"types"in a&&a.types&&(b.typeFieldName=a.typeIdField,b.types=a.types.map(({id:f,name:z,domains:I})=>({code:f,name:z,domains:I})));null!=b.typeFieldName&&(b.typeFieldName=a.getField(b.typeFieldName)?.name??b.typeFieldName);return b};c.isExpressionReference=function(a){return a.startsWith("expression/")};c.isFieldElementWithInputType=k;c.isFieldElementWithShowNoValueOptionInput=
a=>null!=a&&(k(a,"combo-box")||k(a,"radio-buttons"));c.isFieldInput=q;c.isGroupInput=a=>"group"===a?.type;c.isInputInGroupInput=a=>"group"!==a?.type&&null!=a.group;c.isLegacyFieldMapsExpressionReference=function(a){return a.startsWith("expr/")};c.isNumberFieldInput=({domain:a,inputType:b="text-box",dataType:f})=>"number"===f&&"text-box"===b&&(!a||"coded-value"!==a.type);c.isRelationshipInput=n;c.isTextElementInput=a=>"text"===a.type;c.isUtilityNetworkAssociationInput=m;c.parseFormTemplateString=function(a){const {attributes:b,
fieldsIndex:f,label:z,timeZone:I}=a;if(!b||"object"!==typeof b)return z;var r=Object.keys(b).filter(y=>t.templateHasKey(z,y));a=r.map(y=>b[y]);r=r.map(y=>f.get(y)).filter(g.isSome);return K(z,P({values:a,fields:r,timeZone:I}))};c.prependExpressionPrefix=function(a){return`${"expression/"}${a}`};c.prependFieldPrefix=function(a){return`${"field/"}${a}`};c.substituteFieldTemplatesInString=K;c.subtypeChangeShouldPrompt=function(a,b,f){var z=w.getSubtypesFromLayer(a);a=z?.find(I=>I.code===f);if(!a)return!1;
z=z?.find(I=>I.code===b);return D.equalsShallow(a.defaultValues,z?.defaultValues)?!1:Object.values(a.defaultValues).some(I=>null!=I)};c.valueIsInvalidSwitchValue=function(a,b){return null==a||b.onValue!==a&&b.offValue!==a};c.valueIsValidContingentValue=function(a,b){switch(b.objectType){case "any":return!0;case "null":return null==a;case "code":return a===b.codedValue?.code;case "range":return null!=a&&null!=b.minValue&&null!=b.maxValue&&+a>=b.minValue&&+a<=b.maxValue;default:return v.neverReached(b.objectType),
!1}};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/dateUtils":function(){define("exports ../../intl ../../core/has ../../core/Error ../../core/mathUtils ../../intl/date ../../support/dateUtils ../../support/guards ../../time/constants ../../chunks/datetime ../../intl/locale".split(" "),function(c,l,g,v,D,J,t,F,M,p,w){function h(m){return{locale:w.getLocale(),numberingSystem:"latn",zone:m??q}}function x(m,e){return null==m?null:p.DateTime.fromMillis(m,h(e))}
function C(m,e){if(null==m||!F.isString(m)||""===m)return e?(m=p.DateTime.local({zone:e}),{date:null,time:null,timeZoneOffset:m.isValid?m.offset.toString():null}):n;m=p.DateTime.fromISO(m,{setZone:!0});return{date:m.toFormat(t.defaultDatePattern,h()),time:m.toFormat(t.TimeStampOffsetPattern.HMS_MS,h()),timeZoneOffset:m.offset.toString()}}function u(m,e){if(null==m?.value||Array.isArray(m.value))return null;let k=null;k="valueAsDate"in m?p.DateTime.fromFormat(m.value,t.defaultDatePattern,h(e)):t.timeOnlyToDateTime(m.value);
return k?.isValid?k:null}function B(m){const {max:e,min:k,value:a}=m;return isNaN(a)||null!=e&&a>e||null!=k&&a<k?!1:!0}function P(m){const {max:e,min:k,value:a}=m;return null!=e&&null!=k?D.clamp(a,k,e):null!=e&&a>e?e:null!=k&&a<k?k:a}function K(m){if(!m)return"";var e=m.split(".").at(0);if(!e||1>e.length)throw new v("invalid time-only field",`Cannot parse valid time-only field value from ${m}`);m=e.split(":");e=Array(3);for(let k=0;3>k;k++){const a=m.at(k)??"";e[k]=a.padStart(2,"0")}return e.join(":")}
const q=M.utc,n={date:null,time:null,timeZoneOffset:null};l=new Map([["hours",3600],["minutes",60],["seconds",1],["deciseconds",.1],["centiseconds",.01],["milliseconds",.001]]);g=new Set(["date-only","time-only","timestamp-offset"]);c.arcadeDateToFieldValue=function(m,e){switch(e){case "date":return m.getTime();case "date-only":return m.toISODate();case "time-only":return K(m.toISOTime(!0,!1));case "timestamp-offset":return m.toISOString(!1);default:return null}};c.clampValueToRange=P;c.createDateTimeFromFieldValue=
x;c.dateFieldsWithStringFieldValue=g;c.dateTimeIsInRange=function(m){const {type:e,range:k,value:a}=m;if(null==a||!k||a===k.min||a===k.max)return!0;if("date"===e)return B({value:a,min:k.min,max:k.max});const {rawMax:b,rawMin:f}=k;let z=m=null,I=null;switch(e){case "date-only":m=t.dateOnlyToDateTime(b);z=t.dateOnlyToDateTime(f);I=t.dateOnlyToDateTime(a);break;case "time-only":m=t.timeOnlyToDateTime(b);z=t.timeOnlyToDateTime(f);I=t.timeOnlyToDateTime(a);break;case "timestamp-offset":m=t.timestampOffsetToDateTime(b),
z=t.timestampOffsetToDateTime(f),I=t.timestampOffsetToDateTime(a)}return I?B({value:I.valueOf(),min:z?.valueOf(),max:m?.valueOf()}):!0};c.dateTimeToFieldValue=function(m){return m?.isValid?m.toMillis():null};c.getDefaultLocaleOptions=h;c.getISOFieldValueFromDateComponents=function(m){const {dateComponent:e,defaultTimeZone:k,timeComponent:a,timeZoneComponent:b,oldValue:f}=m;if(!e?.value)return null;const {year:z,month:I,day:r}=p.DateTime.fromFormat(e.value,t.defaultDatePattern),{hour:y,minute:H,second:Q,
millisecond:A}=u(a,M.utc)??p.DateTime.now();m=C(f,k);m=b?.value?parseInt(b.value,10):null!=m.timeZoneOffset?parseInt(m.timeZoneOffset,10):(new Date).getTimezoneOffset();m=p.FixedOffsetZone.instance(m);m=p.DateTime.fromObject({year:z,month:I,day:r,hour:y,minute:H,second:Q,millisecond:A},{zone:m});return m.isValid?m.toISO({includeOffset:!0}):null};c.getIntlOptionsForField=function(m){switch(m.type){case "date":return J.convertDateFormatToIntlOptions("short-date-short-time");case "date-only":return J.convertDateFormatToIntlOptions("short-date");
case "time-only":return J.convertDateFormatToIntlOptions("short-time");case "timestamp-offset":return{...J.convertDateFormatToIntlOptions("short-date-short-time"),timeZone:void 0,timeZoneName:"short"};default:return J.convertDateFormatToIntlOptions("short-date-short-time")}};c.getLabelForDateFieldValue=function(m,e,k){if(!m||null==e)return null;switch(m.type){case "date":return J.formatDate(e,k);case "date-only":return J.formatDateOnly(e,k);case "time-only":return J.formatTimeOnly(e,k);case "timestamp-offset":return J.formatTimestamp(e,
k);default:return null}};c.getLocalDateTimeFromComponent=u;c.getUnixFieldValueFromDateComponents=function(m){const {dateComponent:e,timeComponent:k,timeZone:a,max:b,min:f,oldValue:z}=m;var I=u(e,a);m=!!m.applyRange;if(!I)return null;var r=null;if(null!=k?.value){r=u(k,a);var y=Date.now();y=p.DateTime.fromMillis(null!=b&&b<y?b:y,h(a));I=I||y;const {year:H,month:Q,day:A}=I,{hour:N,minute:G,second:d,millisecond:E}=r||y;r=I.set({year:H,month:Q,day:A,hour:N,minute:G,second:d,millisecond:E})}else{m=P({value:z??
Date.now(),max:b,min:f});m=x(m,a);const {year:H,month:Q,day:A}=I,{hour:N,minute:G,second:d,millisecond:E}=m;m=!0;r=I.set({year:H,month:Q,day:A,hour:N,minute:G,second:d,millisecond:E})}if(!r.isValid)return null;I=r.toMillis();return m?P({value:I,max:b,min:f}):I};c.isArcadeDate=function(m){return!!m&&"object"===typeof m&&"getTime"in m&&"toISOString"in m&&"timeZone"in m};c.isCalciteDateComponent=m=>"valueAsDate"in m;c.isInDST=function(m,e="system"){return p.DateTime.fromJSDate(m,{zone:e}).isInDST};c.normalizeTimeOnlyString=
K;c.numberingSystem="latn";c.prepareISOFieldValueForDateComponents=C;c.prepareUnixFieldValueForDateComponents=function(m,e){return null==m||!F.isNumber(m)||isNaN(m)?n:(m=x(m,e))?{date:m.toFormat(t.defaultDatePattern,h(e)),time:m.toFormat(t.defaultTimePattern,h(e))}:n};c.timeResolutionToStepMap=l;c.valueIsInRange=B;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/forms/formUtils":function(){define(["exports","../../../form/support/formUtils","../../../layers/support/domainUtils",
"../../../layers/support/fieldUtils","../dateUtils"],function(c,l,g,v,D){function J(F){return null===F||void 0===F||""===F}function t(F){return"number"===typeof F&&-1<F?F:-1}c.FieldInputDataTypes=void 0;(function(F){F.Text="text";F.Number="number";F.Date="date";F.Unsupported="unsupported"})(c.FieldInputDataTypes||(c.FieldInputDataTypes={}));c.InputValidationError=void 0;(function(F){F.CANNOT_BE_EMPTY="input-validation-error::cannot-be-empty";F.TOO_SHORT="length-validation-error::too-short";F.TOO_LONG=
"length-validation-error::too-long"})(c.InputValidationError||(c.InputValidationError={}));c.capabilitiesAllowEditType=(F,M)=>{if(!F)return!0;({operations:F}=F);switch(M){case "INSERT":return F.supportsAdd;case "UPDATE":case "DELETE":return F.supportsUpdate;default:return!0}};c.dateIsValid=F=>F&&!Number.isNaN(F.valueOf());c.ensureMinOrMaxLength=t;c.getMaxLength=function({dataType:F,field:M,input:p}){if(F===c.FieldInputDataTypes.Date)return-1;F=t(M.length);if(!p||!l.isTextInput(p))return F;p=t(p.maxLength);
return-1===p?F:-1===F?p:Math.min(F,p)};c.getMinLength=function({dataType:F,field:M,input:p}){if(F===c.FieldInputDataTypes.Date||!p||!l.isTextInput(p))return-1;F=t(p.minLength);if(0>F)return-1;M=t(M.length);return-1<M&&M<F?-1:F};c.getRangeErrorMessage=function(F,M){return null!=F.max&&null!=F.min?M.outsideRange:null!=F.max?M.outsideRangeMax:M.outsideRangeMin};c.isEmptyValue=J;c.numberFormatOptions={type:"number"};c.scientificNumberFormatOptions={type:"number",intlOptions:{notation:"scientific"}};c.shouldUseScientificNotation=
function(F){return 1E7<=F||-1E7>=F};c.validateFormValue=function(F,M){const {dataType:p,domain:w,field:h,maxLength:x,minLength:C,range:u,required:B}=M;if(null==F)return B?c.InputValidationError.CANNOT_BE_EMPTY:null;if("text"===p&&"string"===typeof F){if(-1<C&&F.length<C)return c.InputValidationError.TOO_SHORT;if(-1<x&&F.length>x)return c.InputValidationError.TOO_LONG}return"date"!==p||D.dateTimeIsInRange({type:h.type,range:u,value:F})?w?g.validateDomainValue(h,F,w):v.validateFieldValue(h,F)??g.validateDomainValue(h,
F):v.NumericRangeValidationError.OUT_OF_RANGE};c.valuesAreEquivalent=function(F,M){return J(F)&&J(M)||F===M?!0:!1};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/UtilityNetworkAssociations/utils/getFeatureTitle":function(){define(["exports"],function(c){c.getFeatureTitle=function(l){const {attributes:g,sourceLayer:v}=l??{};var D=v&&"displayField"in v?v.displayField:null;D=D?g?.[D]:null;D=null!=D?JSON.stringify(D):null;l=l?.getObjectId()?.toString();return D||
l||""};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations":function(){define("require ../../chunks/tslib.es6 ../../core/maybe ../../core/reactiveUtils ../../core/string ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./FeatureUtilityNetworkAssociations/VisibleElements ./support/FeatureElementInfo ../../chunks/componentsUtils ../support/globalCss ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../support/UtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q){t=class extends w{constructor(n,m){super(n,m);this._featureElementInfo=null;this.onSelectAssociationType=()=>{};this.flowType="feature-utility-network-associations";this.parentFeatureViewModel=this.flowItems=null;this.headingLevel=5;this.viewModel=new q;this.messagesCommon=this.messages=null;this.visibleElements=new h}initialize(){this._featureElementInfo=new x;this.addHandles([v.watch(()=>[this.viewModel.description,this.viewModel.title,this.headingLevel],
()=>this._setupFeatureElementInfo(),v.initial)])}loadDependencies(){return C.loadCalciteComponents({icon:()=>(new Promise((n,m)=>c(["../../chunks/index7"],n,m))).then(n=>n.index),list:()=>new Promise((n,m)=>c(["../../chunks/index16"],n,m)),"list-item":()=>new Promise((n,m)=>c(["../../chunks/index20"],n,m)),loader:()=>new Promise((n,m)=>c(["../../chunks/index32"],n,m)),notice:()=>new Promise((n,m)=>c(["../../chunks/index6"],n,m))})}destroy(){this._featureElementInfo=g.destroyMaybe(this._featureElementInfo)}get description(){return this.viewModel.description}set description(n){this.viewModel.description=
n}get title(){return this.viewModel.title}set title(n){this.viewModel.title=n}render(){const {state:n}=this.viewModel;return K.tsx("div",{class:this.classes("esri-feature-utility-network-associations",u.globalCss.widget)},this._featureElementInfo?.render(),"loading"===n?this._renderLoading():"disabled"===n?this._renderAssociationNotFound():this._renderContent())}_renderStickyLoading(){return"querying"===this.viewModel.state?K.tsx("div",{class:"esri-feature-utility-network-associations__loading-container--sticky",
key:"sticky-loader"},this._renderLoadingIcon()):null}_renderLoadingIcon(){return K.tsx("calcite-loader",{inline:!0,label:this.messagesCommon.loading})}_renderLoading(){return K.tsx("div",{class:"esri-feature-utility-network-associations__loading-container",key:"loading-container"},this._renderLoadingIcon())}_renderAssociationNotFound(){return K.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"association-not-found",kind:"danger",open:!0,scale:"s",width:"full"},K.tsx("div",{slot:"message"},
this.messages?.noAssociations))}_renderAssociationType(n){const {viewModel:m}=this,e=this._getAssociationTypeTitle(n);return K.tsx("calcite-list-item",{description:D.stripHTML(n.description),key:`association-type-${n.type}`,label:D.stripHTML(e),value:n.type,onCalciteListItemSelect:()=>this.onSelectAssociationType({viewModel:m,listType:n,title:e})},K.tsx("calcite-icon",{flipRtl:!0,icon:"chevron-right",scale:"s",slot:"content-end"}))}_renderAssociations(n){const {viewModel:m}=this;return"featureForm"===
m.source||0<m.getFeatureCountForAssociationType(n.type)?this._renderAssociationType(n):void 0}_renderContent(){const {messages:n,viewModel:m}=this,{state:e,associationTypes:k}=m;return K.tsx("div",{class:"esri-feature-utility-network-associations__list",key:"list-container"},"ready"===e?K.tsx("div",null,K.tsx("calcite-list",{displayMode:"flat",label:n?.associationsList},k.map(a=>this._renderAssociations(a)))):null,this._renderStickyLoading())}_getAssociationTypeTitle(n){const {messages:m}=this;if(n.title)return n.title;
switch(n.type){case "attachment":return m.associationsAttachments;case "connectivity":return m.associationsConnectivity;case "structure":return m.associationsStructure;case "content":return m.associationsContents;case "container":return m.associationsContainer}}_setupFeatureElementInfo(){const {headingLevel:n,visibleElements:m}=this,e=m.description&&this.description,k=m.title&&this.title;this._featureElementInfo?.set({description:e,title:k,headingLevel:n})}};l.__decorate([J.property({constructOnly:!0})],
t.prototype,"onSelectAssociationType",void 0);l.__decorate([J.property()],t.prototype,"flowType",void 0);l.__decorate([J.property()],t.prototype,"flowItems",void 0);l.__decorate([J.property()],t.prototype,"parentFeatureViewModel",void 0);l.__decorate([J.property()],t.prototype,"featureVisibleElements",void 0);l.__decorate([J.property()],t.prototype,"description",null);l.__decorate([J.property()],t.prototype,"headingLevel",void 0);l.__decorate([J.property()],t.prototype,"title",null);l.__decorate([J.property({type:q})],
t.prototype,"viewModel",void 0);l.__decorate([J.property(),P.messageBundle("esri/widgets/Feature/t9n/Feature")],t.prototype,"messages",void 0);l.__decorate([J.property(),P.messageBundle("esri/t9n/common")],t.prototype,"messagesCommon",void 0);l.__decorate([J.property({type:h,nonNullable:!0})],t.prototype,"visibleElements",void 0);return t=l.__decorate([p.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociations")],t)})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations/VisibleElements":function(){define("../../../chunks/tslib.es6 ../../../core/Accessor ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(c,l,g,v,D,J,t){l=class extends l{constructor(F){super(F);this.description=this.title=!0}};c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"title",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"description",void 0);return l=c.__decorate([t.subclass("esri.widgets.Feature.FeatureUtilityNetworkAssociations.VisibleElements")],l)})},"esri/widgets/support/UtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel":function(){define("../../../chunks/tslib.es6 ../../../Graphic ../../../core/Accessor ../../../core/Clonable ../../../core/Collection ../../../core/Identifiable ../../../core/promiseUtils ../../../core/ReactiveMap ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../layers/support/layerUtils ../../../rest/networks/support/NetworkElement ../../../rest/support/Query ../../Feature/FeatureUtilityNetworkAssociations/resources ../../Feature/support/featureUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q){g=class extends v.ClonableMixin(J.IdentifiableMixin(g)){constructor(n){super(n);this._loaded=!1;this._queryFeatureCountAbortController=this._queryPageAbortController=this._queryAbortController=null;this.networkSourceIdsInUse=new Set;this.source="popup";this.map=this.layer=this.graphic=this.description=null;this.featureCount=0;this.associationTypes=null;this.showAllEnabled=!1;this.title=null;this.connectivityFeatureCount=this.containerFeatureCount=this.contentFeatureCount=
this.structureFeatureCount=this.attachmentsFeatureCount=0;this._queryOpenAssociationType=async()=>{this.activeAssociationType&&await this._queryDebounced(this.activeAssociationType)};this._cancelQuery=()=>{const {_queryAbortController:m}=this;m&&m.abort();this._queryAbortController=null};this._cancelQueryFeatureCount=()=>{const {_queryFeatureCountAbortController:m}=this;m&&m.abort();this._queryFeatureCountAbortController=null};this._queryController=async m=>{this._cancelQuery();const e=new AbortController;
this._queryAbortController=e;await t.ignoreAbortErrors(this._query(m));this._queryAbortController===e&&(this._queryAbortController=null)};this._queryFeatureCountController=async()=>{this._loaded=!1;this._cancelQueryFeatureCount();const m=new AbortController;this._queryFeatureCountAbortController=m;await t.ignoreAbortErrors(this._queryFeatureCount());this._queryFeatureCountAbortController===m&&(this._queryFeatureCountAbortController=null);this._loaded=!0};this._queryDebounced=t.debounce(this._queryController,
100);this._queryFeatureCountDebounced=t.debounce(this._queryFeatureCountController,100)}initialize(){this.addHandles([M.watch(()=>[this.graphic,this.layer,this.map,this.associationTypes,this.objectId,this.globalId,this.canQuery],()=>this.refresh(),M.initial),M.watch(()=>this.activeAssociationType,n=>this._queryDebounced(n),M.initial)])}destroy(){this._cancelQuery();this._cancelQueryFeatureCount();this._destroyAssociatedFeatureViewModels()}get supportsCacheHint(){return!!this.layer?.capabilities?.query?.supportsCacheHint}get canLoad(){return!!this.map&&
!!this.associationTypes&&"string"===typeof this.globalId}get canQuery(){const n=this.layer?.capabilities?.query;return!!this.associationTypes&&"string"===typeof this.globalId&&!!n?.supportsPagination}set displayCount(n){this._set("displayCount",Math.max(n??3,0))}get displayCount(){return this._get("displayCount")}get objectId(){return(this.objectIdField&&this.graphic?.attributes?.[this.objectIdField])??null}get objectIdField(){return this.layer?.objectIdField||null}get globalId(){return(this.globalIdField&&
this.graphic?.attributes?.[this.globalIdField])??null}get globalIdField(){const {layer:n}=this;return n?.globalIdField}get activeAssociationType(){return this._get("activeAssociationType")}set activeAssociationType(n){n&&!this.associationTypes.includes(n)||this._set("activeAssociationType",n)}get state(){const {_queryAbortController:n,_queryFeatureCountAbortController:m,_queryPageAbortController:e,canQuery:k,_loaded:a,canLoad:b,source:f}=this;return m||b&&!a?"loading":n||e?"querying":!k||"popup"===
f&&0===this.featureCount?"disabled":"ready"}get utilityNetwork(){const {layer:n,map:m}=this;if(!n?.loaded||!m)return null;const e=u.isSubtypeSublayer(n)?n.parent:n;return q.findUtilityNetwork(m,e)}get attachmentsAssociations(){return this._get("attachmentsAssociations")||new D}get structureAssociations(){return this._get("structureAssociations")||new D}get contentAssociations(){return this._get("contentAssociations")||new D}get containerAssociations(){return this._get("containerAssociations")||new D}get connectivityAssociations(){return this._get("connectivityAssociations")||
new D}get associationFeatures(){return this._get("associationFeatures")||new F}get associationViewModels(){return this._get("associationViewModels")||new Map}async refresh(){await this._queryFeatureCountDebounced();await this._queryOpenAssociationType()}getFeatureCountForAssociationType(n){switch(n){case "attachment":return this.attachmentsFeatureCount;case "structure":return this.structureFeatureCount;case "content":return this.contentFeatureCount;case "container":return this.containerFeatureCount;
case "connectivity":return this.connectivityFeatureCount}}_destroyAssociatedFeatureViewModels(){this.associationViewModels.forEach(n=>n.destroyAll())}async _loadUtiltyNetworks(){const n=this.map;if(n){await Promise.allSettled(n.utilityNetworks?.map(async e=>{await e.load()})??[]);var m=this.utilityNetwork;if(m){const e=k=>{"layerId"in k&&m.isUtilityLayer(k)&&(k=m.getSourceIdByLayerId(k.layerId),null!==k&&this.networkSourceIdsInUse.add(k))};this._set("networkSourceIdsInUse",new Set);n.allLayers.forEach(e);
n.allTables.forEach(e)}}}async _findLayersBySourceId(n){const {utilityNetwork:m,map:e}=this;var k=b=>b.url&&b.layerId===a?b.url.replace(/\/\d+$/,"")===m?.featureServiceUrl:!1;await m?.load();const a=m.getLayerIdBySourceId(n);n=e.allLayers.filter(k);k=e.allTables.filter(k);k=n.concat(k).toArray();await Promise.allSettled(k.map(b=>b.load()));return k}_clearAssociations(){this.attachmentsAssociations.removeAll();this.structureAssociations.removeAll();this.contentAssociations.removeAll();this.containerAssociations.removeAll();
this.connectivityAssociations.removeAll()}_clearFeatures(){this.associationFeatures.forEach(n=>n.removeAll());this.associationFeatures.clear()}_getAssociationsByType(n){switch(n){case "attachment":return this.attachmentsAssociations;case "structure":return this.structureAssociations;case "connectivity":return this.connectivityAssociations;case "container":return this.containerAssociations;case "content":return this.contentAssociations}}async _queryLayer(n,m,e,k,a){const b=n.fieldsIndex.get(K.featureUtilityNetworkFields.assetGroup),
f=n.fieldsIndex.get(K.featureUtilityNetworkFields.assetType),z=null!=e,I=null!=k;m="("+m.map(r=>`'${r}'`).join(", ")+")";e=new P({outFields:["*"],cacheHint:this.supportsCacheHint,where:`${n.globalIdField} IN ${m}`+(z?` AND ${b?.name} = ${e}`:"")+(z&&I?` AND ${f?.name} = ${k}`:"")});return await this._queryAll(e,n,{signal:a?.signal})}async _createAssociationFeatureObjects(n,m,e,k,a,b){if(0===n.length)return[];const f=new Map;for(const [I,r]of m){m=await this._findLayersBySourceId(I);for(const y of m)(await this._queryLayer(y,
r,k,a,b)).forEach(H=>{if("popup"===this.source?H.layer&&H.getEffectivePopupTemplate():H.layer){const Q=f.get(H.attributes[y.globalIdField])??[];Q.push(H);f.set(H.attributes[y.globalIdField],Q)}})}const z=[];await Promise.all(n.toArray().map(async I=>{const {fromNetworkElement:r,toNetworkElement:y}=I,H=r.globalId===e?y:r,Q=f.get(H.globalId)??[];await Promise.all(Q.map(async A=>{const N=this.utilityNetwork?.getTerminalById(H?.terminalId)?.name;if(A.layer&&"getFeatureTitle"in A.layer){const G=await A.layer.getFeatureTitle(A);
z.push({title:G,association:I,feature:A,terminalName:N})}else z.push({association:I,feature:A,terminalName:N})}))}));return z}_parseFeatureObjects(n,m){n.forEach(e=>{const k=(e?.feature).layer,a=m.get(k)??new D;a.add(e);m.set(k,a)})}async _queryAll(n,m,e){const k=[];let a=0,b=!1;n.num=m.sourceJSON?.maxRecordCount??2E3;do{n.start=a;const f=await m.queryFeatures(n,e);k.push(...f.features);(b=f.exceededTransferLimit)&&(a+=f.features.length)}while(b);return k}async _queryAssociations(n){const {layer:m,
globalId:e,associationTypes:k,utilityNetwork:a,canQuery:b}=this;await Promise.allSettled([m?.load(),a?.load()]);this._clearAssociations();if(b&&m&&k&&a&&e){var f=u.isSubtypeSublayer(m)?m.parent:m;f=new B({globalId:e,networkSourceId:a.getSourceIdByLayerId(f.layerId)});var z=new Set;k.forEach(y=>{switch(y.type){case "attachment":case "structure":z.add("attachment");break;case "container":case "content":z.add("containment");break;case "connectivity":z.add("connectivity"),z.add("junction-junction-connectivity"),
z.add("junction-edge-from-connectivity"),z.add("junction-edge-midspan-connectivity"),z.add("junction-edge-to-connectivity")}});f=await a?.queryAssociations({elements:[f],types:Array.from(z)},{signal:n?.signal});var I=new Map,r=new Map;k.forEach(y=>{r.set(y.type,y);I.set(y.type,[])});f.forEach(y=>{const {toNetworkElement:H,fromNetworkElement:Q}=y;switch(y.associationType){case "connectivity":case "junction-junction-connectivity":case "junction-edge-from-connectivity":case "junction-edge-midspan-connectivity":case "junction-edge-to-connectivity":if(Q?.globalId===
e){if(this._shouldDiscardNetworkElement(H,"connectivity",r))break;I.get("connectivity")?.push(H.globalId)}else{if(this._shouldDiscardNetworkElement(Q,"connectivity",r))break;I.get("connectivity")?.push(Q.globalId)}this.connectivityAssociations.add(y);break;case "containment":Q?.globalId===e?this._shouldDiscardNetworkElement(H,"content",r)||(I.get("content")?.push(H.globalId),this.contentAssociations.add(y)):this._shouldDiscardNetworkElement(Q,"container",r)||(I.get("container")?.push(Q.globalId),
this.containerAssociations.add(y));break;case "attachment":Q?.globalId===e?this._shouldDiscardNetworkElement(H,"attachment",r)||(I.get("attachment")?.push(H.globalId),this.attachmentsAssociations.add(y)):this._shouldDiscardNetworkElement(Q,"structure",r)||(I.get("structure")?.push(Q.globalId),this.structureAssociations.add(y))}});f=k.map(async y=>{const {associatedNetworkSourceId:H,associatedAssetGroup:Q,associatedAssetType:A}=y;var N=I.get(y.type);N=null!=Q?await this._countAssociatedFeatures(H,
N,Q,A,n):N.length;switch(y.type){case "attachment":this._set("attachmentsFeatureCount",N);break;case "structure":this._set("structureFeatureCount",N);break;case "content":this._set("contentFeatureCount",N);break;case "container":this._set("containerFeatureCount",N);break;case "connectivity":this._set("connectivityFeatureCount",N)}});await Promise.allSettled(f)}}async _countAssociatedFeatureCount(n,m,e,k,a){const b=n.fieldsIndex.get(K.featureUtilityNetworkFields.assetGroup),f=n.fieldsIndex.get(K.featureUtilityNetworkFields.assetType),
z=null!=k;m="("+m.map(I=>`'${I}'`).join(", ")+")";return n.queryFeatureCount({where:`${n.globalIdField} IN ${m}`+` AND ${b?.name} = ${e}`+(z?` AND ${f?.name} = ${k}`:""),outFields:["*"],returnGeometry:!1},{signal:a?.signal})}async _countAssociatedFeatures(n,m,e,k,a){if(0===m.length)return 0;n=(await this._findLayersBySourceId(n)).map(async b=>this._countAssociatedFeatureCount(b,m,e,k,a));return(await Promise.all(n)).reduce((b,f)=>b+f,0)}async _queryAssociatedFeatures(n,m){const {layer:e,globalId:k,
associationTypes:a,utilityNetwork:b,canQuery:f,associationFeatures:z}=this;await Promise.allSettled([e?.load(),b?.load()]);if(f&&e&&a&&b){var I=this._getAssociationsByType(n.type),{associatedAssetGroup:r,associatedAssetType:y}=n,H=new Map;I.forEach(Q=>{const {fromNetworkElement:A,toNetworkElement:N}=Q,{networkSourceId:G,elementGlobalId:d}=A.globalId===k?{networkSourceId:N.networkSourceId,elementGlobalId:N.globalId}:{networkSourceId:A.networkSourceId,elementGlobalId:A.globalId};Q=H.get(G)||[];Q.push(d);
H.set(G,Q)});n=await this._createAssociationFeatureObjects(I,H,k,r,y,m);this._parseFeatureObjects(n,z)}}async _queryFeatureCount(){await this._loadUtiltyNetworks();const {_queryFeatureCountAbortController:n,canQuery:m}=this;m?(await this._queryAssociations(n),this._set("featureCount",this.attachmentsFeatureCount+this.structureFeatureCount+this.contentFeatureCount+this.containerFeatureCount+this.connectivityFeatureCount)):this._set("featureCount",0)}async _query(n){if(n){await this._loadUtiltyNetworks();
var {_queryAbortController:m}=this;this._destroyAssociatedFeatureViewModels();this._clearFeatures();0!==this.featureCount&&(this.destroyed||await this._queryAssociatedFeatures(n,{signal:m?.signal}))}}_shouldDiscardNetworkElement(n,m,e){if(!n)return!1;var {networkSourceIdsInUse:k}=this;({networkSourceId:n}=n);m=e.get(m)?.associatedNetworkSourceId;k=k.has(n);return null!=m&&m!==n||!k}};c.__decorate([p.property()],g.prototype,"_loaded",void 0);c.__decorate([p.property()],g.prototype,"_queryAbortController",
void 0);c.__decorate([p.property()],g.prototype,"_queryPageAbortController",void 0);c.__decorate([p.property()],g.prototype,"_queryFeatureCountAbortController",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,"supportsCacheHint",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"canLoad",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"canQuery",null);c.__decorate([p.property()],g.prototype,"networkSourceIdsInUse",void 0);c.__decorate([p.property({constructOnly:!0})],
g.prototype,"source",void 0);c.__decorate([p.property()],g.prototype,"description",void 0);c.__decorate([p.property({value:3})],g.prototype,"displayCount",null);c.__decorate([p.property({type:l})],g.prototype,"graphic",void 0);c.__decorate([p.property()],g.prototype,"layer",void 0);c.__decorate([p.property()],g.prototype,"map",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,"objectId",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"objectIdField",null);c.__decorate([p.property({readOnly:!0})],
g.prototype,"globalId",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"globalIdField",null);c.__decorate([p.property()],g.prototype,"featureCount",void 0);c.__decorate([p.property()],g.prototype,"associationTypes",void 0);c.__decorate([p.property()],g.prototype,"activeAssociationType",null);c.__decorate([p.property()],g.prototype,"showAllEnabled",void 0);c.__decorate([p.property()],g.prototype,"state",null);c.__decorate([p.property()],g.prototype,"title",void 0);c.__decorate([p.property({readOnly:!0})],
g.prototype,"utilityNetwork",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"attachmentsFeatureCount",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,"structureFeatureCount",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,"attachmentsAssociations",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"structureAssociations",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"contentFeatureCount",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,
"containerFeatureCount",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,"contentAssociations",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"containerAssociations",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"connectivityFeatureCount",void 0);c.__decorate([p.property({readOnly:!0})],g.prototype,"connectivityAssociations",null);c.__decorate([p.property({readOnly:!0})],g.prototype,"associationFeatures",null);c.__decorate([p.property({readOnly:!0})],g.prototype,
"associationViewModels",null);return g=c.__decorate([C.subclass("esri.widgets.support.UtilityNetworkAssociations.FeatureUtilityNetworkAssociationsViewModel")],g)})},"esri/rest/networks/support/NetworkElement":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),function(c,l,g,v,D,J,t){l=class extends l{constructor(F){super(F);
this.terminalId=this.positionTo=this.positionFrom=this.objectId=this.networkSourceId=this.globalId=this.assetTypeCode=this.assetGroupCode=null}};c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"assetGroupCode",void 0);c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"assetTypeCode",void 0);c.__decorate([g.property({type:String,json:{write:!0}})],l.prototype,"globalId",void 0);c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"networkSourceId",
void 0);c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"objectId",void 0);c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"positionFrom",void 0);c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"positionTo",void 0);c.__decorate([g.property({type:Number,json:{write:!0}})],l.prototype,"terminalId",void 0);return l=c.__decorate([t.subclass("esri.rest.networks.support.NetworkElement")],l)})},"esri/widgets/Feature/FeatureUtilityNetworkAssociations/resources":function(){define(["exports"],
function(c){c.featureUtilityNetworkFields={fromGlobalId:"fromglobalid",fromNetworkSourceId:"fromnetworksourceid",fromTerminalId:"fromterminalid",toGlobalId:"toglobalid",toNetworkSourceId:"tonetworksourceid",toTerminalId:"toterminalid",associationType:"associationtype",globalId:"globalid",status:"status",isContentVisible:"iscontentvisible",percentAlong:"percentalong",assetGroup:"assetgroup",assetType:"assettype"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/FeatureViewModel":function(){define("../../chunks/tslib.es6 ../../Graphic ../../arcade/featureset/support/FeatureSetQueryInterceptor ../../core/Accessor ../../core/arrayUtils ../../core/asyncUtils ../../core/Collection ../../core/Identifiable ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/throttle ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/cast ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../popup/content/TextContent ../../support/popupUtils ../../time/constants ./FeatureAttachments/FeatureAttachmentsViewModel ./FeatureContent/FeatureContentViewModel ./FeatureExpression/FeatureExpressionViewModel ./FeatureFields/FeatureFieldsViewModel ./FeatureMedia/FeatureMediaViewModel ./FeatureRelationship/FeatureRelationshipViewModel ./support/arcadeFeatureUtils ./support/featureUtils ./support/relatedFeatureUtils ../support/UtilityNetworkAssociations/FeatureUtilityNetworkAssociationsViewModel".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e,k,a,b,f,z,I,r,y,H,Q){var A;const N={attachmentsContent:!0,chartAnimation:!0,customContent:!0,expressionContent:!0,fieldsContent:!0,mediaContent:!0,textContent:!0,relationshipContent:!0,utilityNetworkAssociationsContent:!0};v=A=class extends F.IdentifiableMixin(v){constructor(G){super(G);this._graphicExpressionAttributes=this._expressionAttributes=this._associationVMAbortController=this._evaluateExpressionAttributesTask=this._graphicChangedTask=
this._error=null;this.abilities={...N};this.content=null;this.contentViewModels=[];this.description=null;this.defaultPopupTemplateEnabled=!1;this.location=this.lastEditInfo=this.formattedAttributes=null;this.relatedInfos=new Map;this.title="";this.view=null;this._graphicChangedThrottled=x.throttle(this._graphicChanged,()=>this.notifyChange("waitingForContent"),1,this);this._isAllowedContentType=d=>{const {abilities:E}=this;return"attachments"===d.type&&!!E.attachmentsContent||"custom"===d.type&&!!E.customContent||
"fields"===d.type&&!!E.fieldsContent||"media"===d.type&&!!E.mediaContent||"text"===d.type&&!!E.textContent||"expression"===d.type&&!!E.expressionContent||"relationship"===d.type&&!!E.relationshipContent||"utility-network-associations"===d.type&&!!E.utilityNetworkAssociationsContent};this._evaluateExpressionAttributesThrottled=x.throttle(this._evaluateExpressionAttributes,()=>this.notifyChange("waitingForContent"),1,this);this.addHandles([h.watch(()=>[this.graphic,this._effectivePopupTemplate,this.abilities,
this.timeZone],()=>this._graphicChangedThrottled(),h.initial),h.when(()=>{if(!this._graphicChangedTask?.finished||null==this._graphicChangedTask.value)return null;const d=this._graphicChangedTask.value,E=d?.expressionInfos?.dependencies;return[d,E?.has("view-scale")?this.view?.scale:null,E?.has("view-time-extent")?this.view?.timeExtent?.start:null,E?.has("view-time-extent")?this.view?.timeExtent?.end:null]},([d])=>this._evaluateExpressionAttributesThrottled(d))])}initialize(){this.addHandles([this._graphicChangedThrottled,
this._evaluateExpressionAttributesThrottled])}destroy(){this._clear();this._graphicChangedTask=p.abortMaybe(this._graphicChangedTask);this._evaluateExpressionAttributesTask=p.abortMaybe(this._evaluateExpressionAttributesTask);this.graphic=this._error=null;this._destroyContentViewModels();this.relatedInfos.clear()}get _effectivePopupTemplate(){return null!=this.graphic?this.graphic.getEffectivePopupTemplate(this.defaultPopupTemplateEnabled):null}get _fieldInfoMap(){return y.createFieldInfoMap(y.getAllFieldInfos(this._effectivePopupTemplate),
this._sourceLayer)}get _sourceLayer(){return y.getSourceLayer(this.graphic)}castAbilities(G){return{...N,...G}}get isTable(){return this._sourceLayer?.isTable||!1}get state(){return this.graphic?this._error?"error":this.waitingForContent?"loading":"ready":"disabled"}set graphic(G){this._set("graphic",G?.clone()??null)}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(G){this._override("spatialReference",G)}get timeZone(){return this.view?.timeZone??e.system}set timeZone(G){this._overrideIfSome("timeZone",
G)}get map(){return this.view?.map||null}set map(G){this._override("map",G)}get waitingForContent(){const {_graphicChangedThrottled:G,_evaluateExpressionAttributesThrottled:d,_graphicChangedTask:E,_evaluateExpressionAttributesTask:L,_associationVMAbortController:R}=this;return G.hasPendingUpdates()||d.hasPendingUpdates()||null!=E&&!E.finished||null!=L&&!L.finished||!!R}setActiveMedia(G,d){G=this.contentViewModels[G];G instanceof z&&G.setActiveMedia(d)}nextMedia(G){G=this.contentViewModels[G];G instanceof
z&&G.next()}previousMedia(G){G=this.contentViewModels[G];G instanceof z&&G.previous()}async updateGeometry(){const {graphic:G,spatialReference:d,_sourceLayer:E}=this;await E?.load();var L=E?.objectIdField;L&&G&&E&&(L=G?.attributes?.[L],null!=L&&(L=[L],!G.geometry&&(L=(await y.querySourceLayer({layer:E,graphic:G,outFields:[],objectIds:L,returnGeometry:!0,spatialReference:d}))?.geometry)))&&(G.geometry=L)}_clear(){this._set("title","");this._set("content",null);this._set("formattedAttributes",null)}_graphicChanged(){this._evaluateExpressionAttributesTask=
p.abortMaybe(this._evaluateExpressionAttributesTask);this._graphicChangedTask=p.abortMaybe(this._graphicChangedTask);this._graphicChangedTask=J.createTask(async G=>{this._error=null;this._clear();const {graphic:d}=this;try{if(!d)return null;const {_sourceLayer:E,_effectivePopupTemplate:L}=this;await y.queryUpdatedFeature({graphic:d,popupTemplate:L,layer:E,spatialReference:this.spatialReference},{signal:G});const [{value:R},{value:U}]=await w.eachAlways([this._getContent(),this._getTitle()]),[,{value:V}]=
await w.eachAlways([this._checkForRelatedFeatures({signal:G}),r.compileExpressionInfos(L?.expressionInfos,d)]);return{expressionInfos:V,content:R,title:U}}catch(E){throw w.isAbortError(E)||(this._error=E,M.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:E,graphic:d,popupTemplate:this._effectivePopupTemplate})),E;}})}_compileContentElement(G,d){if("attachments"===G.type)return this._compileAttachments(G,d);if("custom"===G.type)return this._compileCustom(G,
d);if("fields"===G.type)return this._compileFields(G,d);if("media"===G.type)return this._compileMedia(G,d);if("text"===G.type)return this._compileText(G,d);if("expression"===G.type)return this._compileExpression(G,d);if("relationship"===G.type)return this._compileRelationship(G,d);if("utility-network-associations"===G.type)return this._compileUtilityNetworkAssociation(G,d)}_compileContent(G){this._destroyContentViewModels();if(this.graphic)return Array.isArray(G)?G.filter(this._isAllowedContentType).map((d,
E)=>this._compileContentElement(d,E)).filter(D.isSome):"string"===typeof G?this._compileText(new n({text:G}),0).text:G}_destroyContentViewModels(){this.removeHandles("relationship-view-models");this.removeHandles("content-view-models");this.contentViewModels.forEach(G=>G&&!G.destroyed&&G.destroy());this._set("contentViewModels",[])}_matchesFeature(G,d){G=G?.graphic?.getObjectId();d=d?.getObjectId();return null!=G&&null!=d&&G===d}_setRelatedFeaturesViewModels({relatedFeatureViewModels:G,relatedFeatures:d,
map:E}){const {view:L,spatialReference:R,timeZone:U}=this;d?.filter(Boolean).forEach(V=>{G.some(X=>this._matchesFeature(X,V))||G.add(new A({abilities:{relationshipContent:!1},map:E,view:L,spatialReference:R,timeZone:U,graphic:V}))});G.forEach(V=>{d?.find(X=>this._matchesFeature(V,X))||G.remove(V)})}_setExpressionContentVM(G,d){const E=this.formattedAttributes,{contentElement:L,contentElementViewModel:R}=G;G=L?.type;R&&G&&("fields"===G&&(this._createFieldsFormattedAttributes({contentElement:L,contentElementIndex:d,
formattedAttributes:E}),R.set(this._createFieldsVMParams(L,d))),"media"===G&&(this._createMediaFormattedAttributes({contentElement:L,contentElementIndex:d,formattedAttributes:E}),R.set(this._createMediaVMParams(L,d))),"text"===G&&R.set(this._createTextVMParams(L)))}_compileRelationship(G,d){const {displayCount:E,orderByFields:L,relationshipId:R,title:U,description:V}=G,{_sourceLayer:X,graphic:Y,map:aa}=this;if(y.isRelatableFeatureSupportedLayer(X)){var W=new I({displayCount:E,graphic:Y,orderByFields:L,
relationshipId:R,layer:X,map:aa,...this._compileTitleAndDesc({title:U,description:V})});this.contentViewModels[d]=W;this.addHandles(h.on(()=>W.relatedFeatures,"change",()=>this._setRelatedFeaturesViewModels(W)),"relationship-view-models");return G}}_matchesGlobalFeature(G,d){G=G?.association.globalId;d=d?.association.globalId;return null!=G&&null!=d&&G===d}async _setUpUtilityNetworkAssociationsViewModels(G,d,E){const {view:L,spatialReference:R,timeZone:U}=this;G.forEach((X,Y)=>{const aa=d.get(Y);
aa?X.forEach(W=>{aa.find(ca=>this._matchesGlobalFeature(W,ca))||(X.remove(W),0===X.length&&G.delete(Y))}):(X.removeAll(),G.delete(Y))});d.forEach((X,Y)=>{const aa=G.get(Y)||new t;X?.filter(Boolean).forEach(W=>{aa.some(ca=>this._matchesGlobalFeature(ca,W))||aa.add({association:W.association,featureViewModel:new A({abilities:{utilityNetworkAssociationsContent:!1},map:E,view:L,spatialReference:R,timeZone:U,graphic:W.feature}),terminalName:W.terminalName})});G.set(Y,aa)});const V=new AbortController;
this._associationVMAbortController=V;await this._sortListObjectsByTitle(G,{signal:V.signal});this._associationVMAbortController===V&&(this._associationVMAbortController=null)}async _sortListObjectsByTitle(G,d){for(const E of G.values())G=E.map(L=>h.whenOnce(()=>"ready"===L.featureViewModel.state,d?.signal)),await Promise.all(G),E.sort(this._compareByFeatureTitle)}_compareByFeatureTitle(G,d){G=m.getFeaturePopupTitle(G.featureViewModel);d=m.getFeaturePopupTitle(d.featureViewModel);return G.localeCompare(d,
void 0,{numeric:!0})}_compileUtilityNetworkAssociation(G,d){const {displayCount:E,title:L,description:R,associationTypes:U}=G,{_sourceLayer:V,graphic:X,map:Y}=this;if(y.isAssociatedFeatureSupportedLayer(V)){var aa=new Q({graphic:X,displayCount:E,associationTypes:U,layer:V,map:Y,...this._compileTitleAndDesc({title:L,description:R})});this.contentViewModels[d]=aa;this.addHandles([h.watch(()=>aa.associationFeatures.values(),()=>this._setUpUtilityNetworkAssociationsViewModels(aa.associationViewModels,
aa.associationFeatures,aa.map))],"association-view-models");return G}}_compileExpression(G,d){const {expressionInfo:E}=G,{graphic:L,map:R,spatialReference:U,view:V,location:X}=this,Y=new b({expressionInfo:E,graphic:L,interceptor:A.interceptor,map:R,spatialReference:U,view:V,location:X});this.contentViewModels[d]=Y;this.addHandles(h.watch(()=>Y.contentElementViewModel,()=>this._setExpressionContentVM(Y,d),h.initial),"content-view-models");return G}_compileAttachments(G,d){const {graphic:E}=this,{description:L,
title:R,orderByFields:U}=G;this.contentViewModels[d]=new k({graphic:E,orderByFields:U,...this._compileTitleAndDesc({title:R,description:L})});return G}_compileCustom(G,d){const {graphic:E}=this,{creator:L,destroyer:R}=G;this.contentViewModels[d]=new a({graphic:E,creator:L,destroyer:R});return G}_compileTitleAndDesc({title:G,description:d}){const {_fieldInfoMap:E,_sourceLayer:L,graphic:R,formattedAttributes:U}=this,V=R?.attributes,X=this._expressionAttributes,Y=U.global;return{title:y.substituteFieldsInLinksAndAttributes({attributes:V,
fieldInfoMap:E,globalAttributes:Y,expressionAttributes:X,layer:L,text:G}),description:y.substituteFieldsInLinksAndAttributes({attributes:V,fieldInfoMap:E,globalAttributes:Y,expressionAttributes:X,layer:L,text:d})}}_createFieldsVMParams(G,d){const E=this._effectivePopupTemplate,L=this.formattedAttributes,R={...L?.global,...L?.content[d]};d=(G?.fieldInfos||E?.fieldInfos)?.filter(({fieldName:X})=>!!X&&(y.isExpressionField(X)||y.isRelatedField(X)||R.hasOwnProperty(X)));const {description:U,title:V}=G;
return{attributes:R,expressionInfos:E?.expressionInfos,fieldInfos:d,...this._compileTitleAndDesc({title:V,description:U})}}_compileFields(G,d){const E=G.clone();G=new f(this._createFieldsVMParams(G,d));this.contentViewModels[d]=G;E.fieldInfos=G.formattedFieldInfos.slice();return E}_createMediaVMParams(G,d){const {abilities:E,graphic:L,_fieldInfoMap:R,_effectivePopupTemplate:U,relatedInfos:V,_sourceLayer:X,_expressionAttributes:Y}=this,aa=this.formattedAttributes,W=L?.attributes??{},{description:ca,
mediaInfos:fa,title:da}=G;return{abilities:{chartAnimation:E.chartAnimation},activeMediaInfoIndex:G.activeMediaInfoIndex||0,attributes:W,isAggregate:L?.isAggregate,layer:X,fieldInfoMap:R,formattedAttributes:{...aa?.global,...aa?.content[d]},expressionAttributes:Y,mediaInfos:fa,popupTemplate:U,relatedInfos:V,...this._compileTitleAndDesc({title:da,description:ca})}}_compileMedia(G,d){const E=G.clone();G=new z(this._createMediaVMParams(G,d));E.mediaInfos=G.formattedMediaInfos.slice();this.contentViewModels[d]=
G;return E}_createTextVMParams(G){const {graphic:d,_fieldInfoMap:E,_sourceLayer:L,_expressionAttributes:R}=this;G&&G.text&&(G.text=y.substituteFieldsInLinksAndAttributes({attributes:d?.attributes??{},fieldInfoMap:E,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:R,layer:L,text:G.text}));return{graphic:d,creator:G.text}}_compileText(G,d){G=G.clone();this.contentViewModels[d]=new a(this._createTextVMParams(G));return G}_compileLastEditInfo(){const {_effectivePopupTemplate:G,
_sourceLayer:d,graphic:E,timeZone:L}=this;if(G){var {lastEditInfoEnabled:R}=G,U=d?.editFieldsInfo;if(R&&U)return y.formatEditInfo(U,E?.attributes,L,d)}}_compileTitle(G){const {_fieldInfoMap:d,_sourceLayer:E,graphic:L,_expressionAttributes:R}=this;return y.substituteFieldsInLinksAndAttributes({attributes:L?.attributes??{},fieldInfoMap:d,globalAttributes:this.formattedAttributes?.global??{},expressionAttributes:R,layer:E,text:G})}async _getTitle(){const {_effectivePopupTemplate:G,graphic:d}=this;return d?
y.graphicCallback({type:"title",value:G?.title,event:{graphic:d}}):null}async _getContent(){const {_effectivePopupTemplate:G,graphic:d}=this;return d?y.graphicCallback({type:"content",value:G?.content,event:{graphic:d}}):null}_evaluateExpressionAttributes({title:G,content:d,expressionInfos:E}){this._evaluateExpressionAttributesTask=p.abortMaybe(this._evaluateExpressionAttributesTask);this._evaluateExpressionAttributesTask=J.createTask(async L=>{const {graphic:R,map:U,view:V,spatialReference:X,location:Y}=
this;try{if(R){if(null!=E){const W=[];for(const [ca,fa]of E.expressions.entries())null!=fa?W.push(fa.evaluate({graphic:R,interceptor:A.interceptor,location:Y,map:U,options:{signal:L},spatialReference:X,view:V}).then(da=>[ca,r.formatArcadeValue(da)]).catch(()=>[ca,void 0])):W.push(Promise.resolve([ca,void 0]));var aa=Object.fromEntries(await Promise.all(W));w.throwIfAborted(L)}this._expressionAttributes=aa;this._graphicExpressionAttributes={...R.attributes,...aa};this._set("formattedAttributes",this._createFormattedAttributes(d));
this._set("title",this._compileTitle(G));this._set("lastEditInfo",this._compileLastEditInfo()||null);this._set("content",this._compileContent(d)||null)}}catch(W){w.isAbortError(W)||(this._error=W,M.getLogger(this).error("error","The popupTemplate could not be displayed for this feature.",{error:W,graphic:R,popupTemplate:this._effectivePopupTemplate}))}})}_createMediaFormattedAttributes({contentElement:G,contentElementIndex:d,formattedAttributes:E}){const {_effectivePopupTemplate:L,graphic:R,relatedInfos:U,
_sourceLayer:V,_fieldInfoMap:X,_graphicExpressionAttributes:Y,timeZone:aa}=this;E.content[d]=y.formatAttributes({fieldInfos:L?.fieldInfos,graphic:R,attributes:{...Y,...G.attributes},layer:V,fieldInfoMap:X,relatedInfos:U,timeZone:aa})}_createFieldsFormattedAttributes({contentElement:G,contentElementIndex:d,formattedAttributes:E}){if(G.fieldInfos){const {graphic:L,relatedInfos:R,_sourceLayer:U,_fieldInfoMap:V,_graphicExpressionAttributes:X,timeZone:Y}=this;E.content[d]=y.formatAttributes({fieldInfos:G.fieldInfos,
graphic:L,attributes:{...X,...G.attributes},layer:U,fieldInfoMap:V,relatedInfos:R,timeZone:Y})}}_createFormattedAttributes(G){const {_effectivePopupTemplate:d,graphic:E,relatedInfos:L,_sourceLayer:R,_fieldInfoMap:U,_graphicExpressionAttributes:V,timeZone:X}=this,Y={global:y.formatAttributes({fieldInfos:d?.fieldInfos,graphic:E,attributes:V,layer:R,fieldInfoMap:U,relatedInfos:L,timeZone:X}),content:[]};Array.isArray(G)&&G.forEach((aa,W)=>{"fields"===aa.type&&this._createFieldsFormattedAttributes({contentElement:aa,
contentElementIndex:W,formattedAttributes:Y});"media"===aa.type&&this._createMediaFormattedAttributes({contentElement:aa,contentElementIndex:W,formattedAttributes:Y})});return Y}_checkForRelatedFeatures(G){const {graphic:d,_effectivePopupTemplate:E}=this;return this._queryRelatedInfos(d,y.getAllFieldInfos(E),G)}async _queryRelatedInfos(G,d,E){const {relatedInfos:L,_sourceLayer:R}=this;L.clear();const U=null!=R?.associatedLayer?await R?.associatedLayer.load(E):R;if(U&&G&&d.filter(Y=>!!Y.fieldName&&
y.isRelatedField(Y.fieldName))?.length){d.forEach(Y=>this._configureRelatedInfo(Y,U));var V=await H.queryLayerInfos({relatedInfos:L,layer:U},E);Object.keys(V).forEach(Y=>{const aa=L.get(Y.toString());Y=V[Y]?.value;aa&&Y&&(aa.layerInfo=Y.data)});var X=await H.queryRelatedFeatures({graphic:G,relatedInfos:L,layer:U},E);Object.keys(X).forEach(Y=>{H.setRelatedFeatures(X[Y]?.value,L.get(Y.toString()))})}}_configureRelatedInfo(G,d){const {relatedInfos:E}=this,L=H.getRelatedFieldInfo(G.fieldName||"");if(L){var {layerId:R,
fieldName:U}=L;R&&(d=E.get(R.toString())||H.createRelatedInfo(R,d))&&(H.updateRelatedInfo({relatedInfo:d,fieldName:U,fieldInfo:G}),this.relatedInfos.set(R,d))}}};v.interceptor=new g.FeatureSetQueryInterceptor(y.preLayerQueryCallback,y.preRequestCallback);c.__decorate([C.property()],v.prototype,"_error",void 0);c.__decorate([C.property()],v.prototype,"_graphicChangedTask",void 0);c.__decorate([C.property()],v.prototype,"_evaluateExpressionAttributesTask",void 0);c.__decorate([C.property()],v.prototype,
"_associationVMAbortController",void 0);c.__decorate([C.property({readOnly:!0})],v.prototype,"_effectivePopupTemplate",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"_fieldInfoMap",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"_sourceLayer",null);c.__decorate([C.property()],v.prototype,"abilities",void 0);c.__decorate([u.cast("abilities")],v.prototype,"castAbilities",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"content",void 0);c.__decorate([C.property({readOnly:!0})],
v.prototype,"contentViewModels",void 0);c.__decorate([C.property()],v.prototype,"description",void 0);c.__decorate([C.property({type:Boolean})],v.prototype,"defaultPopupTemplateEnabled",void 0);c.__decorate([C.property({readOnly:!0})],v.prototype,"isTable",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"state",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"formattedAttributes",void 0);c.__decorate([C.property({type:l,value:null})],v.prototype,"graphic",null);c.__decorate([C.property({readOnly:!0})],
v.prototype,"lastEditInfo",void 0);c.__decorate([C.property({type:K})],v.prototype,"location",void 0);c.__decorate([C.property({readOnly:!0})],v.prototype,"relatedInfos",void 0);c.__decorate([C.property({type:q})],v.prototype,"spatialReference",null);c.__decorate([C.property()],v.prototype,"timeZone",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"title",void 0);c.__decorate([C.property()],v.prototype,"map",null);c.__decorate([C.property({readOnly:!0})],v.prototype,"waitingForContent",
null);c.__decorate([C.property()],v.prototype,"view",void 0);return v=A=c.__decorate([P.subclass("esri.widgets.Feature.FeatureViewModel")],v)})},"esri/arcade/featureset/support/FeatureSetQueryInterceptor":function(){define(["exports"],function(c){class l{constructor(g,v){this.preLayerQueryCallback=g;this.preRequestCallback=v;this.preLayerQueryCallback||(this.preLayerQueryCallback=D=>{});this.preRequestCallback||(this.preLayerQueryCallback=D=>{})}}c.FeatureSetQueryInterceptor=l;Object.defineProperty(c,
Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/resources":function(){define(["exports"],function(c){c.css={base:"esri-feature",container:"esri-feature__size-container",title:"esri-feature__title",main:"esri-feature__main-container",btn:"esri-feature__button",icon:"esri-feature__icon",content:"esri-feature__content",contentNode:"esri-feature__content-node",contentNodeText:"esri-feature__content-node--text",contentElement:"esri-feature__content-element",text:"esri-feature__text",lastEditedInfo:"esri-feature__last-edited-info",
fields:"esri-feature__fields",fieldHeader:"esri-feature__field-header",fieldData:"esri-feature__field-data",fieldDataDate:"esri-feature__field-data--date",loadingSpinnerContainer:"esri-feature__loading-container"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Feature/support/FeatureContentMixin":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Logger ../../../core/has ../../../core/RandomLCG ../../../core/Error ../../../core/accessorSupport/decorators/subclass ../resources ../../support/widget ../../support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p){c.FeatureContentMixin=w=>{w=class extends w{constructor(){super(...arguments);this.renderNodeContent=h=>M.isWidget(h)&&!h.destroyed?p.tsx("div",{class:F.css.contentNode,key:h},h.render()):h instanceof HTMLElement?p.tsx("div",{afterCreate:this._attachToNode,bind:h,class:F.css.contentNode,key:h}):M.hasDomNode(h)?p.tsx("div",{afterCreate:this._attachToNode,bind:h.domNode,class:F.css.contentNode,key:h}):null}_attachToNode(h){h.appendChild(this)}};return w=l.__decorate([t.subclass("esri.widgets.Feature.support.FeatureContentMixin")],
w)};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Spinner":function(){define("../chunks/tslib.es6 ../core/promiseUtils ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/has ../core/Logger ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Spinner/SpinnerViewModel ./support/widgetUtils ./support/jsxFactory".split(" "),function(c,l,g,v,D,J,t,F,M,p,w,h){D=class extends M{constructor(x,C){super(x,C);this._animationDelay=500;
this._animationPromise=null;this.viewModel=new p}initialize(){this.addHandles(g.watch(()=>this.visible,x=>this._visibleChange(x)))}destroy(){this._animationPromise=null}get location(){return this.viewModel.location}set location(x){this.viewModel.location=x}get view(){return this.viewModel.view}set view(x){this.viewModel.view=x}get visible(){return this.viewModel.visible}set visible(x){this.viewModel.visible=x}show(x){const {location:C,promise:u}=x??{};C&&(this.viewModel.location=C);this.visible=!0;
x=()=>this.hide();u&&u.catch(()=>{}).then(x)}hide(){this.visible=!1}render(){var {visible:x}=this,{screenLocation:C}=this.viewModel;C=!!C;x={["esri-spinner--start"]:x&&C,["esri-spinner--finish"]:!x&&C};C=this._getPositionStyles();return h.tsx("div",{class:this.classes("esri-spinner",x),styles:C})}_visibleChange(x){if(x)this.viewModel.screenLocationEnabled=!0;else{var C=l.after(this._animationDelay);this._animationPromise=C;C.catch(()=>{}).then(()=>{this._animationPromise===C&&(this.viewModel.screenLocationEnabled=
!1,this._animationPromise=null)})}}_getPositionStyles(){const {screenLocation:x,view:C}=this.viewModel;if(null==C||null==x)return{};const {padding:u}=C;return{left:`${x.x-u.left}px`,top:`${x.y-u.top}px`}}};c.__decorate([v.property()],D.prototype,"location",null);c.__decorate([v.property()],D.prototype,"view",null);c.__decorate([v.property({type:p})],D.prototype,"viewModel",void 0);c.__decorate([v.property()],D.prototype,"visible",null);return D=c.__decorate([F.subclass("esri.widgets.Spinner")],D)})},
"esri/widgets/Spinner/SpinnerViewModel":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../support/AnchorElementViewModel".split(" "),function(c,l,g,v,D,J,t){g=class extends t{constructor(F){super(F);this.visible=!1}};c.__decorate([l.property()],g.prototype,"visible",void 0);return g=c.__decorate([J.subclass("esri.widgets.Spinner.SpinnerViewModel")],g)})},"esri/widgets/support/AnchorElementViewModel":function(){define("../../chunks/tslib.es6 ../../core/Evented ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/projection".split(" "),
function(c,l,g,v,D,J,t,F,M){l=class extends l.EventedAccessor{constructor(p){super(p);this.location=null;this.screenLocationEnabled=!1;this.view=null;this.addHandles([g.when(()=>{const w=this.screenLocationEnabled?this.view:null;return w?[w.size,"3d"===w.type?w.camera:w.viewpoint]:null},()=>this.notifyChange("screenLocation")),g.watch(()=>this.screenLocation,(w,h)=>{null!=w&&null!=h&&this.emit("view-change")})])}destroy(){this.view=null}get screenLocation(){const {location:p,view:w,screenLocationEnabled:h}=
this;var x=w?.spatialReference;x=x?M.projectOrLoad(p,x).geometry:null;return h&&x&&w?.ready?w.toScreen(x):null}};c.__decorate([v.property()],l.prototype,"location",void 0);c.__decorate([v.property()],l.prototype,"screenLocation",null);c.__decorate([v.property()],l.prototype,"screenLocationEnabled",void 0);c.__decorate([v.property()],l.prototype,"view",void 0);return l=c.__decorate([F.subclass("esri.widgets.support.AnchorElementViewModel")],l)})},"esri/widgets/Features/css":function(){define(["exports"],
function(c){c.css={icon:"esri-features__icon",actionImage:"esri-features__action-image",base:"esri-features",container:"esri-features__container",contentContainer:"esri-features__content-container",contentFeature:"esri-features__content-feature",flowItemCollapsed:"esri-features__flow-item--collapsed",header:"esri-features__header",footer:"esri-features__footer",featureMenuObserver:"esri-features__feature-menu-observer",actionExit:"esri-features__action--exit",loader:"esri-features__loader",featuresHeading:"esri-features__heading",
paginationText:"esri-features__pagination-text",paginationActionBar:"esri-features__pagination-action-bar",paginationMenuButton:"esri-features__pagination-menu-button",paginationPrevious:"esri-features__pagination-previous",paginationNext:"esri-features__pagination-next"};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesDrillIn":function(){define("require ../../chunks/tslib.es6 ../../intl ../../core/string ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./css ../Popup/actions ../../chunks/componentsUtils ../support/widgetUtils ../support/decorators/messageBundle ../support/jsxFactory ../../intl/substitute".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P){const K=h.zoomToFeature.clone();g=class extends p{constructor(q,n){super(q,n);this.messages=null;this.closed=!1;this.closable=!0;this._handleOpenFeature=m=>{this.emit("open-feature",{feature:m})};this._handleZoomToFeature=m=>{this.emit("zoom-to-feature",{featureWidget:m})}}loadDependencies(){return x.loadCalciteComponents({action:()=>new Promise((q,n)=>c(["../../chunks/index12"],q,n)),"action-bar":()=>new Promise((q,n)=>c(["../../chunks/index56"],q,n)),
"action-group":()=>(new Promise((q,n)=>c(["../../chunks/index18"],q,n))).then(q=>q.index),"flow-item":()=>new Promise((q,n)=>c(["../../chunks/index15"],q,n))})}render(){const {flowItems:q}=this,n=q?.toArray();return B.tsx(B.tsxFragment,null,n?.map((m,e)=>this._renderFlowItem(m,e===q.length-1)))}_handleCloseClick(){this.emit("close")}_handleExitClick(){this.emit("exit")}_handleDrillInBackClick(){const {flowItems:q}=this,n=q?.pop();n&&("activeCategory"in n.viewModel?(n.viewModel.activeCategory=null,
q.length||(n.viewModel.showAllEnabled=!1)):"showAllEnabled"in n.viewModel&&(n.viewModel.showAllEnabled=!1),n&&(n.viewModel=null,n.destroy()))}_getExitMessage(q){switch(q.flowType){case "feature":case "feature-association":return"";case "feature-relationship":return this.messages.exitRelatedRecords;case "feature-utility-network-associations":case "feature-utility-network-association-type":return this.messages.exitAssociations}}_renderFlowItem(q,n){const {messages:m,closable:e,closed:k}=this,a="graphic"in
q&&!q.isTable,b="feature-association"===q.flowType,f=this._getExitMessage(q),z=m.selectFeature;return B.tsx("calcite-flow-item",{bind:this,closable:e,closed:k,description:v.stripHTML(this._getDrillInFlowItemDescription(q)??""),heading:v.stripHTML(q.title??""),key:`flow-item-${q.viewModel.uid}`,selected:n,onCalciteFlowItemBack:I=>{I.preventDefault();this._handleDrillInBackClick()},onCalciteFlowItemClose:this._handleCloseClick},B.tsx("calcite-action",{appearance:"transparent",bind:this,class:w.css.actionExit,
icon:"move-up",key:"exit-action",onclick:this._handleExitClick,slot:"header-actions-start",text:f,title:f}),a?B.tsx("calcite-action",{appearance:"transparent",bind:this,icon:"zoom-to-object",key:"open-feature-action",onclick:()=>this._handleOpenFeature(q),slot:"header-actions-end",text:z,title:z}):null,b?B.tsx("calcite-action-bar",{expandDisabled:!0,expanded:!0,key:"header-action-bar",scale:"s",slot:"action-bar"},B.tsx("calcite-action-group",{overlayPositioning:"fixed",scale:"s"},this._renderDefaultActions(q))):
null,B.tsx("div",{class:w.css.container},q.render()))}_renderDefaultActions(q){const n=this._getActionTitle(K);return B.tsx("calcite-action",{active:K.active,appearance:"solid",bind:this,"data-action-uid":K.uid,disabled:K.disabled,icon:K.icon??"question",indicator:K.indicator,key:`action-${K.uid}`,loading:K.active,onclick:()=>this._handleZoomToFeature(q),scale:"s",text:n,textEnabled:!0,title:n})}_getActionTitle(q){const {messages:n}=this,{id:m}=q;q=q.title??"";return"zoom-to-feature"===m?P.substitute(q,
{messages:n}):q}_getDrillInFlowItemDescription(q){switch(q.flowType){case "feature":case "feature-association":case "feature-utility-network-associations":return q.viewModel.description??"";case "feature-relationship":return q.allItemsDescription;case "feature-utility-network-association-type":return q.description??""}}};l.__decorate([D.property()],g.prototype,"flowItems",void 0);l.__decorate([D.property(),u.messageBundle("esri/widgets/Features/t9n/Features")],g.prototype,"messages",void 0);l.__decorate([D.property()],
g.prototype,"closed",void 0);l.__decorate([D.property()],g.prototype,"closable",void 0);return g=l.__decorate([M.subclass("esri.widgets.Features.FeaturesDrillIn")],g)})},"esri/widgets/Popup/actions":function(){define("exports ../../core/Collection ../../support/actions/ActionBase ../../support/actions/ActionButton ../../support/actions/ActionToggle ../support/legacyIcon".split(" "),function(c,l,g,v,D,J){l=l.ofType({key:"type",defaultKeyValue:"button",base:g,typeMap:{button:v,toggle:D}});g=new v({icon:"magnifying-glass-plus",
id:"zoom-to-feature",title:"{messages.zoom}",className:J.legacyIcon.zoomInMagnifyingGlass});const t=new v({icon:"trash",id:"remove-selected-feature",title:"{messages.remove}",className:J.legacyIcon.trash});v=new v({icon:"magnifying-glass-plus",id:"zoom-to-clustered-features",title:"{messages.zoom}",className:J.legacyIcon.zoomInMagnifyingGlass});D=new D({icon:"table",id:"browse-clustered-features",title:"{messages.browseClusteredFeatures}",className:J.legacyIcon.table,value:!1});J=[g,t,D,v];c.ActionsCollection=
l;c.all=J;c.browseClusteredFeatures=D;c.removeSelectedFeature=t;c.zoomToClusteredFeatures=v;c.zoomToFeature=g;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Features/FeaturesViewModel":function(){define("require ../../chunks/tslib.es6 ../../Graphic ../../core/arrayUtils ../../core/Error ../../core/Logger ../../core/promiseUtils ../../core/ReactiveSet ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/projection ../../geometry/SpatialReference ../../geometry/support/geometryUtils ../../geometry/support/webMercatorUtils ../../layers/LayerConstants ../../symbols/SimpleFillSymbol ../../symbols/support/symbolUtils ../../time/constants ../../views/support/layerViewUtils ../Feature/FeatureViewModel ../Popup/actions ../Popup/actionUtils ../support/AnchorElementViewModel ../support/GoTo".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e,k,a,b,f,z){let I=null;w=class extends z(f){constructor(r){super(r);this._pendingPromises=new F;this._fetchFeaturesController=null;this._highlightPromises={"highlight-active-feature":null,"highlight-selected-feature":null};this._selectedClusterFeature=null;this.actions=new a.ActionsCollection;this.activeFeature=null;this.browseClusterEnabled=this.autoCloseEnabled=!1;this.content=null;this.defaultPopupTemplateEnabled=!1;this.featurePage=null;this.featuresPerPage=
20;this.featureMenuOpen=!1;this.featureViewModelAbilities=this.featureMenuTitle=null;this.featureViewModels=[];this.includeDefaultActions=this.highlightEnabled=!0;this.initialDisplayMode="feature";this.selectedClusterBoundaryFeature=new g({symbol:new q({outline:{width:1.5,color:"cyan"},style:"none"})});this.title=null;this.updateLocationEnabled=!1;this.view=null;this.visible=!1;this.zoomFactor=4;this.zoomToLocation=null;this._debouncedLocationUpdate=t.debounce(async y=>{const {spatialReference:H}=
this,Q=this.selectedFeature?.geometry?.type;y=this.location??y;if(Q&&"mesh"!==Q&&H&&y&&this.selectedFeature)if("point"===Q)this.location=B.getPointFromGeometry(this.selectedFeature.geometry)??y;else try{const A=this.selectedFeature;let N=A.geometry;const G=this._getHighlightLayer(A),d=A.getObjectId();if(G&&this.view){if(d){const E=this.view?.allLayerViews.find(U=>U.layer.uid===G.uid);if(!(E&&"queryFeatures"in E))return;const L=E.createQuery();L.outSpatialReference=H;L.objectIds=[d];L.returnGeometry=
!0;const {features:R}=await E.queryFeatures(L);N=R[0]?.geometry}if(N&&"mesh"!==N.type&&(N=C.project(N,H),I||=await new Promise((E,L)=>c(["../../geometry/geometryEngineAsync"],E,L)),!await I.intersects(N,y))){const E=(await I.nearestCoordinate(N,y)).coordinate??y;this.selectedFeature===A&&(this.location=E)}}}catch(A){t.isAbortError(A)||J.getLogger(this).error(A)}})}initialize(){this.addHandles([this.on("view-change",()=>this._autoClose()),M.watch(()=>[this.highlightEnabled,this.selectedFeature,this.visible,
this.view],()=>this._highlightSelectedFeature()),M.watch(()=>[this.highlightEnabled,this.activeFeature,this.visible,this.view],()=>this._highlightActiveFeature()),M.watch(()=>this.view?.animation?.state,r=>this._animationStateChange(r)),M.watch(()=>this.location,r=>this._locationChange(r)),M.watch(()=>this.selectedFeature,r=>this._selectedFeatureChange(r)),M.watch(()=>[this.selectedFeatureIndex,this.featureCount,this.featuresPerPage],()=>this._selectedFeatureIndexChange()),M.watch(()=>[this.featurePage,
this.selectedFeatureIndex,this.featureCount,this.featuresPerPage,this.featureViewModels],()=>this._setGraphicOnFeatureViewModels()),M.watch(()=>this.featureViewModels,()=>this._featureViewModelsChange()),this.on("trigger-action",r=>b.triggerAction({event:r,viewModel:this,view:this.view})),M.when(()=>!this.waitingForResult,()=>this._waitingForResultChange(),M.sync),M.watch(()=>[this.features,this.map,this.spatialReference,this.timeZone],()=>this._updateFeatureVMs()),M.watch(()=>this.view?.scale,()=>
this._viewScaleChange()),M.when(()=>!this.visible,()=>this.browseClusterEnabled=!1),M.watch(()=>this.browseClusterEnabled,r=>r?this.enableClusterBrowsing():this.disableClusterBrowsing())])}destroy(){this._cancelFetchingFeatures();this._pendingPromises.clear();this.browseClusterEnabled=!1;this.timeZone=this.spatialReference=this.map=this.view=null}get active(){return!(!this.visible||this.waitingForResult)}get allActions(){const r=this._get("allActions")||new a.ActionsCollection;r.removeAll();const {actions:y,
defaultActions:H,defaultPopupTemplateEnabled:Q,includeDefaultActions:A,selectedFeature:N}=this,G=A?H.concat(y):y,d=N&&("function"===typeof N.getEffectivePopupTemplate&&N.getEffectivePopupTemplate(Q)||N.popupTemplate),E=d?.actions;(d?.overwriteActions?E:E?.concat(G)??G)?.filter(Boolean).forEach(L=>r.add(L));return r}get defaultActions(){const r=this._get("defaultActions")||new a.ActionsCollection;r.removeAll();r.addMany(b.isClusterFeature(this.selectedFeature)?[a.zoomToClusteredFeatures.clone(),a.browseClusteredFeatures.clone()]:
[a.zoomToFeature.clone()]);return r}get featureCount(){return this.features.length}set features(r){r=r||[];this._set("features",r);const {pendingPromisesCount:y,promiseCount:H,selectedFeatureIndex:Q}=this,A=H&&r.length;if("list"===this.initialDisplayMode){if(!A||A&&y===H)this.selectedFeatureIndex=-1}else A&&y&&-1===Q?this.selectedFeatureIndex=0:A&&-1!==Q||(this.selectedFeatureIndex=r.length?0:-1)}set location(r){let y=r;const H=this.spatialReference?.isWebMercator;r?.spatialReference?.isWGS84&&H&&
(y=P.geographicToWebMercator(r));this._set("location",y)}get map(){return this.view?.map??null}set map(r){this._override("map",r)}get pendingPromisesCount(){return this._pendingPromises.size}get promiseCount(){return this.promises.length}get promises(){return this._get("promises")||[]}set promises(r){this._pendingPromises.clear();this.features=[];Array.isArray(r)&&r.length?(this._set("promises",r),r=r.slice(),r.forEach(y=>this._pendingPromises.add(y)),r.reduce((y,H)=>y.finally(()=>H.then(Q=>{this._pendingPromises.has(H)&&
this._updateFeatures(Q)}).finally(()=>this._pendingPromises.delete(H)).catch(()=>{})),Promise.resolve())):this._set("promises",[])}get selectedFeature(){const {features:r,selectedFeatureIndex:y}=this;return-1===y?null:r[y]||null}get selectedFeatureIndex(){const r=this._get("selectedFeatureIndex");return"number"===typeof r?r:-1}set selectedFeatureIndex(r){const {featureCount:y}=this;if(isNaN(r)||0>r||!y)r=-1;this.activeFeature=null;this._set("selectedFeatureIndex",r)}get selectedFeatureViewModel(){return this.featureViewModels[this.selectedFeatureIndex]||
null}get spatialReference(){return this.view?.spatialReference??null}set spatialReference(r){this._override("spatialReference",r)}get state(){const {view:r,map:y}=this;return r?r.ready?"ready":"disabled":y?"ready":"disabled"}get timeZone(){return this.view?.timeZone??m.system}set timeZone(r){this._overrideIfSome("timeZone",r)}get waitingForContents(){return this.featureViewModels.some(r=>r.waitingForContent)}get waitingForResult(){return!(!(this._fetchFeaturesController||0<this.pendingPromisesCount)||
0!==this.featureCount)}centerAtLocation(){const {view:r}=this,y=b.getSelectedTarget(this);return y&&r?this.callGoTo({target:{target:y,scale:r.scale}}):Promise.reject(new D("center-at-location:invalid-target-or-view","Cannot center at a location without a target and view.",{target:y,view:r}))}zoomTo(r){return this.callGoTo(r)}clear(){this.set({promises:[],features:[],content:null,title:null,location:null,activeFeature:null})}fetchFeatures(r,y){const {view:H}=this;if(!H||!r)throw new D("fetch-features:invalid-screenpoint-or-view",
"Cannot fetch features without a screenPoint and view.",{screenPoint:r,view:H});return H.fetchPopupFeatures(r,{pointerType:y?.event?.pointerType,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,signal:y?.signal})}open(r){r={updateLocationEnabled:!1,promises:[],fetchFeatures:!1,...r,visible:!0};var {fetchFeatures:y}=r;delete r.fetchFeatures;y&&this._setFetchFeaturesPromises(r.location);y=["actionsMenuOpen","collapsed"];for(const H of y)delete r[H];this.set(r)}triggerAction(r){(r=this.allActions.at(r))&&
!r.disabled&&this.emit("trigger-action",{action:r})}next(){this.selectedFeatureIndex=this._getRoundRobinIndex(this.selectedFeatureIndex+1,this.featureCount);return this}previous(){this.selectedFeatureIndex=this._getRoundRobinIndex(this.selectedFeatureIndex-1,this.featureCount);return this}disableClusterBrowsing(){b.removeClusteredFeaturesForBrowsing(this);this._clearBrowsedClusterGraphics()}async enableClusterBrowsing(){const {view:r,selectedFeature:y}=this;"2d"!==r?.type?J.getLogger(this).warn("enableClusterBrowsing:invalid-view: View must be 2d MapView.",
y):b.isClusterFeature(y)?(await b.displayClusterExtent(this),await b.browseAggregateFeatures(this)):J.getLogger(this).warn("enableClusterBrowsing:invalid-selectedFeature: Selected feature must represent an aggregate/cluster graphic.",y)}handleViewClick(r){this._fetchFeaturesAndOpen(r)}_getRoundRobinIndex(r,y){return(r+y)%y}_animationStateChange(r){this.zoomToLocation||(a.zoomToFeature.disabled="waiting-for-target"===r)}_clearBrowsedClusterGraphics(){const r=[this.selectedClusterBoundaryFeature,this._selectedClusterFeature].filter(v.isSome);
this.view?.graphics?.removeMany(r);this._selectedClusterFeature=null;this.selectedClusterBoundaryFeature.geometry=null}_viewScaleChange(){b.isClusterFeature(this.selectedFeature)?(this.visible=this.browseClusterEnabled=!1,this.clear()):this.browseClusterEnabled&&(this.features=this.selectedFeature?[this.selectedFeature]:[])}_locationChange(r){const {selectedFeature:y,updateLocationEnabled:H,view:Q}=this;Q&&H&&r&&(!y||y.geometry)&&this.centerAtLocation()}_selectedFeatureIndexChange(){this.featurePage=
0<this.featureCount?Math.floor((this.selectedFeatureIndex+1)/this.featuresPerPage):null}_featureViewModelsChange(){this.featurePage=0<this.featureCount?1:null}_setGraphicOnFeatureViewModels(){const {features:r,featureCount:y,featurePage:H,featuresPerPage:Q,featureViewModels:A}=this;if(null!=H){var N=((H-1)*Q+y)%y;A.slice(N,N+Q).forEach((G,d)=>{G&&(G.graphic??(G.graphic=r[N+d]))})}}async _selectedFeatureChange(r){const {location:y,updateLocationEnabled:H,view:Q}=this;if(r&&Q)if(this.browseClusterEnabled)this._selectedClusterFeature&&
(Q.graphics.remove(this._selectedClusterFeature),this._selectedClusterFeature=null),b.isClusterFeature(r)||(r.symbol=await n.getDisplayedSymbol(r),this._selectedClusterFeature=r,Q.graphics.add(this._selectedClusterFeature));else{var A=r.sourceLayer?.type;if("map-image"===A||"imagery"===A||"imagery-tile"===A)r.symbol=await n.getDisplayedSymbol(r);!H&&y||!r.geometry?H&&!r.geometry&&(await this.centerAtLocation(),r=Q.center?.clone())&&(this.location=r):this.location=B.getPointFromGeometry(r.geometry)}}_waitingForResultChange(){!this.featureCount&&
this.promises&&(this.visible=!1)}async _setFetchFeaturesPromises(r){({pendingFeatures:r}=await this._fetchFeaturesWithController({mapPoint:r}));this.promises=r}_destroyFeatureVMs(){this.featureViewModels.forEach(r=>r&&!r.destroyed&&r.destroy());this._set("featureViewModels",[])}_updateFeatureVMs(){const {selectedFeature:r,features:y,featureViewModels:H,view:Q,spatialReference:A,map:N,timeZone:G,location:d}=this;b.isClusterFeature(y[0])||(this.browseClusterEnabled=!1);this._destroyFeatureVMs();if(y?.length){var E=
H.slice(),L=[];y.forEach((R,U)=>{if(R){var V=null;E.some((X,Y)=>{X&&X.graphic===R&&(V=X,E.splice(Y,1));return!!V});if(V)L[U]=V;else{const X=new k({abilities:this.featureViewModelAbilities,defaultPopupTemplateEnabled:this.defaultPopupTemplateEnabled,spatialReference:A,graphic:R===r?R:null,location:d,map:N,view:Q,timeZone:G});L[U]=X}}});E.forEach(R=>R&&!R.destroyed&&R.destroy());this._set("featureViewModels",L)}}async _getScreenPoint(r,y){const {spatialReference:H,view:Q}=this;if(!Q)return null;await Q?.when();
const A=r?.spatialReference;if(!A||!H)return null;await C.initializeProjection(A,H,null,y);return Q.toScreen(r)}_cancelFetchingFeatures(){const r=this._fetchFeaturesController;r&&r.abort();this._fetchFeaturesController=null}async _projectScreenPointAndFetchFeatures({mapPoint:r,screenPoint:y,event:H,signal:Q}){return this.fetchFeatures(y??await this._getScreenPoint(r??this.location,{signal:Q}),{signal:Q,event:H})}_fetchFeaturesWithController({mapPoint:r,screenPoint:y,event:H}){this._cancelFetchingFeatures();
const Q=new AbortController,{signal:A}=Q;this._fetchFeaturesController=Q;r=this._projectScreenPointAndFetchFeatures({mapPoint:r,screenPoint:y,signal:A,event:H});r.catch(()=>{}).then(()=>{this._fetchFeaturesController=null});return r}async _fetchFeaturesAndOpen(r){const {mapPoint:y,screenPoint:H}=r,{view:Q}=this;this.removeHandles("location-scale-handle");this.addHandles([M.watch(()=>this.view?.scale,()=>this._debouncedLocationUpdate(y).catch(A=>{t.isAbortError(A)||J.getLogger(this).error(A)})),M.when(()=>
!this.visible,()=>{this.removeHandles("location-scale-handle")},{once:!0})],"location-scale-handle");({pendingFeatures:r}=await this._fetchFeaturesWithController({mapPoint:y,screenPoint:H,event:r}));Q?.popup&&"open"in Q.popup&&Q.popup.open({location:y??void 0,promises:r})}_autoClose(){this.autoCloseEnabled&&(this.visible=!1)}async _getLayerView(r,y){await r.when();return r.whenLayerView(y)}_getHighlightLayer(r){const {layer:y,sourceLayer:H}=r;return H&&"layer"in H&&H.layer?H.layer:"map-notes"===H?.type||
"subtype-group"===H?.type?H:y}_getHighlightLayerView(r,y){return"subtype-sublayer"===y.type&&y.parent&&this._mapIncludesLayer(y.parent)?this._getLayerView(r,y.parent):y&&this._mapIncludesLayer(y)?this._getLayerView(r,y):null}_getHighlightTarget(r,y,H){var Q=y.type;if("building-scene"===Q||"2d"===H&&("map-image"===Q||"tile"===Q||"imagery"===Q||"imagery-tile"===Q))return r;H=r.getObjectId();if(null!=H)return H;y="imagery"===y.type?void 0:"objectIdField"in y?y.objectIdField||K.fallbackObjectIDAttribute:
null;return(H=r.attributes)&&y&&H[y]||r}_mapIncludesLayer(r){return!!this.map?.allLayers?.includes(r)}async _highlightFeature(r,y){this.removeHandles(r);const H=this[y];if(H){var {highlightEnabled:Q,view:A,visible:N}=this;if(A&&Q&&N){var G=this._getHighlightLayer(H);if(G){var d=this._getHighlightLayerView(A,G);if(d){this._highlightPromises[r]=d;var E=await d;E&&e.highlightsSupported(E)&&this._highlightPromises[r]===d&&this[y]&&this.highlightEnabled&&(y=E.highlight(this._getHighlightTarget(H,G,A.type)),
this.addHandles(y,r))}}}}}async _highlightActiveFeature(){return this._highlightFeature("highlight-active-feature","activeFeature")}async _highlightSelectedFeature(){return this._highlightFeature("highlight-selected-feature","selectedFeature")}_updateFeatures(r){const {features:y}=this;r=r.filter(H=>!y.includes(H));r?.length&&(this.features=y.concat(r))}};l.__decorate([p.property()],w.prototype,"_fetchFeaturesController",void 0);l.__decorate([p.property({type:a.ActionsCollection})],w.prototype,"actions",
void 0);l.__decorate([p.property({readOnly:!0})],w.prototype,"active",null);l.__decorate([p.property()],w.prototype,"activeFeature",void 0);l.__decorate([p.property({readOnly:!0})],w.prototype,"allActions",null);l.__decorate([p.property()],w.prototype,"autoCloseEnabled",void 0);l.__decorate([p.property()],w.prototype,"browseClusterEnabled",void 0);l.__decorate([p.property()],w.prototype,"content",void 0);l.__decorate([p.property({type:a.ActionsCollection,readOnly:!0})],w.prototype,"defaultActions",
null);l.__decorate([p.property({type:Boolean})],w.prototype,"defaultPopupTemplateEnabled",void 0);l.__decorate([p.property({readOnly:!0})],w.prototype,"featureCount",null);l.__decorate([p.property()],w.prototype,"featurePage",void 0);l.__decorate([p.property({value:[]})],w.prototype,"features",null);l.__decorate([p.property()],w.prototype,"featuresPerPage",void 0);l.__decorate([p.property()],w.prototype,"featureMenuOpen",void 0);l.__decorate([p.property()],w.prototype,"featureMenuTitle",void 0);l.__decorate([p.property()],
w.prototype,"featureViewModelAbilities",void 0);l.__decorate([p.property({readOnly:!0})],w.prototype,"featureViewModels",void 0);l.__decorate([p.property()],w.prototype,"highlightEnabled",void 0);l.__decorate([p.property()],w.prototype,"includeDefaultActions",void 0);l.__decorate([p.property()],w.prototype,"initialDisplayMode",void 0);l.__decorate([p.property({type:x})],w.prototype,"location",null);l.__decorate([p.property()],w.prototype,"map",null);l.__decorate([p.property({readOnly:!0})],w.prototype,
"pendingPromisesCount",null);l.__decorate([p.property({readOnly:!0})],w.prototype,"promiseCount",null);l.__decorate([p.property()],w.prototype,"promises",null);l.__decorate([p.property({readOnly:!0})],w.prototype,"selectedClusterBoundaryFeature",void 0);l.__decorate([p.property({value:null,readOnly:!0})],w.prototype,"selectedFeature",null);l.__decorate([p.property({value:-1})],w.prototype,"selectedFeatureIndex",null);l.__decorate([p.property({readOnly:!0})],w.prototype,"selectedFeatureViewModel",
null);l.__decorate([p.property({type:u})],w.prototype,"spatialReference",null);l.__decorate([p.property({readOnly:!0})],w.prototype,"state",null);l.__decorate([p.property()],w.prototype,"timeZone",null);l.__decorate([p.property()],w.prototype,"title",void 0);l.__decorate([p.property()],w.prototype,"updateLocationEnabled",void 0);l.__decorate([p.property()],w.prototype,"view",void 0);l.__decorate([p.property()],w.prototype,"visible",void 0);l.__decorate([p.property({readOnly:!0})],w.prototype,"waitingForContents",
null);l.__decorate([p.property({readOnly:!0})],w.prototype,"waitingForResult",null);l.__decorate([p.property()],w.prototype,"zoomFactor",void 0);l.__decorate([p.property()],w.prototype,"zoomToLocation",void 0);l.__decorate([p.property()],w.prototype,"centerAtLocation",null);return w=l.__decorate([h.subclass("esri.widgets.Features.FeaturesViewModel")],w)})},"esri/core/ReactiveSet":function(){define(["./accessorSupport/tracking","./accessorSupport/tracking/SimpleObservable"],function(c,l){class g{constructor(v){this._observable=
new l.SimpleObservable;this._set=new Set(v)}get size(){c.trackAccess(this._observable);return this._set.size}add(v){const D=this._set.size;this._set.add(v);this._set.size!==D&&this._observable.notify();return this}clear(){0<this._set.size&&(this._set.clear(),this._observable.notify())}delete(v){(v=this._set.delete(v))&&this._observable.notify();return v}entries(){c.trackAccess(this._observable);return this._set.entries()}forEach(v,D){c.trackAccess(this._observable);this._set.forEach((J,t)=>v.call(D,
J,t,this),D)}has(v){c.trackAccess(this._observable);return this._set.has(v)}keys(){c.trackAccess(this._observable);return this._set.keys()}values(){c.trackAccess(this._observable);return this._set.values()}[Symbol.iterator](){c.trackAccess(this._observable);return this._set[Symbol.iterator]()}[Symbol.dispose](){this._observable.destroy()}get [Symbol.toStringTag](){return this._set[Symbol.toStringTag]}}return g})},"esri/layers/LayerConstants":function(){define(["exports"],function(c){c.fallbackObjectIDAttribute=
"OBJECTID";Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../core/screenUtils ../../layers/support/layerUtils ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ./webStyleAcceptedFormats ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(c,l,g,v,D,J,t,F,M,p,w,h,x){function C(m,e){if(e&&(m.style.filter=
p.getCSSFilterFromEffectList(e),e=e.effects))for(const k of e)if("drop-shadow"===k?.type){0>k.offsetX?m.style.marginLeft=`${Math.abs(k.offsetX)}px`:m.style.marginRight=`${k.offsetX}px`;break}}async function u(m,e){switch(m.type){case "web-style":var {previewWebStyleSymbol:k}=await new Promise((a,b)=>c(["./previewWebStyleSymbol"],a,b));return k(m,u,e);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:k}=await new Promise((a,b)=>c(["./previewSymbol3D"],
a,b)),k(m,e);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:k}=await new Promise((a,b)=>c(["./previewSymbol2D"],a,b)),k(m,e);case "cim":return{previewCIMSymbol:k}=await new Promise((a,b)=>c(["./previewCIMSymbol"],a,b)),k(m,e)}}function B(m){return m&&"opacity"in m?m.opacity*B(m.parent):1}async function P(m,e){if(m){var k=m.sourceLayer,a=(null!=e&&(e.useSourceLayer??!1)?k:m.layer)??k;k=e?.ignoreOpacity?1:B(a);
if(null!=m.symbol&&(null==e||!0!==e.ignoreGraphicSymbol))return m="web-style"===m.symbol.type?await m.symbol.fetchSymbol({...e,acceptedFormats:["web","cim"],cache:null!=e?e.webStyleCache:null}):m.symbol.clone(),p.applyColorToSymbol(m,null,k),m;var b=e?.renderer??K(a);if(a=b&&"getSymbolAsync"in b?await b.getSymbolAsync(m,e):null){a="web-style"===a.type?await a.fetchSymbol({...e,cache:null!=e?e.webStyleCache:null}):a.clone();if(!(b&&"visualVariables"in b&&b.visualVariables?.length))return p.applyColorToSymbol(a,
null,k),a;"arcadeRequiredForVisualVariables"in b&&b.arcadeRequiredForVisualVariables&&null==e?.arcade&&(e={...e},e.arcade=await J.loadArcade());var {getColor:f,getOpacity:z,getAllSizes:I,getRotationAngle:r}=await new Promise((G,d)=>c(["../../renderers/visualVariables/support/visualVariableUtils"],G,d)),y=[],H=[],Q=[],A=[];for(var N of b.visualVariables)switch(N.type){case "color":y.push(N);break;case "opacity":H.push(N);break;case "rotation":A.push(N);break;case "size":N.target||Q.push(N)}N=(N=!!y.length&&
y[y.length-1])?f(N,m,e):null;H=(H=!!H.length&&H[H.length-1])?z(H,m,e):null;null!=k&&(H=null!=H?H*k:k);e?.ignoreOpacity&&(H=1);p.applyColorToSymbol(a,N,H);Q.length&&!0!==e?.ignoreSizeVariables&&(k=I(Q,m,e),await p.applySizesToSymbol(a,k));if(!0!==e?.ignoreRotationVariables)for(const G of A)p.applyRotationToSymbol(a,r(G,m,e),G.axis);return a}}}function K(m){if(m)return"renderer"in m?m.renderer:void 0}let q=null;const n=[255,255,255];l.getDisplayedColor=async function(m,e){if(m){var {layer:k,sourceLayer:a}=
m,b=B(k??a);if(null!=m.symbol&&(null==e||!0!==e.ignoreGraphicSymbol))return m="web-style"===m.symbol.type?await m.symbol.fetchSymbol({...e,acceptedFormats:w.defaultAcceptedFormats}):m.symbol.clone(),p.getColorFromSymbol(m,b);var f=e?.renderer??K(k)??K(a),z=f&&"getSymbolAsync"in f?await f.getSymbolAsync(m,e):void 0;if(z){z="web-style"===z.type?await z.fetchSymbol({...e,acceptedFormats:w.defaultAcceptedFormats}):z.clone();z=p.getColorFromSymbol(z,b);if(!(f&&"visualVariables"in f)||"visualVariables"in
f&&!f.visualVariables||"visualVariables"in f&&!f.visualVariables?.length)return z;"arcadeRequiredForVisualVariables"in f&&f.arcadeRequiredForVisualVariables&&null==e?.arcade&&(e={...e},e.arcade=await J.loadArcade());var {getColor:I,getOpacity:r}=await new Promise((Q,A)=>c(["../../renderers/visualVariables/support/visualVariableUtils"],Q,A)),y=[],H=[];if(f.visualVariables)for(const Q of f.visualVariables)switch(Q.type){case "color":y.push(Q);break;case "opacity":H.push(Q)}f=(f=0<y.length?y[y.length-
1]:null)?I(f,m,e):z;m=(z=0<H.length?H[H.length-1]:null)?r(z,m,e):null;null!=b&&(m=null!=m?m*b:b);return f?p.applyOpacityToColor(f,m):null}}};l.getDisplayedSymbol=P;l.getLegendLabel=async function(m,e,k){if(m){var {layer:a,sourceLayer:b}=m,f=k?.renderer??K(a)??K(b);if(!f)return null;if("visualVariables"in f&&f.visualVariables?.length){const {getRampStops:I}=await new Promise((Q,A)=>c(["../../widgets/Legend/support/colorRampUtils"],Q,A)),{getRampStops:r}=await new Promise((Q,A)=>c(["../../widgets/Legend/support/sizeRampUtils"],
Q,A)),{getDateFormatOptions:y}=await new Promise((Q,A)=>c(["../../widgets/Legend/support/utils"],Q,A));let H=null;for(const Q of f.visualVariables){var z=e?y(a,Q,e.timeZone):null;let A=null;switch(Q.type){case "color":A=await I(Q,null,z);break;case "opacity":A=await I(Q);break;case "size":Q.target||(A=await r(f,Q,null,k?.scale||e?.scale,e,z))}if(A?.length&&(z=A.find((N,G)=>{const d=m.attributes[Q.field];return 0===G?d>=N.value:G===A?.length-1?d<=N.value:N.value===d}))){H=z.label;break}}if(H)return H}switch(f.type){case "class-breaks":return e=
"getClassBreakInfo"in f?await f.getClassBreakInfo(m,k):null,e?.label??(e&&1<f.classBreakInfos?.length)?`${e.minValue} - ${e.maxValue}`:null;case "unique-value":return("getUniqueValueInfo"in f?await f.getUniqueValueInfo(m,k):null)?.label}return null}};l.previewGraphic=async function(m,e){m?.layer&&D.isSubtypeGroupLayer(m.layer)&&(m=m.cloneShallow(),m.layer=m.layer.findSublayerForFeature(m)??null);const k=null===m?e?.fallbackSymbol??null:await P(m,{ignoreGraphicSymbol:m.layer?!0:!1,ignoreOpacity:e?.ignoreOpacity??
!0,ignoreRotationVariables:e?.ignoreRotationVariables??!0,ignoreSizeVariables:e?.ignoreSizeVariables??!0})??e?.fallbackSymbol??null;return k?(m=await u(k,{geometry:e.useGeometryForShape?m?.geometry??null:null,useMarkerSymbolSize:!1!==e.useMarkerSymbolSize,size:{width:v.px2pt(e.widthInPixels??16),height:v.px2pt(e.heightInPixels??16)},...("cim"===k?.type?{cimOptions:{feature:{attributes:m?.attributes??{}}}}:{})}))?"element"===(e?.format??"element")?m:m.outerHTML:null:null};l.renderColorRampPreviewHTML=
function(m,e={}){var k="horizontal"===e.align;const a=e.width??(k?75:24),b=e.height??(k?24:75);var f=e.gradient??!0,z=window.devicePixelRatio,I=a*z,r=b*z;z=document.createElement("canvas");z.width=I;z.height=r;z.ariaLabel=e.ariaLabel??null;z.style.width=`${a}px`;z.style.height=`${b}px`;const y=z.getContext("2d");var H=k?I:0;const Q=k?0:r;if(f){const A=y.createLinearGradient(0,0,H,Q);k=m.length;const N=1===k?0:1/(k-1);m.forEach((G,d)=>A.addColorStop(d*N,G.toString()));y.fillStyle=A;y.fillRect(0,0,
I,r)}else{I=k?I/m.length:I;r=k?r:r/m.length;H=f=0;for(const A of m)y.fillStyle=A.toString(),y.fillRect(f,H,I,r),f=k?f+I:0,H=k?0:H+r}m=document.createElement("div");m.style.width=`${a}px`;m.style.height=`${b}px`;C(m,e?.effectList);m.appendChild(z);return m};l.renderDotDensityPreviewHTML=function(m,e,k){const {backgroundColor:a,outline:b,dotSize:f}=m;var z=k?.swatchSize||F.SymbolSizeDefaults.size;const I=Math.round(z*z/Math.max(f,.5)**2*.8),r=window.devicePixelRatio;m=document.createElement("canvas");
const y=z*r;m.width=y;m.height=y;m.style.width=`${m.width/r}px`;m.style.height=`${m.height/r}px`;const H=m.getContext("2d");a&&(H.fillStyle=a.toCss(!0),H.fillRect(0,0,y,y),H.fill());H.fillStyle=e?.toCss(!0)??"";if(q&&q.length/2===I)for(e=0;e<2*I;e+=2)H.fillRect(q[e],q[e+1],f*r,f*r),H.fill();else for(q=[],e=0;e<2*I;e+=2){const Q=Math.floor(Math.random()*(y-0+1)),A=Math.floor(Math.random()*(y-0+1));q.push(Q,A);H.fillRect(Q,A,f*r,f*r);H.fill()}b&&(b.color&&(H.strokeStyle=b.color.toCss(!0)),H.lineWidth=
b.width,H.strokeRect(0,0,y,y));z=new Image(z,z);z.src=m.toDataURL();z.ariaLabel=k?.ariaLabel??null;z.alt=k?.ariaLabel??"";return z};l.renderPieChartPreviewHTML=function(m,e={}){const k=e.radius||40;var a=2*Math.PI*k,b=m.length;const f=a/b,z=[],I=t.getStroke(e.outline);null!=I?.width&&(I.width*=2);(I||e.backgroundColor)&&z.push({shape:{type:"circle",cx:k,cy:k,r:k},fill:e.backgroundColor,stroke:I,offset:[0,0]});const r=e.values,y=r&&r.length===b&&100===r.reduce((Q,A)=>Q+A,0),H=[0];for(let Q=0;Q<b;Q++){let A=
null;y&&(A=r[Q]*a/100,H.push(A+H[Q]));z.push({shape:{type:"circle",cx:k,cy:k,r:k/2},fill:[0,0,0,0],stroke:{width:k,dashArray:`${(A??f)/2} ${a}`,dashoffset:`-${y?H[Q]/2:f/2*Q}`,color:m[Q]},offset:[0,0]})}b=null;m=2*k+(I?.width||0);if(a=e.holePercentage)I&&z.push({shape:{type:"circle",cx:k,cy:k,r:k*a},fill:null,stroke:I,offset:[0,0]}),b=m/2,b=[[{shape:{type:"circle",cx:b,cy:b,r:b},fill:n,stroke:I?{...I,color:n}:null,offset:[0,0]},{shape:{type:"circle",cx:b,cy:b,r:k*a},fill:[0,0,0],stroke:null,offset:[0,
0]}]];return M.renderSymbol([z],[m,m],{effectView:e.effectList,ignoreStrokeWidth:!0,masking:b,rotations:[-90],ariaLabel:e.ariaLabel})};l.renderPreviewHTML=u;l.renderRelationshipRampPreviewHTML=function(m,e={}){const k=m?.authoringInfo;if("relationship"!==k?.type||!k?.numClasses||!m.uniqueValueInfos)return null;const {focus:a,numClasses:b}=k,f=x.getRelationshipRampElement({focus:a,numClasses:b,infos:m.uniqueValueInfos});m=e?.node||document.createElement("div");M.renderOnce(m,()=>h.renderRelationshipRamp(f,
e.id||"relationship",{opacity:e.opacity||1,effectList:e.effectList,ariaLabel:e.ariaLabel}));return m};Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(c,l){function g(v,D){return Math.round(Math.min(Math.max(v+191.25*D,0),255))}c.SymbolSizeDefaults=void 0;(function(v){v[v.size=22]="size";v[v.lineWidth=50]="lineWidth";v[v.maxSize=120]="maxSize";v[v.maxOutlineSize=80]="maxOutlineSize";v[v.tallSymbolWidth=
20]="tallSymbolWidth"})(c.SymbolSizeDefaults||(c.SymbolSizeDefaults={}));c.adjustColorBrightness=function(v,D){if(null==v)return new l;if("type"in v&&("linear"===v.type||"pattern"===v.type))return v;v=new l(v);return new l([g(v.r,D),g(v.g,D),g(v.b,D),v.a])};c.adjustColorComponentBrightness=g;c.getConeShapes=function(v,D){let J=D?c.SymbolSizeDefaults.tallSymbolWidth:v;D=D?4:6;J=J<=c.SymbolSizeDefaults.size?J-.5*D:J-D;D=.15*J;const t=J;v-=D;return[{type:"ellipse",cx:.5*J,cy:v,rx:.5*J,ry:D},{type:"path",
path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,v]},{command:"L",values:[0,v]},{command:"Z",values:[]}]}]};c.getCubeShapes=function(v,D){let J=D?c.SymbolSizeDefaults.tallSymbolWidth:v;var t=D?4:6;t=J=J<=c.SymbolSizeDefaults.size?J-.5*t:J-t;D=D?.35*J:.5*J;return[{type:"path",path:[{command:"M",values:[.5*t,0]},{command:"L",values:[t,.5*D]},{command:"L",values:[.5*t,D]},{command:"L",values:[0,.5*D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*D]},{command:"L",values:[.5*
t,D]},{command:"L",values:[.5*t,v]},{command:"L",values:[0,v-.5*D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*t,D]},{command:"L",values:[.5*t,v]},{command:"L",values:[t,v-.5*D]},{command:"L",values:[t,.5*D]},{command:"Z",values:[]}]}]};c.getCylinderShapes=function(v,D){var J=D?c.SymbolSizeDefaults.tallSymbolWidth:v;D=D?4:6;J=J<=c.SymbolSizeDefaults.size?J-.5*D:J-D;D=.5*J;const t=.15*J;v-=t;return[{type:"ellipse",cx:.5*J,cy:v,rx:D,ry:t},{type:"path",path:[{command:"M",values:[0,
t]},{command:"L",values:[0,v]},{command:"L",values:[J,v]},{command:"L",values:[J,t]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*J,cy:t,rx:D,ry:t}]};c.getDiamondShapes=function(v){var D=v;D=D<c.SymbolSizeDefaults.size?D-2:D-4;const J=Math.floor(v/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*D,0]},{command:"L",values:[D,.5*v-J]},{command:"L",values:[.45*D-J,.5*v+J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*D,0]},{command:"L",values:[.45*D-J,.5*v+J]},
{command:"L",values:[0,.5*v-J]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*v-J]},{command:"L",values:[.45*D-J,.5*v+J]},{command:"L",values:[.45*D,v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*D,v]},{command:"L",values:[D,.5*v-J]},{command:"L",values:[.45*D-J,.5*v+J]},{command:"Z",values:[]}]}]};c.getExtrudeSymbolShapes=function(v){const D=c.SymbolSizeDefaults.size;v*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*D]},{command:"L",values:[.3*
D,.7*D]},{command:"L",values:[.3*D,.7*D+v]},{command:"L",values:[0,.7*D+v-.35*D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*D,.7*D]},{command:"L",values:[.3*D,.7*D+v]},{command:"L",values:[D,v]},{command:"L",values:[D,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*D,0]},{command:"L",values:[D,0]},{command:"L",values:[.3*D,.7*D]},{command:"L",values:[0,.35*D]},{command:"Z",values:[]}]}]};c.getInvertedConeShapes=function(v){let D=v;D=D<c.SymbolSizeDefaults.size?
D-3:D-6;const J=.15*D,t=D;return[{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[t,0]},{command:"L",values:[.5*t,v-J]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*D,cy:0,rx:.5*D,ry:J}]};c.getPathSymbolShapes=function(v,D,J){var t=c.SymbolSizeDefaults.size;let F=t,M=t;1>v?F*=.75:1<v&&(M*=1.25);v=t;D&&J&&(F=M=v=t=0);return[{type:"path",path:[{command:"M",values:[v,0]},{command:"L",values:[J?v:.875*v,0]},{command:"L",values:[J?F-.5*v:0,M-.5*t]},{command:"L",values:[F-.5*v,M-.5*
t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[v,0]},{command:"L",values:[v,D?0:.125*t]},{command:"L",values:[F-.5*v,D?M-.5*t:t]},{command:"L",values:[F-.5*v,M-.5*t]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[F-.5*v,M-.5*t]},{command:"L",values:[J?F-.5*v:0,M-.5*t]},{command:"L",values:[J?F-.5*v:0,D?M-.5*t:t]},{command:"L",values:[F-.5*v,D?M-.5*t:t]},{command:"Z",values:[]}]}]};c.getTetrahedronShapes=function(v){var D=v;D=D<c.SymbolSizeDefaults.size?D-
1:D-2;return[{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[v,D]},{command:"L",values:[.45*v,.6*D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[.45*v,.6*D]},{command:"L",values:[0,D]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,D]},{command:"L",values:[.45*v,.6*D]},{command:"L",values:[v,D]},{command:"Z",values:[]}]}]};c.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
c.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(c,l,g,v,D,J,t,F,M,p){function w(C,u){x.append(C,u);x.detach(u)}function h(C,u,B){return C?g(C,{responseType:"image"}).then(P=>{P=P.data;const K=P.width,q=
P.height,n=K/q;let m=u;B&&(m=Math.min(m,Math.max(K,q)));return{image:P,width:1>=n?Math.ceil(m*n):m,height:1>=n?m:Math.ceil(m/n)}}):Promise.reject(new D("renderUtils: imageDataSize","href not provided."))}const x=F.createProjector();c.renderOnce=w;c.renderSymbol=function(C,u,B){const P=Math.ceil(u[0]),K=Math.ceil(u[1]);if(!C.some(q=>!!q.length))return null;u=B?.node||document.createElement("div");null!=B.opacity&&(u.style.opacity=B.opacity.toString());null!=B.effectView&&(u.style.filter=p.getCSSFilterFromEffectList(B.effectView));
w(u,()=>M.renderSVG(C,P,K,B));return u};c.tintImageWithColor=function(C,u,B,P,K){return h(C,u,K).then(q=>{const n=q.width??u,m=q.height??u;var e;if(e=q.image)e=B&&"ignore"!==P?"multiply"===P&&255===B.r&&255===B.g&&255===B.b&&1===B.a?!1:!0:!1;if(e){var k=q.image.width,a=q.image.height;J("edge")&&/\.svg$/i.test(C)&&(--k,--a);e=Math.ceil(n);var b=Math.ceil(m);var f=document.createElement("canvas");f.width=e;f.height=b;f.style.width=e+"px";f.style.height=b+"px";f=f.getContext("2d");f.clearRect(0,0,e,
b);e=f;e.drawImage(q.image,0,0,k,a,0,0,n,m);b=e.getImageData(0,0,n,m);f=[B.r/255,B.g/255,B.b/255,B.a];const I=v.toHSV(B);for(let r=0;r<b.data.length;r+=4){q=b.data;k=r;a=f;var z=I;switch(P){case "multiply":q[k]*=a[0];q[k+1]*=a[1];q[k+2]*=a[2];q[k+3]*=a[3];break;default:const y=v.toHSV({r:q[k],g:q[k+1],b:q[k+2]});y.h=z.h;y.s=z.s;y.v=y.v/100*z.v;z=v.toRGB(y);q[k]=z.r;q[k+1]=z.g;q[k+2]=z.b;q[k+3]*=a[3]}}e.putImageData(b,0,0);C=e.canvas.toDataURL("image/png")}else e=l.id?.findCredential(C),e?.token&&
(q=C.includes("?")?"\x26":"?",C=`${C}${q}token=${e.token}`);return{url:C,width:n,height:m}}).catch(()=>({url:C,width:u,height:u}))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define("exports ../Color ./arrayUtils ./lang ./mathUtils ../chunks/vec42 ./libs/gl-matrix-2/factories/vec4f64".split(" "),function(c,l,g,v,D,J,t){function F(b){return"r"in b&&"g"in b&&"b"in b}function M(b,f){const z=[];let I,r;if(b[0].length!==f.length)throw Error("dimensions do not match");
const y=b.length,H=b[0].length;let Q=0;for(I=0;I<y;I++){for(r=Q=0;r<H;r++)Q+=b[I][r]*f[r];z.push(Q)}return z}function p(b){b=[b.r/255,b.g/255,b.b/255].map(f=>.04045>=f?f/12.92:((f+.055)/1.055)**2.4);b=M(e,b);return{x:100*b[0],y:100*b[1],z:100*b[2]}}function w(b){b=M(k,[b.x/100,b.y/100,b.z/100]).map(f=>Math.min(1,Math.max(.0031308>=f?12.92*f:1.055*f**(1/2.4)-.055,0)));return{r:Math.round(255*b[0]),g:Math.round(255*b[1]),b:Math.round(255*b[2])}}function h(b){b=[b.x/95.047,b.y/100,b.z/108.883].map(f=>
f>(6/29)**3?f**(1/3):1/3*(29/6)**2*f+4/29);return{l:116*b[1]-16,a:500*(b[0]-b[1]),b:200*(b[1]-b[2])}}function x(b){const f=b.l;b=[(f+16)/116+b.a/500,(f+16)/116,(f+16)/116-b.b/200].map(z=>z>6/29?z**3:3*(6/29)**2*(z-4/29));return{x:95.047*b[0],y:100*b[1],z:108.883*b[2]}}function C(b){if(F(b))return b;if("l"in b&&"c"in b&&"h"in b){var f=b.c,z=b.h;return w(x({l:b.l,a:f*Math.cos(z),b:f*Math.sin(z)}))}if("l"in b&&"a"in b&&"b"in b)return w(x(b));if("x"in b&&"y"in b&&"z"in b)return w(b);if("h"in b&&"s"in
b&&"v"in b){z=(b.h+360)%360/60;f=b.v/100*255;b=b.s/100*f;const I=b*(1-Math.abs(z%2-1));switch(Math.floor(z)){case 0:z={r:b,g:I,b:0};break;case 1:z={r:I,g:b,b:0};break;case 2:z={r:0,g:b,b:I};break;case 3:z={r:0,g:I,b};break;case 4:z={r:I,g:0,b};break;case 5:case 6:z={r:b,g:0,b:I};break;default:z={r:0,g:0,b:0}}z.r=Math.round(z.r+f-b);z.g=Math.round(z.g+f-b);z.b=Math.round(z.b+f-b);return z}return b}function u(b){if("h"in b&&"s"in b&&"v"in b)return b;var f=C(b);b=f.r;const z=f.g,I=f.b;f=Math.max(b,z,
I);const r=f-Math.min(b,z,I);b=0===r?0:f===b?(z-I)/r%6:f===z?(I-b)/r+2:(b-z)/r+4;0>b&&(b+=6);return{h:60*b,s:100*(0===r?0:r/f),v:100/255*f}}function B(b){return"l"in b&&"a"in b&&"b"in b?b:h(p(C(b)))}function P(b){let {r:f,g:z,b:I,a:r}=b;1>r&&(f=Math.round(r*f+255*(1-r)),z=Math.round(r*z+255*(1-r)),I=Math.round(r*I+255*(1-r)));return new l({r:f,g:z,b:I})}function K(b,f){const {r:z,g:I,b:r}=f?.ignoreAlpha?b:P(b);return.2126*z+.7152*I+.0722*r}function q(b){b[0]??(b[0]=0);b[1]??(b[1]=0);b[2]??(b[2]=0);
return b}function n(b,f,z={}){const I=[],r=b.length-1,y=Math.ceil((f-b.length)/r);a:for(let H=0;H<r;H++){const Q=b[H],A=b[H+1];for(let N=1;N<=y;N++)if(I.push(m(Q,A,N/(y+1),z)),I.length+b.length===f)break a}return[...b.map(H=>H.clone()),...g.shuffle(I,z.seed??1)]}function m(b,f,z,I={}){var r=b.r,y=b.g;b=b.b;r=Math.round(r+(f.r-r)*z);y=Math.round(y+(f.g-y)*z);f=Math.round(b+(f.b-b)*z);if(!I.offset)return new l([r,y,f]);I=g.getRandomNumberGenerator(I.seed);return new l([a(r,I),a(y,I),a(f,I)])}const e=
[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],k=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];c.BrightnessThreshold=void 0;(function(b){b[b.Low=160]="Low";b[b.High=225]="High"})(c.BrightnessThreshold||(c.BrightnessThreshold={}));const a=(b,f)=>{f=Math.floor(10*f())-5;return Math.min(255,Math.max(0,b+f))};c.colorEquals=function(b,f){return b===f||null!=b&&b.equals(f)};c.colorVectorEquals=function(b,f){return b===f||null!=b&&null!=f&&J.equals(b,f)};c.colorVectorToColorAndOpacity=
function(b){return t.fromValues(b[0],b[1],b[2],3<b.length?b[3]:1)};c.createUniqueColors=function(b,f,z={}){if(0===b.length||0>=f)return[];b=b.map(r=>"string"===typeof r?new l(r):r);if(1===b.length||1===f){z=[];b=b[0];for(var I=0;I<f;I++)z.push(b.clone());return z}z.shuffle&&(b=g.shuffle(v.clone(b),z.seed));if(b.length>=f){z=[];I=(b.length-1)/(f-1);for(let r=0;r<f;r++)z.push(b[Math.round(r*I)].clone());return z}return n(b,f,z)};c.darken=function(b,f){var z=B(b);z.l*=1-f;f=C(z);z=b.clone();z.setColor(f);
z.a=b.a;return z};c.desaturate=function(b,f){var z=u(b);z.s*=f;f=C(z);z=b.clone();z.setColor(f);z.a=b.a;return z};c.getColorLuminance=K;c.getColorTheme=function(b){return P(b).isBright?"light":"dark"};c.getContrast=function(b,f=c.BrightnessThreshold.High){return K(b,{ignoreAlpha:!0})>f?new l([0,0,0,b.a]):new l([255,255,255,b.a])};c.isRGB=F;c.multiplyOpacity=function(b,f){b=b.clone();b.a*=f;return b};c.multiplyOpacityToUnitRGBA=function(b,f){b=l.toUnitRGBA(b);b[3]*=f;return b};c.toHSV=u;c.toLAB=B;
c.toLCH=function(b){if(!("l"in b&&"c"in b&&"h"in b)){var f=h(p(C(b)));b=f.l;var z=f.a;const I=f.b;f=Math.sqrt(z*z+I*I);z=Math.atan2(I,z);z=0<z?z:z+2*Math.PI;b={l:b,c:f,h:z}}return b};c.toRGB=C;c.unitRGBAFromColor=function(b){return l.toUnitRGBA(b)};c.validateColor=q;c.validateColorAndOpacity=function(b){b.length=4;q(b);b[3]??(b[3]=1);D.clamp(b[3],0,1);return b};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ./svgGlobalState ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(c,l,g,v,D,J,t,F,M,p){function w(A,N){A*=Q/180;return Math.abs(N*Math.sin(A))+Math.abs(N*Math.cos(A))}function h(A){return A.map(N=>`${N.command} ${N.values.join(" ")}`).join(" ").trim()}function x(A,N,G,d,E){if(A){if("circle"===A.type)return p.tsx("circle",{cx:A.cx,cy:A.cy,fill:N,"fill-rule":"evenodd",r:A.r,stroke:G.color,"stroke-dasharray":G.dashArray,"stroke-dashoffset":G.dashOffset,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-miterlimit":"4","stroke-width":G.width});if("ellipse"===
A.type)return p.tsx("ellipse",{cx:A.cx,cy:A.cy,fill:N,"fill-rule":"evenodd",rx:A.rx,ry:A.ry,stroke:G.color,"stroke-dasharray":G.dashArray,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-miterlimit":"4","stroke-width":G.width});if("rect"===A.type)return p.tsx("rect",{fill:N,"fill-rule":"evenodd",height:A.height,stroke:G.color,"stroke-dasharray":G.dashArray,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-miterlimit":"4","stroke-width":G.width,width:A.width,x:A.x,y:A.y});if("image"===
A.type)return p.tsx("image",{alt:E||"image",height:A.height,href:A.src,preserveAspectRatio:"none",width:A.width,x:A.x,y:A.y});if("path"===A.type)return A="string"!==typeof A.path?h(A.path):A.path,p.tsx("path",{d:A,fill:N,"fill-rule":"evenodd",stroke:G.color,"stroke-dasharray":G.dashArray,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-miterlimit":"4","stroke-width":G.width});if("text"===A.type)return v.assertIsSome(d),p.tsx("text",{"dominant-baseline":d.dominantBaseline,fill:N,"fill-rule":"evenodd",
"font-family":d.font.family,"font-size":d.font.size,"font-style":d.font.style,"font-variant":d.font.variant,"font-weight":d.font.weight,kerning:d.kerning,rotate:d.rotate,stroke:G.color,"stroke-dasharray":G.dashArray,"stroke-linecap":G.cap,"stroke-linejoin":G.join,"stroke-miterlimit":"4","stroke-width":G.width,"text-anchor":d.align,"text-decoration":d.decoration,"text-rendering":z,x:A.x,y:A.y},A.text)}return null}function C(A){if(!A)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in
A))return{fill:(new l(A)).toString(),pattern:null,linearGradient:null};if("pattern"===A.type){var N=`patternId-${F.nextPatternId()}`;return{fill:`url(#${N})`,pattern:{id:N,x:A.x,y:A.y,width:A.width,height:A.height,image:{x:0,y:0,width:A.width,height:A.height,href:A.src}},linearGradient:null}}N=`linearGradientId-${F.nextLinearGradientId()}`;return{fill:`url(#${N})`,pattern:null,linearGradient:{id:N,x1:A.x1,y1:A.y1,x2:A.x2,y2:A.y2,stops:A.colors.map(G=>({offset:G.offset,color:G.color&&(new l(G.color)).toString()}))}}}
function u(A){const N={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};A&&(null!=A.width&&(N.width=A.width),A.cap&&(N.cap=A.cap),A.join&&(N.join=A.join.toString()),A.color&&(N.color=(new l(A.color)).toString()),A.dashArray&&(N.dashArray=A.dashArray),A.dashoffset&&(N.dashOffset=A.dashoffset),A.style&&!A.dashArray&&(N.dashArray=t.getDashArray(A).join(",")||"none"));return N}function B(A,N){const G={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,
weight:null,size:null,family:null}};if(A){const d=A.alignBaseline;G.align=A.align;G.dominantBaseline="baseline"===d?"auto":"top"===d?"text-top":"bottom"===d?"hanging":d;G.decoration=A.decoration;G.kerning=A.kerning?"auto":"0";G.rotate=A.rotated?"90":"0";v.assertIsSome(N);G.font.style=N.style||"normal";G.font.variant=N.variant||"normal";G.font.weight=N.weight||"normal";G.font.size=N.size&&N.size.toString()||"10pt";G.font.family=N.family||"serif"}return G}function P(A){const {pattern:N,linearGradient:G}=
A;return N?p.tsx("pattern",{height:N.height,id:N.id,patternUnits:"userSpaceOnUse",width:N.width,x:N.x,y:N.y},p.tsx("image",{height:N.image.height,href:N.image.href,width:N.image.width,x:N.image.x,y:N.image.y})):G?(A=G.stops.map((d,E)=>p.tsx("stop",{key:`${E}-stop`,offset:d.offset,"stop-color":d.color})),p.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:G.id,x1:G.x1,x2:G.x2,y1:G.y1,y2:G.y2},A)):null}function K(A,N){if(!A||0===A.length)return null;const G=[];for(const d of A){const {shape:E,
fill:L,stroke:R,font:U}=d;A=C(L);const V=u(R),X="text"===E.type?B(E,U):null;(A=x(E,A.fill,V,X))&&G.push(A)}return p.tsx("mask",{id:N,maskUnits:"userSpaceOnUse"},p.tsx("g",null,G))}function q(A,N,G,d,E){J.scale(A,J.identity(A),[N,G]);A[4]=A[4]*N-d*N+d;A[5]=A[5]*G-E*G+E;return A}function n(A,N){if(y&&"left"in y){null!=y.left&&y.left>A&&(y.left=A);if(null==y.right||y.right<A)y.right=A;if(null==y.top||y.top>N)y.top=N;if(null==y.bottom||y.bottom<N)y.bottom=N}else y={left:A,bottom:N,right:A,top:N}}function m(A){const N=
A.args,G=N.length;switch(A.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(A=0;A<G;A+=2)n(N[A],N[A+1]);H.x=N[G-2];H.y=N[G-1];break;case "H":for(A=0;A<G;++A)n(N[A],H.y);H.x=N[G-1];break;case "V":for(A=0;A<G;++A)n(H.x,N[A]);H.y=N[G-1];break;case "m":A=0;"x"in H||(n(H.x=N[0],H.y=N[1]),A=2);for(;A<G;A+=2)n(H.x+=N[A],H.y+=N[A+1]);break;case "l":case "t":for(A=0;A<G;A+=2)n(H.x+=N[A],H.y+=N[A+1]);break;case "h":for(A=0;A<G;++A)n(H.x+=N[A],H.y);break;case "v":for(A=0;A<G;++A)n(H.x,H.y+=
N[A]);break;case "c":for(A=0;A<G;A+=6)n(H.x+N[A],H.y+N[A+1]),n(H.x+N[A+2],H.y+N[A+3]),n(H.x+=N[A+4],H.y+=N[A+5]);break;case "s":case "q":for(A=0;A<G;A+=4)n(H.x+N[A],H.y+N[A+1]),n(H.x+=N[A+2],H.y+=N[A+3]);break;case "A":for(A=0;A<G;A+=7)n(N[A+5],N[A+6]);H.x=N[G-2];H.y=N[G-1];break;case "a":for(A=0;A<G;A+=7)n(H.x+=N[A+5],H.y+=N[A+6])}}function e(A,N,G){const d=I[A.toLowerCase()];"number"===typeof d&&(d?N.length>=d&&(A={action:A,args:N.slice(0,N.length-N.length%d)},G.push(A),m(A)):(A={action:A,args:[]},
G.push(A),m(A)))}function k(A){const N={x:0,y:0,width:0,height:0};if("circle"===A.type)N.x=A.cx-A.r,N.y=A.cy-A.r,N.width=2*A.r,N.height=2*A.r;else if("ellipse"===A.type)N.x=A.cx-A.rx,N.y=A.cy-A.ry,N.width=2*A.rx,N.height=2*A.ry;else if("image"===A.type||"rect"===A.type)N.x=A.x,N.y=A.y,N.width=A.width,N.height=A.height;else if("path"===A.type){{const E=("string"!==typeof A.path?h(A.path):A.path).match(r),L=[];y={};H={};if(E){A="";var G=[],d=E.length;for(let R=0;R<d;++R){const U=E[R],V=parseFloat(U);
isNaN(V)?(A&&e(A,G,L),G=[],A=U):G.push(V)}e(A,G,L);A={x:0,y:0,width:0,height:0};y&&"left"in y&&(A.x=y.left,A.y=y.top,A.width=y.right-y.left,A.height=y.bottom-y.top)}else A=null}N.x=A.x;N.y=A.y;N.width=A.width;N.height=A.height}return N}function a(A){const N={x:0,y:0,width:0,height:0};let G=null,d=Number.NEGATIVE_INFINITY,E=Number.NEGATIVE_INFINITY;for(const L of A)G?(G.x=Math.min(G.x,L.x),G.y=Math.min(G.y,L.y),d=Math.max(d,L.x+L.width),E=Math.max(E,L.y+L.height)):(G=N,G.x=L.x,G.y=L.y,d=L.x+L.width,
E=L.y+L.height);G&&(G.width=d-G.x,G.height=E-G.y);return G}function b(A,N,G,d,E,L,R,U,V){var X=(R&&L?w(L,N):N)/2,Y=(R&&L?w(L,G):G)/2;if(V){var aa=V[0];V=V[1];X=(R&&L?w(L,aa):aa)/2;Y=(R&&L?w(L,V):V)/2}aa=A.width+d;const W=A.height+d;R=D.create();V=D.create();var ca=!1;if(E&&0!==aa&&0!==W){E=N!==G?N/G:aa/W;ca=N>G?N:G;let fa=1,da=1;isNaN(ca)||(1<E?(fa=ca/aa,da=ca/E/W):(da=ca/W,fa=ca*E/aa));J.multiply(V,V,q(R,fa,da,X,Y));ca=!0}E=A.x+(aa-d)/2;A=A.y+(W-d)/2;d=J.multiply;X-=E;Y-=A;X=J.translate(R,J.identity(R),
[X,Y]);d.call(J,V,V,X);!ca&&(aa>N||W>G)&&(X=aa/N>W/G,N=(X?N:G)/(X?aa:W),J.multiply(V,V,q(R,N,N,E,A)));U&&(N=J.multiply,G=U[0],U=U[1],U=J.translate(R,J.identity(R),[G,U]),N.call(J,V,V,U));L&&(U=J.multiply,N=L%360*Math.PI/180,J.rotate(R,J.identity(R),N),L=Math.cos(N),N=Math.sin(N),G=R[4],aa=R[5],R[4]=G*L-aa*N+A*N-E*L+E,R[5]=aa*L+G*N-E*N-A*L+A,U.call(J,V,V,R));return`matrix(${V[0]},${V[1]},${V[2]},${V[3]},${V[4]},${V[5]})`}function f(A,N,G){A=A?.effects.find(U=>"bloom"===U.type);if(!A)return null;const {strength:d,
radius:E}=A;A=0<d?E:0;const L=(d+A)*N,R=4*d+1;return p.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${G}`,width:"300%",x:"-100%",y:"-100%"},p.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(d+.5*A)*5**(N/100)*(.4+N/100),result:"dilate"}),p.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:L/25}),p.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:L/50}),p.tsx("feComponentTransfer",{in:"SourceGraphic",result:"intensityBrightness"},
p.tsx("feFuncR",{slope:R,type:"linear"}),p.tsx("feFuncG",{slope:R,type:"linear"}),p.tsx("feFuncB",{slope:R,type:"linear"})),p.tsx("feMerge",null,p.tsx("feMergeNode",{in:"intensityBlur"}),p.tsx("feMergeNode",{in:"intensityBrightness"}),p.tsx("feGaussianBlur",{stdDeviation:d/10})))}M=g("android");const z=g("chrome")||M&&4<=M?"auto":"optimizeLegibility",I={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},r=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;let y={},H={};const Q=Math.PI;c.computeBBox=a;c.generateFillAttributes=
C;c.generateStrokeAttributes=u;c.generateTextAttributes=B;c.getBoundingBox=k;c.getTransformMatrix=b;c.renderDef=P;c.renderSVG=function(A,N,G,d={}){const E=[],L=[],R=F.nextBloomId(),U=f(d.effectView,N,R);var V=null;U&&(V=d.effectView?.effects.find(S=>"bloom"===S.type),V=(V.strength?V.strength+V.radius/2:0)/3,V=[Math.max(N+N*V,10),Math.max(G+G*V,10)]);let X=N,Y=G;if(d.useRotationSize)for(var aa=0;aa<A.length;aa++){var W=d.rotations?.[aa]??0;X=Math.max(w(W,N),X);Y=Math.max(w(W,G),Y)}for(aa=0;aa<A.length;aa++){var ca=
A[aa];W=[];var fa=[],da=0,O=0;let S=0;for(const T of ca){const {shape:Z,fill:ea,stroke:ba,font:ha,offset:ia}=T;d.ignoreStrokeWidth||"text"===Z.type||(da+=ba?.width||0);ca=C(ea);const ja=u(ba),ka="text"===Z.type?B(Z,ha):null;E.push(P(ca));W.push(x(Z,ca.fill,ja,ka,d.ariaLabel));fa.push(k(Z));ia&&(O+=ia[0],S+=ia[1])}ca=d.rotations?.[aa]??0;d.useRotationSize&&(O+=(X-w(ca,N))/2,S+=(Y-w(ca,G))/2);fa=a(fa);da=b(fa,N,G,da,d.scale??!1,ca,d.useRotationSize??!1,[O,S],V);O=null;d.masking&&(O=`mask-${aa}`,E.push(K(d.masking[aa],
O)),O=`url(#${O})`);L.push(O?p.tsx("g",{mask:O},p.tsx("g",{transform:da},W)):p.tsx("g",{transform:da},W))}U&&(v.assertIsSome(V),X=V[0],Y=V[1]);return p.tsx("svg",{"aria-label":d.ariaLabel,focusable:!1,height:Y,role:"img",style:"display: block;",width:X,xmlns:"http://www.w3.org/2000/svg"},U,p.tsx("defs",null,E),U?p.tsx("g",{filter:`url(#bloom${R})`},L):L)};c.renderShape=x;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],
function(c){function l(){const M=new Float32Array(6);M[0]=1;M[3]=1;return M}function g(M){const p=new Float32Array(6);p[0]=M[0];p[1]=M[1];p[2]=M[2];p[3]=M[3];p[4]=M[4];p[5]=M[5];return p}function v(M,p,w,h,x,C){const u=new Float32Array(6);u[0]=M;u[1]=p;u[2]=w;u[3]=h;u[4]=x;u[5]=C;return u}function D(M,p){return new Float32Array(M,p,6)}function J(M,p,w,h){const x=p[h];p=p[h+1];M[h]=w[0]*x+w[2]*p+w[4];M[h+1]=w[1]*x+w[3]*p+w[5]}function t(M,p,w,h=0,x=0,C=2){for(x=x||p.length/C;h<x;h++)J(M,p,w,h*C)}const F=
Object.freeze(Object.defineProperty({__proto__:null,clone:g,create:l,createView:D,fromValues:v,transform:J,transformMany:t},Symbol.toStringTag,{value:"Module"}));c.clone=g;c.create=l;c.createView=D;c.fromValues=v;c.mat2df32=F;c.transform=J;c.transformMany=t;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports","./common"],function(c,l){function g(a,b){a[0]=b[0];a[1]=b[1];a[2]=b[2];a[3]=b[3];a[4]=b[4];a[5]=b[5];return a}
function v(a){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=0;a[5]=0;return a}function D(a,b,f,z,I,r,y){a[0]=b;a[1]=f;a[2]=z;a[3]=I;a[4]=r;a[5]=y;return a}function J(a,b){const f=b[0],z=b[1],I=b[2],r=b[3],y=b[4];b=b[5];let H=f*r-z*I;if(!H)return null;H=1/H;a[0]=r*H;a[1]=-z*H;a[2]=-I*H;a[3]=f*H;a[4]=(I*b-r*y)*H;a[5]=(z*y-f*b)*H;return a}function t(a){return a[0]*a[3]-a[1]*a[2]}function F(a,b,f){const z=b[0],I=b[1],r=b[2],y=b[3],H=b[4];b=b[5];const Q=f[0],A=f[1],N=f[2],G=f[3],d=f[4];f=f[5];a[0]=z*Q+r*A;a[1]=I*Q+
y*A;a[2]=z*N+r*G;a[3]=I*N+y*G;a[4]=z*d+r*f+H;a[5]=I*d+y*f+b;return a}function M(a,b,f){const z=b[0],I=b[1],r=b[2],y=b[3],H=b[4];b=b[5];const Q=Math.sin(f);f=Math.cos(f);a[0]=z*f+r*Q;a[1]=I*f+y*Q;a[2]=z*-Q+r*f;a[3]=I*-Q+y*f;a[4]=H;a[5]=b;return a}function p(a,b,f){const z=b[1],I=b[2],r=b[3],y=b[4],H=b[5],Q=f[0];f=f[1];a[0]=b[0]*Q;a[1]=z*Q;a[2]=I*f;a[3]=r*f;a[4]=y;a[5]=H;return a}function w(a,b,f){const z=b[0],I=b[1],r=b[2],y=b[3],H=b[4];b=b[5];const Q=f[0];f=f[1];a[0]=z;a[1]=I;a[2]=r;a[3]=y;a[4]=z*
Q+r*f+H;a[5]=I*Q+y*f+b;return a}function h(a,b){const f=Math.sin(b);b=Math.cos(b);a[0]=b;a[1]=f;a[2]=-f;a[3]=b;a[4]=0;a[5]=0;return a}function x(a,b){a[0]=b[0];a[1]=0;a[2]=0;a[3]=b[1];a[4]=0;a[5]=0;return a}function C(a,b){a[0]=1;a[1]=0;a[2]=0;a[3]=1;a[4]=b[0];a[5]=b[1];return a}function u(a){return"mat2d("+a[0]+", "+a[1]+", "+a[2]+", "+a[3]+", "+a[4]+", "+a[5]+")"}function B(a){return Math.sqrt(a[0]**2+a[1]**2+a[2]**2+a[3]**2+a[4]**2+a[5]**2+1)}function P(a,b,f){a[0]=b[0]+f[0];a[1]=b[1]+f[1];a[2]=
b[2]+f[2];a[3]=b[3]+f[3];a[4]=b[4]+f[4];a[5]=b[5]+f[5];return a}function K(a,b,f){a[0]=b[0]-f[0];a[1]=b[1]-f[1];a[2]=b[2]-f[2];a[3]=b[3]-f[3];a[4]=b[4]-f[4];a[5]=b[5]-f[5];return a}function q(a,b,f){a[0]=b[0]*f;a[1]=b[1]*f;a[2]=b[2]*f;a[3]=b[3]*f;a[4]=b[4]*f;a[5]=b[5]*f;return a}function n(a,b,f,z){a[0]=b[0]+f[0]*z;a[1]=b[1]+f[1]*z;a[2]=b[2]+f[2]*z;a[3]=b[3]+f[3]*z;a[4]=b[4]+f[4]*z;a[5]=b[5]+f[5]*z;return a}function m(a,b){return a[0]===b[0]&&a[1]===b[1]&&a[2]===b[2]&&a[3]===b[3]&&a[4]===b[4]&&a[5]===
b[5]}function e(a,b){const f=a[0],z=a[1],I=a[2],r=a[3],y=a[4];a=a[5];const H=b[0],Q=b[1],A=b[2],N=b[3],G=b[4];b=b[5];const d=l.getEpsilon();return Math.abs(f-H)<=d*Math.max(1,Math.abs(f),Math.abs(H))&&Math.abs(z-Q)<=d*Math.max(1,Math.abs(z),Math.abs(Q))&&Math.abs(I-A)<=d*Math.max(1,Math.abs(I),Math.abs(A))&&Math.abs(r-N)<=d*Math.max(1,Math.abs(r),Math.abs(N))&&Math.abs(y-G)<=d*Math.max(1,Math.abs(y),Math.abs(G))&&Math.abs(a-b)<=d*Math.max(1,Math.abs(a),Math.abs(b))}const k=Object.freeze(Object.defineProperty({__proto__:null,
add:P,copy:g,determinant:t,equals:e,exactEquals:m,frob:B,fromRotation:h,fromScaling:x,fromTranslation:C,identity:v,invert:J,mul:F,multiply:F,multiplyScalar:q,multiplyScalarAndAdd:n,rotate:M,scale:p,set:D,str:u,sub:K,subtract:K,translate:w},Symbol.toStringTag,{value:"Module"}));c.add=P;c.copy=g;c.determinant=t;c.equals=e;c.exactEquals=m;c.frob=B;c.fromRotation=h;c.fromScaling=x;c.fromTranslation=C;c.identity=v;c.invert=J;c.mat2d=k;c.mul=F;c.multiply=F;c.multiplyScalar=q;c.multiplyScalarAndAdd=n;c.rotate=
M;c.scale=p;c.set=D;c.str=u;c.sub=K;c.subtract=K;c.translate=w;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgGlobalState":function(){define(["exports"],function(c){function l(F=0){D=F}function g(F=0){J=F}function v(F=0){t=F}let D=0,J=0,t=0;c.nextBloomId=function(){return t++};c.nextLinearGradientId=function(){return J++};c.nextPatternId=function(){return D++};c.resetBloomId=v;c.resetLinearGradientId=g;c.resetPatternId=l;c.resetSVGGlobalState=function(){l();
g();v()};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleAcceptedFormats":function(){define(["exports"],function(c){c.defaultAcceptedFormats=["web-gltf","web","cim"];Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(c,
l,g,v,D){function J(M,p,w){const h=`${w}_arrowStart`;w=`${w}_arrowEnd`;M="left"===M;const x={markerStart:null,markerEnd:null};switch(p){case "HL":M?x.markerStart=`url(#${w})`:x.markerEnd=`url(#${h})`;break;case "LL":x.markerStart=`url(#${w})`;break;case "LH":M?x.markerEnd=`url(#${h})`:x.markerStart=`url(#${w})`;break;default:x.markerEnd=`url(#${h})`}return x}function t(M,p,w={}){const {focus:h,numClasses:x,colors:C,rotation:u}=M,{opacity:B,effectList:P,ariaLabel:K}=w;M=w.size??60;w=!!h;const q=Math.sqrt(M**
2+M**2)+(w?0:5),n=[],m=[];var e=[],k=(M||75)/x;for(var a=0;a<x;a++){var b=a*k;for(var f=0;f<x;f++){var z=f*k,I=l.generateFillAttributes(C[a][f]);const r=l.generateStrokeAttributes(null);z={type:"rect",x:z,y:b,width:k,height:k};const y=l.renderDef(I);y&&n.push(y);(I=l.renderShape(z,I.fill,r,null))&&m.push(I);e.push(l.getBoundingBox(z))}}k=null;w||(k="margin: -15px -15px -18px -15px");a=J("left",h,p);b=J("right",h,p);f=l.computeBBox(e);e=l.getTransformMatrix(f,q,q,0,!1,u,!1);f=l.getTransformMatrix(f,
q,q,0,!1,w?-45:null,!1);I={filter:g.getCSSFilterFromEffectList(P)??void 0,opacity:null==B?"":`${B}`};return D.tsx("div",{class:w?F.diamondMidColRamp:F.squareTableCell,styles:I},D.tsx("svg",{"aria-label":K,focusable:!1,height:q,role:"image",style:k,width:q,xmlns:"http://www.w3.org/2000/svg"},D.tsx("defs",null,D.tsx("marker",{id:`${p}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},D.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555",
"stroke-width":"1"})),D.tsx("marker",{id:`${p}_arrowEnd`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},D.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),n),D.tsx("g",{transform:e},m),D.tsx("g",{transform:f},D.tsx("line",{fill:"none","marker-end":a.markerEnd,"marker-start":a.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:M-15,y2:15}),D.tsx("line",{fill:"none","marker-end":b.markerEnd,"marker-start":b.markerStart,
stroke:"#555555","stroke-width":"1",x1:15,x2:M-15,y1:M+10,y2:M+10}))))}const F={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",
squareTableRow:"esri-relationship-ramp--square__table-row",squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};
c.renderRelationshipRamp=function(M,p,w={}){const {focus:h,labels:x}=M,C=!!h;M=t(M,p,w);const u={justifyContent:"center"},B=v.isRTL();p=w.key??p;return C?D.tsx("div",{class:F.diamondContainer,key:`${p}-container`,styles:u},D.tsx("div",{class:F.diamondLeftCol},B?x.right:x.left),D.tsx("div",{class:F.diamondMidCol},D.tsx("div",{class:F.diamondMidColLabel},x.top),M,D.tsx("div",{class:F.diamondMidColLabel},x.bottom)),D.tsx("div",{class:F.diamondRightCol},B?x.left:x.right)):D.tsx("div",{class:F.squareTable,
key:`${p}-container`},D.tsx("div",{class:F.squareTableRow},D.tsx("div",{class:v.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelRightBottom)},B?x.top:x.left),D.tsx("div",{class:F.squareTableCell}),D.tsx("div",{class:v.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelLeftBottom)},B?x.left:x.top)),D.tsx("div",{class:F.squareTableRow},D.tsx("div",{class:F.squareTableCell}),M,D.tsx("div",{class:F.squareTableCell})),D.tsx("div",{class:F.squareTableRow},D.tsx("div",{class:v.classes(F.squareTableCell,
F.squareTableLabel,F.squareTableLabelRightTop)},B?x.right:x.bottom),D.tsx("div",{class:F.squareTableCell}),D.tsx("div",{class:v.classes(F.squareTableCell,F.squareTableLabel,F.squareTableLabelLeftTop)},B?x.bottom:x.right)))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(c,l,g,v){function D(p){if(p){var {type:w}=
p;return w.includes("3d")?v.getSymbolLayerFill(p.symbolLayers.at(0)):"simple-line"===w||"simple-marker"===p.type&&("x"===p.style||"cross"===p.style)?(p=g.getStroke(p))&&p.color:g.getFill(p)}}function J(p,w){const h=w.HH.label,x=w.LL.label,C=w.HL.label;w=w.LH.label;switch(p){case "HH":return{top:h,bottom:x,left:C,right:w};case "HL":return{top:C,bottom:w,left:x,right:h};case "LL":return{top:x,bottom:h,left:w,right:C};case "LH":return{top:w,bottom:C,left:h,right:x};default:return{top:h,bottom:x,left:C,
right:w}}}function t(p){let w=F[p];p&&null==w&&(w=F.HH);return w||0}const F={HH:315,HL:45,LL:135,LH:225},M={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};c.getRelationshipRampColors2D=function(p,w){const h=[],x=p.length**.5;p=l.clone(p);var C=(w||"HH").split("");w=C[0];for(C="H"===C[1];p.length;){const u=[];for(;u.length<x;)u.push(p.shift());C&&u.reverse();
h.push(u)}"L"===w&&h.reverse();return h};c.getRelationshipRampElement=function(p){const {focus:w,infos:h,numClasses:x}=p;var C=M[x];const u={};h.forEach(B=>{u[B.value]={label:B.label,fill:D(B.symbol)}});p=[];for(let B=0;B<x;B++){const P=[];for(let K=0;K<x;K++)P.push(u[C[B][K]].fill);p.push(P)}C=J(w,u);return{type:"relationship-ramp",numClasses:x,focus:w,colors:p,labels:C,rotation:t(w)}};c.getRotationAngleForFocus=t;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h,x,C){function u(d){const E=d.outline;var L=null!=d.material?d.material.color:null;L=null!=L?L.toHex():null;if(null==E||"pattern"in E&&null!=E.pattern&&"style"===E.pattern.type&&"none"===E.pattern.style)return"fill"===d.type&&"#ffffff"===L?{color:"#bdc3c7",width:.75}:null;d=t.pt2px(E.size)||0;return{color:"rgba("+(null!=E.color?E.color.toRgba():"255,255,255,1")+")",width:Math.min(d,A),style:"pattern"in E&&null!=E.pattern&&"style"===E.pattern.type?F.dekebabifyLineStyle(E.pattern.style):
null,join:"butt",cap:"patternCap"in E?E.patternCap:"butt"}}async function B(d,E){if(d.thumbnail?.url)return d.thumbnail.url;if("icon"===E.type&&E?.resource?.href)return x.getIconHref(E);E=l.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return d.styleOrigin&&(d.styleOrigin.styleName||d.styleOrigin.styleUrl)&&(d=await C.resolveWebStyleSymbol(d.styleOrigin,{portal:d.styleOrigin.portal}).catch(()=>null))&&"thumbnail"in d&&d.thumbnail?.url?d.thumbnail.url:E}function P(d,E=1){const L=d.a;
d=g.toHSV(d);const {r:R,g:U,b:V}=g.toRGB({h:d.h,s:d.s/E,v:100-(100-d.v)/E});return[R,U,V,L]}function K(d){return"water"===d.type?null==d.color?null:d.color:null==d.material?.color?null:d.material.color}function q(d,E=0){var L=K(d);if(!L){if("fill"===d.type)return null;E=w.adjustColorComponentBrightness(F.defaultThematicColor.r,E);return[E,E,E,100]}d=L.toRgba();for(L=0;3>L;L++)d[L]=w.adjustColorComponentBrightness(d[L],E);return d}async function n(d,E){d=d.style;return"none"===d?null:{type:"pattern",
x:0,y:0,src:await F.getPatternUrlWithColor(l.getAssetUrl(`esri/symbols/patterns/${d}.png`),E.toCss(!0)),width:5,height:5}}function m(d){return d.outline?u(d):{color:"rgba(0, 0, 0, 1)",width:1.5}}function e(d,E){d=K(d);if(!d)return null;let L;L="rgba("+(w.adjustColorComponentBrightness(d.r,E)+",");L+=w.adjustColorComponentBrightness(d.g,E)+",";L+=w.adjustColorComponentBrightness(d.b,E)+",";return L+d.a+");"}function k(d,E){E=e(d,E);if(!E)return{};if("pattern"in d&&null!=d.pattern&&"style"===d.pattern.type&&
"none"===d.pattern.style)return null;const L=Math.min(d.size?t.pt2px(d.size):.75,A);return{color:E,width:L,style:"pattern"in d&&null!=d.pattern&&"style"===d.pattern.type?F.dekebabifyLineStyle(d.pattern.style):null,cap:"cap"in d?d.cap:null,join:"join"in d?"miter"===d.join?t.pt2px(2):d.join:null}}function a(d,E,L){L=null!=L?.75*L:0;return{type:"linear",x1:L?.25*L:0,y1:L?.5*L:0,x2:L||4,y2:L?.5*L:4,colors:[{color:d,offset:0},{color:E,offset:1}]}}function b(d){const E=d.depth,L=d.height;d=d.width;return 0!==
d&&0!==E&&0!==L&&d===E&&null!=d&&null!=L&&d<L}function f(d,E,L){const R=[];if(!d)return R;switch(d.type){case "icon":switch(d.resource?.primitive??M.defaultPrimitive){case "circle":R.push({shape:{type:"circle",cx:0,cy:0,r:.5*E},fill:q(d,0),stroke:u(d)});break;case "square":R.push({shape:{type:"path",path:[{command:"M",values:[0,E]},{command:"L",values:[0,0]},{command:"L",values:[E,0]},{command:"L",values:[E,E]},{command:"Z",values:[]}]},fill:q(d,0),stroke:u(d)});break;case "triangle":R.push({shape:{type:"path",
path:[{command:"M",values:[0,E]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,E]},{command:"Z",values:[]}]},fill:q(d,0),stroke:u(d)});break;case "cross":R.push({shape:{type:"path",path:[{command:"M",values:[.5*E,0]},{command:"L",values:[.5*E,E]},{command:"M",values:[0,.5*E]},{command:"L",values:[E,.5*E]}]},stroke:m(d)});break;case "x":R.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[E,E]},{command:"M",values:[E,0]},{command:"L",values:[0,E]}]},stroke:m(d)});
break;case "kite":R.push({shape:{type:"path",path:[{command:"M",values:[0,.5*E]},{command:"L",values:[.5*E,0]},{command:"L",values:[E,.5*E]},{command:"L",values:[.5*E,E]},{command:"Z",values:[]}]},fill:q(d,0),stroke:u(d)})}break;case "object":switch(d.resource?.primitive??p.defaultPrimitive){case "cone":var U=q(d,0);d=q(d,-.6);d=a(U,d,L?G:E);E=w.getConeShapes(E,L);R.push({shape:E[0],fill:d},{shape:E[1],fill:d});break;case "inverted-cone":L=q(d,0);d=q(d,-.6);d=a(L,d,E);E=w.getInvertedConeShapes(E);
R.push({shape:E[0],fill:d},{shape:E[1],fill:L});break;case "cube":E=w.getCubeShapes(E,L);R.push({shape:E[0],fill:q(d,0)},{shape:E[1],fill:q(d,-.3)},{shape:E[2],fill:q(d,-.5)});break;case "cylinder":U=q(d,0);const V=q(d,-.6);U=a(U,V,L?G:E);E=w.getCylinderShapes(E,L);R.push({shape:E[0],fill:U},{shape:E[1],fill:U},{shape:E[2],fill:q(d,0)});break;case "diamond":E=w.getDiamondShapes(E);R.push({shape:E[0],fill:q(d,-.3)},{shape:E[1],fill:q(d,0)},{shape:E[2],fill:q(d,-.3)},{shape:E[3],fill:q(d,-.7)});break;
case "sphere":L=q(d,0);d=q(d,-.6);d=a(L,d);d.x1=0;d.y1=0;d.x2=.25*E;d.y2=.25*E;R.push({shape:{type:"circle",cx:0,cy:0,r:.5*E},fill:d});break;case "tetrahedron":E=w.getTetrahedronShapes(E),R.push({shape:E[0],fill:q(d,-.3)},{shape:E[1],fill:q(d,0)},{shape:E[2],fill:q(d,-.6)})}}return R}function z(d){return(d="number"===typeof d?.size?d?.size:null)?t.pt2px(d):null}async function I(d,E){const L=z(E),R=E?.maxSize?t.pt2px(E.maxSize):null,U=E?.disableUpsampling??!1,V=[],X=[];let Y=!1,aa=0,W=0,ca=0;d.symbolLayers.forEach(da=>
{if("icon"===da.type||"object"===da.type){da&&"icon"===da.type&&(ca=Math.max(da.size&&t.pt2px(da.size),ca));var O="icon"===da.type?da.size&&t.pt2px(da.size):0,S=L||O?Math.ceil(Math.min(L||O,R||Q)):H,T="icon"===da.type?da.angle:null;null!=E?.rotation&&(T=(T??0)+E.rotation);X.push(T);if(da?.resource?.href){var Z=B(d,da).then(ea=>{const ba=da?.material?.color;var ha="icon"===da.type?"multiply":"tint";return h.tintImageWithColor(ea,S,ba,ha,U)}).then(ea=>{const ba=ea.width,ha=ea.height;aa=Math.max(aa,
ba);W=Math.max(W,ha);T&&(Y=!0);return[{shape:{type:"image",x:0,y:0,width:ba,height:ha,src:ea.url},fill:null,stroke:null}]});V.push(Z)}else Z=S,"icon"===da.type&&L&&(Z=O/ca*S),O="tall"===E?.symbolConfig||E?.symbolConfig?.isTall||("object"===da.type?b(da):!1),aa=Math.max(aa,O?G:Z),W=Math.max(W,Z),T&&da.resource?.primitive&&["square","triangle","x"].includes(da.resource?.primitive)&&(Y=!0),V.push(Promise.resolve(f(da,Z,O)))}});const fa=[];(await Promise.allSettled(V)).forEach(da=>{"fulfilled"===da.status?
fa.push(da.value):da.reason&&J.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",da.reason)});return h.renderSymbol(fa,[aa,W],{node:E?.node,scale:!1,opacity:E?.opacity,ariaLabel:E?.ariaLabel,rotations:X,useRotationSize:Y})}function r(d,E){const L=d.symbolLayers,R=[];d=x.isVolumetricSymbol(d);const U=z(E),V=(E?.maxSize?t.pt2px(E.maxSize):null)||A;let X=0,Y=0,aa;L.forEach((W,ca)=>{if(W&&("line"===W.type||"path"===W.type)){var fa=[];switch(W.type){case "line":var da=
k(W,0);if(null==da)break;var O=da?.width||0;0===ca&&(aa=O);W=Math.min(U||O,V);ca=0===ca?W:U?O/aa*W:W;O=ca>N/2?2*ca:N;Y=Math.max(Y,ca);X=Math.max(X,O);da.width=ca;fa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*Y]},{command:"L",values:[X,.5*Y]}]},stroke:da});break;case "path":da=Math.min(U||H,V);ca=q(W,0);O=q(W,-.2);var S=e(W,-.4);S=S?{color:S,width:1}:{};if("quad"===W.profile){const T=W.width;W=W.height;W=w.getPathSymbolShapes(T&&W?T/W:1,0===W,0===T);S={...S,join:"bevel"};fa.push({shape:W[0],
fill:O,stroke:S},{shape:W[1],fill:O,stroke:S},{shape:W[2],fill:ca,stroke:S})}else fa.push({shape:w.shapes.pathSymbol3DLayer[0],fill:O,stroke:S},{shape:w.shapes.pathSymbol3DLayer[1],fill:ca,stroke:S});X=Y=Math.max(Y,da)}R.push(fa)}});return Promise.resolve(h.renderSymbol(R,[X,Y],{node:E?.node,scale:d,opacity:E?.opacity,ariaLabel:E?.ariaLabel}))}async function y(d,E){const L="mesh-3d"===d.type;d=d.symbolLayers;var R=z(E);const U=E?.maxSize?t.pt2px(E.maxSize):null;R=R||H;const V=[];let X=0,Y=0;var aa=
!1;for(let O=0;O<d.length;O++){var W=d.at(O);const S=[];if(!L||"fill"===W.type){switch(W.type){case "fill":aa=Math.min(R,U||Q);X=Math.max(X,aa);Y=Math.max(Y,aa);aa=!0;if(L){var ca=w.shapes.meshSymbol3DFill,fa=e(W,-.4);fa=fa?{color:fa,width:1,join:"round"}:{};S.push({shape:ca[0],fill:q(W,0),stroke:fa},{shape:ca[1],fill:q(W,-.2),stroke:fa},{shape:ca[2],fill:q(W,-.6),stroke:fa})}else{ca=q(W,0);fa="pattern"in W?W.pattern:null;var da=u(W);W=K(W);null!=fa&&"style"===fa.type&&"solid"!==fa.style&&W&&(ca=
await n(fa,W));S.push({shape:w.shapes.fill[0],fill:ca,stroke:da})}break;case "line":W=k(W,0);if(null==W)break;W={stroke:W,shape:w.shapes.fill[0]};X=Math.max(X,H);Y=Math.max(Y,H);S.push(W);break;case "extrude":ca={join:"round",width:1,...k(W,-.4)};fa=q(W,0);W=q(W,-.2);da=Math.min(R,U||Q);const T=w.getExtrudeSymbolShapes(da);ca.width=1;S.push({shape:T[0],fill:W,stroke:ca},{shape:T[1],fill:W,stroke:ca},{shape:T[2],fill:fa,stroke:ca});W=.7*H+.5*da;X=Math.max(X,H);Y=Math.max(Y,W);break;case "water":aa=
K(W),W=P(aa),ca=P(aa,2),fa=P(aa,3),da=w.getWaterSymbolShapes(),aa=!0,S.push({shape:da[0],fill:W},{shape:da[1],fill:ca},{shape:da[2],fill:fa}),W=Math.min(R,U||Q),X=Math.max(X,W),Y=Math.max(Y,W)}V.push(S)}}return h.renderSymbol(V,[X,Y],{node:E?.node,scale:aa,opacity:E?.opacity,ariaLabel:E?.ariaLabel})}const H=w.SymbolSizeDefaults.size,Q=w.SymbolSizeDefaults.maxSize,A=w.SymbolSizeDefaults.maxOutlineSize,N=w.SymbolSizeDefaults.lineWidth,G=w.SymbolSizeDefaults.tallSymbolWidth;c.getPatternDescriptor=n;
c.getSizeFromOptions=z;c.getSymbolLayerFill=q;c.previewSymbol3D=function(d,E){if(0===d.symbolLayers.length)return Promise.reject(new D("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(d.type){case "point-3d":return I(d,E);case "line-3d":return r(d,E);case "polygon-3d":case "mesh-3d":return y(d,E)}return Promise.reject(new D("symbolPreview: swatchInfo3D","symbol not supported."))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail ./typeUtils ./webStyleAcceptedFormats".split(" "),
function(c,l,g,v,D,J,t,F,M,p,w,h){function x(B,P){return P.items.find(K=>K.name===B)}async function C(B,P,K,q,n){const m=null!=K?.portal?K.portal:D.getDefault(),e={portal:m,url:v.urlToObject(B.baseUrl),origin:"portal-item"},k=x(P,B.data);if(!k)throw new g("symbolstyleutils:symbol-name-not-found",`The symbol name '${P}' could not be found`,{symbolName:P});var a=n?.acceptedFormats??h.defaultAcceptedFormats;q=q(k,a);if(!q)throw new g("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${P}' does not have an accepted format (one of ${a})`,
{symbolName:P});const {url:b,format:f}=q;a=J.fromJSON(b,e);let z=k.thumbnail?.href??null;const I=k.thumbnail?.imageData;l.isDevEnvironment()&&(a=l.adjustStaticAGOUrl(a)??"",z=l.adjustStaticAGOUrl(z));const r={portal:m,url:v.urlToObject(v.removeFile(a)),origin:"portal-item"};return M.requestJSON(a,n).then(y=>{y="cim"===f?M.makeCIMSymbolRef(y.data):y.data;if((y=t.fromJSON(y,r))&&w.isSymbol3D(y)){if(z){const H=J.fromJSON(z,e);y.thumbnail=new p.Thumbnail({url:H})}else I&&(y.thumbnail=new p.Thumbnail({url:`data:image/png;base64,${I}`}));
B.styleUrl?y.styleOrigin=new F({portal:K.portal,styleUrl:B.styleUrl,name:P}):B.styleName&&(y.styleOrigin=new F({portal:K.portal,styleName:B.styleName,name:P}))}return y})}function u(B,P,K){const q=M.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,B),n=null!=P.portal?P.portal:D.getDefault();return M.requestJSON(q,K).then(m=>{m=M.makeCIMSymbolRef(m.data);return t.fromJSON(m,{portal:n,url:v.urlToObject(v.removeFile(q)),origin:"portal-item"})})}c.fetchSymbolFromStyle=C;c.getStyleItemFromStyle=x;c.resolveWebStyleSymbol=
function(B,P,K){const q=B.name;return null==q?Promise.reject(new g("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):"Esri2DPointSymbolsStyle"===B.styleName?u(q,P,K):M.fetchStyle(B,P,K).then(n=>C(n,q,P,M.symbolUrlFromStyleItem,K))};Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(c){const l=/^devext\.arcgis\.com$/,g=/^qaext\.arcgis\.com$/,v=/^[\w-]*\.mapsdevext\.arcgis\.com$/,
D=/^[\w-]*\.mapsqa\.arcgis\.com$/,J=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,l,g,/^jsapps\.esri\.com$/,v,D];c.adjustStaticAGOUrl=function(t,F){return t?(F=F||globalThis.location.hostname)?null!=F.match(l)||null!=F.match(v)?t.replace("static.arcgis.com","staticdev.arcgis.com"):null!=F.match(g)||null!=F.match(D)?t.replace("static.arcgis.com","staticqa.arcgis.com"):t:t:null};c.devHostnames=J;c.isDevEnvironment=function(t){t=t||globalThis.location.hostname;return J.some(F=>null!=t?.match(F))};
Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/actionUtils":function(){define(["exports","../../core/Error","../../core/Logger","../../core/promiseUtils","./actions"],function(c,l,g,v,D){function J(h){const {selectedFeature:x,location:C,view:u}=h;return u?x??C??null:null}function t(h){return!!h&&h.isAggregate&&"cluster"===h.sourceLayer?.featureReduction?.type}async function F(h,x){if("3d"!==x?.type||!h||"esri.Graphic"!==h.declaredClass)return!0;if((x=x.getViewForGraphic(h))&&
"whenGraphicBounds"in x){let C=null;try{C=await x.whenGraphicBounds(h,{useViewElevation:!0})}catch(u){}return!C||!C.boundingBox||C.boundingBox[0]===C.boundingBox[3]&&C.boundingBox[1]===C.boundingBox[4]&&C.boundingBox[2]===C.boundingBox[5]}return!0}async function M(h,x){const {location:C,selectedFeature:u,view:B,zoomFactor:P}=h;await x?.viewModel?.updateGeometry();x=x?.graphic;const K=x?.geometry?x:J(h);if(!B||!K)throw h=new l("zoom-to:invalid-target-or-view","Cannot zoom to location without a target and view.",
{target:K,view:B}),g.getLogger("esri.widgets.Popup.PopupViewModel").error(h),h;const q=B.scale/P,n=x?.geometry??h.selectedFeature?.geometry??C,m=null!=n&&"point"===n.type&&await F(x??u,B);D.zoomToFeature.active=!0;D.zoomToFeature.disabled=!0;try{await h.zoomTo({target:{target:K,scale:m?q:void 0}})}catch(k){if(!v.isAbortError(k)){var e=new l("zoom-to:invalid-graphic","Could not zoom to the location of the graphic.",{graphic:x??u});g.getLogger("esri.widgets.Popup.PopupViewModel").error(e)}}finally{D.zoomToFeature.active=
!1,D.zoomToFeature.disabled=!1,h.zoomToLocation=null,m&&(h.location=n)}}async function p(h){const {selectedFeature:x,view:C}=h;if("2d"!==C?.type)throw h=new l("zoomToCluster:invalid-view","View must be 2d MapView.",{view:C}),g.getLogger("esri.widgets.Popup.PopupViewModel").error(h),h;if(!x||!t(x))throw h=new l("zoomToCluster:invalid-selectedFeature","Selected feature must represent an aggregate/cluster graphic.",{selectedFeature:x}),g.getLogger("esri.widgets.Popup.PopupViewModel").error(h),h;const [u,
B]=await w(C,x);D.zoomToClusteredFeatures.active=!0;D.zoomToClusteredFeatures.disabled=!0;const {extent:P}=await u.queryExtent(B);P&&await h.zoomTo({target:P});D.zoomToClusteredFeatures.active=!1;D.zoomToClusteredFeatures.disabled=!1}async function w(h,x){h=await h.whenLayerView(x.sourceLayer);const C=h.createQuery();x=x.getObjectId();C.aggregateIds=null!=x?[x]:[];return[h,C]}c.browseAggregateFeatures=async function(h){const {selectedFeature:x,view:C}=h;if(C&&x){var [u,B]=await w(C,x);D.browseClusteredFeatures.active=
!0;D.browseClusteredFeatures.disabled=!0;var {features:P}=await u.queryFeatures(B);D.browseClusteredFeatures.active=!1;D.browseClusteredFeatures.disabled=!1;D.browseClusteredFeatures.value=!0;P={features:[x].concat(P)};"feature"===h?.initialDisplayMode&&(P.featureMenuOpen=!0);h?.open(P)}};c.displayClusterExtent=async function(h){const {view:x,selectedFeature:C}=h;if(x&&C){var [u,B]=await w(x,C),{extent:P}=await u.queryExtent(B);h.selectedClusterBoundaryFeature.geometry=P;x.graphics.add(h.selectedClusterBoundaryFeature)}};
c.getSelectedTarget=J;c.isClusterFeature=t;c.removeClusteredFeaturesForBrowsing=function(h){D.browseClusteredFeatures.value=!1;const x=h.features.filter(C=>t(C));x.length&&(h.features=x)};c.triggerAction=h=>{const {event:x,view:C,viewModel:u}=h;({action:h}=x);if(!h)return Promise.reject(new l("trigger-action:missing-arguments","Event has no action"));const {disabled:B,id:P}=h;if(!P)return Promise.reject(new l("trigger-action:invalid-action","action.id is missing"));if(B)return Promise.reject(new l("trigger-action:invalid-action",
"Action is disabled"));if(P===D.zoomToFeature.id)return M(u).catch(v.throwIfNotAbortError);if(P===D.zoomToClusteredFeatures.id)return p(u);if(P===D.browseClusteredFeatures.id)return u.browseClusterEnabled=!u.browseClusterEnabled,u.featureMenuOpen=u.browseClusterEnabled,Promise.resolve();if(P===D.removeSelectedFeature.id){u.visible=!1;({selectedFeature:h}=u);if(!h)return Promise.reject(new l(`trigger-action:${D.removeSelectedFeature.id}`,"selectedFeature is required",{selectedFeature:h}));const {sourceLayer:K}=
h;K?K.remove(h):C?.graphics.remove(h)}return Promise.resolve()};c.zoomToClusterExtent=p;c.zoomToLocation=M;Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/GoTo":function(){define("../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(c,l,g,v,D,J,t){return F=>{F=class extends F{constructor(...M){super(...M);
this.view=this.goToOverride=null}callGoTo(M){const {view:p}=this;l.assertIsSome(p);return this.goToOverride?this.goToOverride(p,M):p.goTo(M.target,M.options)}};c.__decorate([g.property()],F.prototype,"goToOverride",void 0);c.__decorate([g.property()],F.prototype,"view",void 0);return F=c.__decorate([t.subclass("esri.widgets.support.GoTo")],F)}})},"esri/widgets/Features/FeaturesVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(c,l,g,v,D,J,t){l=class extends l{constructor(){super(...arguments);this.closeButton=this.actionBar=!0;this.collapseButton=!1;this.spinner=this.heading=this.flow=this.featureListLayerTitle=this.featureNavigation=this.featureMenuHeading=!0}};c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"actionBar",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"closeButton",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"collapseButton",
void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"featureMenuHeading",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"featureNavigation",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"featureListLayerTitle",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"flow",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"heading",void 0);c.__decorate([g.property({type:Boolean,
nonNullable:!0})],l.prototype,"spinner",void 0);return l=c.__decorate([t.subclass("esri.widgets.Features.FeaturesVisibleElements")],l)})},"esri/widgets/Popup/css":function(){define(["exports"],function(c){c.css={base:"esri-popup",baseHidden:"esri-popup--hidden",main:"esri-popup__main-container",shadow:"esri-popup--shadow",isDocked:"esri-popup--is-docked",isDockedTopLeft:"esri-popup--is-docked-top-left",isDockedTopCenter:"esri-popup--is-docked-top-center",isDockedTopRight:"esri-popup--is-docked-top-right",
isDockedBottomLeft:"esri-popup--is-docked-bottom-left",isDockedBottomCenter:"esri-popup--is-docked-bottom-center",isDockedBottomRight:"esri-popup--is-docked-bottom-right",alignTopCenter:"esri-popup--aligned-top-center",alignBottomCenter:"esri-popup--aligned-bottom-center",alignTopLeft:"esri-popup--aligned-top-left",alignBottomLeft:"esri-popup--aligned-bottom-left",alignTopRight:"esri-popup--aligned-top-right",alignBottomRight:"esri-popup--aligned-bottom-right",pointer:"esri-popup__pointer",pointerDirection:"esri-popup__pointer-direction"};
Object.defineProperty(c,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Popup/PopupViewModel":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/subclass ../Features/FeaturesViewModel".split(" "),function(c,l,g,v,D,J,t){l=class extends t{constructor(F){super(F)}};return l=c.__decorate([J.subclass("esri.widgets.Popup.PopupViewModel")],l)})},"esri/widgets/Popup/PopupVisibleElements":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(c,l,g,v,D,J,t){l=class extends l{constructor(){super(...arguments);this.spinner=this.heading=this.featureListLayerTitle=this.featureNavigation=this.featureMenuHeading=this.collapseButton=this.closeButton=this.actionBar=!0}};c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"actionBar",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"closeButton",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"collapseButton",void 0);
c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"featureMenuHeading",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"featureNavigation",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"featureListLayerTitle",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"heading",void 0);c.__decorate([g.property({type:Boolean,nonNullable:!0})],l.prototype,"spinner",void 0);return l=c.__decorate([t.subclass("esri.widgets.Popup.PopupVisibleElements")],
l)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/Logger ../core/promiseUtils ../core/reactiveUtils ../core/scheduling ../core/string ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ../support/actions/ActionButton ./Features ./Widget ./Features/FeaturesViewModel ./Popup/css ./Popup/PopupViewModel ./Popup/PopupVisibleElements ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory".split(" "),function(c,
l,g,v,D,J,t,F,M,p,w,h,x,C,u,B,P,K,q,n,m,e){const k={buttonEnabled:!0,position:"auto",breakpoint:{width:544}};F=class extends x{constructor(a,b){super(a,b);this._dockAction=new w({id:"popup-dock-action"});this._featuresWidget=new h({responsiveActionsEnabled:!0});this._mainContainerNode=this._containerNode=null;this._pointerOffsetInPx=16;this._focusAbortController=null;this.alignment="auto";this.dockEnabled=!1;this.headingLevel=2;this.messages=null;this.viewModel=new B;this.visibleElements=new P}initialize(){this.addHandles([v.watch(()=>
[this.viewModel?.view?.widthBreakpoint,this.dockEnabled],()=>this._handleDockIcon(),v.initial),v.watch(()=>[this.dockEnabled,this.messages?.undock,this.messages?.dock],()=>this._handleDockEnabled(),v.initial),v.watch(()=>this.dockOptions,a=>{const {_dockAction:b}=this,f=this._featuresWidget.headerActions;f.remove(b);a.buttonEnabled&&f.add(b)},v.initial),v.watch(()=>this.viewModel?.screenLocation,()=>this._positionContainer()),v.watch(()=>[this.viewModel?.active,this.dockEnabled],()=>this._toggleScreenLocationEnabled()),
v.watch(()=>[this.viewModel?.screenLocation,this.viewModel?.view?.padding,this.viewModel?.view?.size,this.viewModel?.active,this.viewModel?.location,this.alignment],()=>this.reposition()),v.watch(()=>this.viewModel?.view?.size,(a,b)=>this._updateDockEnabledForViewSize(a,b)),v.watch(()=>this.viewModel?.view,(a,b)=>this._viewChange(a,b)),v.watch(()=>this.viewModel?.view?.ready,(a,b)=>this._viewReadyChange(a??!1,b??!1)),v.watch(()=>this.viewModel,()=>this._featuresWidget.viewModel=this.viewModel,v.initial),
v.watch(()=>this._featureNavigationTop,a=>this._featuresWidget.featureNavigationTop=a,v.initial),v.watch(()=>this.headingLevel,a=>this._featuresWidget.headingLevel=a,v.initial),v.watch(()=>this.visibleElements.actionBar,a=>this._featuresWidget.visibleElements.actionBar=!!a,v.initial),v.watch(()=>this.visibleElements.closeButton,a=>this._featuresWidget.visibleElements.closeButton=!!a,v.initial),v.watch(()=>this.visibleElements.collapseButton,a=>this._featuresWidget.visibleElements.collapseButton=!!a,
v.initial),v.watch(()=>this.visibleElements.heading,a=>this._featuresWidget.visibleElements.heading=!!a,v.initial),v.watch(()=>this.visibleElements.spinner,a=>this._featuresWidget.visibleElements.spinner=!!a,v.initial),v.watch(()=>this.visibleElements.featureNavigation,a=>this._featuresWidget.visibleElements.featureNavigation=!!a,v.initial),v.watch(()=>this.visibleElements.featureMenuHeading,a=>this._featuresWidget.visibleElements.featureMenuHeading=!!a,v.initial),v.watch(()=>this.visibleElements.featureListLayerTitle,
a=>this._featuresWidget.visibleElements.featureListLayerTitle=!!a,v.initial),v.on(()=>this._featuresWidget,"trigger-header-action",a=>{a.action===this._dockAction&&(this.dockEnabled=!this.dockEnabled)})])}destroy(){this._dockAction.destroy();this._featuresWidget&&(this._featuresWidget.viewModel=new C,this._featuresWidget.destroy());this._focusAbortController?.abort()}get _featureNavigationTop(){const {currentAlignment:a,currentDockPosition:b}=this;return"bottom-left"===a||"bottom-center"===a||"bottom-right"===
a||"top-left"===b||"top-center"===b||"top-right"===b}get actions(){return this.viewModel.actions}set actions(a){this.viewModel.actions=a}get active(){return this.viewModel.active}get autoCloseEnabled(){return this.viewModel.autoCloseEnabled}set autoCloseEnabled(a){this.viewModel.autoCloseEnabled=a}get defaultPopupTemplateEnabled(){return this.viewModel.defaultPopupTemplateEnabled}set defaultPopupTemplateEnabled(a){this.viewModel.defaultPopupTemplateEnabled=a}get content(){return this.viewModel.content}set content(a){this.viewModel.content=
a}get collapsed(){return this._featuresWidget.collapsed}set collapsed(a){this._featuresWidget.collapsed=a}get currentAlignment(){return this._getCurrentAlignment()}get currentDockPosition(){return this._getCurrentDockPosition()}get dockOptions(){return this._get("dockOptions")||k}set dockOptions(a){var b={...k};const f=this.viewModel?.view?.breakpoints;var z={};f&&(z.width=f.xsmall,z.height=f.xsmall);a={...b,...a};b={...b.breakpoint,...z};({breakpoint:z}=a);"object"===typeof z?a.breakpoint={...b,
...z}:z&&(a.breakpoint=b);this._set("dockOptions",a);this._setCurrentDockPosition();this.reposition()}get featureCount(){return this.viewModel.featureCount}get featureMenuOpen(){return this.viewModel.featureMenuOpen}set featureMenuOpen(a){this.viewModel.featureMenuOpen=a}get features(){return this.viewModel.features}set features(a){this.viewModel.features=a}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(a){this.viewModel.goToOverride=a}get highlightEnabled(){return this.viewModel.highlightEnabled}set highlightEnabled(a){this.viewModel.highlightEnabled=
a}get icon(){return"popup"}set icon(a){this._overrideIfSome("icon",a)}get initialDisplayMode(){return this.viewModel.initialDisplayMode}set initialDisplayMode(a){this.viewModel.initialDisplayMode=a}get location(){return this.viewModel.location}set location(a){this.viewModel.location=a}get label(){return this.messages?.widgetLabel??""}set label(a){this._overrideIfSome("label",a)}get promises(){return this.viewModel.promises}set promises(a){this.viewModel.promises=a}get selectedFeature(){return this.viewModel.selectedFeature}get selectedDrillInFeature(){return this._featuresWidget.selectedDrillInFeature??
null}get selectedFeatureIndex(){return this.viewModel.selectedFeatureIndex}set selectedFeatureIndex(a){this.viewModel.selectedFeatureIndex=a}get selectedFeatureWidget(){return this._featuresWidget.selectedFeatureWidget}get title(){return this.viewModel.title}set title(a){this.viewModel.title=a}get updateLocationEnabled(){return this.viewModel.updateLocationEnabled}set updateLocationEnabled(a){this.viewModel.updateLocationEnabled=a}get view(){return this.viewModel.view}set view(a){this.viewModel.view=
a}get visible(){return this.viewModel.visible}set visible(a){this.viewModel.visible=a}blur(){const {active:a}=this.viewModel;a||l.getLogger(this).warn("Popup can only be blurred when currently active.");this._featuresWidget.blur()}clear(){return this.viewModel.clear()}close(){this.visible=!1}fetchFeatures(a,b){return this.viewModel.fetchFeatures(a,b)}focus(){const {active:a}=this.viewModel;a||l.getLogger(this).warn("Popup can only be focused when currently active.");this._handleFocus()}next(){return this.viewModel.next()}open(a){this.set({collapsed:a?
!!a.collapsed:!1,featureMenuOpen:a?!!a.featureMenuOpen:!1});this.viewModel.open(a);a?.shouldFocus&&this._handleFocus(!0)}previous(){return this.viewModel.previous()}reposition(){this.renderNow();this._positionContainer();this._setCurrentAlignment()}triggerAction(a){return this.viewModel.triggerAction(a)}render(){const {dockEnabled:a,currentAlignment:b,currentDockPosition:f}=this,{active:z,screenLocation:I}=this.viewModel,r=this.selectedFeature?.layer?.title,y=this.selectedFeature?.layer?.id,H={[u.css.alignTopCenter]:"top-center"===
b,[u.css.alignBottomCenter]:"bottom-center"===b,[u.css.alignTopLeft]:"top-left"===b,[u.css.alignBottomLeft]:"bottom-left"===b,[u.css.alignTopRight]:"top-right"===b,[u.css.alignBottomRight]:"bottom-right"===b,[u.css.isDocked]:z&&a,[u.css.shadow]:z&&!a,[u.css.isDockedTopLeft]:"top-left"===f,[u.css.isDockedTopCenter]:"top-center"===f,[u.css.isDockedTopRight]:"top-right"===f,[u.css.isDockedBottomLeft]:"bottom-left"===f,[u.css.isDockedBottomCenter]:"bottom-center"===f,[u.css.isDockedBottomRight]:"bottom-right"===
f};return e.tsx("div",{afterCreate:this._positionContainer,afterUpdate:this._positionContainer,"aria-hidden":(!z).toString(),"aria-label":J.stripHTML(this.title??""),"aria-modal":"false",bind:this,class:this.classes(u.css.base,H,{[u.css.baseHidden]:!I&&!a}),"data-layer-id":y,"data-layer-title":r,role:"dialog"},z?[this._renderMainContainer(),this._renderPointer()]:null)}_renderPointer(){return this.dockEnabled?null:e.tsx("div",{class:u.css.pointer,key:"popup-pointer",role:"presentation"},e.tsx("div",
{class:this.classes(u.css.pointerDirection,u.css.shadow)}))}_renderMainContainer(){const {dockEnabled:a}=this;return e.tsx("div",{afterCreate:this._setMainContainerNode,afterUpdate:this._setMainContainerNode,bind:this,class:this.classes(u.css.main,K.globalCss.widget,{[u.css.shadow]:a})},this._featuresWidget.render())}_getAnimationDurationMS(){const {_containerNode:a}=this;return a?1E3*parseFloat(window.getComputedStyle(a).animationDuration):200}async _handleFocus(a=!1){this._focusAbortController?.abort();
this._focusAbortController=new AbortController;const b=this._focusAbortController.signal;a&&await v.whenOnce(()=>!0===this.viewModel?.active,{signal:b});await g.ignoreAbortErrors(D.waitAnimationFrame(b));await g.ignoreAbortErrors(g.after(this._getAnimationDurationMS(),b));this._featuresWidget.focus()}_isOutsideView(a){const {popupHeight:b,popupWidth:f,screenLocation:z,side:I,view:r}=a;if(isNaN(f)||isNaN(b)||!r||!z)return!1;a=r.padding;return"right"===I&&z.x+f/2>r.width-a.right||"left"===I&&z.x-f/
2<a.left||"top"===I&&z.y-b<a.top||"bottom"===I&&z.y+b>r.height-a.bottom?!0:!1}_calculateAutoAlignment(a){if("auto"!==a)return a;const {_pointerOffsetInPx:b,_containerNode:f,_mainContainerNode:z,viewModel:I}=this,{screenLocation:r,view:y}=I;if(null==r||!y||!f)return"top-center";var H=(a=z?window.getComputedStyle(z,null):null)?parseInt(a.getPropertyValue("max-height").replaceAll(/[^-\d.]/g,""),10):0,Q=a?parseInt(a.getPropertyValue("height").replaceAll(/[^-\d.]/g,""),10):0;const {height:A,width:N}=f.getBoundingClientRect();
a=N+b;const G=Math.max(A,H,Q)+b;H=this._isOutsideView({popupHeight:G,popupWidth:a,screenLocation:r,side:"right",view:y});Q=this._isOutsideView({popupHeight:G,popupWidth:a,screenLocation:r,side:"left",view:y});const d=this._isOutsideView({popupHeight:G,popupWidth:a,screenLocation:r,side:"top",view:y});a=this._isOutsideView({popupHeight:G,popupWidth:a,screenLocation:r,side:"bottom",view:y});return Q?d?"bottom-right":"top-right":H?d?"bottom-left":"top-left":d?a?"top-center":"bottom-center":"top-center"}_callCurrentAlignment(a){return"function"===
typeof a?a.call(this):a}_getCurrentAlignment(){const {alignment:a,dockEnabled:b}=this;return b||!this.viewModel.active?null:this._calculatePositionResult(this._calculateAutoAlignment(this._callCurrentAlignment(a)))}_setCurrentAlignment(){this._set("currentAlignment",this._getCurrentAlignment())}_setCurrentDockPosition(){this._set("currentDockPosition",this._getCurrentDockPosition())}_calculatePositionResult(a){const b=["left","right"];q.isRTL(this.container)&&b.reverse();return a?.replace(/leading/gi,
b[0]).replaceAll(/trailing/gi,b[1])}_callDockPosition(a){return"function"===typeof a?a.call(this):a}_getDockPosition(){return this._calculatePositionResult(this._calculateAutoDockPosition(this._callDockPosition(this.dockOptions?.position)))}_getCurrentDockPosition(){return this.dockEnabled&&this.viewModel.active?this._getDockPosition():null}_calculateAutoDockPosition(a){if("auto"!==a)return a;var b=this.viewModel?.view;a=q.isRTL(this.container)?"top-left":"top-right";if(!b)return a;var f=b.padding||
{left:0,right:0,top:0,bottom:0};f=b.width-f.left-f.right;({breakpoints:b}=b);return b&&f<=b.xsmall?"bottom-center":a}_getDockIcon(){const a=this._getDockPosition();if(this.dockEnabled)return"minimize";switch(a){case "top-left":case "bottom-left":return"dock-left";case "top-center":return"maximize";case "bottom-center":return"dock-bottom";default:return"dock-right"}}_handleDockIcon(){this._dockAction.icon=this._getDockIcon()}_handleDockEnabled(){this._dockAction.title=this.dockEnabled?this.messages?.undock:
this.messages?.dock}_setMainContainerNode(a){this._mainContainerNode=a}_positionContainer(a=this._containerNode){a&&(this._containerNode=a);if(this._containerNode){({screenLocation:a}=this.viewModel);var {width:b}=this._containerNode.getBoundingClientRect();(a=this._calculatePositionStyle(a,b))&&Object.assign(this._containerNode.style,a)}}_calculateFullWidth(a){const {currentAlignment:b,_pointerOffsetInPx:f}=this;return"top-left"===b||"bottom-left"===b||"top-right"===b||"bottom-right"===b?a+f:a}_calculateAlignmentPosition(a,
b,f,z){const {currentAlignment:I,_pointerOffsetInPx:r}=this;if(f){var {padding:y}=f;z/=2;var H=f.height-b;f=f.width-a;if("bottom-center"===I)return{top:b+r-y.top,left:a-z-y.left};if("top-left"===I)return{bottom:H+r-y.bottom,right:f+r-y.right};if("bottom-left"===I)return{top:b+r-y.top,right:f+r-y.right};if("top-right"===I)return{bottom:H+r-y.bottom,left:a+r-y.left};if("bottom-right"===I)return{top:b+r-y.top,left:a+r-y.left};if("top-center"===I)return{bottom:H+r-y.bottom,left:a-z-y.left}}}_calculatePositionStyle(a,
b){const {dockEnabled:f,view:z}=this;if(z){if(f)return{left:"",top:"",right:"",bottom:""};if(null!=a&&b&&(b=this._calculateFullWidth(b),a=this._calculateAlignmentPosition(a.x,a.y,z,b)))return{top:void 0!==a.top?`${a.top}px`:"auto",left:void 0!==a.left?`${a.left}px`:"auto",bottom:void 0!==a.bottom?`${a.bottom}px`:"auto",right:void 0!==a.right?`${a.right}px`:"auto"}}}_viewChange(a,b){a&&b&&(this.close(),this.clear())}_viewReadyChange(a,b){a?this._wireUpView():b&&(this.close(),this.clear())}_wireUpView(){this._setDockEnabledForViewSize(this.dockOptions)}_dockingThresholdCrossed(a,
b,f){const [z,I]=a,[r,y]=b,{width:H=0,height:Q=0}=f??{};return z<=H&&r>H||z>H&&r<=H||I<=Q&&y>Q||I>Q&&y<=Q}_updateDockEnabledForViewSize(a,b){if(a&&b){var f=this.viewModel?.view?.padding||{left:0,right:0,top:0,bottom:0},z=f.left+f.right,I=f.top+f.bottom;f=[];var r=[];f[0]=a[0]-z;f[1]=a[1]-I;r[0]=b[0]-z;r[1]=b[1]-I;({dockOptions:a}=this);this._dockingThresholdCrossed(f,r,a.breakpoint)&&this._setDockEnabledForViewSize(a);this._setCurrentDockPosition()}}_toggleScreenLocationEnabled(){const {dockEnabled:a,
viewModel:b}=this;b&&(b.screenLocationEnabled=b.active&&!a)}_shouldDockAtCurrentViewSize(a){a=a.breakpoint;var b=this.viewModel?.view?.ui;if(!b)return!1;const {width:f,height:z}=b;if(isNaN(f)||isNaN(z)||!a)return!1;b=a.hasOwnProperty("width")&&f<=(a.width??0);a=a.hasOwnProperty("height")&&z<=(a.height??0);return b||a}_setDockEnabledForViewSize(a){a.breakpoint&&(this.dockEnabled=this._shouldDockAtCurrentViewSize(a))}};c.__decorate([t.property({readOnly:!0})],F.prototype,"_featureNavigationTop",null);
c.__decorate([t.property()],F.prototype,"actions",null);c.__decorate([t.property({readOnly:!0})],F.prototype,"active",null);c.__decorate([t.property()],F.prototype,"alignment",void 0);c.__decorate([t.property()],F.prototype,"autoCloseEnabled",null);c.__decorate([t.property()],F.prototype,"defaultPopupTemplateEnabled",null);c.__decorate([t.property()],F.prototype,"content",null);c.__decorate([t.property()],F.prototype,"collapsed",null);c.__decorate([t.property({readOnly:!0})],F.prototype,"currentAlignment",
null);c.__decorate([t.property({readOnly:!0})],F.prototype,"currentDockPosition",null);c.__decorate([t.property()],F.prototype,"dockOptions",null);c.__decorate([t.property()],F.prototype,"dockEnabled",void 0);c.__decorate([t.property({readOnly:!0})],F.prototype,"featureCount",null);c.__decorate([t.property()],F.prototype,"featureMenuOpen",null);c.__decorate([t.property()],F.prototype,"features",null);c.__decorate([t.property()],F.prototype,"goToOverride",null);c.__decorate([t.property()],F.prototype,
"headingLevel",void 0);c.__decorate([t.property()],F.prototype,"highlightEnabled",null);c.__decorate([t.property()],F.prototype,"icon",null);c.__decorate([t.property()],F.prototype,"initialDisplayMode",null);c.__decorate([t.property()],F.prototype,"location",null);c.__decorate([t.property()],F.prototype,"label",null);c.__decorate([t.property(),n.messageBundle("esri/widgets/Popup/t9n/Popup")],F.prototype,"messages",void 0);c.__decorate([t.property()],F.prototype,"promises",null);c.__decorate([t.property({readOnly:!0})],
F.prototype,"selectedFeature",null);c.__decorate([t.property({readOnly:!0})],F.prototype,"selectedDrillInFeature",null);c.__decorate([t.property()],F.prototype,"selectedFeatureIndex",null);c.__decorate([t.property({readOnly:!0})],F.prototype,"selectedFeatureWidget",null);c.__decorate([t.property()],F.prototype,"title",null);c.__decorate([t.property()],F.prototype,"updateLocationEnabled",null);c.__decorate([t.property()],F.prototype,"view",null);c.__decorate([t.property({type:B}),m.vmEvent(["triggerAction",
"trigger-action"])],F.prototype,"viewModel",void 0);c.__decorate([t.property()],F.prototype,"visible",null);c.__decorate([t.property({type:P,nonNullable:!0})],F.prototype,"visibleElements",void 0);return F=c.__decorate([p.subclass("esri.widgets.Popup")],F)});