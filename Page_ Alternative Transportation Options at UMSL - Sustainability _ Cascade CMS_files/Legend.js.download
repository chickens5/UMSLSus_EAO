// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.32/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Legend/LegendViewModel":function(){define("../../chunks/tslib.es6 ../../intl ../../core/Accessor ../../core/Collection ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../core/accessorSupport/get ../../views/2d/layers/features/layerAdapters/featureReductionUtils ./support/ActiveLayerInfo ../../intl/locale".split(" "),function(g,A,C,B,v,F,y,H,
K,z,h,c,l,d){const f=B.ofType(l),k=new Set("esri.layers.BuildingSceneLayer esri.layers.CatalogLayer esri.layers.CSVLayer esri.layers.FeatureLayer esri.layers.GeoJSONLayer esri.layers.GeoRSSLayer esri.layers.GroupLayer esri.layers.HeatmapLayer esri.layers.ImageryLayer esri.layers.ImageryTileLayer esri.layers.MapImageLayer esri.layers.OGCFeatureLayer esri.layers.OrientedImageryLayer esri.layers.ParquetLayer esri.layers.PointCloudLayer esri.layers.StreamLayer esri.layers.SceneLayer esri.layers.SubtypeGroupLayer esri.layers.TileLayer esri.layers.VoxelLayer esri.layers.WFSLayer esri.layers.WMSLayer esri.layers.WMTSLayer esri.layers.WCSLayer esri.layers.LinkChartLayer esri.layers.catalog.CatalogFootprintLayer esri.layers.catalog.CatalogDynamicGroupLayer esri.layers.knowledgeGraph.KnowledgeGraphSublayer esri.layers.KnowledgeGraphLayer".split(" ")),
m=["view.basemapView.baseLayerViews","view.groundView.layerViews","view.layerViews","view.basemapView.referenceLayerViews"];A=class extends C{constructor(r){super(r);this._layerViewByLayerId={};this._layerInfosByLayerViewId={};this._activeLayerInfosByLayerViewId={};this._activeLayerInfosWithNoParent=new B;this.activeLayerInfos=new f;this.respectLayerDefinitionExpression=this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=this.groundLegendVisible=this.basemapLegendVisible=!1;this.respectLayerVisibility=
!0;this.layerInfos=[];this.view=null}initialize(){this.addHandles(v.watch(()=>this.view,()=>this._viewHandles(),v.initial),"view");this.addHandles(d.onLocaleChange(()=>this._refresh()))}destroy(){this._destroyViewActiveLayerInfos();this.view=null}get state(){return this.view?.ready?"ready":"disabled"}_viewHandles(){this.removeHandles("state");this.view&&this.addHandles(v.watch(()=>this.state,()=>this._stateHandles(),v.initial),"state")}_stateHandles(){this._resetAll();"ready"===this.state&&this._watchPropertiesAndAllLayerViews()}_resetAll(){this.removeHandles(["all-layer-views",
"legend-properties"]);this._destroyViewActiveLayerInfos();this.activeLayerInfos.removeAll()}_destroyViewActiveLayerInfos(){Object.keys(this._activeLayerInfosByLayerViewId).forEach(this._destroyViewActiveLayerInfo,this)}_destroyViewActiveLayerInfo(r){this.removeHandles(r);const n=this._activeLayerInfosByLayerViewId[r];delete this._activeLayerInfosByLayerViewId[r];n?.parent&&n.parent.children.remove(n)}_watchPropertiesAndAllLayerViews(){var {view:r}=this;r&&({allLayerViews:r}=r,r.length&&this._refresh(),
this.addHandles(r.on("change",n=>this._allLayerViewsChangeHandle(n)),"all-layer-views"),this.addHandles(v.watch(()=>[this.layerInfos,this.basemapLegendVisible,this.groundLegendVisible],()=>this._propertiesChangeHandle()),"legend-properties"))}_allLayerViewsChangeHandle(r){r.moved.length?this._propertiesChangeHandle():(r.removed.forEach(n=>this._destroyViewActiveLayerInfo(n.uid)),this._refresh())}_propertiesChangeHandle(){this._destroyViewActiveLayerInfos();this._refresh()}_refresh(){this._layerInfosByLayerViewId=
{};this.activeLayerInfos.removeAll();this._generateLayerViews().filter(this._filterLayerViewsByLayerInfos,this).filter(this._isLayerViewSupported,this).forEach(this._generateActiveLayerInfo,this);this._sortActiveLayerInfos(this.activeLayerInfos)}_sortActiveLayerInfos(r){const n=this.view;if(!(2>r.length)&&n){var q=[];r.forEach(w=>{if(!w.parent){var E=w.layer.parent;(E=(E=E&&"uid"in E&&this._layerViewByLayerId[E.uid])&&this._activeLayerInfosByLayerViewId[E.uid])&&r.includes(E)&&(q.push(w),w.parent=
E,E.children.add(w),this._sortActiveLayerInfos(E.children))}});r.removeMany(q);var u={};n.allLayerViews.forEach((w,E)=>u[w.layer.uid]=E);r.sort((w,E)=>(u[E.layer.uid]||0)-(u[w.layer.uid]||0))}}_generateLayerViews(){const r=[];m.filter(this._filterLayerViews,this).map(n=>h.get(this,n)).filter(n=>null!=n).forEach(this._collectLayerViews("layerViews",r));return r}_filterLayerViews(r){const n=!this.groundLegendVisible&&"view.groundView.layerViews"===r;return!(!this.basemapLegendVisible&&("view.basemapView.baseLayerViews"===
r||"view.basemapView.referenceLayerViews"===r))&&!n}_collectLayerViews(r,n){const q=u=>{u&&u.forEach(w=>{n.push(w);q(w[r])});return n};return q}_filterLayerViewsByLayerInfos(r){const n=this.layerInfos;return n&&n.length?n.some(q=>this._hasLayerInfo(q,r)):!0}_hasLayerInfo(r,n){const q=this._isLayerUIDMatching(r.layer,n.layer.uid);q&&(this._layerInfosByLayerViewId[n.uid]=r);return q}_isLayerUIDMatching(r,n){return r&&(r.uid===n||this._hasLayerUID(r.layers,n))}_hasLayerUID(r,n){return r&&r.some(q=>this._isLayerUIDMatching(q,
n))}_isLayerViewSupported(r){return k.has(r.layer.declaredClass)?(this._layerViewByLayerId[r.layer.uid]=r,!0):!1}_generateActiveLayerInfo(r){this._isLayerActive(r)?this._buildActiveLayerInfo(r):(this.removeHandles(r.uid),this.addHandles(v.watch(()=>[r.legendEnabled,r.layer?.legendEnabled],()=>this._layerActiveHandle(r)),r.uid))}_layerActiveHandle(r){this._isLayerActive(r)&&(this.removeHandles(r.uid),this._buildActiveLayerInfo(r))}_isLayerActive(r){return this.respectLayerVisibility?r.legendEnabled&&
r.layer?.legendEnabled:!0}_buildActiveLayerInfo(r){const n=r.layer,q=r.uid;var u=this._layerInfosByLayerViewId[q];let w=this._activeLayerInfosByLayerViewId[q];w||(w=new l({layer:n,layerView:r,title:void 0!==u?.title&&u.layer.uid===n.uid?u.title:n.title,view:this.view??void 0,respectLayerDefinitionExpression:this.respectLayerDefinitionExpression,respectLayerVisibility:this.respectLayerVisibility,hideLayersNotInCurrentView:this.hideLayersNotInCurrentView,keepCacheOnDestroy:this.keepCacheOnDestroy,sublayerIds:u?.sublayerIds||
[]}),this._activeLayerInfosByLayerViewId[q]=w);w.parent=this._activeLayerInfosByLayerViewId[(n.parent&&"uid"in n.parent?this._layerViewByLayerId[n.parent?.uid]:null)?.uid];if(!this.hasHandles(q)){u=v.watch(()=>n.title,T=>this._titleHandle(T,w));var E=v.watch(()=>[n.opacity,"renderer"in n&&n.renderer,"pointSymbol"in n&&n.pointSymbol,"lineSymbol"in n&&n.lineSymbol,"polygonSymbol"in n&&n.polygonSymbol],()=>this._constructLegendElements(w)),e=v.when(()=>!0===this.view?.stationary,()=>this._scaleHandle(w),
v.initial);const b=v.watch(()=>r.layer?c.getEffectiveFeatureReduction(r.layer,r.view):null,()=>this._constructLegendElements(w)),p=v.watch(()=>r.updating,()=>{null!=r.layer&&null!=c.getEffectiveFeatureReduction(r.layer,r.view)&&this._constructLegendElements(w)}),I=v.watch(()=>"effect"in n&&n.effect,()=>this._constructLegendElements(w)),R=v.when(()=>this.view?.timeZone,()=>this._constructLegendElements(w),v.initial);u=[u,E,e,b,p,I,R];this.respectLayerVisibility&&(E=v.watch(()=>r.legendEnabled,T=>this._legendEnabledHandle(T,
w)),e=v.watch(()=>n.legendEnabled,T=>this._legendEnabledHandle(T,w)),u.push(E,e));this.respectLayerDefinitionExpression&&"definitionExpression"in n&&(E=v.watch(()=>[n.definitionExpression,this.respectLayerDefinitionExpression],()=>{w.respectLayerDefinitionExpression=this.respectLayerDefinitionExpression;this._constructLegendElements(w)}),u.push(E));this.addHandles(u,q)}w.isScaleDriven||this._constructLegendElements(w);this._addActiveLayerInfo(w)}_titleHandle(r,n){n.title=r;this._constructLegendElements(n)}_legendEnabledHandle(r,
n){r?this._addActiveLayerInfo(n):this._removeActiveLayerInfo(n)}_scaleHandle(r){(r.isScaleDriven||r.hideLayersNotInCurrentView)&&this._constructLegendElements(r)}_addActiveLayerInfo(r){const {layerView:n,layer:q}=r;if(this._isLayerActive(n)&&!this.activeLayerInfos.includes(r)){var u=r.parent;if(u)u.children.includes(r)||u.children.push(r),this._sortActiveLayerInfos(u.children);else{u=this.layerInfos?.some(E=>E.layer.uid===q.uid);const w=q.parent;w&&"uid"in w&&this._layerViewByLayerId[w.uid]&&!u?this._activeLayerInfosWithNoParent.add(r):
(this.activeLayerInfos.add(r),this._sortActiveLayerInfos(this.activeLayerInfos))}if(this._activeLayerInfosWithNoParent.length){const w=[];this._activeLayerInfosWithNoParent.forEach(E=>{var e=E.layer.parent;if(e=this._activeLayerInfosByLayerViewId[(e&&"uid"in e?this._layerViewByLayerId[e?.uid]:null)?.uid])w.push(E),E.parent=e});w.length&&(this._activeLayerInfosWithNoParent.removeMany(w),w.forEach(E=>this._addActiveLayerInfo(E)))}}}_removeActiveLayerInfo(r){const n=r.parent;n?n.children.remove(r):this.activeLayerInfos.remove(r)}_constructLegendElements(r){const n=
r.layer;"featureCollections"in n&&n.featureCollections?r.buildLegendElementsForFeatureCollections(n.featureCollections):"featureReduction"in n&&n.featureReduction&&"renderer"in n.featureReduction&&("binning"===n.featureReduction.type||"cluster"===n.featureReduction.type)&&(!this.view||n.featureReduction.maxScale<=this.view.scale)?r.buildLegendElementsForFeatureReduction(n.featureReduction):"renderer"in n&&n.renderer&&!("sublayers"in n)?r.buildLegendElementsForRenderer(n.renderer):"url"in n&&n.url&&
"catalog"!==n.type&&"knowledge-graph"!==n.type?r.buildLegendElementsForTools():r.children.forEach(q=>this._constructLegendElements(q))}};g.__decorate([F.property({type:f})],A.prototype,"activeLayerInfos",void 0);g.__decorate([F.property()],A.prototype,"basemapLegendVisible",void 0);g.__decorate([F.property()],A.prototype,"groundLegendVisible",void 0);g.__decorate([F.property()],A.prototype,"hideLayersNotInCurrentView",void 0);g.__decorate([F.property()],A.prototype,"keepCacheOnDestroy",void 0);g.__decorate([F.property()],
A.prototype,"respectLayerDefinitionExpression",void 0);g.__decorate([F.property()],A.prototype,"respectLayerVisibility",void 0);g.__decorate([F.property()],A.prototype,"layerInfos",void 0);g.__decorate([F.property({readOnly:!0})],A.prototype,"state",null);g.__decorate([F.property()],A.prototype,"view",void 0);return A=g.__decorate([z.subclass("esri.widgets.Legend.LegendViewModel")],A)})},"esri/views/2d/layers/features/layerAdapters/featureReductionUtils":function(){define(["exports"],function(g){g.getEffectiveFeatureReduction=
function(A,C){return(A=A.featureReduction)&&"selection"!==A.type?!("maxScale"in A&&A.maxScale)||A.maxScale<C.scale?A:null:null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/ActiveLayerInfo":function(){define("require ../../../chunks/tslib.es6 ../../../Color ../../../intl ../../../kernel ../../../request ../../../core/Accessor ../../../core/arrayUtils ../../../core/Collection ../../../core/has ../../../core/jsonMap ../../../core/Logger ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/screenUtils ../../../core/sql ../../../core/urlUtils ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ../../../core/accessorSupport/PropertyOrigin ../../../layers/effects/EffectView ../../../layers/effects/jsonUtils ../../../layers/support/displayFilterUtils ../../../layers/support/ExportImageParameters ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../layers/support/rasterFormats/pixelRangeUtils ../../../renderers/support/jsonUtils ../../../renderers/support/rendererConversion ../../../renderers/visualVariables/SizeVariable ../../../renderers/visualVariables/support/SizeVariableLegendOptions ../../../smartMapping/renderers/support/referenceSizeUtils ../../../symbols/SimpleFillSymbol ../../../symbols/SimpleMarkerSymbol ../../../symbols/support/cimSymbolUtils ../../../symbols/support/previewUtils ../../../symbols/support/renderUtils ../../../symbols/support/symbolUtils ../../../symbols/support/utils ./clusterUtils ./colorRampUtils ./heatmapRampUtils ./relationshipRampUtils ./sizeRampUtils ./utils ../../smartMapping/support/utils ../../../intl/messages ../../../intl/substitute".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l,d,f,k,m,r,n,q,u,w,E,e,b,p,I,R,T,J,M,U,x,L,Q,G,N,S,W,ca,Z,ja,ma,da,X,fa,oa,ba){function la(a){return"esri.renderers.SimpleRenderer"===a.declaredClass}function ia(a){return"esri.renderers.ClassBreaksRenderer"===a.declaredClass}function qa(a){return"esri.renderers.UniqueValueRenderer"===a.declaredClass}function ta(a){return"esri.renderers.HeatmapRenderer"===a.declaredClass}function va(a){return"esri.renderers.PointCloudClassBreaksRenderer"===a.declaredClass}function ya(a){return"esri.renderers.PointCloudStretchRenderer"===
a.declaredClass}function za(a){return"esri.renderers.PointCloudUniqueValueRenderer"===a.declaredClass}function Da(a){return"esri.renderers.DotDensityRenderer"===a.declaredClass}function La(a){return"esri.renderers.PieChartRenderer"===a.declaredClass}function Ha(a){return"esri.layers.SubtypeGroupLayer"===a.declaredClass}function Sa(a){return"esri.layers.MapImageLayer"===a.declaredClass}function $a(a){a="authoringInfo"in a?a?.authoringInfo:null;return"univariate-color-size"===a?.type&&"above-and-below"===
a?.univariateTheme}async function Ba(a,t){const D=await oa.fetchMessageBundle("esri/widgets/Legend/t9n/Legend");"previewTemplateAriaLabel"!==a||t||(a="previewAriaLabel");return ba.substitute(D[a],{label:t})}const Ma=/^\s*(return\s+)?\$view\.scale\s*(;)?\s*$/i,ab=new h.JSONMap({esriGeometryPoint:"point",esriGeometryMultipoint:"multipoint",esriGeometryPolyline:"polyline",esriGeometryPolygon:"polygon",esriGeometryMultiPatch:"multipatch"}),Na=new L({size:6,outline:{color:[128,128,128,.5],width:.5}}),
bb=new x({style:"solid"}),cb=new L({style:"path",path:"M10,5 L5,0 0,5 M5,0 L5,15",size:15,outline:{width:1,color:[85,85,85,1]}});let Ea={};B=class extends y{constructor(a){super(a);this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._webStyleSymbolCache=new Map;this._dotDensityUrlCache=new Map;this._scaleDrivenSizeVariable=null;this._hasClusterSizeVariable=!1;this._layerDisplayFilterClause=this._layerDisplayFilterId=this._layerDefinitionExpressionClause=this._layerDefinitionExpression=
null;this.children=new K;this.layer=this.layerView=null;this.legendElements=[];this.parent=null;this.respectLayerDefinitionExpression=this.keepCacheOnDestroy=this.hideLayersNotInCurrentView=!1;this.respectLayerVisibility=!0;this.sublayerIds=[];this.view=this.title=null}initialize(){const a=()=>this.notifyChange("ready");this.addHandles([d.on(()=>this.children,"change",t=>{const {added:D,removed:O}=t;D.forEach(P=>{const V=`activeLayerInfo-ready-watcher-${P.layer.uid}`;this.addHandles(d.watch(()=>P.ready,
a,d.initial),V)});O.forEach(P=>this.removeHandles(P.layer.uid));a()})]);this.keepCacheOnDestroy||(Ea={})}destroy(){this._scaleDrivenSizeVariable=this._dotDensityUrlCache=this._webStyleSymbolCache=null;this.keepCacheOnDestroy||(Ea=null);this._layerDefinitionExpressionClause=null}get effectList(){const a=this.layer;let t=null;"effect"in a&&a.effect&&(t=new u.EffectView,t.effect=a.effect,t.endTransition(),t.scale=this.scale);return t}get opacity(){const a=this.layer.opacity,t=this.parent?.opacity;var D=
this.layer.parent;D=D&&"uid"in D?this._getParentLayerOpacity(D):null;return null!=t?t*a:null!=D?D*a:a}get ready(){return null===this.layer?!0:0<this.children.length?this._isGroupActive():0<this.legendElements.length}get scale(){return this.view?.scale??0}get isScaleDriven(){const a=this.layer;if(null===a)return!1;if("effect"in a&&a.effect&&Array.isArray(a.effect))return!0;if("featureReduction"in a&&a.featureReduction){if("cluster"===a.featureReduction.type)return!0;if("binning"===a.featureReduction.type&&
"renderer"in a.featureReduction&&a.featureReduction.renderer)return this._isRendererScaleDriven(a.featureReduction.renderer)}return"renderer"in a&&a.renderer?"displayFilterInfo"in a&&a.displayFilterInfo&&qa(a.renderer)?!0:this._isRendererScaleDriven(a.renderer):this._isLayerScaleDriven(this.layer)}get version(){return this._get("version")+1}async buildLegendElementsForFeatureCollections(a){if(this.hideLayersNotInCurrentView&&!await this._isLayerInCurrentView())this.legendElements=[],this.notifyChange("ready");
else{a=Array.from(a,t=>{if(p.isFeatureLayer(t))return this._getRendererLegendElements(t.renderer,{title:t.title});if(t.featureSet?.features.length){var D=t.layerDefinition,O=D?.drawingInfo;O=O&&R.fromJSON(O.renderer);D=ab.read(D.geometryType);return O?this._getRendererLegendElements(O,{title:t.name,geometryType:D}):(c.getLogger(this).warn("drawingInfo not available!"),null)}return null});try{const t=[],D=await Promise.allSettled(a);for(const O of D)if("fulfilled"===O.status)for(const P of O.value??
[])t.push(P);this.legendElements=t;this.notifyChange("ready")}catch(t){c.getLogger(this).warn("error while building legend for layer!",t)}}}async buildLegendElementsForRenderer(a){try{this.legendElements=(this.hideLayersNotInCurrentView?await this._isLayerInCurrentView():1)?await this._getRendererLegendElements(a):[],this.notifyChange("ready")}catch(t){c.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForFeatureReduction(a){try{this.legendElements=(this.hideLayersNotInCurrentView?
await this._isLayerInCurrentView():1)?await this._getLegendElementsForFeatureReduction(a):[],this.notifyChange("ready")}catch(t){c.getLogger(this).warn("error while building legend for layer!",t)}}async buildLegendElementsForTools(){const a=this.layer;if("esri.layers.VoxelLayer"===a.declaredClass)this._constructLegendElementsForVoxelLayer();else if("esri.layers.WMTSLayer"===a.declaredClass)this._constructLegendElementsForWMTSlayer();else if("esri.layers.WMSLayer"===a.declaredClass)await this._constructLegendElementsForWMSSublayers();
else if("esri.layers.BuildingSceneLayer"===a.declaredClass)await this._constructLegendElementsForBuildingSceneLayer();else if(Sa(a)||"esri.layers.TileLayer"===a.declaredClass||Ha(a))await this._constructLegendElementsForSublayers();else{this.removeHandles("imageryLayers-watcher");var t="default";if("esri.layers.ImageryLayer"===a.declaredClass){t=a?.rasterFunction?.functionName||"default";const D=a.bandIds?.length?a.bandIds.join(""):"###";t=t+"_"+D}"esri.layers.ImageryTileLayer"!==a.declaredClass&&
"link-chart"!==a.type&&await this._getLegendLayers(`${a.uid}-${t}`).then(async D=>{this.legendElements=[];this.notifyChange("ready");D=D.map(async O=>{if("esri.layers.ImageryLayer"===a.declaredClass){const P=d.watch(()=>[a.rasterFunction,a.bandIds],()=>l.debounce(async()=>{Ea["default"]=null;a.renderer?await this.buildLegendElementsForRenderer(a.renderer):await this.buildLegendElementsForTools()})());this.addHandles(P,"imageryLayers-watcher")}O=this._generateSymbolTableElementForLegendLayer(O);O?.infos.length&&
("esri.layers.ImageryLayer"===a.declaredClass&&(O.title=a.title),this.legendElements.push(O));this.notifyChange("ready")});await Promise.allSettled(D)}).catch(D=>{c.getLogger(this).warn("Request to server for legend has failed!",D)})}}async _isLayerInCurrentView(){const a=this.layer,t=this.layerView,D=t&&"createQuery"in t&&"queryFeatureCount"in t;if(!(D||t&&"createQuery"in a&&"queryFeatureCount"in a))return!0;await d.whenOnce(()=>!t.updating);const O=D?"createQuery"in t&&t.createQuery():"createQuery"in
a&&a.createQuery();if(!O)return!0;O.geometry=this.view.extent;return 0!==(D?"queryFeatureCount"in t&&await t.queryFeatureCount(O):"queryFeatureCount"in a&&await a.queryFeatureCount(O))}_getParentLayerOpacity(a){let t=1;const D=a.parent;D&&"uid"in D&&(t=this._getParentLayerOpacity(D));return a.opacity*t}_isGroupActive(){return this.children.some(a=>a.ready)}_isRendererScaleDriven(a){return"dot-density"===a.type||Ma.test("valueExpression"in a?a.valueExpression:null)||("visualVariables"in a?a.visualVariables:
null)?.some(t=>this._isScaleDrivenSizeVariable(t))?!0:this._hasScaleDrivenSymbols(a)}_hasScaleDrivenSymbols(a){switch(a.type){case "simple":return this._isScaleDrivenSymbol(a.symbol);case "class-breaks":return this._isScaleDrivenSymbol(a.defaultSymbol)||a.classBreakInfos.some(t=>this._isScaleDrivenSymbol(t.symbol));case "unique-value":return this._isScaleDrivenSymbol(a.defaultSymbol)||!!a.uniqueValueInfos?.some(t=>this._isScaleDrivenSymbol(t.symbol))}return!1}_isScaleDrivenSymbol(a){if("cim"===a?.type){const {primitiveOverrides:t,
minScale:D,maxScale:O}=a.data;a=t?.some(P=>/\$view\.scale/.test(P.valueExpressionInfo?.expression||""))??!1;return null!=D||null!=O||a}return!1}_isScaleDrivenSizeVariable(a){if(a&&"size"!==a.type)return!1;const t=a.minSize,D=a.maxSize;return"object"===typeof t&&t&&this._isScaleDrivenSizeVariable(t)||"object"===typeof D&&D&&this._isScaleDrivenSizeVariable(D)?!0:Ma.test(a.valueExpression)}_isLayerScaleDriven(a){if("minScale"in a&&0<a.minScale||"maxScale"in a&&0<a.maxScale)return!0;if("sublayers"in a&&
a.sublayers)return a.sublayers.some(D=>this._isLayerScaleDriven(D));const t=a.parent;if(!1===a.loaded&&t&&Sa(t)&&"source"in a&&a.source&&"map-layer"===a.source.type)for(const D of t.sourceJSON.layers??[])if(D.id===a.source.mapLayerId&&(0<D.minScale||0<D.maxScale))return!0;return!1}async _constructLegendElementsForVoxelLayer(){this.legendElements=[];this.removeHandles("voxel-style-watcher");this.removeHandles("voxel-current-variable");const a=this.layer;this.addHandles(d.watch(()=>a.currentVariableId,
()=>this._constructLegendElementsForVoxelLayer()),"voxel-current-variable");this.addHandles(d.watch(()=>a.getVariableStyles(),()=>this._constructLegendElementsForVoxelLayer()),"voxel-style-watcher");var t=a.getVariableStyle(null);const D=[];if(t)if(t.uniqueValues?.length){const P=[];t.uniqueValues.forEach(V=>{V.enabled&&P.push({label:V.label||`${V.value}`,value:V.value,symbol:new x({color:V.color,outline:null})})});P.length&&D.push({type:"symbol-table",title:t.label,infos:P})}else if(t.transferFunction){const {colorStops:P,
stretchRange:V}=t.transferFunction,Y=P.toArray().reverse(),aa=V.map((sa,na)=>`${0===na?X.specialCharsLessThan:X.specialCharsGreaterThan} ${fa.formatNumberLabel(sa)}`).reverse(),ea=Y.map(sa=>({color:sa.color,value:null,label:null}));ea[0].label=aa[0];ea[ea.length-1].label=aa[1];D.push({type:"color-ramp",title:t.label,infos:ea,preview:S.renderColorRampPreviewHTML(Y.map(sa=>sa.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})})}const O=a.opacity;t=D.reduce((P,V)=>[...P,...this._getAllInfos(V)],
[]).filter(P=>!!P?.symbol).map(P=>this._getSymbolPreview(P,O));await Promise.allSettled(t);this.legendElements=D;this.notifyChange("ready")}_constructLegendElementsForWMTSlayer(){this.legendElements=[];this.removeHandles("wmts-activeLayer-watcher");const a=this.layer.activeLayer;this.addHandles(d.watch(()=>{const {layer:D}=this;return D&&"activeLayer"in D&&D.activeLayer},()=>this._constructLegendElementsForWMTSlayer()),"wmts-activeLayer-watcher");const t=a.styleId?a.styles?.find(({id:D})=>D===a.styleId)?.legendUrl:
void 0;t&&(this.legendElements=[{type:"symbol-table",title:a.title,infos:[{src:t,opacity:this.opacity}]}]);this.notifyChange("ready")}async _constructLegendElementsForWMSSublayers(){this.legendElements=[];this.removeHandles("wms-sublayers-watcher");const a=this.layer;let t=null;if(a.customParameters||a.customLayerParameters)t={...a.customParameters,...a.customLayerParameters};this.addHandles(d.watch(()=>{const {layer:D}=this;return D&&"sublayers"in D&&D.sublayers},()=>this._constructLegendElementsForWMSSublayers()),
"wms-sublayers-watcher");this.legendElements=await this._generateLegendElementsForWMSSublayers(a.sublayers,t);this.notifyChange("ready")}async _generateLegendElementsForWMSSublayers(a,t){const D=this.layer,O=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForWMSSublayers()),"wms-sublayers-watcher");const P=this.sublayerIds?.map(V=>D.findSublayerById(V))?.filter(H.isSome)??[];a=P.length?P:a.toArray();for(const V of a)if(a=d.watch(()=>[V.title,V.visible,V.legendEnabled],()=>this._constructLegendElementsForWMSSublayers()),
this.addHandles(a,"wms-sublayers-watcher"),!this.respectLayerVisibility||V.visible&&V.legendEnabled)a=await this._generateSymbolTableElementForWMSSublayer(V,t),a?.infos.length&&O.unshift(a);return O}async _generateSymbolTableElementForWMSSublayer(a,t){return!a.legendUrl&&a.sublayers?(t=(await this._generateLegendElementsForWMSSublayers(a.sublayers,t)).filter(D=>D),{type:"symbol-table",title:a.title,infos:t}):this._generateSymbolTableElementForLegendUrl(a,t)}async _generateSymbolTableElementForLegendUrl(a,
t){let D=a.legendUrl;if(D){var O={type:"symbol-table",title:a.title||a.name||String(a.id??""),infos:[]};t&&(D=m.addQueryParameters(D,t));t=null;a=a.layer?.opacity;try{if(t=(await F(D,{responseType:"image"})).data)t.style.opacity=a}catch{}O.infos.push({src:D,preview:t,opacity:a});return O}}_getLegendLayers(a,t){const D=Ea&&Ea[a];return D?Promise.resolve(D):this._legendRequest(t).then(O=>{O=O.layers;return Ea[a]=O})}_legendRequest(a){var t=this.layer;a={f:"json",dynamicLayers:a};if("esri.layers.ImageryLayer"===
t.declaredClass){var D=t.exportImageServiceParameters.rasterFunction;D&&(a.renderingRule=JSON.stringify(D.functionDefinition?.toJSON()||D.toJSON()));t.bandIds&&(a.bandIds=t.bandIds.join());if(t.raster||t.viewId||t.customParameters){const {raster:O,viewId:P,customParameters:V}=t;a={raster:O,viewId:P,...a,...V}}}D=t.url.replace(/(\/)+$/,"");"version"in t&&10.01<=+t.version?(t=D.indexOf("?"),D=-1<t?D.slice(0,t)+"/legend"+D.slice(t):D+"/legend"):(t=D.toLowerCase().indexOf("/rest/"),t=-1===t?D:D.slice(0,
t)+D.slice(t+5),D="https://utility.arcgis.com/sharing/tools/legend?soapUrl\x3d"+encodeURI(t)+"\x26returnbytes\x3dtrue");return F(D,{query:a}).then(O=>O.data)}async _constructLegendElementsForBuildingSceneLayer(){this.legendElements=[];this.removeHandles("sublayers-watcher");const a=this.layer;this.addHandles(d.watch(()=>a.sublayers,()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForBuildingSublayers(a.sublayers,
this.opacity),this.notifyChange("ready")}catch(t){c.getLogger(this).warn("Request to server for legend has failed!",t)}}async _generateLegendElementsForBuildingSublayers(a,t){let D=[];this.addHandles(a.on("change",()=>this._constructLegendElementsForBuildingSceneLayer()),"sublayers-watcher");a=a.toArray();for(const P of a)if(a=d.watch(()=>["renderer"in P&&P.renderer,P.opacity,P.title,P.visible],()=>this._constructLegendElementsForBuildingSceneLayer()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||
P.visible){a=null!=P?.opacity?P.opacity:null;var O=null!=a?a*t:t;"building-group"===P.type?(a={type:"symbol-table",title:P.title,infos:[]},O=await this._generateLegendElementsForBuildingSublayers(P.sublayers,O),a.infos.push(...O),D=[a,...D]):P.renderer&&(D=[...(await this._getRendererLegendElements(P.renderer,{title:P.title,opacity:O,sublayer:P})),...D])}return D.filter(P=>!!P&&("infos"in P&&P.infos?0<P.infos.length:!0))}async _constructLegendElementsForSublayers(){this.legendElements=[];this.removeHandles("sublayers-watcher");
const a=this.layer;if(Sa(a)||"esri.layers.TileLayer"===a.declaredClass||Ha(a)){this.addHandles(d.watch(()=>a.sublayers,()=>this._constructLegendElementsForSublayers),"sublayers-watcher");try{this.legendElements=await this._generateLegendElementsForSublayers(a.sublayers,this.opacity),this.notifyChange("ready")}catch(t){c.getLogger(this).warn("Request to server for legend has failed!",t)}}}async _generateLegendElementsForSublayers(a,t,D){const O=this.layer;let P=[];this.addHandles(a.on("change",()=>
this._constructLegendElementsForSublayers()),"sublayers-watcher");a=a.toArray();!D&&this.sublayerIds&&this.sublayerIds.length&&(a=Ha(O)?this.sublayerIds.map(V=>O.findSublayerForSubtypeCode(V)).filter(H.isSome):this.sublayerIds.map(V=>O.findSublayerById(V)).filter(H.isSome));for(const V of a)if(a=d.watch(()=>[V.renderer,V.opacity,V.title,V.visible,V.legendEnabled],()=>this._constructLegendElementsForSublayers()),this.addHandles(a,"sublayers-watcher"),!this.respectLayerVisibility||V.visible&&V.legendEnabled&&
this._isSublayerInScale(V)){a=null!=V?.opacity?V.opacity:null;a=null!=a?a*t:t;const Y="sublayers"in V?V.originIdOf("renderer")>q.OriginId.SERVICE&&!V.sublayers:!0;V.renderer&&Y?(await V.load(),P=[...(await this._getRendererLegendElements(V.renderer,{title:V.title,opacity:a,sublayer:V})),...P]):"sublayers"in V&&(a=await this._generateSymbolTableElementForSublayer(V,a,D))&&P.unshift(a)}return P.filter(V=>!!V&&("infos"in V&&V.infos?0<V.infos.length:!0))}async _generateSymbolTableElementForSublayer(a,
t,D){if(!D){D=new Map;var O=this.layer,P=a.source;let V=null;if(P&&("map-layer"!==P.type||P.mapLayerId!==a.id||P.gdbVersion&&P.gdbVersion!==("gdbVersion"in O&&O.gdbVersion))||a.originIdOf("renderer")>q.OriginId.SERVICE||a.originIdOf("labelingInfo")>q.OriginId.SERVICE||a.originIdOf("labelsVisible")>q.OriginId.SERVICE)P=new e.ExportImageParameters({layer:this.layer}),V=P.hasDynamicLayers?P.dynamicLayers:null,P.destroy();(await this._getLegendLayers(V||`${O.uid}-default`,V)).forEach(Y=>D.set(Y.layerId,
Y))}O=D.get(a.id);return(!O||O?.subLayerIds&&O.defaultVisibility)&&a.sublayers?(t=await this._generateLegendElementsForSublayers(a.sublayers,t,D),{type:"symbol-table",title:a.title,infos:t}):this._generateSymbolTableElementForLegendLayer(O,a,t)}_generateSymbolTableElementForLegendLayer(a,t,D){if(!a?.legend||this.respectLayerVisibility&&!this._isLegendLayerInScale(a,t))return null;var O=t?.renderer;let P=t?.title||a.layerName;O&&(!t||t?.originIdOf("renderer")>q.OriginId.SERVICE)&&(O=t?.title||this._getRendererTitle(O,
t))&&(P&&"string"!==typeof O&&"title"in O&&(O.title=P),P=O);const V={type:"symbol-table",title:P,legendType:a.legendType||null,infos:[]},Y=t?this._sanitizeLegendForSublayer(a.legend.slice(),t):a.legend;a.legendGroups&&0<a.legendGroups.length?a.legendGroups.forEach(aa=>{const ea={type:"symbol-table",title:aa.heading,legendType:a.legendType||null,infos:this._generateSymbolTableElementInfosForLegendLayer(Y.filter(sa=>sa.groupId===aa.id),a.layerId,D)};0<ea.infos?.length&&V.infos.push(ea)}):V.infos=this._generateSymbolTableElementInfosForLegendLayer(Y,
a.layerId,D);return 0<V.infos.length?V:null}_generateSymbolTableElementInfosForLegendLayer(a,t,D){return a.map(O=>{let P=O.url;if(O.imageData&&0<O.imageData.length)P=`data:image/png;base64,${O.imageData}`;else if(0!==P.indexOf("http"))P=v.addTokenParameter(`${this.layer.url}/${t}/images/${P}`);else return null;return{label:O.label,src:P,opacity:null==D?this.opacity:D,width:O.width,height:O.height}}).filter(H.isSome)}_isSublayerInScale(a){const t=a.minScale||0;a=a.maxScale||0;return 0<t&&t<this.scale||
a>this.scale?!1:!0}_isLegendLayerInScale(a,t){t=t||this.layer;let D=null,O=null,P=!0;!t.minScale&&0!==t.minScale||!t.maxScale&&0!==t.maxScale?(0===a.minScale&&t.tileInfo&&(D=t.tileInfo.lods[0].scale),0===a.maxScale&&t.tileInfo&&(O=t.tileInfo.lods[t.tileInfo.lods.length-1].scale)):(D=Math.min(t.minScale,a.minScale)||t.minScale||a.minScale,O=Math.max(t.maxScale,a.maxScale));if(0<D&&D<this.scale||O>this.scale)P=!1;return P}_sanitizeLegendForSublayer(a,t){if("version"in this.layer&&10.1>+this.layer.version||
0===a.length)return a;t=t.renderer;let D=0,O=null;a.some(P=>P.values)&&a.some((P,V)=>{P.values||(D=V,O=P,O.label||(O.label="others"));return null!=O});t?"unique-value"===t.type?O&&(a.splice(D,1),a.push(O)):"class-breaks"===t.type&&(O&&a.splice(D,1),t.legendOptions?.order||a.reverse(),O&&a.push(O)):O&&(a.splice(D,1),a.push(O));return a}async _getRendererLegendElements(a,t={}){var D=this.view;D=la(a)||ia(a)||qa(a)||ta(a)||Da(a)||La(a)?"2d"===D.type||T.isSupportedRenderer3D(a):"raster-stretch"===a.type||
"raster-colormap"===a.type||"raster-shaded-relief"===a.type||va(a)||ya(a)||za(a)||"vector-field"===a.type||"flow"===a.type;if(!D)return c.getLogger(this).warn(`Renderer of type '${a.type}' not supported!`),[];if(va(a)||ya(a)||za(a)||"esri.renderers.PointCloudRGBRenderer"===a.declaredClass)return this._constructPointCloudRendererLegendElements(a,t);if(Da(a))return this._constructDotDensityRendererLegendElements(a);a=await this._loadRenderer(a);return La(a)?this._constructPieChartRendererLegendElements(a):
this._constructRendererLegendElements(a,t)}async _getLegendElementsForFeatureReduction(a){let t=null;"binning"===a.type?t=a.renderer:"cluster"===a.type&&(t=this._getClusterRenderer(a));return t?this._getRendererLegendElements(t):[]}_getPointCloudRendererTitle(a){return(a.legendOptions?.title||a.field)??""}async _constructPointCloudRendererLegendElements(a,t={}){var D=t.title;t=[];let O=null;var P=null;if(va(a))O={type:"symbol-table",title:D||this._getPointCloudRendererTitle(a),infos:[]},a.colorClassBreakInfos.forEach(V=>
{O.infos.unshift({label:V.label||V.minValue+" - "+V.maxValue,value:[V.minValue,V.maxValue],symbol:this._getAppliedCloneSymbol(Na,V.color)})});else if(ya(a)){P=a.stops;let V=null;if(P?.length&&(1===P.length&&(V=P[0].color),!V)){const Y=P[0].value,aa=P[P.length-1].value;null!=Y&&null!=aa&&(V=Z.getColorFromPointCloudStops(Y+(aa-Y)/2,P))}O={type:"symbol-table",title:null,infos:[{label:null,value:null,symbol:this._getAppliedCloneSymbol(Na,V||Na.color)}]};P=Z.getRampStopsForPointCloud(a.stops??[])??[];
P={type:"color-ramp",title:D||this._getPointCloudRendererTitle(a),infos:P,preview:S.renderColorRampPreviewHTML(P.map(Y=>Y.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})}}else za(a)&&(O={type:"symbol-table",title:D||this._getPointCloudRendererTitle(a),infos:[]},a.colorUniqueValueInfos?.forEach(V=>{O.infos.push({label:V.label||V.values.join(", "),value:V.values.join(", "),symbol:this._getAppliedCloneSymbol(Na,V.color)})}));O?.infos.length&&t.push(O);P?.infos.length&&t.push(P);D=t.reduce((V,
Y)=>[...V,...(Y.infos??[])],[]).filter(V=>!!V.symbol).map(V=>this._getSymbolPreview(V,this.opacity,{symbolConfig:{applyColorModulation:!!a.colorModulation}}));await Promise.allSettled(D);return t}async _getElementInfoForDotDensity(a,t){const {color:D,label:O,valueExpressionTitle:P}=t,{backgroundColor:V,outline:Y,dotSize:aa}=a;t=this.effectList?.effects.map(na=>na.toJSON());var ea=w.effectFunctionsFromJSON(t);t=await Ba("previewTemplateAriaLabel",O||P);ea=aa+"-"+D+"-"+V+"-"+(Y&&JSON.stringify(Y.toJSON()))+
"-"+ea;const sa=this._dotDensityUrlCache;a=sa.has(ea)?sa.get(ea):S.renderDotDensityPreviewHTML(a,D,{ariaLabel:t});sa.set(ea,a);t=N.renderSymbol([[{shape:{type:"image",x:0,y:0,width:a.width,height:a.height,src:a.src},fill:null,stroke:null,offset:[0,0]}]],[a.width,a.height],{effectView:this.effectList,ariaLabel:t});return{opacity:1,src:a.src,preview:t,width:a.width,height:a.height}}async _constructDotDensityRendererLegendElements(a){var t=a.calculateDotValue(this.view.scale);t={type:"symbol-table",
title:{value:t&&Math.round(t),unit:a.legendOptions?.unit||""},infos:[]};for(const D of a.attributes){const O=await this._getElementInfoForDotDensity(a,D);O.label=D.label||D.valueExpressionTitle||D.field;t.infos.push(O)}return[t]}async _constructPieChartRendererLegendElements(a){const t=this.layer.opacity,D=[];let O=null;const P=a.outline;a.attributes.forEach(aa=>{const ea=new L({color:aa.color,outline:P});D.push({label:aa.label||aa.valueExpressionTitle||aa.field,symbol:ea})});var V=D.length?[...D]:
[];if(a.othersCategory?.color&&0!==a.othersCategory?.threshold){var Y=new L({color:a.othersCategory.color,outline:P});O=a.othersCategory.label||"Other";D.push({label:O,symbol:Y})}a.defaultColor?.a&&(Y=new L({color:a.defaultColor,outline:P}),D.push({label:a.defaultLabel,symbol:Y}));Y=await this._getVisualVariableLegendElements(a,this.layer)||[];D.length&&(Y.unshift({type:"symbol-table",title:null,infos:D}),V=V.filter(aa=>aa.label!==O).map(aa=>aa.symbol.color).filter(Boolean),V=S.renderPieChartPreviewHTML(V,
{holePercentage:a.holePercentage,backgroundColor:a.backgroundFillSymbol?.color,effectList:this.effectList,outline:P,ariaLabel:await Ba("previewPieChartAriaLabel")}),Y.unshift({type:"pie-chart-ramp",title:this._getRendererTitle(a,this.layer),infos:D,preview:V}));a=Y.reduce((aa,ea)=>[...aa,...this._getAllInfos(ea)],[]).filter(aa=>!!aa?.symbol&&!aa?.preview).map(aa=>this._getSymbolPreview(aa,t,{effectList:this.effectList}));await Promise.allSettled(a);return Y}async _getWhereClause(a,t,D){a=await k.parseWhereClause(a,
D);t=await b.getRendererFields(t,D);const O=new Set(t.map(P=>P.toLowerCase()));return a?.fieldNames.map(P=>P.toLowerCase())?.some(P=>!O.has(P))?null:a}async _processDefinitionExpression(a,t){if("definitionExpression"in a){var D=a.definitionExpression;D&&this.respectLayerDefinitionExpression?this._layerDefinitionExpression!==D&&(this._layerDefinitionExpressionClause=await this._getWhereClause(D,t,a.fieldsIndex)):this._layerDefinitionExpressionClause=null;this._layerDefinitionExpression=D}}async _processDisplayFilter(a,
t){if("displayFilterInfo"in a){var D=a.displayFilterInfo?E.getEffectiveDisplayFilter(a.displayFilterInfo,this.view):null;D?.where?this._layerDisplayFilterId!==D?.id&&(this._layerDisplayFilterClause=await this._getWhereClause(D.where,t,a.fieldsIndex)):this._layerDisplayFilterClause=null;this._layerDisplayFilterId=D?.id;return D}}async _constructRendererLegendElements(a,t={}){const {title:D,sublayer:O}=t,P=O||this.layer,V=X.getReferenceSizeAuthoringInfoVisualVariable(a);var Y=null;qa(a)&&(await this._processDefinitionExpression(P,
a),Y=await this._processDisplayFilter(P,a));this._hasSizeRamp=this._hasOpacityRamp=this._hasColorRamp=!1;this._scaleDrivenSizeVariable=null;const aa=await this._getVisualVariableLegendElements(a,P)||[],ea={type:"symbol-table",title:D||this._getRendererTitle(a,P),infos:[]};let sa=null,na=!1;const Aa=new Set;if("flow"!==a.type||this._hasSizeRamp)if("univariate-color-size"===("authoringInfo"in a?a?.authoringInfo:null)?.type){var ha=D,pa=$a(a)?"univariate-above-and-below-ramp":"univariate-color-size-ramp",
ra=aa.findIndex(ka=>"color-ramp"===ka.type);ra=-1!==ra?aa.splice(ra,1)[0]:null;Y=aa.findIndex(ka=>"size-ramp"===ka.type);Y=-1!==Y?aa.splice(Y,1)[0]:null;var wa=[];ra&&(ha=ra.title,wa.push(ra));Y&&(ha=Y.title,wa.push(Y));0<wa.length&&aa.push({type:pa,title:ha,infos:wa})}else if(ta(a))ha=ja.getHeatmapRampStops(a),aa.push({type:"heatmap-ramp",title:D||this._getRendererTitle(a,P),infos:ha,preview:S.renderColorRampPreviewHTML(ha.map(ka=>ka.color),{effectList:this.effectList,ariaLabel:await Ba("previewColorRampAriaLabel")})});
else if(qa(a)){if((pa=a.authoringInfo)&&"relationship"===pa.type){const {numClasses:ka,field1:ua,field2:xa}=pa;pa=pa.focus;if(ka&&ua&&xa){Y=[ua,xa];ra=ma.getRotationAngleForFocus(pa)||0;for(ha of Y){const {field:Ia,normalizationField:Ja,label:Oa}=ha;Y=Oa||{field:this._getFieldAlias(Ia,P),normField:Ja&&this._getFieldAlias(Ja,P)};wa=cb.clone();wa.angle=ra;ea.infos.push({label:Y,symbol:wa});Aa.add(wa);ra+=90}ha=ma.getRelationshipRampElement({focus:pa,numClasses:ka,infos:a.uniqueValueInfos??[]});aa.unshift(ha)}}else if("esri.layers.ImageryLayer"===
this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass)a.uniqueValueInfos?.forEach(ka=>{ka.symbol&&this._checkClausesForUVR(a,ka.value)&&ea.infos.push({label:ka.label||ka.value,value:ka.value,symbol:ka.symbol})});else{const {field:ka,field2:ua,field3:xa,fieldDelimiter:Ia,valueExpression:Ja,defaultSymbol:Oa}=a,db=!(!ka&&!Ja||!ua&&!xa),eb=this._layerDisplayFilterClause?Y?.title:null,Fa=[];a.uniqueValueGroups?.forEach(Wa=>{const Ta={type:"symbol-table",title:eb||Wa.heading,
infos:[]};Wa.classes?.forEach(Ga=>{const {symbol:Xa,values:fb}=Ga;if(Xa){const Ua=[];var Ca=[];for(var Pa of fb??[]){const {value:Qa,value2:Ya,value3:Za}=Pa,Ka=[],Ra=[];if(ka||Ja)Ka.push(Qa),Ra.push(this._getDomainName(ka,Qa,P));ua&&(Ka.push(Ya),Ra.push(this._getDomainName(ua,Ya,P)));xa&&(Ka.push(Za),Ra.push(this._getDomainName(xa,Za,P)));Ua.push(db?Ka.join(Ia||""):Ka[0]);Ca.push(Ra.join(" - "))}Pa=Ua.join(", ");Ga=Ga.label;Ga||(Ca=Ca.filter(Boolean),Ga=Ca.length?Ca.join(", "):Pa);Ca=Xa.clone();"cim"===
Ca.type&&V&&U.updateReferenceSizeSymbol(Ca,{innerDotSize:8,outerRingSize:16});Ua.some(Qa=>this._checkClausesForUVR(a,Qa))&&Ta.infos.push({label:Ga,value:Pa,symbol:Ca})}});Ta.infos.length&&Fa.push(Ta)});Fa.length&&(ha=Fa[0],1===Fa.length&&"title"in ha&&!ha.title?ea.infos.push(...(ha.infos??[])):(Oa&&(Fa.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Oa}]}),na=!0),ea.infos.push(...Fa)),D||a.legendOptions?.title||a.valueExpressionTitle||(ea.title=null))}a.defaultSymbol&&!na&&
(ea.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),na=!0)}else if(ia(a)){if(!V){sa=this._isUnclassedRenderer(a);if(!sa||!this._hasSizeRamp){pa=a.classBreakInfos.filter(({symbol:ka})=>ka);ha="ascending-values"===a.legendOptions?.order;for(const {label:ka,minValue:ua,maxValue:xa,symbol:Ia}of pa)pa={label:ka||(sa?null:`${ua} - ${xa}`),value:[ua,xa],symbol:Ia},ha?ea.infos.push(pa):ea.infos.unshift(pa);sa&&(ea.title=null);this._updateInfosForClassedSizeRenderer(a,ea.infos)}a.defaultSymbol&&
!sa&&(ea.infos.push({label:a.defaultLabel||"others",symbol:a.defaultSymbol}),na=!0)}}else if("raster-stretch"===a.type)if("esri.layers.ImageryTileLayer"===this.layer.declaredClass||"esri.layers.WCSLayer"===this.layer.declaredClass)ha=await this._constructTileImageryStretchRendererElements(a),"stretch-ramp"===ha.type?aa.push(ha):ea.infos=ha;else{ha=this.layer;a.customStatistics?.length&&({min:pa,max:ra}=a.customStatistics[0]);Y=[];Y=ha.serviceRasterInfo;if(ha.rasterFunction)try{Y=await ha.generateRasterInfo(ha.rasterFunction)}catch{}wa=
I.getPixelValueRange(Y.pixelType);if(1===Y.bandCount)ha=ha.bandIds?.[0]||0,pa=null!=pa?pa:Y.statistics?Y.statistics[ha].min:wa[0],ra=null!=ra?ra:Y.statistics?Y.statistics[ha].max:wa[1],pa||ra?aa.push(await this._getStretchLegendElements(a,{min:pa,max:ra})):this._getServerSideLegend();else if(ha.bandIds&&1===ha.bandIds.length)pa=null!=pa?pa:Y.statistics?Y.statistics[ha.bandIds[0]].min:wa[0],ra=null!=ra?ra:Y.statistics?Y.statistics[ha.bandIds[0]].max:wa[1],pa||ra?aa.push(await this._getStretchLegendElements(a,
{min:pa,max:ra})):this._getServerSideLegend();else if(3<=Y.bandCount){const {bandInfos:ka}=Y;({bandIds:pa}=ha);ka.length>=Y.bandCount?3===pa?.length?(Y=pa.map(ua=>ka[ua].name),ea.infos=this._createSymbolTableElementMultiBand(Y)):"lerc"===ha.format?(Y=[0,1,2].map(ua=>ka[ua].name),ea.infos=this._createSymbolTableElementMultiBand(Y)):this._getServerSideLegend():"lerc"===ha.format?(Y=["band1","band2","band3"],ea.infos=this._createSymbolTableElementMultiBand(Y)):this._getServerSideLegend()}else this._getServerSideLegend()}else if("raster-colormap"===
a.type)a.colormapInfos.forEach(ka=>{ea.infos.push({label:ka.label,value:ka.value,symbol:this._getAppliedCloneSymbol(bb,ka.color)})});else if(la(a)){ha=a.symbol;switch(t.geometryType){case "point":ha="pointSymbol"in P?P.pointSymbol:null;break;case "polyline":ha="lineSymbol"in P?P.lineSymbol:null;break;case "polygon":ha="polygonSymbol"in P?P.polygonSymbol:null}pa=this._hasClusterSizeVariable&&this._getClusterSymbol()||!this._hasSizeRamp;a.symbol&&pa&&ea.infos.push({label:a.label,symbol:ha})}else"vector-field"===
a.type?(a.outputUnit&&(this.title="("+a.toJSON().outputUnit+")"),ea.title=a.attributeField,ha=a.getClassBreakInfos(),ha?.length?ha.forEach(ka=>{ea.infos.push({label:ka.minValue+" - "+ka.maxValue,symbol:ka.symbol})}):ea.infos.push({label:a.attributeField,symbol:a.getDefaultSymbol()})):"raster-shaded-relief"===a.type&&aa.push(await this._getStretchLegendElements(a,{min:0,max:255}));else ha=await X.getSymbolForFlowRenderer(a),ea.infos.push({label:null,symbol:ha});const Va=a.defaultSymbol;!Va||na||la(a)||
sa&&!this._hasColorRamp&&!this._hasSizeRamp&&!this._hasOpacityRamp||aa.push({type:"symbol-table",infos:[{label:a.defaultLabel||"others",symbol:Va}]});ea.infos.length&&aa.unshift(ea);const gb=null==t.opacity?this.opacity:t.opacity,hb=this._isTallSymbol("visualVariables"in a?a.visualVariables:null),ib="esri.layers.ImageryLayer"===this.layer.declaredClass||"esri.layers.ImageryTileLayer"===this.layer.declaredClass;t=aa.reduce((ka,ua)=>[...ka,...this._getAllInfos(ua)],[]).filter(ka=>!!ka?.symbol).filter(ka=>
{if("cim"===ka.symbol.type){const {minScale:ua,maxScale:xa}=ka.symbol.data;if(ua&&ua<this.scale||xa&&xa>this.scale)return!1}return!0}).map(ka=>this._getSymbolPreview(ka,gb,{isDefault:ka.symbol===Va,applyScaleDrivenSize:!Aa.has(ka.symbol),symbolConfig:{isTall:hb,isSquareFill:ib},effectList:Aa.has(ka.symbol)?null:this.effectList}));a=null;await Promise.allSettled(t);return aa}_checkClausesForUVR(a,t){{const {field:D,field2:O,field3:P,fieldDelimiter:V,valueExpression:Y}=a;if(D){a=(D||Y)&&(O||P)?t?.toString().split(V||
""):[t];if(t=D?{[D]:a?.[0]}:null)O&&(t[O]=a?.[1]),P&&(t[P]=a?.[2]);a=t}else a=null}return a?(this._layerDefinitionExpressionClause?this._layerDefinitionExpressionClause.testFeature(a):!0)&&(this._layerDisplayFilterClause?this._layerDisplayFilterClause.testFeature(a):!0):!0}_getServerSideLegend(){setTimeout(()=>this.buildLegendElementsForTools(),0)}_getAllInfos(a){const t=a?.infos;return t?t.reduce((D,O)=>D.concat(this._getAllInfos(O)),[]):[a]}async _constructTileImageryStretchRendererElements(a){const t=
this.layer,D=t.symbolizer.rasterInfo??t.raster.rasterInfo;var O;if(O=a?.customStatistics?.length?a.customStatistics:D?.statistics)({min:O,max:P}=O[0]);else{var P=I.getPixelValueRange(D.pixelType);O=P[0];P=P[1]}t.hasStandardTime()&&(O=t.getStandardTimeValue(O),P=t.getStandardTimeValue(P));if(1===D.bandCount||1===t.bandIds?.length)return this._getStretchLegendElements(a,{min:O,max:P});a=(t?.bandIds?.length?t.bandIds:Array.from(Array(Math.min(D.bandCount,3)).keys())).map(V=>D.bandInfos[V].name);3>a.length?
a.push(a[1]):3<a.length&&a.splice(3);return this._createSymbolTableElementMultiBand(a)}async _getStretchLegendElements(a,t){a=Z.getStretchRampStops(a.colorRamp,t);return{type:"stretch-ramp",title:"",infos:a,preview:S.renderColorRampPreviewHTML(a.map(D=>D.color),{ariaLabel:await Ba("previewColorRampAriaLabel")})}}_getClusterSymbol(){var a=this.layer;const t=(a="featureReduction"in a&&a.featureReduction)&&"symbol"in a&&a.renderer;return t&&!0!==t?.authoringInfo?.isAutoGenerated?null:a&&"symbol"in a?
a.symbol:null}async _getSizeLegendElement(a,t,D,O){return{type:"size-ramp",title:this._hasClusterSizeVariable?this._getClusterTitle(t):a,infos:await da.getRampStops(D,t,await X.getMedianColor(D),this.scale,this.view,O,this._hasClusterSizeVariable?this._getClusterSymbol():null)}}_createSymbolTableElementMultiBand(a){const t=[],D=["red","green","blue"];a.forEach((O,P)=>{t.push({label:{colorName:D[P],bandName:O},src:X.rgbImgSource[P],opacity:this.opacity??1})});return t}_updateInfosForClassedSizeRenderer(a,
t){const D=a.authoringInfo&&"class-breaks-size"===a.authoringInfo.type,O=a.classBreakInfos.some(P=>W.isVolumetricSymbol(P.symbol));if(D&&O){const P=da.realWorldMaxSize;a=a.classBreakInfos.length;const V=(P-da.realWorldMinSize)/(1<a?a-1:a);t.forEach((Y,aa)=>{Y.size=P-V*aa})}}_isTallSymbol(a){let t=!1,D=!1;if(a)for(let O=0;O<a.length&&(!t||!D);O++){const P=a[O];"size"===P.type&&("height"===P.axis&&(t=!0),"width-and-depth"===P.axis&&(D=!0))}return t&&D}async _getSymbolPreview(a,t,D){var O=!D?.isDefault&&
null==a.size&&this._hasSizeRamp?f.px2pt(G.SymbolSizeDefaults.size):a.size;this._scaleDrivenSizeVariable&&D?.applyScaleDrivenSize&&({getSize:O}=await new Promise((P,V)=>g(["../../../renderers/visualVariables/support/visualVariableUtils"],P,V)),O=O(this._scaleDrivenSizeVariable,null,{view:this.view.type,scale:this.scale,shape:"simple-marker"===a.symbol.type?a.symbol.style:null}));return S.renderPreviewHTML(a.symbol,{size:O,opacity:t,scale:!1,symbolConfig:D?.symbolConfig,effectView:D?.effectList,style:"legend",
cimOptions:{allowScalingUp:!D?.isDefault&&this._hasSizeRamp||!(!this._scaleDrivenSizeVariable||!D?.applyScaleDrivenSize),viewParams:this.isScaleDriven?{viewingMode:"2d"===this.view?.type?"map":this.view?.viewingMode,scale:this.view?.scale}:null},ariaLabel:a.label&&"string"!==typeof a.label?null:await Ba("previewTemplateAriaLabel",a.label)}).then(P=>{a.preview=P;return a}).catch(()=>{a.preview=null;return a})}_getClusterRenderer(a){this._hasClusterSizeVariable=!1;var t="renderer"in this.layer?this.layer.renderer:
null;t=a.renderer?.clone()||t?.clone();const D=ca.getEffectiveClusterSizeVariable(a,this.layerView,this.view);if(D&&null!=t&&"visualVariables"in t&&!t.visualVariables?.some(O=>"size"===O.type&&"outline"!==O.target&&!Ma.test(O.valueExpression))){if("clusterMinSize"in a&&"clusterMaxSize"in a){const {clusterMinSize:O,clusterMaxSize:P}=a;D.legendOptions=new M({showLegend:O!==P})}t.visualVariables=(t.visualVariables||[]).concat([D]);this._hasClusterSizeVariable=!0}return t}async _loadRenderer(a){const t=
[],D=a.clone(),O=await X.getMedianColor(D);if(ia(D)||qa(D))a=(D.classBreakInfos||D.uniqueValueInfos).map(P=>this._fetchSymbol(P.symbol,O).then(V=>{P.symbol=V}).catch(()=>{P.symbol=null})),Array.prototype.push.apply(t,a);t.push(this._fetchSymbol(D.symbol||D.defaultSymbol,D.defaultSymbol?null:O).then(P=>{this._applySymbolToRenderer(D,P,la(D))}).catch(()=>{this._applySymbolToRenderer(D,null,la(D))}));await Promise.allSettled(t);return D}_applySymbolToRenderer(a,t,D){D?a.symbol=t:a.defaultSymbol=t}async _fetchSymbol(a,
t){if(!a)throw Error();if("web-style"===a.type){const D=this._webStyleSymbolCache;try{const O=await ("2d"===this.view.type?a.fetchCIMSymbol({cache:D}):a.fetchSymbol({cache:D}));return this._getAppliedCloneSymbol(O,t)}catch{throw c.getLogger(this).warn("Fetching web-style failed!"),Error();}}return this._getAppliedCloneSymbol(a,t)}_getAppliedCloneSymbol(a,t){if(!a||!t)return a;a=a.clone();const D=t&&t.toRgba();a.type.includes("3d")?this._applyColorTo3dSymbol(a,D):"cim"===a.type?Q.applyCIMSymbolColor(a,
t):a.color&&(a.color=new C(D||a.color));return a}_applyColorTo3dSymbol(a,t){t&&a.symbolLayers.forEach(D=>{D&&(D.material||(D.material={}),D.material.color=new C(t))})}async _getVisualVariableLegendElements(a,t){if(!("visualVariables"in a)||"vector-field"===a.type)return null;var D=a.visualVariables??[],O=[];const P=[],V=[],Y=X.getReferenceSizeAuthoringInfoVisualVariable(a);if(2===Y?.sizeStops?.length&&(ia(a)||qa(a))){const [na,Aa]=Y.sizeStops;P.push(new J({field:Y.field??void 0,normalizationField:Y.normalizationField,
minSize:na.size,maxSize:Aa.size,minDataValue:na.value,maxDataValue:Aa.value}))}for(const na of D)"color"===na.type?O.push(na):"size"===na.type?P.push(na):"opacity"===na.type&&V.push(na);D=[...O,...P,...V];let aa;if(0===O.length&&ia(a)&&a.classBreakInfos&&1===a.classBreakInfos.length)var ea=(ea=a.classBreakInfos[0])&&ea.symbol;0===O.length&&la(a)&&(ea=a.symbol);ea&&(ea.type.includes("3d")?(O=ea.symbolLayers.at(0),"water"===O.type?null!=O.color&&(aa=O.color):null!=O.material?.color&&(aa=O.material.color)):
ea.url||(aa=ea.color));const sa=this.effectList;return(await Promise.all(D.map(async na=>{if(!na.legendOptions||!1!==na.legendOptions.showLegend){const Aa="flow"===a.type?na.field:this._getRampTitle(na,t);let ha=null;const pa=X.getDateFormatOptions(t,na,this.view.timeZone);"color"===na.type?(na=await Z.getRampStops(na,null,pa)??[],ha={type:"color-ramp",title:Aa,infos:na,preview:S.renderColorRampPreviewHTML(na.map(ra=>ra.color),{effectList:sa,ariaLabel:await Ba("previewColorRampAriaLabel")})},this._hasColorRamp||
(this._hasColorRamp=0<na.length)):"size"===na.type&&"outline"!==na.target?Ma.test(na.valueExpression)?this._hasClusterSizeVariable||(this._scaleDrivenSizeVariable=na):(ha=await this._getSizeLegendElement(Aa,na,a,pa),this._hasSizeRamp||(this._hasSizeRamp=!(null==ha.infos||!ha.infos.length))):"opacity"===na.type&&(na=await Z.getRampStops(na,aa,pa)??[],ha={type:"opacity-ramp",title:Aa,infos:na,preview:S.renderColorRampPreviewHTML(na.map(ra=>ra.color),{effectList:sa,ariaLabel:await Ba("previewColorRampAriaLabel")})},
this._hasOpacityRamp||(this._hasOpacityRamp=0<na.length));return ha?.infos?ha:null}}))).filter(H.isSome)}_getDomainName(a,t,D){return a&&"function"!==typeof a?(D=(a="getField"in D&&D.getField?.(a))&&"getFieldDomain"in D&&D.getFieldDomain?D.getFieldDomain(a.name,{excludeImpliedDomains:z("esri-widget-legacy-field-domain-calculation")}):null,"coded-value"===D?.type?D.getName(t):null):null}_getClusterTitle(a){var t=this.layer;a=a.field;if("featureReduction"in t&&t.featureReduction&&"cluster"===t.featureReduction.type&&
(t=t.featureReduction,t=(t="popupTemplate"in t&&t.popupTemplate)&&t.fieldInfos))for(const D of t)if(D.fieldName===a)return"cluster_count"===a?D.label||{showCount:!0}:D.label;return{showCount:!0}}_getRampTitle(a,t){let D=a.field,O=a.normalizationField,P=!1,V=!1,Y=!1;var aa=null;D="function"===typeof D?null:D;O="function"===typeof O?null:O;aa=a.legendOptions?.title;if(null==aa)if(a.valueExpressionTitle)aa=a.valueExpressionTitle;else{if("renderer"in t&&t.renderer&&"authoringInfo"in t.renderer&&t.renderer.authoringInfo?.visualVariables)for(a=
t.renderer.authoringInfo.visualVariables,aa=0;aa<a.length;aa++){const ea=a[aa];if("color"===ea.type){if("ratio"===ea.style){P=!0;break}if("percent"===ea.style){V=!0;break}if("percent-of-total"===ea.style){Y=!0;break}}}aa={field:D&&this._getFieldAlias(D,t),normField:O&&this._getFieldAlias(O,t),ratio:P,ratioPercent:V,ratioPercentTotal:Y}}return aa}_getRendererTitle(a,t){if(a.legendOptions?.title)return a.legendOptions.title;if(a.valueExpressionTitle)return a.valueExpressionTitle;var D=a.field;let O=
null,P=null;ia(a)&&(O=a.normalizationField,P="percent-of-total"===a.normalizationType);D="function"===typeof D?null:D;O="function"===typeof O?null:O;if(qa(a)){const {field2:V,field3:Y,fieldDelimiter:aa}=a;D=D&&this._getFieldAlias(D,t);V&&(D=`<${D}>${aa}<${this._getFieldAlias(V,t)}>`,Y&&(D=`${D}${aa}<${this._getFieldAlias(Y,t)}>`));return D}a=null;if(D||O)a={field:D&&this._getFieldAlias(D,t),normField:O&&this._getFieldAlias(O,t),normByPct:P};return a}_getFieldAlias(a,t){let D=("popupTemplate"in t?
t.popupTemplate:null)?.fieldInfos?.find(Y=>a===Y.fieldName),O=null;"getField"in t&&t.getField?O=t.getField(a):"fieldsIndex"in t&&t.fieldsIndex&&(O=t.fieldsIndex.get(a));let P=null;if(t="featureReduction"in t&&t.featureReduction)D??="popupTemplate"in t?t.popupTemplate?.fieldInfos?.find(Y=>a?.toLowerCase()===Y.fieldName?.toLowerCase()):void 0,"fields"in t&&t.fields&&(P=t.fields.find(Y=>Y.name?.toLowerCase()===a?.toLowerCase()));t=D||O||P;let V=null;t&&(V=D?.label||O?.alias||P?.alias||"name"in t&&t.name||
"fieldName"in t&&t.fieldName||null);return V}_isUnclassedRenderer(a){const t=a.visualVariables;let D=!1;ia(a)&&a.classBreakInfos&&1===a.classBreakInfos.length&&t&&(D=a.field?t.some(O=>!(!O||a.field!==O.field||(a.normalizationField||O.normalizationField)&&a.normalizationField!==O.normalizationField)):!!t.length);return D}};A.__decorate([r.property()],B.prototype,"children",void 0);A.__decorate([r.property({readOnly:!0})],B.prototype,"effectList",null);A.__decorate([r.property()],B.prototype,"layerView",
void 0);A.__decorate([r.property()],B.prototype,"layer",void 0);A.__decorate([r.property()],B.prototype,"legendElements",void 0);A.__decorate([r.property({readOnly:!0})],B.prototype,"opacity",null);A.__decorate([r.property()],B.prototype,"parent",void 0);A.__decorate([r.property({readOnly:!0,dependsOn:[]})],B.prototype,"ready",null);A.__decorate([r.property()],B.prototype,"hideLayersNotInCurrentView",void 0);A.__decorate([r.property()],B.prototype,"keepCacheOnDestroy",void 0);A.__decorate([r.property()],
B.prototype,"respectLayerDefinitionExpression",void 0);A.__decorate([r.property()],B.prototype,"respectLayerVisibility",void 0);A.__decorate([r.property({readOnly:!0})],B.prototype,"scale",null);A.__decorate([r.property()],B.prototype,"sublayerIds",void 0);A.__decorate([r.property({readOnly:!0})],B.prototype,"isScaleDriven",null);A.__decorate([r.property()],B.prototype,"title",void 0);A.__decorate([r.property({readOnly:!0,dependsOn:["ready"],value:0})],B.prototype,"version",null);A.__decorate([r.property()],
B.prototype,"view",void 0);return B=A.__decorate([n.subclass("esri.widgets.Legend.support.ActiveLayerInfo")],B)})},"esri/layers/effects/EffectView":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/lang ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/decorators/subclass ./parser ./utils".split(" "),function(g,A,C,B,v,F,y,H,K,z){function h(d){d=K.parse(d)||[];var f=(f=d[0])?"type"in f:!1;return f?[{scale:-1,effects:d}]:
d}function c(d,f,k){return d[0]?.effects&&f[0]?.effects?(-1===d[0]?.scale||-1===f[0]?.scale)&&(1<d.length||1<f.length)&&0>=k?!1:z.canInterpolateEffects(d[0].effects,f[0].effects):!0}function l(d,f,k){const m=d.length>f.length?d:f;d=d.length>f.length?f:d;var r=d[d.length-1];f=r?.scale??k;r=r?.effects??[];for(let n=d.length;n<m.length;n++)d.push({scale:f,effects:[...r]});for(f=0;f<m.length;f++)d[f].scale=-1===d[f].scale?k:d[f].scale,m[f].scale=-1===m[f].scale?k:m[f].scale,z.normalizeEffects(d[f].effects,
m[f].effects)}g.EffectView=class extends C{constructor(d){super(d);this._final=this._to=this._from=null;this._current=[];this._time=0;this.duration=B("mapview-transitions-duration");this.effects=[]}set effect(d){const f=this._get("effect");d=d||"";if(f!==d){this._set("effect",d);try{this._transitionTo(h(d))}catch(k){this._transitionTo([]),F.getLogger(this).warn("Invalid Effect",{effect:d,error:k})}}}get final(){return this._final}get hasEffects(){return this.transitioning||!!this.effects.length}set scale(d){this._updateForScale(d)}get transitioning(){return null!==
this._to}canTransitionTo(d){try{return 0<this.scale&&c(this._current,h(d),this.scale)}catch{return!1}}transitionStep(d,f){this._applyTimeTransition(d);this._updateForScale(f)}endTransition(){this._applyTimeTransition(this.duration)}_transitionTo(d){0<this.scale&&c(this._current,d,this.scale)?(this._final=d,this._to=v.clone(d),l(this._current,this._to,this.scale),this._from=v.clone(this._current),this._time=0):(this._from=this._to=this._final=null,this._current=d);this._set("effects",this._current[0]?
v.clone(this._current[0].effects):[])}_applyTimeTransition(d){if(this._to&&this._from&&this._current&&this._final){this._time+=d;d=Math.min(1,this._time/this.duration);for(let k=0;k<this._current.length;k++){const m=this._current[k],r=this._from[k],n=this._to[k];var f=r.scale;m.scale=f+(n.scale-f)*d;for(f=0;f<m.effects.length;f++)m.effects[f].interpolate(r.effects[f],n.effects[f],d)}1===d&&(this._current=this._final,this._set("effects",this._current[0]?v.clone(this._current[0].effects):[]),this._from=
this._to=this._final=null)}}_updateForScale(d){this._set("scale",d);if(0!==this._current.length){var f=this._current,k=this._current.length-1,m,r=1;if(1===f.length||d>=f[0].scale)var n=m=f[0].effects;else if(d<=f[k].scale)n=m=f[k].effects;else for(let q=0;q<k;q++){const u=f[q],w=f[q+1];if(u.scale>=d&&w.scale<=d){r=(d-u.scale)/(w.scale-u.scale);m=u.effects;n=w.effects;break}}for(d=0;d<this.effects.length;d++)this.effects[d].interpolate(m[d],n[d],r)}}};A.__decorate([y.property()],g.EffectView.prototype,
"_to",void 0);A.__decorate([y.property()],g.EffectView.prototype,"duration",void 0);A.__decorate([y.property({value:""})],g.EffectView.prototype,"effect",null);A.__decorate([y.property({readOnly:!0})],g.EffectView.prototype,"effects",void 0);A.__decorate([y.property({readOnly:!0})],g.EffectView.prototype,"final",null);A.__decorate([y.property({readOnly:!0})],g.EffectView.prototype,"hasEffects",null);A.__decorate([y.property({value:0})],g.EffectView.prototype,"scale",null);A.__decorate([y.property({readOnly:!0})],
g.EffectView.prototype,"transitioning",null);g.EffectView=A.__decorate([H.subclass("esri.layers.effects.EffectView")],g.EffectView);g.canInterpolateEffectStops=c;g.convertEffectToStops=h;g.normalizeEffectStops=l;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/ExportImageParameters":function(){define("exports ../../chunks/tslib.es6 ../../core/Accessor ../../core/sql ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/support/scaleUtils ./floorFilterUtils ./sublayerUtils".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){const l={visible:"visibleSublayers",definitionExpression:"layerDefs",labelingInfo:"hasDynamicLayers",labelsVisible:"hasDynamicLayers",opacity:"hasDynamicLayers",minScale:"visibleSublayers",maxScale:"visibleSublayers",renderer:"hasDynamicLayers",source:"hasDynamicLayers"};g.ExportImageParameters=class extends C{constructor(d){super(d);this.floors=null;this.scale=0}destroy(){this.layer=null}get dynamicLayers(){if(!this.hasDynamicLayers)return null;const d=this.visibleSublayers.map(f=>
{const k=h.getLayerFloorFilterClause(this.floors,f);return f.toExportImageJSON(k)});return d.length?JSON.stringify(d):null}get hasDynamicLayers(){return this.layer&&c.isExportDynamic(this.visibleSublayers,this.layer.serviceSublayers,this.layer.gdbVersion)}set layer(d){this._get("layer")!==d&&(this._set("layer",d),this.removeHandles("layer"),d&&this.addHandles([d.allSublayers.on("change",()=>this.notifyChange("visibleSublayers")),d.on("sublayer-update",f=>this.notifyChange(l[f.propertyName]))],"layer"))}get layers(){const d=
this.visibleSublayers;return d?d.length?"show:"+d.map(f=>f.id).join(","):"show:-1":null}get layerDefs(){const d=!!this.floors?.length,f=this.visibleSublayers.filter(k=>null!=k.definitionExpression||d&&null!=k.floorInfo);return f.length?JSON.stringify(f.reduce((k,m)=>{var r=h.getLayerFloorFilterClause(this.floors,m);r=B.sqlAnd(r,m.definitionExpression);null!=r&&(k[m.id]=r);return k},{})):null}get version(){this.commitProperty("layers");this.commitProperty("layerDefs");this.commitProperty("dynamicLayers");
const d=this.layer;d&&(d.commitProperty("dpi"),d.commitProperty("imageFormat"),d.commitProperty("imageTransparency"),d.commitProperty("gdbVersion"));return(this._get("version")||0)+1}get visibleSublayers(){const d=[];if(!this.layer)return d;var f=this.layer.sublayers;const k=this.scale,m=r=>{r.visible&&(0===k||z.isInScaleRange(k,r.minScale,r.maxScale))&&(r.sublayers?r.sublayers.forEach(m):d.unshift(r))};f&&f.forEach(m);f=this._get("visibleSublayers");return!f||f.length!==d.length||f.some((r,n)=>d[n]!==
r)?d:f}toJSON(){var d=this.layer;d={dpi:d.dpi,format:d.imageFormat,transparent:d.imageTransparency,gdbVersion:d.gdbVersion||null};this.hasDynamicLayers&&this.dynamicLayers?d.dynamicLayers=this.dynamicLayers:d={...d,layers:this.layers,layerDefs:this.layerDefs};return d}};A.__decorate([v.property({readOnly:!0})],g.ExportImageParameters.prototype,"dynamicLayers",null);A.__decorate([v.property()],g.ExportImageParameters.prototype,"floors",void 0);A.__decorate([v.property({readOnly:!0})],g.ExportImageParameters.prototype,
"hasDynamicLayers",null);A.__decorate([v.property()],g.ExportImageParameters.prototype,"layer",null);A.__decorate([v.property({readOnly:!0})],g.ExportImageParameters.prototype,"layers",null);A.__decorate([v.property({readOnly:!0})],g.ExportImageParameters.prototype,"layerDefs",null);A.__decorate([v.property({type:Number})],g.ExportImageParameters.prototype,"scale",void 0);A.__decorate([v.property({readOnly:!0})],g.ExportImageParameters.prototype,"version",null);A.__decorate([v.property({readOnly:!0})],
g.ExportImageParameters.prototype,"visibleSublayers",null);g.ExportImageParameters=A.__decorate([K.subclass("esri.layers.support.ExportImageParameters")],g.ExportImageParameters);Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],function(g){function A(C,B){if(!C?.length)return null;C=C.filter(v=>""!==v).map(v=>`'${v}'`);C.push("''");return`${B} IN (${C.join(",")}) OR ${B} IS NULL`}g.getFloorFilterClause=function(C){const B=
C.layer;return"floorInfo"in B&&B.floorInfo?.floorField&&"floors"in C.view?A(C.view.floors,B.floorInfo.floorField):null};g.getLayerFloorFilterClause=function(C,B){return"floorInfo"in B&&B.floorInfo?.floorField?A(C,B.floorInfo.floorField):null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/sublayerUtils":function(){define(["exports","../../core/accessorSupport/PropertyOrigin"],function(g,A){function C(B,v){if(!B?.length||null==v)return!0;v=v.slice().reverse().flatten(({sublayers:H})=>
H&&H.toArray().reverse()).map(H=>H.id).toArray();if(B.length>v.length)return!1;let F=0;const y=v.length;for(const {id:H}of B){for(;F<y&&v[F]!==H;)F++;if(F>=y)return!1}return!0}g.isExportDynamic=function(B,v,F){return B.some(y=>{var H=y.source;H=!H||"map-layer"===H.type&&H.mapLayerId===y.id&&(null==H.gdbVersion||H.gdbVersion===F);y.commitProperty("renderer");y.commitProperty("labelingInfo");y.commitProperty("opacity");y.commitProperty("labelsVisible");y.commitProperty("orderBy");const K=y.layer?.capabilities?.exportMap?.supportsSublayerOrderBy??
!1;return!H||y.originIdOf("renderer")>A.OriginId.SERVICE||y.originIdOf("labelingInfo")>A.OriginId.SERVICE||y.originIdOf("opacity")>A.OriginId.SERVICE||y.originIdOf("labelsVisible")>A.OriginId.SERVICE||K&&y.originIdOf("orderBy")>A.OriginId.SERVICE})?!0:!C(B,v)};g.isSublayerOverhaul=function(B){return!!B&&B.some(v=>null!=v.minScale||null!=v.layerDefinition?.minScale)};g.shouldWriteSublayerStructure=function(B,v,F){return v.flatten(({sublayers:y})=>y).length!==B.length||B.some(y=>y.originIdOf("minScale")>
F||y.originIdOf("maxScale")>F||y.originIdOf("renderer")>F||y.originIdOf("labelingInfo")>F||y.originIdOf("opacity")>F||y.originIdOf("labelsVisible")>F||y.originIdOf("source")>F)?!0:!C(B,v)};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/rasterFormats/pixelRangeUtils":function(){define(["exports"],function(g){function A(v){return B[v]??[-3.4028234663852886E38,3.4028234663852886E38]}function C(v){return(v?.startsWith("s")||v?.startsWith("u"))??!1}const B={u1:[0,
1],u2:[0,3],u4:[0,15],u8:[0,255],s8:[-128,127],u16:[0,65535],s16:[-32768,32767],u32:[0,4294967295],s32:[-2147483648,2147483647],f32:[-3.4028234663852886E38,3.4028234663852886E38],f64:[-Number.MAX_VALUE,Number.MAX_VALUE],unknown:void 0,c64:void 0,c128:void 0};g.clipBandToPixelTypeRange=function(v,F,y,H){let [K,z]=A(y);var h=C(y);h&&(K-=1E-5,z+=1E-5);if(h)if(y.startsWith("u")){const [c,l]=[K,z];for(y=0;y<F.length;y++)F[y]&&(h=v[y],h<c||h>l?F[y]=0:H[y]=h+.5<<0)}else{const [c,l]=[K,z];for(y=0;y<F.length;y++)F[y]&&
(h=v[y],h<c||h>l?F[y]=0:H[y]=h+(0<h?.5:-.5)<<0)}else{const [c,l]=[K,z];for(y=0;y<F.length;y++)F[y]&&(h=v[y],h<c||h>l?F[y]=0:H[y]=h)}};g.convertNoDataToMask=function(v,F,y){if(!(v.depthCount&&1<v.depthCount)){var {pixels:H,statistics:K,pixelType:z}=v,h=H[0].length,c=v.bandMasks??[],l=v.mask??(new Uint8Array(h)).fill(255),d="f32"===z||"f64"===z,f=A(z);h=!1;for(let r=0;r<H.length;r++){const n="number"===typeof F?F:F[r];if(null==n)continue;var k=K?.[r]?.maxValue??f[1];if((K?.[r]?.minValue??f[0])>n+Number.EPSILON||
k<n-Number.EPSILON)continue;k=c[r]||l.slice();const q=H[r];var m=y?.customFloatTolerance;if(d&&0!==m){m||=9.999999E37<=Math.abs(n)?2E-7*Math.abs(n):"f32"===z?2**-23:Number.EPSILON;for(let u=0;u<q.length;u++)k[u]&&Math.abs(q[u]-n)<m&&(q[u]=0,k[u]=0,l[u]=0,h=!0)}else for(m=0;m<q.length;m++)k[m]&&q[m]===n&&(q[m]=0,k[m]=0,l[m]=0,h=!0);c[r]=k}if(h)if(F=v.bandMasks||1<v.pixels.length?c:null,y?.matchAllNoData){if(F&&1<F.length)if(y=F,2>y.length)y=y[0];else{F=y[0].length;c=(new Uint8Array(F)).fill(0);for(l=
0;l<y.length;l++)for(d=y[l],f=0;f<F;f++)d[f]&&(c[f]=255);y=c}else y=l;v.mask=y}else v.bandMasks=F,v.mask=l;h&&"updateStatistics"in v&&v.updateStatistics()}};g.fixNaN=function(v,F){for(let y=0;y<F.length;y++)F[y]&&isNaN(v[y])&&(F[y]=0,v[y]=0)};g.getIntegerPixelType=function(v,F){return null==v||null==F?"s32":0>v?-128<=v&&128>F?"s8":-32768<=v&&32768>F?"s16":"s32":256>F?"u8":65536>F?"u16":"u32"};g.getPixelValueRange=A;g.isIntegerPixelType=C;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},
"esri/renderers/support/rendererConversion":function(){define(["exports","../../core/arrayUtils","../../core/has","../../core/Error","../../symbols/support/symbolConversion"],function(g,A,C,B,v){function F(z){return null==z||"simple"===z.type||"unique-value"===z.type||"class-breaks"===z.type||"dictionary"===z.type||"heatmap"===z.type}function y(z,h){if(!h)return null;Array.isArray(h)||(h=[h]);if(0<h.length){const c=h.map(d=>d.details.symbol.type||d.details.symbol.declaredClass).filter(d=>!!d);c.sort();
const l=[];c.forEach((d,f)=>{0!==f&&d===c[f-1]||l.push(d)});return new B("renderer-conversion-3d:unsupported-symbols",`Renderer contains symbols (${l.join(", ")}) which are not supported in 3D`,{renderer:z,symbolErrors:h})}return null}function H(z,h){const c={...v.defaultTo3DOptions,...h,cimFallbackEnabled:!0};h=z.uniqueValueInfos?.map(d=>v.to3D(d.symbol,c).error).filter(A.isSome);const l=v.to3D(z.defaultSymbol,c);l.error&&h?.unshift(l.error);return y(z,h)}function K(z,h){const c={...v.defaultTo3DOptions,
...h,cimFallbackEnabled:!0};h=z.classBreakInfos.map(d=>v.to3D(d.symbol,c).error).filter(A.isSome);const l=v.to3D(z.defaultSymbol,c);l.error&&h.unshift(l.error);return y(z,h)}g.isSupportedRenderer3D=F;g.validateTo3D=function(z,h){if(null==z)return null;if(!F(z))return new B("renderer-conversion-3d:unsupported-renderer",`Unsupported renderer of type '${z.type||z.declaredClass}'`,{renderer:z});switch(z.type){case "simple":return y(z,v.to3D(z.symbol,{...v.defaultTo3DOptions,...h,cimFallbackEnabled:!0}).error);
case "unique-value":return H(z,h);case "class-breaks":return K(z,h)}return null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/renderers/support/referenceSizeUtils":function(){define("exports ../../../core/Error ../../../core/lang ../../../renderers/visualVariables/support/SizeStop ../../../symbols/CIMSymbol ../../../symbols/cim/enums".split(" "),function(g,A,C,B,v,F){function y(h){switch(h){case "circle":return{rings:[[[8.5,.2],[7.06,.33],[5.66,.7],[4.35,1.31],
[3.16,2.14],[2.14,3.16],[1.31,4.35],[.7,5.66],[.33,7.06],[.2,8.5],[.33,9.94],[.7,11.34],[1.31,12.65],[2.14,13.84],[3.16,14.86],[4.35,15.69],[5.66,16.3],[7.06,16.67],[8.5,16.8],[9.94,16.67],[11.34,16.3],[12.65,15.69],[13.84,14.86],[14.86,13.84],[15.69,12.65],[16.3,11.34],[16.67,9.94],[16.8,8.5],[16.67,7.06],[16.3,5.66],[15.69,4.35],[14.86,3.16],[13.84,2.14],[12.65,1.31],[11.34,.7],[9.94,.33],[8.5,.2]]]};case "square":return{rings:[[[.5,.5],[.5,16.5],[16.5,16.5],[16.5,.5],[.5,.5]]]};case "diamond":return{rings:[[[8.5,
.5],[.2,8.5],[8.5,16.5],[16.5,8.5],[8.5,.5]]]};case "hexagon-pointy":return{rings:[[[15.86,12.75],[15.86,4.25],[8.5,0],[1.14,4.25],[1.14,12.75],[8.5,17],[15.86,12.75]]]};case "hexagon-flat":return{rings:[[[12.75,15.86],[17,8.5],[12.75,1.14],[4.25,1.14],[0,8.5],[4.25,15.86],[12.75,15.86]]]}}}function H(h){return"CIMVectorMarker"===h?.type?h.markerGraphics?.[0]:void 0}function K(h){return"CIMPolygonSymbol"===h?.symbol?.type?h.symbol.symbolLayers?.[0]:void 0}var z;(function(h){h.OuterRing="reference-size-outer-ring";
h.InnerDot="reference-size-inner-dot"})(z||={});g.createPrimitiveOverrides=function(h){const {view:c,field:l,normalizationField:d,sizeStops:f,sizeByScaleEnabled:k}=h,{value:m,size:r}=f[0],{value:n,size:q}=f[1];h=0;let u;l&&(h=`$feature["${l}"]`,u=`\n      if(!HasValue($feature, "${l}")){\n        return 0;\n      }\n      $feature["${l}"];\n    `);d&&(h=`$feature["${l}"] / $feature["${d}"]`,u=`if(!HasValue($feature, "${l}") || !HasValue($feature, "${d}") || $feature["${d}"] <= 0){\n        return 0;\n      }\n      $feature["${l}"];\n      $feature["${d}"];`);
return[{type:"CIMPrimitiveOverride",primitiveName:z.OuterRing,propertyName:"Size",valueExpressionInfo:{type:"CIMExpressionInfo",title:"Size in pixels of outer ring",expression:k?`\n      ${u}\n      var maxSize = ${q};\n      var referenceScale = ${c.scale};\n      return (maxSize * (referenceScale / $view.scale));\n    `:`${u}\n      return ${q}`,returnType:"Default"}},{type:"CIMPrimitiveOverride",primitiveName:z.InnerDot,propertyName:"Size",valueExpressionInfo:{type:"CIMExpressionInfo",title:"Size in pixels of inner ring",
expression:`\n        ${u}\n        var value = ${h};\n\n        var referenceScale = ${c.scale};\n        var referenceScaleRatio = ${k?"(referenceScale / $view.scale)":1};\n        var maxSize = ${q} * referenceScaleRatio;\n        var minSize = ${r} * referenceScaleRatio;\n\n        var minDataValue = ${m};\n        var maxDataValue = ${n};\n\n        var ratio = Constrain(( value - minDataValue ) / ( maxDataValue - minDataValue ), 0, 1);\n\n        var innerDotSize = Constrain(maxSize * ratio, minSize, maxSize);\n        return innerDotSize;\n      `,
returnType:"Default"}}]};g.createReferenceSizeSymbol=function(h){const {primitiveOverrides:c}=h;const {type:l,color:d,colorLocked:f}=h;var k={type:"CIMVectorMarker",enable:!0,colorLocked:!1,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",primitiveName:z.OuterRing,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:y(l),symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",enable:!0,color:d.toArray(),colorLocked:!!f,effects:[{type:"CIMGeometricEffectDonut",
width:.75}]}]}}],scaleSymbolsProportionally:!1,respectFrame:!0,markerPlacement:{type:"CIMMarkerPlacementPolygonCenter",placePerPart:!1,method:F.PlacementPolygonCenterMethod.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:20};const {type:m,color:r}=h;h={type:"CIMVectorMarker",enable:!0,anchorPoint:{x:0,y:0},anchorPointUnits:"Relative",primitiveName:z.InnerDot,frame:{xmin:0,ymin:0,xmax:17,ymax:17},markerGraphics:[{type:"CIMMarkerGraphic",geometry:y(m),symbol:{type:"CIMPolygonSymbol",symbolLayers:[{type:"CIMSolidFill",
enable:!0,color:r.toArray()}]}}],scaleSymbolsProportionally:!0,respectFrame:!0,markerPlacement:{type:"CIMMarkerPlacementPolygonCenter",placePerPart:!1,method:F.PlacementPolygonCenterMethod.OnPolygon,offsetX:0,offsetY:0,clipAtBoundary:!1},size:10};return new v({data:{type:"CIMSymbolReference",symbol:{type:"CIMPolygonSymbol",symbolLayers:[k,h]},primitiveOverrides:c}})};g.getReferenceSizeStops=function(h){if(null!=h.minDataValue&&null!=h.maxDataValue&&null!=h.minSize&&null!=h.maxSize&&"number"===typeof h.minSize&&
"number"===typeof h.maxSize)return[new B({value:h.minDataValue,size:h.minSize}),new B({value:h.maxDataValue,size:h.maxSize})];throw new A("create-reference-size-symbol","Invalid size variable");};g.updateReferenceSizeSymbol=function(h,c){const {outerRingSize:l,innerDotSize:d,type:f,color:k,colorLocked:m,primitiveOverrides:r}=c;c="CIMPolygonSymbol"===h.data.symbol?.type?h.data.symbol.symbolLayers:null;if(2===c?.length)for(const u of c){var n=(c=u.primitiveName===z.OuterRing)?l:d;"CIMVectorMarker"===
u?.type&&null!=n&&(u.size=n);n=f;var q=H(u);q&&null!=n&&(q.geometry=y(n));n=k;(q=K(H(u)))&&null!=n&&(q.color=n.toArray());n=m;(q=K(H(u)))&&null!=n&&c&&(q.colorLocked=n)}null!=l&&null!=d&&(h.data.primitiveOverrides=null);void 0!==r&&(h.data.primitiveOverrides=C.clone(r));return h};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/cimSymbolUtils":function(){define(["exports","../../Color","../cim/utils"],function(g,A,C){function B(c){c=C.toCIMSymbolJSON(c);if("CIMTextSymbol"===
c?.type)return c.height??0;let l=0;if(c?.symbolLayers)for(const d of c.symbolLayers)C.isCIMMarker(d)&&null!=d.size&&d.size>l?l=d.size:C.isCIMStroke(d)&&null!=d.width&&d.width>l?l=d.width:C.isCIMFill(d);return l}function v(c,l,d,f){if(c)if("CIMTextSymbol"===c.type)null!=c.height&&(c.height*=l);else{if(d&&c.effects)for(const k of c.effects)H(k,l);if(c.symbolLayers)for(const k of c.symbolLayers){switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":F(k,l,f);break;case "CIMPictureStroke":case "CIMSolidStroke":case "CIMGradientStroke":!f?.preserveOutlineWidth&&
k.width&&(k.width*=l);break;case "CIMPictureFill":k.height&&(k.height*=l);k.offsetX&&(k.offsetX*=l);k.offsetY&&(k.offsetY*=l);break;case "CIMHatchFill":v(k.lineSymbol,l,!0,{...f,preserveOutlineWidth:!1}),k.offsetX&&(k.offsetX*=l),k.offsetY&&(k.offsetY*=l),k.separation&&(k.separation*=l)}if(k.effects)for(const m of k.effects)H(m,l)}}}function F(c,l,d){if(c&&(c.markerPlacement&&y(c.markerPlacement,l),c.offsetX&&(c.offsetX*=l),c.offsetY&&(c.offsetY*=l),c.anchorPoint&&"Absolute"===c.anchorPointUnits&&
(c.anchorPoint={x:c.anchorPoint.x*l,y:c.anchorPoint.y*l}),c.size=null!=c.size?c.size*l:0,"CIMVectorMarker"===c.type&&c.markerGraphics))for(const f of c.markerGraphics)c.scaleSymbolsProportionally||v(f.symbol,l,!0,d)}function y(c,l){C.isCIMMarkerStrokePlacement(c)&&c.offset&&(c.offset*=l);switch(c.type){case "CIMMarkerPlacementAlongLineRandomSize":case "CIMMarkerPlacementAlongLineSameSize":c.customEndingOffset&&(c.customEndingOffset*=l);c.offsetAlongLine&&(c.offsetAlongLine*=l);if(c.placementTemplate&&
c.placementTemplate.length){var d=c.placementTemplate.map(f=>f*l);c.placementTemplate=d}break;case "CIMMarkerPlacementAlongLineVariableSize":c.maxRandomOffset&&(c.maxRandomOffset*=l);c.placementTemplate&&c.placementTemplate.length&&(d=c.placementTemplate.map(f=>f*l),c.placementTemplate=d);break;case "CIMMarkerPlacementOnLine":c.startPointOffset&&(c.startPointOffset*=l);break;case "CIMMarkerPlacementAtExtremities":c.offsetAlongLine&&(c.offsetAlongLine*=l);break;case "CIMMarkerPlacementAtRatioPositions":c.beginPosition&&
(c.beginPosition*=l);c.endPosition&&(c.endPosition*=l);break;case "CIMMarkerPlacementPolygonCenter":c.offsetX&&(c.offsetX*=l);c.offsetY&&(c.offsetY*=l);break;case "CIMMarkerPlacementInsidePolygon":c.offsetX&&(c.offsetX*=l),c.offsetY&&(c.offsetY*=l),c.stepX&&(c.stepX*=l),c.stepY&&(c.stepY*=l)}}function H(c,l){switch(c.type){case "CIMGeometricEffectArrow":case "CIMGeometricEffectDonut":c.width&&(c.width*=l);break;case "CIMGeometricEffectBuffer":c.size&&(c.size*=l);break;case "CIMGeometricEffectCut":c.beginCut&&
(c.beginCut*=l);c.endCut&&(c.endCut*=l);c.middleCut&&(c.middleCut*=l);break;case "CIMGeometricEffectDashes":c.customEndingOffset&&(c.customEndingOffset*=l);c.offsetAlongLine&&(c.offsetAlongLine*=l);if(c.dashTemplate&&c.dashTemplate.length){const d=c.dashTemplate.map(f=>f*l);c.dashTemplate=d}break;case "CIMGeometricEffectExtension":case "CIMGeometricEffectJog":case "CIMGeometricEffectRadial":c.length&&(c.length*=l);break;case "CIMGeometricEffectMove":c.offsetX&&(c.offsetX*=l);c.offsetY&&(c.offsetY*=
l);break;case "CIMGeometricEffectOffset":case "CIMGeometricEffectOffsetTangent":c.offset&&(c.offset*=l);break;case "CIMGeometricEffectRegularPolygon":c.radius&&(c.radius*=l);break;case "CIMGeometricEffectTaperedPolygon":c.fromWidth&&(c.fromWidth*=l);c.length&&(c.length*=l);c.toWidth&&(c.toWidth*=l);break;case "CIMGeometricEffectWave":c.amplitude&&(c.amplitude*=l),c.period&&(c.period*=l)}}function K(c,l){if(c){var d="CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===c.type;if(d?.symbolLayers)for(const f of d.symbolLayers)if(!(f.colorLocked||
c&&(C.isCIMStroke(f)||C.isCIMMarker(f)&&f.markerPlacement&&C.isCIMMarkerStrokePlacement(f.markerPlacement))))switch(f.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":f.tintColor&&z(l,f.tintColor);break;case "CIMVectorMarker":f.markerGraphics?.forEach(k=>{K(k.symbol,l)});break;case "CIMSolidStroke":case "CIMSolidFill":z(l,f.color);break;case "CIMHatchFill":K(f.lineSymbol,l)}}}function z(c,l){for(const d of c)if(d.join(".")===l.join("."))return;c.push(l)}function h(c,l,d){if(c){var f=
"CIMTextSymbol"===c.type?c.symbol:c;c="CIMPolygonSymbol"===f?.type;if(f?.symbolLayers)for(const k of f.symbolLayers)if(!k.colorLocked){if(c)if(d){if({layersToColor:f}=d,(C.isCIMStroke(k)||C.isCIMMarker(k)&&k.markerPlacement&&C.isCIMMarkerStrokePlacement(k.markerPlacement))&&"fill"===f||C.isCIMFill(k)&&"outline"===f)continue}else if(C.isCIMStroke(k)||C.isCIMMarker(k)&&k.markerPlacement&&C.isCIMMarkerStrokePlacement(k.markerPlacement))continue;f=l.toArray();switch(k.type){case "CIMPictureMarker":case "CIMPictureStroke":case "CIMPictureFill":k.tintColor=
f;break;case "CIMVectorMarker":k.markerGraphics?.forEach(m=>{h(m.symbol,l,d)});break;case "CIMSolidStroke":case "CIMSolidFill":k.color=f;break;case "CIMHatchFill":h(k.lineSymbol,l,d)}}}}g.applyCIMSymbolColor=function(c,l,d){l instanceof A||(l=new A(l));(c=C.toCIMSymbolJSON(c))&&h(c,l,d)};g.applyCIMSymbolRotation=function(c,l,d=!1){c=C.toCIMSymbolJSON(c);d&&(l=360-l);if("CIMTextSymbol"===c?.type)c.angle=l;else if("CIMPointSymbol"===c?.type&&c.symbolLayers){d=l-(c.angle||0);for(const f of c.symbolLayers)if(C.isCIMMarker(f)){let k=
f.rotation||0;k=f.rotateClockwise?k-d:k+d;f.rotation=k}c.angle=l}};g.getCIMSymbolColor=function(c){c=C.toCIMSymbolJSON(c);const l=[];K(c,l);return l.length?new A(C.normalizeAlpha(l[0])):null};g.getCIMSymbolRotation=function(c,l=!1){c=C.toCIMSymbolJSON(c);return"CIMTextSymbol"===c?.type||"CIMPointSymbol"===c?.type?(c=c.angle,null!=c&&l?360-c:c??0):0};g.getCIMSymbolSize=B;g.getCIMSymbolType=function(c){c=C.toCIMSymbolJSON(c);if(!c)return null;switch(c.type){case "CIMPointSymbol":return"CIMPointSymbol";
case "CIMLineSymbol":return"CIMLineSymbol";case "CIMPolygonSymbol":return"CIMPolygonSymbol";case "CIMTextSymbol":return"CIMTextSymbol";case "CIMMeshSymbol":return"CIMMeshSymbol";default:return null}};g.scaleCIMMarker=F;g.scaleCIMSymbol=v;g.scaleCIMSymbolTo=function(c,l,d){if(c){var f=C.toCIMSymbolJSON(c);c=B(c);if(0===c){if(f)if("CIMTextSymbol"===f.type)f.height=l;else if(f.symbolLayers)for(const k of f.symbolLayers)switch(k.type){case "CIMPictureMarker":case "CIMVectorMarker":k.size=l;break;case "CIMPictureStroke":case "CIMSolidStroke":case "CIMGradientStroke":k.width=
l}}else v(f,l/c,!1,d)}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewUtils":function(){define(["exports","../../Color"],function(g,A){function C(B,v){return Math.round(Math.min(Math.max(B+191.25*v,0),255))}g.SymbolSizeDefaults=void 0;(function(B){B[B.size=22]="size";B[B.lineWidth=50]="lineWidth";B[B.maxSize=120]="maxSize";B[B.maxOutlineSize=80]="maxOutlineSize";B[B.tallSymbolWidth=20]="tallSymbolWidth"})(g.SymbolSizeDefaults||(g.SymbolSizeDefaults={}));
g.adjustColorBrightness=function(B,v){if(null==B)return new A;if("type"in B&&("linear"===B.type||"pattern"===B.type))return B;B=new A(B);return new A([C(B.r,v),C(B.g,v),C(B.b,v),B.a])};g.adjustColorComponentBrightness=C;g.getConeShapes=function(B,v){let F=v?g.SymbolSizeDefaults.tallSymbolWidth:B;v=v?4:6;F=F<=g.SymbolSizeDefaults.size?F-.5*v:F-v;v=.15*F;const y=F;B-=v;return[{type:"ellipse",cx:.5*F,cy:B,rx:.5*F,ry:v},{type:"path",path:[{command:"M",values:[.5*y,0]},{command:"L",values:[y,B]},{command:"L",
values:[0,B]},{command:"Z",values:[]}]}]};g.getCubeShapes=function(B,v){let F=v?g.SymbolSizeDefaults.tallSymbolWidth:B;var y=v?4:6;y=F=F<=g.SymbolSizeDefaults.size?F-.5*y:F-y;v=v?.35*F:.5*F;return[{type:"path",path:[{command:"M",values:[.5*y,0]},{command:"L",values:[y,.5*v]},{command:"L",values:[.5*y,v]},{command:"L",values:[0,.5*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,.5*v]},{command:"L",values:[.5*y,v]},{command:"L",values:[.5*y,B]},{command:"L",values:[0,B-.5*v]},
{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.5*y,v]},{command:"L",values:[.5*y,B]},{command:"L",values:[y,B-.5*v]},{command:"L",values:[y,.5*v]},{command:"Z",values:[]}]}]};g.getCylinderShapes=function(B,v){var F=v?g.SymbolSizeDefaults.tallSymbolWidth:B;v=v?4:6;F=F<=g.SymbolSizeDefaults.size?F-.5*v:F-v;v=.5*F;const y=.15*F;B-=y;return[{type:"ellipse",cx:.5*F,cy:B,rx:v,ry:y},{type:"path",path:[{command:"M",values:[0,y]},{command:"L",values:[0,B]},{command:"L",values:[F,B]},{command:"L",
values:[F,y]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*F,cy:y,rx:v,ry:y}]};g.getDiamondShapes=function(B){var v=B;v=v<g.SymbolSizeDefaults.size?v-2:v-4;const F=Math.floor(B/10)-1||1;return[{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[v,.5*B-F]},{command:"L",values:[.45*v-F,.5*B+F]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*v,0]},{command:"L",values:[.45*v-F,.5*B+F]},{command:"L",values:[0,.5*B-F]},{command:"Z",values:[]}]},{type:"path",
path:[{command:"M",values:[0,.5*B-F]},{command:"L",values:[.45*v-F,.5*B+F]},{command:"L",values:[.45*v,B]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*v,B]},{command:"L",values:[v,.5*B-F]},{command:"L",values:[.45*v-F,.5*B+F]},{command:"Z",values:[]}]}]};g.getExtrudeSymbolShapes=function(B){const v=g.SymbolSizeDefaults.size;B*=.5;return[{type:"path",path:[{command:"M",values:[0,.35*v]},{command:"L",values:[.3*v,.7*v]},{command:"L",values:[.3*v,.7*v+B]},{command:"L",values:[0,
.7*v+B-.35*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*v,.7*v]},{command:"L",values:[.3*v,.7*v+B]},{command:"L",values:[v,B]},{command:"L",values:[v,0]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.3*v,0]},{command:"L",values:[v,0]},{command:"L",values:[.3*v,.7*v]},{command:"L",values:[0,.35*v]},{command:"Z",values:[]}]}]};g.getInvertedConeShapes=function(B){let v=B;v=v<g.SymbolSizeDefaults.size?v-3:v-6;const F=.15*v,y=v;return[{type:"path",path:[{command:"M",
values:[0,0]},{command:"L",values:[y,0]},{command:"L",values:[.5*y,B-F]},{command:"Z",values:[]}]},{type:"ellipse",cx:.5*v,cy:0,rx:.5*v,ry:F}]};g.getPathSymbolShapes=function(B,v,F){var y=g.SymbolSizeDefaults.size;let H=y,K=y;1>B?H*=.75:1<B&&(K*=1.25);B=y;v&&F&&(H=K=B=y=0);return[{type:"path",path:[{command:"M",values:[B,0]},{command:"L",values:[F?B:.875*B,0]},{command:"L",values:[F?H-.5*B:0,K-.5*y]},{command:"L",values:[H-.5*B,K-.5*y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[B,
0]},{command:"L",values:[B,v?0:.125*y]},{command:"L",values:[H-.5*B,v?K-.5*y:y]},{command:"L",values:[H-.5*B,K-.5*y]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[H-.5*B,K-.5*y]},{command:"L",values:[F?H-.5*B:0,K-.5*y]},{command:"L",values:[F?H-.5*B:0,v?K-.5*y:y]},{command:"L",values:[H-.5*B,v?K-.5*y:y]},{command:"Z",values:[]}]}]};g.getTetrahedronShapes=function(B){var v=B;v=v<g.SymbolSizeDefaults.size?v-1:v-2;return[{type:"path",path:[{command:"M",values:[.45*B,0]},{command:"L",
values:[B,v]},{command:"L",values:[.45*B,.6*v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[.45*B,0]},{command:"L",values:[.45*B,.6*v]},{command:"L",values:[0,v]},{command:"Z",values:[]}]},{type:"path",path:[{command:"M",values:[0,v]},{command:"L",values:[.45*B,.6*v]},{command:"L",values:[B,v]},{command:"Z",values:[]}]}]};g.getWaterSymbolShapes=function(){return[{type:"path",path:"M80,80.2v-27c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4C8.3,59.3,5.7,58,3.9,56c-1.1-1.2-2.4-2.1-3.9-2.8v27"},
{type:"path",path:"M11,59.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8v-24c-1.5,0.7-2.8,1.6-3.9,2.8c-1.8,2.1-4.4,3.3-7.1,3.5c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-2.2-2.3-4.7-3.6-7.4-3.6s-5.1,1.3-7.4,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.7-0.1-5.3-1.4-7.1-3.4c-1.1-1.2-2.4-2.1-3.9-2.8v24c1.5,0.7,2.8,1.6,3.9,2.8C5.7,58,8.3,59.3,11,59.4z"},
{type:"path",path:"M11,35.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.4-3.6s5.1,1.3,7.4,3.6c1.8,2,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c2.2-2.3,4.7-3.6,7.3-3.6s5.1,1.3,7.4,3.6c1.8,2.1,4.4,3.3,7.2,3.4c2.7-0.1,5.3-1.4,7.1-3.4c1.1-1.2,2.4-2.1,3.9-2.8V3.6c-1.5,0.7-2.8,1.6-3.9,2.8c-2.2,2.1-4.6,3.4-7.1,3.4s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6S42.5,9.9,40,9.9s-5-1.3-7.1-3.4s-4.7-3.6-7.4-3.6s-5.1,1.3-7.3,3.6c-1.8,2.1-4.4,3.3-7.2,3.4c-2.5,0-5-1.3-7.1-3.4C2.8,5.3,1.4,4.3,0,3.6v25.6c1.5,0.7,2.8,1.6,3.9,2.8C5.7,34.1,8.3,35.3,11,35.4z"}]};
g.shapes={fill:[{type:"path",path:"M -10,-10 L 10,0 L 10,10 L -10,10 L -10,-10 Z"}],squareFill:[{type:"path",path:"M -10,-10 L 10,-10 L 10,10 L -10,10 L -10,-10 Z"}],meshSymbol3DFill:[{type:"path",path:"M -10,-8 L 6,0 L 6,6 L -10,6 L -10,-8 Z"},{type:"path",path:"M -10,-8 L -7,-10 L 9,-2 L 6,0 L -10,-8 Z"},{type:"path",path:"M 6,0 L 9,-2 L 9,4 L 6,6 L 6,0 Z"}],pathSymbol3DLayer:[{type:"path",path:"M 3,12 L 12,0 L 11,-2 L -4,5 L -1,5 L 1,7 L 3,10 L 3,12 Z"},{type:"circle",cx:-2,cy:10,r:5}],extrudeSymbol3DLayer:[{type:"path",
path:"M -7,-5 L -2,0 L -2,7 L -7,3 L -7,-5 Z"},{type:"path",path:"M -2,0 L -2,7 L 10,-3 L 10,-10 L -2,0 Z"},{type:"path",path:"M -7,-5 L -2,0 L 10,-10 L -2,-10 L -7,-5 Z"}],cone:[{type:"path",path:"M 0,-10 L -8,5 L -4,6.5 L 0,7 L 4,6.5 L 8,5 Z"}],tallCone:[{type:"path",path:"M 0,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 0,-9 Z"}],invertedCone:[{type:"path",path:"M 0,7 L -8,-8 L 8,-8 Z"},{type:"path",path:"M -8,-8 L -4,-9.5 L 0,-10 L 4,-9.5 L 8,-8 L 4,-6.5 L 0,-6 L -4,-6.5 Z"}],cube:[{type:"path",
path:"M -10,-7 L 0,-12 L 10,-7 L 0,-2 L -10,-7 Z"},{type:"path",path:"M -10,-7 L 0,-2 L 0,12 L -10,7 L -10,-7 Z"},{type:"path",path:"M 0,-2 L 10,-7 L 10,7 L 0,12 L 0,-2 Z"}],tallCube:[{type:"path",path:"M -3.5,-8.5 L 0,-9.5 L 3.5,-8.5 L 0,-7.5 L -3.5,-8.5 Z"},{type:"path",path:"M -3.5,-8.5 L 0,-7.5 L 0,9 L -3.5,8 L -3.5,-8.5 Z"},{type:"path",path:"M 0,-7.5 L 3.5,-8.5 L 3.5,8 L 0,9 L 0,-7.5 Z"}],cylinder:[{type:"path",path:"M -8,-9 L -8,7 L -4,8.5 L 0,9 L 4,8.5 L 8,7 L 8,-9 Z"},{type:"ellipse",cx:0,
cy:-9,rx:8,ry:2}],tallCylinder:[{type:"path",path:"M -3.5,-9 L -3.5,7 L -1.5,7.8 L 0,8 L 1.5,7.8 L 3.5,7 L 3.5,-9 Z"},{type:"ellipse",cx:0,cy:-9,rx:3.5,ry:1}],diamond:[{type:"path",path:"M 0,-10 L 10,-1 L -1,1 L 0,-10 Z"},{type:"path",path:"M 0,-10 L -1,1 L -8,-1 L 0,-10 Z"},{type:"path",path:"M -1,1 L 0,10 L -8,-1 L -1,1 Z"},{type:"path",path:"M -1,0 L 0,10 L 10,-1 L -1,1 Z"}],tetrahedron:[{type:"path",path:"M 0,-10 L 10,7 L 0,0 L 0,-10 Z"},{type:"path",path:"M 0,-10 L 0,0 L -8,7 L 0,-10 Z"},{type:"path",
path:"M 10,7 L 0,0 L -8,7 L 10,7 Z"}]};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/renderUtils":function(){define("exports ../../kernel ../../request ../../core/colorUtils ../../core/Error ../../core/has ../../libs/maquette/projection ../../libs/maquette/projector ./svgUtils ./utils".split(" "),function(g,A,C,B,v,F,y,H,K,z){function h(d,f){l.append(d,f);l.detach(f)}function c(d,f,k){return d?C(d,{responseType:"image"}).then(m=>{m=m.data;const r=m.width,n=
m.height,q=r/n;let u=f;k&&(u=Math.min(u,Math.max(r,n)));return{image:m,width:1>=q?Math.ceil(u*q):u,height:1>=q?u:Math.ceil(u/q)}}):Promise.reject(new v("renderUtils: imageDataSize","href not provided."))}const l=H.createProjector();g.renderOnce=h;g.renderSymbol=function(d,f,k){const m=Math.ceil(f[0]),r=Math.ceil(f[1]);if(!d.some(n=>!!n.length))return null;f=k?.node||document.createElement("div");null!=k.opacity&&(f.style.opacity=k.opacity.toString());null!=k.effectView&&(f.style.filter=z.getCSSFilterFromEffectList(k.effectView));
h(f,()=>K.renderSVG(d,m,r,k));return f};g.tintImageWithColor=function(d,f,k,m,r){return c(d,f,r).then(n=>{const q=n.width??f,u=n.height??f;var w;if(w=n.image)w=k&&"ignore"!==m?"multiply"===m&&255===k.r&&255===k.g&&255===k.b&&1===k.a?!1:!0:!1;if(w){var E=n.image.width,e=n.image.height;F("edge")&&/\.svg$/i.test(d)&&(--E,--e);w=Math.ceil(q);var b=Math.ceil(u);var p=document.createElement("canvas");p.width=w;p.height=b;p.style.width=w+"px";p.style.height=b+"px";p=p.getContext("2d");p.clearRect(0,0,w,
b);w=p;w.drawImage(n.image,0,0,E,e,0,0,q,u);b=w.getImageData(0,0,q,u);p=[k.r/255,k.g/255,k.b/255,k.a];const R=B.toHSV(k);for(let T=0;T<b.data.length;T+=4){n=b.data;E=T;e=p;var I=R;switch(m){case "multiply":n[E]*=e[0];n[E+1]*=e[1];n[E+2]*=e[2];n[E+3]*=e[3];break;default:const J=B.toHSV({r:n[E],g:n[E+1],b:n[E+2]});J.h=I.h;J.s=I.s;J.v=J.v/100*I.v;I=B.toRGB(J);n[E]=I.r;n[E+1]=I.g;n[E+2]=I.b;n[E+3]*=e[3]}}w.putImageData(b,0,0);d=w.canvas.toDataURL("image/png")}else w=A.id?.findCredential(d),w?.token&&
(n=d.includes("?")?"\x26":"?",d=`${d}${n}token=${w.token}`);return{url:d,width:q,height:u}}).catch(()=>({url:d,width:f,height:f}))};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/core/colorUtils":function(){define("exports ../Color ./arrayUtils ./lang ./mathUtils ../chunks/vec42 ./libs/gl-matrix-2/factories/vec4f64".split(" "),function(g,A,C,B,v,F,y){function H(b){return"r"in b&&"g"in b&&"b"in b}function K(b,p){const I=[];let R,T;if(b[0].length!==p.length)throw Error("dimensions do not match");
const J=b.length,M=b[0].length;let U=0;for(R=0;R<J;R++){for(T=U=0;T<M;T++)U+=b[R][T]*p[T];I.push(U)}return I}function z(b){b=[b.r/255,b.g/255,b.b/255].map(p=>.04045>=p?p/12.92:((p+.055)/1.055)**2.4);b=K(w,b);return{x:100*b[0],y:100*b[1],z:100*b[2]}}function h(b){b=K(E,[b.x/100,b.y/100,b.z/100]).map(p=>Math.min(1,Math.max(.0031308>=p?12.92*p:1.055*p**(1/2.4)-.055,0)));return{r:Math.round(255*b[0]),g:Math.round(255*b[1]),b:Math.round(255*b[2])}}function c(b){b=[b.x/95.047,b.y/100,b.z/108.883].map(p=>
p>(6/29)**3?p**(1/3):1/3*(29/6)**2*p+4/29);return{l:116*b[1]-16,a:500*(b[0]-b[1]),b:200*(b[1]-b[2])}}function l(b){const p=b.l;b=[(p+16)/116+b.a/500,(p+16)/116,(p+16)/116-b.b/200].map(I=>I>6/29?I**3:3*(6/29)**2*(I-4/29));return{x:95.047*b[0],y:100*b[1],z:108.883*b[2]}}function d(b){if(H(b))return b;if("l"in b&&"c"in b&&"h"in b){var p=b.c,I=b.h;return h(l({l:b.l,a:p*Math.cos(I),b:p*Math.sin(I)}))}if("l"in b&&"a"in b&&"b"in b)return h(l(b));if("x"in b&&"y"in b&&"z"in b)return h(b);if("h"in b&&"s"in
b&&"v"in b){I=(b.h+360)%360/60;p=b.v/100*255;b=b.s/100*p;const R=b*(1-Math.abs(I%2-1));switch(Math.floor(I)){case 0:I={r:b,g:R,b:0};break;case 1:I={r:R,g:b,b:0};break;case 2:I={r:0,g:b,b:R};break;case 3:I={r:0,g:R,b};break;case 4:I={r:R,g:0,b};break;case 5:case 6:I={r:b,g:0,b:R};break;default:I={r:0,g:0,b:0}}I.r=Math.round(I.r+p-b);I.g=Math.round(I.g+p-b);I.b=Math.round(I.b+p-b);return I}return b}function f(b){if("h"in b&&"s"in b&&"v"in b)return b;var p=d(b);b=p.r;const I=p.g,R=p.b;p=Math.max(b,I,
R);const T=p-Math.min(b,I,R);b=0===T?0:p===b?(I-R)/T%6:p===I?(R-b)/T+2:(b-I)/T+4;0>b&&(b+=6);return{h:60*b,s:100*(0===T?0:T/p),v:100/255*p}}function k(b){return"l"in b&&"a"in b&&"b"in b?b:c(z(d(b)))}function m(b){let {r:p,g:I,b:R,a:T}=b;1>T&&(p=Math.round(T*p+255*(1-T)),I=Math.round(T*I+255*(1-T)),R=Math.round(T*R+255*(1-T)));return new A({r:p,g:I,b:R})}function r(b,p){const {r:I,g:R,b:T}=p?.ignoreAlpha?b:m(b);return.2126*I+.7152*R+.0722*T}function n(b){b[0]??(b[0]=0);b[1]??(b[1]=0);b[2]??(b[2]=0);
return b}function q(b,p,I={}){const R=[],T=b.length-1,J=Math.ceil((p-b.length)/T);a:for(let M=0;M<T;M++){const U=b[M],x=b[M+1];for(let L=1;L<=J;L++)if(R.push(u(U,x,L/(J+1),I)),R.length+b.length===p)break a}return[...b.map(M=>M.clone()),...C.shuffle(R,I.seed??1)]}function u(b,p,I,R={}){var T=b.r,J=b.g;b=b.b;T=Math.round(T+(p.r-T)*I);J=Math.round(J+(p.g-J)*I);p=Math.round(b+(p.b-b)*I);if(!R.offset)return new A([T,J,p]);R=C.getRandomNumberGenerator(R.seed);return new A([e(T,R),e(J,R),e(p,R)])}const w=
[[.4124,.3576,.1805],[.2126,.7152,.0722],[.0193,.1192,.9505]],E=[[3.2406,-1.5372,-.4986],[-.9689,1.8758,.0415],[.0557,-.204,1.057]];g.BrightnessThreshold=void 0;(function(b){b[b.Low=160]="Low";b[b.High=225]="High"})(g.BrightnessThreshold||(g.BrightnessThreshold={}));const e=(b,p)=>{p=Math.floor(10*p())-5;return Math.min(255,Math.max(0,b+p))};g.colorEquals=function(b,p){return b===p||null!=b&&b.equals(p)};g.colorVectorEquals=function(b,p){return b===p||null!=b&&null!=p&&F.equals(b,p)};g.colorVectorToColorAndOpacity=
function(b){return y.fromValues(b[0],b[1],b[2],3<b.length?b[3]:1)};g.createUniqueColors=function(b,p,I={}){if(0===b.length||0>=p)return[];b=b.map(T=>"string"===typeof T?new A(T):T);if(1===b.length||1===p){I=[];b=b[0];for(var R=0;R<p;R++)I.push(b.clone());return I}I.shuffle&&(b=C.shuffle(B.clone(b),I.seed));if(b.length>=p){I=[];R=(b.length-1)/(p-1);for(let T=0;T<p;T++)I.push(b[Math.round(T*R)].clone());return I}return q(b,p,I)};g.darken=function(b,p){var I=k(b);I.l*=1-p;p=d(I);I=b.clone();I.setColor(p);
I.a=b.a;return I};g.desaturate=function(b,p){var I=f(b);I.s*=p;p=d(I);I=b.clone();I.setColor(p);I.a=b.a;return I};g.getColorLuminance=r;g.getColorTheme=function(b){return m(b).isBright?"light":"dark"};g.getContrast=function(b,p=g.BrightnessThreshold.High){return r(b,{ignoreAlpha:!0})>p?new A([0,0,0,b.a]):new A([255,255,255,b.a])};g.isRGB=H;g.multiplyOpacity=function(b,p){b=b.clone();b.a*=p;return b};g.multiplyOpacityToUnitRGBA=function(b,p){b=A.toUnitRGBA(b);b[3]*=p;return b};g.toHSV=f;g.toLAB=k;
g.toLCH=function(b){if(!("l"in b&&"c"in b&&"h"in b)){var p=c(z(d(b)));b=p.l;var I=p.a;const R=p.b;p=Math.sqrt(I*I+R*R);I=Math.atan2(R,I);I=0<I?I:I+2*Math.PI;b={l:b,c:p,h:I}}return b};g.toRGB=d;g.unitRGBAFromColor=function(b){return A.toUnitRGBA(b)};g.validateColor=n;g.validateColorAndOpacity=function(b){b.length=4;n(b);b[3]??(b[3]=1);v.clamp(b[3],0,1);return b};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgUtils":function(){define("exports ../../Color ../../core/has ../../core/maybe ../../core/libs/gl-matrix-2/factories/mat2df32 ../../core/libs/gl-matrix-2/math/mat2d ./gfxUtils ./svgGlobalState ../../widgets/support/widgetUtils ../../widgets/support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z){function h(x,L){x*=U/180;return Math.abs(L*Math.sin(x))+Math.abs(L*Math.cos(x))}function c(x){return x.map(L=>`${L.command} ${L.values.join(" ")}`).join(" ").trim()}function l(x,L,Q,G,N){if(x){if("circle"===x.type)return z.tsx("circle",{cx:x.cx,cy:x.cy,fill:L,"fill-rule":"evenodd",r:x.r,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-dashoffset":Q.dashOffset,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width});if("ellipse"===
x.type)return z.tsx("ellipse",{cx:x.cx,cy:x.cy,fill:L,"fill-rule":"evenodd",rx:x.rx,ry:x.ry,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width});if("rect"===x.type)return z.tsx("rect",{fill:L,"fill-rule":"evenodd",height:x.height,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width,width:x.width,x:x.x,y:x.y});if("image"===
x.type)return z.tsx("image",{alt:N||"image",height:x.height,href:x.src,preserveAspectRatio:"none",width:x.width,x:x.x,y:x.y});if("path"===x.type)return x="string"!==typeof x.path?c(x.path):x.path,z.tsx("path",{d:x,fill:L,"fill-rule":"evenodd",stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width});if("text"===x.type)return B.assertIsSome(G),z.tsx("text",{"dominant-baseline":G.dominantBaseline,fill:L,"fill-rule":"evenodd",
"font-family":G.font.family,"font-size":G.font.size,"font-style":G.font.style,"font-variant":G.font.variant,"font-weight":G.font.weight,kerning:G.kerning,rotate:G.rotate,stroke:Q.color,"stroke-dasharray":Q.dashArray,"stroke-linecap":Q.cap,"stroke-linejoin":Q.join,"stroke-miterlimit":"4","stroke-width":Q.width,"text-anchor":G.align,"text-decoration":G.decoration,"text-rendering":I,x:x.x,y:x.y},x.text)}return null}function d(x){if(!x)return{fill:"none",pattern:null,linearGradient:null};if(!("type"in
x))return{fill:(new A(x)).toString(),pattern:null,linearGradient:null};if("pattern"===x.type){var L=`patternId-${H.nextPatternId()}`;return{fill:`url(#${L})`,pattern:{id:L,x:x.x,y:x.y,width:x.width,height:x.height,image:{x:0,y:0,width:x.width,height:x.height,href:x.src}},linearGradient:null}}L=`linearGradientId-${H.nextLinearGradientId()}`;return{fill:`url(#${L})`,pattern:null,linearGradient:{id:L,x1:x.x1,y1:x.y1,x2:x.x2,y2:x.y2,stops:x.colors.map(Q=>({offset:Q.offset,color:Q.color&&(new A(Q.color)).toString()}))}}}
function f(x){const L={color:"none",width:1,cap:"butt",join:"4",dashArray:"none",dashOffset:"0"};x&&(null!=x.width&&(L.width=x.width),x.cap&&(L.cap=x.cap),x.join&&(L.join=x.join.toString()),x.color&&(L.color=(new A(x.color)).toString()),x.dashArray&&(L.dashArray=x.dashArray),x.dashoffset&&(L.dashOffset=x.dashoffset),x.style&&!x.dashArray&&(L.dashArray=y.getDashArray(x).join(",")||"none"));return L}function k(x,L){const Q={align:null,decoration:null,kerning:null,rotate:null,font:{style:null,variant:null,
weight:null,size:null,family:null}};if(x){const G=x.alignBaseline;Q.align=x.align;Q.dominantBaseline="baseline"===G?"auto":"top"===G?"text-top":"bottom"===G?"hanging":G;Q.decoration=x.decoration;Q.kerning=x.kerning?"auto":"0";Q.rotate=x.rotated?"90":"0";B.assertIsSome(L);Q.font.style=L.style||"normal";Q.font.variant=L.variant||"normal";Q.font.weight=L.weight||"normal";Q.font.size=L.size&&L.size.toString()||"10pt";Q.font.family=L.family||"serif"}return Q}function m(x){const {pattern:L,linearGradient:Q}=
x;return L?z.tsx("pattern",{height:L.height,id:L.id,patternUnits:"userSpaceOnUse",width:L.width,x:L.x,y:L.y},z.tsx("image",{height:L.image.height,href:L.image.href,width:L.image.width,x:L.image.x,y:L.image.y})):Q?(x=Q.stops.map((G,N)=>z.tsx("stop",{key:`${N}-stop`,offset:G.offset,"stop-color":G.color})),z.tsx("linearGradient",{gradientUnits:"userSpaceOnUse",id:Q.id,x1:Q.x1,x2:Q.x2,y1:Q.y1,y2:Q.y2},x)):null}function r(x,L){if(!x||0===x.length)return null;const Q=[];for(const G of x){const {shape:N,
fill:S,stroke:W,font:ca}=G;x=d(S);const Z=f(W),ja="text"===N.type?k(N,ca):null;(x=l(N,x.fill,Z,ja))&&Q.push(x)}return z.tsx("mask",{id:L,maskUnits:"userSpaceOnUse"},z.tsx("g",null,Q))}function n(x,L,Q,G,N){F.scale(x,F.identity(x),[L,Q]);x[4]=x[4]*L-G*L+G;x[5]=x[5]*Q-N*Q+N;return x}function q(x,L){if(J&&"left"in J){null!=J.left&&J.left>x&&(J.left=x);if(null==J.right||J.right<x)J.right=x;if(null==J.top||J.top>L)J.top=L;if(null==J.bottom||J.bottom<L)J.bottom=L}else J={left:x,bottom:L,right:x,top:L}}
function u(x){const L=x.args,Q=L.length;switch(x.action){case "M":case "L":case "C":case "S":case "Q":case "T":for(x=0;x<Q;x+=2)q(L[x],L[x+1]);M.x=L[Q-2];M.y=L[Q-1];break;case "H":for(x=0;x<Q;++x)q(L[x],M.y);M.x=L[Q-1];break;case "V":for(x=0;x<Q;++x)q(M.x,L[x]);M.y=L[Q-1];break;case "m":x=0;"x"in M||(q(M.x=L[0],M.y=L[1]),x=2);for(;x<Q;x+=2)q(M.x+=L[x],M.y+=L[x+1]);break;case "l":case "t":for(x=0;x<Q;x+=2)q(M.x+=L[x],M.y+=L[x+1]);break;case "h":for(x=0;x<Q;++x)q(M.x+=L[x],M.y);break;case "v":for(x=
0;x<Q;++x)q(M.x,M.y+=L[x]);break;case "c":for(x=0;x<Q;x+=6)q(M.x+L[x],M.y+L[x+1]),q(M.x+L[x+2],M.y+L[x+3]),q(M.x+=L[x+4],M.y+=L[x+5]);break;case "s":case "q":for(x=0;x<Q;x+=4)q(M.x+L[x],M.y+L[x+1]),q(M.x+=L[x+2],M.y+=L[x+3]);break;case "A":for(x=0;x<Q;x+=7)q(L[x+5],L[x+6]);M.x=L[Q-2];M.y=L[Q-1];break;case "a":for(x=0;x<Q;x+=7)q(M.x+=L[x+5],M.y+=L[x+6])}}function w(x,L,Q){const G=R[x.toLowerCase()];"number"===typeof G&&(G?L.length>=G&&(x={action:x,args:L.slice(0,L.length-L.length%G)},Q.push(x),u(x)):
(x={action:x,args:[]},Q.push(x),u(x)))}function E(x){const L={x:0,y:0,width:0,height:0};if("circle"===x.type)L.x=x.cx-x.r,L.y=x.cy-x.r,L.width=2*x.r,L.height=2*x.r;else if("ellipse"===x.type)L.x=x.cx-x.rx,L.y=x.cy-x.ry,L.width=2*x.rx,L.height=2*x.ry;else if("image"===x.type||"rect"===x.type)L.x=x.x,L.y=x.y,L.width=x.width,L.height=x.height;else if("path"===x.type){{const N=("string"!==typeof x.path?c(x.path):x.path).match(T),S=[];J={};M={};if(N){x="";var Q=[],G=N.length;for(let W=0;W<G;++W){const ca=
N[W],Z=parseFloat(ca);isNaN(Z)?(x&&w(x,Q,S),Q=[],x=ca):Q.push(Z)}w(x,Q,S);x={x:0,y:0,width:0,height:0};J&&"left"in J&&(x.x=J.left,x.y=J.top,x.width=J.right-J.left,x.height=J.bottom-J.top)}else x=null}L.x=x.x;L.y=x.y;L.width=x.width;L.height=x.height}return L}function e(x){const L={x:0,y:0,width:0,height:0};let Q=null,G=Number.NEGATIVE_INFINITY,N=Number.NEGATIVE_INFINITY;for(const S of x)Q?(Q.x=Math.min(Q.x,S.x),Q.y=Math.min(Q.y,S.y),G=Math.max(G,S.x+S.width),N=Math.max(N,S.y+S.height)):(Q=L,Q.x=S.x,
Q.y=S.y,G=S.x+S.width,N=S.y+S.height);Q&&(Q.width=G-Q.x,Q.height=N-Q.y);return Q}function b(x,L,Q,G,N,S,W,ca,Z){var ja=(W&&S?h(S,L):L)/2,ma=(W&&S?h(S,Q):Q)/2;if(Z){var da=Z[0];Z=Z[1];ja=(W&&S?h(S,da):da)/2;ma=(W&&S?h(S,Z):Z)/2}da=x.width+G;const X=x.height+G;W=v.create();Z=v.create();var fa=!1;if(N&&0!==da&&0!==X){N=L!==Q?L/Q:da/X;fa=L>Q?L:Q;let oa=1,ba=1;isNaN(fa)||(1<N?(oa=fa/da,ba=fa/N/X):(ba=fa/X,oa=fa*N/da));F.multiply(Z,Z,n(W,oa,ba,ja,ma));fa=!0}N=x.x+(da-G)/2;x=x.y+(X-G)/2;G=F.multiply;ja-=
N;ma-=x;ja=F.translate(W,F.identity(W),[ja,ma]);G.call(F,Z,Z,ja);!fa&&(da>L||X>Q)&&(ja=da/L>X/Q,L=(ja?L:Q)/(ja?da:X),F.multiply(Z,Z,n(W,L,L,N,x)));ca&&(L=F.multiply,Q=ca[0],ca=ca[1],ca=F.translate(W,F.identity(W),[Q,ca]),L.call(F,Z,Z,ca));S&&(ca=F.multiply,L=S%360*Math.PI/180,F.rotate(W,F.identity(W),L),S=Math.cos(L),L=Math.sin(L),Q=W[4],da=W[5],W[4]=Q*S-da*L+x*L-N*S+N,W[5]=da*S+Q*L-N*L-x*S+x,ca.call(F,Z,Z,W));return`matrix(${Z[0]},${Z[1]},${Z[2]},${Z[3]},${Z[4]},${Z[5]})`}function p(x,L,Q){x=x?.effects.find(ca=>
"bloom"===ca.type);if(!x)return null;const {strength:G,radius:N}=x;x=0<G?N:0;const S=(G+x)*L,W=4*G+1;return z.tsx("filter",{filterUnits:"userSpaceOnUse",height:"300%",id:`bloom${Q}`,width:"300%",x:"-100%",y:"-100%"},z.tsx("feMorphology",{in:"SourceGraphic",operator:"dilate",radius:(G+.5*x)*5**(L/100)*(.4+L/100),result:"dilate"}),z.tsx("feGaussianBlur",{in:"dilate",result:"blur",stdDeviation:S/25}),z.tsx("feGaussianBlur",{in:"blur",result:"intensityBlur",stdDeviation:S/50}),z.tsx("feComponentTransfer",
{in:"SourceGraphic",result:"intensityBrightness"},z.tsx("feFuncR",{slope:W,type:"linear"}),z.tsx("feFuncG",{slope:W,type:"linear"}),z.tsx("feFuncB",{slope:W,type:"linear"})),z.tsx("feMerge",null,z.tsx("feMergeNode",{in:"intensityBlur"}),z.tsx("feMergeNode",{in:"intensityBrightness"}),z.tsx("feGaussianBlur",{stdDeviation:G/10})))}K=C("android");const I=C("chrome")||K&&4<=K?"auto":"optimizeLegibility",R={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7,z:0},T=/([A-DF-Za-df-z])|([-+]?\d*[.]?\d+(?:[eE][-+]?\d+)?)/g;
let J={},M={};const U=Math.PI;g.computeBBox=e;g.generateFillAttributes=d;g.generateStrokeAttributes=f;g.generateTextAttributes=k;g.getBoundingBox=E;g.getTransformMatrix=b;g.renderDef=m;g.renderSVG=function(x,L,Q,G={}){const N=[],S=[],W=H.nextBloomId(),ca=p(G.effectView,L,W);var Z=null;ca&&(Z=G.effectView?.effects.find(ia=>"bloom"===ia.type),Z=(Z.strength?Z.strength+Z.radius/2:0)/3,Z=[Math.max(L+L*Z,10),Math.max(Q+Q*Z,10)]);let ja=L,ma=Q;if(G.useRotationSize)for(var da=0;da<x.length;da++){var X=G.rotations?.[da]??
0;ja=Math.max(h(X,L),ja);ma=Math.max(h(X,Q),ma)}for(da=0;da<x.length;da++){var fa=x[da];X=[];var oa=[],ba=0,la=0;let ia=0;for(const qa of fa){const {shape:ta,fill:va,stroke:ya,font:za,offset:Da}=qa;G.ignoreStrokeWidth||"text"===ta.type||(ba+=ya?.width||0);fa=d(va);const La=f(ya),Ha="text"===ta.type?k(ta,za):null;N.push(m(fa));X.push(l(ta,fa.fill,La,Ha,G.ariaLabel));oa.push(E(ta));Da&&(la+=Da[0],ia+=Da[1])}fa=G.rotations?.[da]??0;G.useRotationSize&&(la+=(ja-h(fa,L))/2,ia+=(ma-h(fa,Q))/2);oa=e(oa);
ba=b(oa,L,Q,ba,G.scale??!1,fa,G.useRotationSize??!1,[la,ia],Z);la=null;G.masking&&(la=`mask-${da}`,N.push(r(G.masking[da],la)),la=`url(#${la})`);S.push(la?z.tsx("g",{mask:la},z.tsx("g",{transform:ba},X)):z.tsx("g",{transform:ba},X))}ca&&(B.assertIsSome(Z),ja=Z[0],ma=Z[1]);return z.tsx("svg",{"aria-label":G.ariaLabel,focusable:!1,height:ma,role:"img",style:"display: block;",width:ja,xmlns:"http://www.w3.org/2000/svg"},ca,z.tsx("defs",null,N),ca?z.tsx("g",{filter:`url(#bloom${W})`},S):S)};g.renderShape=
l;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/factories/mat2df32":function(){define(["exports"],function(g){function A(){const K=new Float32Array(6);K[0]=1;K[3]=1;return K}function C(K){const z=new Float32Array(6);z[0]=K[0];z[1]=K[1];z[2]=K[2];z[3]=K[3];z[4]=K[4];z[5]=K[5];return z}function B(K,z,h,c,l,d){const f=new Float32Array(6);f[0]=K;f[1]=z;f[2]=h;f[3]=c;f[4]=l;f[5]=d;return f}function v(K,z){return new Float32Array(K,z,6)}function F(K,z,h,c){const l=
z[c];z=z[c+1];K[c]=h[0]*l+h[2]*z+h[4];K[c+1]=h[1]*l+h[3]*z+h[5]}function y(K,z,h,c=0,l=0,d=2){for(l=l||z.length/d;c<l;c++)F(K,z,h,c*d)}const H=Object.freeze(Object.defineProperty({__proto__:null,clone:C,create:A,createView:v,fromValues:B,transform:F,transformMany:y},Symbol.toStringTag,{value:"Module"}));g.clone=C;g.create=A;g.createView=v;g.fromValues=B;g.mat2df32=H;g.transform=F;g.transformMany=y;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/core/libs/gl-matrix-2/math/mat2d":function(){define(["exports",
"./common"],function(g,A){function C(e,b){e[0]=b[0];e[1]=b[1];e[2]=b[2];e[3]=b[3];e[4]=b[4];e[5]=b[5];return e}function B(e){e[0]=1;e[1]=0;e[2]=0;e[3]=1;e[4]=0;e[5]=0;return e}function v(e,b,p,I,R,T,J){e[0]=b;e[1]=p;e[2]=I;e[3]=R;e[4]=T;e[5]=J;return e}function F(e,b){const p=b[0],I=b[1],R=b[2],T=b[3],J=b[4];b=b[5];let M=p*T-I*R;if(!M)return null;M=1/M;e[0]=T*M;e[1]=-I*M;e[2]=-R*M;e[3]=p*M;e[4]=(R*b-T*J)*M;e[5]=(I*J-p*b)*M;return e}function y(e){return e[0]*e[3]-e[1]*e[2]}function H(e,b,p){const I=
b[0],R=b[1],T=b[2],J=b[3],M=b[4];b=b[5];const U=p[0],x=p[1],L=p[2],Q=p[3],G=p[4];p=p[5];e[0]=I*U+T*x;e[1]=R*U+J*x;e[2]=I*L+T*Q;e[3]=R*L+J*Q;e[4]=I*G+T*p+M;e[5]=R*G+J*p+b;return e}function K(e,b,p){const I=b[0],R=b[1],T=b[2],J=b[3],M=b[4];b=b[5];const U=Math.sin(p);p=Math.cos(p);e[0]=I*p+T*U;e[1]=R*p+J*U;e[2]=I*-U+T*p;e[3]=R*-U+J*p;e[4]=M;e[5]=b;return e}function z(e,b,p){const I=b[1],R=b[2],T=b[3],J=b[4],M=b[5],U=p[0];p=p[1];e[0]=b[0]*U;e[1]=I*U;e[2]=R*p;e[3]=T*p;e[4]=J;e[5]=M;return e}function h(e,
b,p){const I=b[0],R=b[1],T=b[2],J=b[3],M=b[4];b=b[5];const U=p[0];p=p[1];e[0]=I;e[1]=R;e[2]=T;e[3]=J;e[4]=I*U+T*p+M;e[5]=R*U+J*p+b;return e}function c(e,b){const p=Math.sin(b);b=Math.cos(b);e[0]=b;e[1]=p;e[2]=-p;e[3]=b;e[4]=0;e[5]=0;return e}function l(e,b){e[0]=b[0];e[1]=0;e[2]=0;e[3]=b[1];e[4]=0;e[5]=0;return e}function d(e,b){e[0]=1;e[1]=0;e[2]=0;e[3]=1;e[4]=b[0];e[5]=b[1];return e}function f(e){return"mat2d("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+")"}function k(e){return Math.sqrt(e[0]**
2+e[1]**2+e[2]**2+e[3]**2+e[4]**2+e[5]**2+1)}function m(e,b,p){e[0]=b[0]+p[0];e[1]=b[1]+p[1];e[2]=b[2]+p[2];e[3]=b[3]+p[3];e[4]=b[4]+p[4];e[5]=b[5]+p[5];return e}function r(e,b,p){e[0]=b[0]-p[0];e[1]=b[1]-p[1];e[2]=b[2]-p[2];e[3]=b[3]-p[3];e[4]=b[4]-p[4];e[5]=b[5]-p[5];return e}function n(e,b,p){e[0]=b[0]*p;e[1]=b[1]*p;e[2]=b[2]*p;e[3]=b[3]*p;e[4]=b[4]*p;e[5]=b[5]*p;return e}function q(e,b,p,I){e[0]=b[0]+p[0]*I;e[1]=b[1]+p[1]*I;e[2]=b[2]+p[2]*I;e[3]=b[3]+p[3]*I;e[4]=b[4]+p[4]*I;e[5]=b[5]+p[5]*I;return e}
function u(e,b){return e[0]===b[0]&&e[1]===b[1]&&e[2]===b[2]&&e[3]===b[3]&&e[4]===b[4]&&e[5]===b[5]}function w(e,b){const p=e[0],I=e[1],R=e[2],T=e[3],J=e[4];e=e[5];const M=b[0],U=b[1],x=b[2],L=b[3],Q=b[4];b=b[5];const G=A.getEpsilon();return Math.abs(p-M)<=G*Math.max(1,Math.abs(p),Math.abs(M))&&Math.abs(I-U)<=G*Math.max(1,Math.abs(I),Math.abs(U))&&Math.abs(R-x)<=G*Math.max(1,Math.abs(R),Math.abs(x))&&Math.abs(T-L)<=G*Math.max(1,Math.abs(T),Math.abs(L))&&Math.abs(J-Q)<=G*Math.max(1,Math.abs(J),Math.abs(Q))&&
Math.abs(e-b)<=G*Math.max(1,Math.abs(e),Math.abs(b))}const E=Object.freeze(Object.defineProperty({__proto__:null,add:m,copy:C,determinant:y,equals:w,exactEquals:u,frob:k,fromRotation:c,fromScaling:l,fromTranslation:d,identity:B,invert:F,mul:H,multiply:H,multiplyScalar:n,multiplyScalarAndAdd:q,rotate:K,scale:z,set:v,str:f,sub:r,subtract:r,translate:h},Symbol.toStringTag,{value:"Module"}));g.add=m;g.copy=C;g.determinant=y;g.equals=w;g.exactEquals=u;g.frob=k;g.fromRotation=c;g.fromScaling=l;g.fromTranslation=
d;g.identity=B;g.invert=F;g.mat2d=E;g.mul=H;g.multiply=H;g.multiplyScalar=n;g.multiplyScalarAndAdd=q;g.rotate=K;g.scale=z;g.set=v;g.str=f;g.sub=r;g.subtract=r;g.translate=h;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/gfxUtils":function(){define("exports ../../assets ../../Color ../../request ../../core/LRUCache ../../core/screenUtils ./cimSymbolUtils".split(" "),function(g,A,C,B,v,F,y){function H(l){if(!l)return null;let d=null;switch(l.type){case "simple-fill":case "picture-fill":case "simple-marker":d=
H(l.outline);break;case "simple-line":const f=F.pt2px(l.width);null!=l.style&&"none"!==l.style&&0!==f&&(d={color:l.color,style:c(l.style),width:f,cap:l.cap,join:"miter"===l.join?F.pt2px(l.miterLimit):l.join},d.dashArray=K(d).join(",")||"none");break;default:d=null}return d}function K(l){if(!l?.style)return[];const {dashArray:d,style:f,width:k}=l;if("string"===typeof d&&"none"!==d)return d.split(",").map(n=>Number(n));const m=k??0,r=z.has(f)?z.get(f).map(n=>n*m):[];if("butt"!==l.cap)for(const [n,q]of r.entries())r[n]=
1===n%2?q+m:Math.max(q-m,1);return r}const z=new Map([["dash",[4,3]],["dashdot",[4,3,1,3]],["dot",[1,3]],["longdash",[8,3]],["longdashdot",[8,3,1,3]],["longdashdotdot",[8,3,1,3,1,3]],["shortdash",[4,1]],["shortdashdot",[4,1,1,1]],["shortdashdotdot",[4,1,1,1,1,1]],["shortdot",[1,1]],["solid",[]]]),h=new v.LRUCache(1E3),c=(()=>{const l={};return d=>{if(l[d])return l[d];const f=d.replaceAll("-","");return l[d]=f}})();C=new C([128,128,128]);g.defaultThematicColor=C;g.dekebabifyLineStyle=c;g.getDashArray=
K;g.getFill=function(l){const d=l.style;let f=null;if(l)switch(l.type){case "simple-marker":"cross"!==d&&"x"!==d&&(f=l.color);break;case "simple-fill":d&&"solid"!==d?"none"!==d&&(f={type:"pattern",x:0,y:0,src:A.getAssetUrl(`esri/symbols/patterns/${d}.png`),width:5,height:5}):f=l.color;break;case "picture-fill":f={type:"pattern",src:l.url,width:F.pt2px(l.width)*l.xscale,height:F.pt2px(l.height)*l.yscale,x:F.pt2px(l.xoffset),y:F.pt2px(l.yoffset)};break;case "text":f=l.color;break;case "cim":f=y.getCIMSymbolColor(l)}return f};
g.getPatternUrlWithColor=function(l,d){const f=l+"-"+d;return void 0!==h.get(f)?Promise.resolve(h.get(f)):B(l,{responseType:"image"}).then(k=>{k=k.data;const m=k.naturalWidth,r=k.naturalHeight,n=document.createElement("canvas");n.width=m;n.height=r;const q=n.getContext("2d");q.fillStyle=d;q.fillRect(0,0,m,r);q.globalCompositeOperation="destination-in";q.drawImage(k,0,0);k=n.toDataURL();h.put(f,k);return k})};g.getStroke=H;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/svgGlobalState":function(){define(["exports"],
function(g){function A(H=0){v=H}function C(H=0){F=H}function B(H=0){y=H}let v=0,F=0,y=0;g.nextBloomId=function(){return y++};g.nextLinearGradientId=function(){return F++};g.nextPatternId=function(){return v++};g.resetBloomId=B;g.resetLinearGradientId=C;g.resetPatternId=A;g.resetSVGGlobalState=function(){A();C();B()};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/utils":function(){define("require exports ../../Color ../../core/asyncUtils ../../core/has ../../core/screenUtils ../../core/libs/gl-matrix-2/factories/vec3f64 ../../layers/effects/jsonUtils ./cimSymbolUtils ./gfxUtils ./Symbol3DMaterial ./typeUtils".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){function l(e){e=e.symbolLayers;if(!e)return null;let b=null;e.forEach(p=>{"object"===p.type&&p.resource?.href||(b="water"===p.type?p.color:p.material?p.material.color:null)});return b?new C(b):null}function d(e,b){if(null==b||null==e)return e;e=e.toRgba();e[3]*=b;return new C(e)}function f(e,b,p){if(e=e.symbolLayers){var I=R=>{b=b??R??(null!=p?E:null);return d(b,p)};e.forEach(R=>{if("object"!==R.type||!R.resource?.href||b)if("water"===R.type)R.color=I(R.color);else{const T=
I(null!=R.material?R.material.color:null);null==R.material?R.material=new h.Symbol3DMaterial({color:T}):R.material.color=T;null!=p&&"outline"in R&&null!=R.outline?.color&&(R.outline.color=d(R.outline.color,p))}})}}async function k(e,b){(e=e.symbolLayers)&&await B.forEach(e,async p=>m(p,b))}async function m(e,b){switch(e.type){case "extrude":e.size="number"===typeof b[2]?b[2]:0;break;case "icon":case "line":case "text":b=r(b);null!=b&&(e.size=b);break;case "path":const p=q(b,y.ONES,[e.width,void 0,
e.height]);e.width=w(b[0],e.width,1,p);e.height=w(b[2],e.height,1,p);break;case "object":await n(e,b)}}function r(e){for(const b of e)if("number"===typeof b)return b;return null}async function n(e,b){const {resourceSize:p,symbolSize:I}=await u(e),R=q(b,p,I);e.width=w(b[0],I[0],p[0],R);e.depth=w(b[1],I[1],p[1],R);e.height=w(b[2],I[2],p[2],R)}function q(e,b,p){for(let I=0;3>I;I++){const R=e[I];switch(R){case "symbol-value":return e=p[I],null!=e?e/b[I]:1;case "proportional":break;default:if(R&&b[I])return R/
b[I]}}return 1}async function u(e){var {computeObjectLayerResourceSize:b}=await new Promise((M,U)=>g(["./symbolLayerUtils"],M,U));b=await b(e,10);const {width:p,height:I,depth:R}=e;e=[p,R,I];let T=1;for(var J=0;3>J;J++){const M=e[J];if(null!=M){T=M/b[J];break}}for(J=0;3>J;J++)null==e[J]&&(e[J]=b[J]*T);return{resourceSize:b,symbolSize:e}}function w(e,b,p,I){switch(e){case "proportional":return p*I;case "symbol-value":return null!=b?b:p;default:return e}}const E=new C("white");A.applyColorToSymbol=
function(e,b,p){if(e&&(b||null!=p))if(b&&=new C(b),c.isSymbol3D(e))f(e,b,p);else if(c.isSymbol2D(e)){if(b=b??e.color)e.color=d(b,p);null!=p&&"outline"in e&&e.outline?.color&&(e.outline.color=d(e.outline.color,p))}};A.applyOpacityToColor=d;A.applyRotationToSymbol=function(e,b,p){e&&null!=b&&(c.isSymbol3D(e)?(e=e.symbolLayers)&&e.forEach(I=>{if("object"===I.type)switch(p){case "tilt":I.tilt=(I.tilt??0)+b;break;case "roll":I.roll=(I.roll??0)+b;break;default:I.heading=(I.heading??0)+b}"icon"===I.type&&
(I.angle+=b)}):!c.isSymbol2D(e)||"simple-marker"!==e.type&&"picture-marker"!==e.type&&"text"!==e.type||(e.angle+=b))};A.applySizesToSymbol=async function(e,b){if(e&&b){if(c.isSymbol3D(e))return k(e,b);if(c.isSymbol2D(e)&&(b=r(b),null!=b))switch(e.type){case "simple-marker":e.size=b;break;case "picture-marker":const p=e.width/e.height;1<p?(e.width=b,e.height=b*p):(e.width=b*p,e.height=b);break;case "simple-line":e.width=b;break;case "text":e.font.size=b}}};A.getCSSFilterFromEffectList=function(e){if(!e)return null;
e=e.effects.filter(b=>"bloom"!==b.type).map(b=>b.toJSON());return H.effectFunctionsFromJSON(e)};A.getColorFromSymbol=function(e,b){if(!e)return null;let p=null;c.isSymbol3D(e)?p=l(e):c.isSymbol2D(e)&&(p="cim"===e.type?K.getCIMSymbolColor(e):e.color?new C(e.color):null);return p?d(p,b):null};A.getIconHref=function(e){return e.resource?.href??""};A.getSymbolOutlineSize=function(e){return e?c.isSymbol3D(e)?(e=(e=e.symbolLayers?.at(-1))&&"outline"in e?e?.outline?.size:void 0,null!=e?e:0):F.px2pt(z.getStroke(e)?.width):
0};A.isVolumetricSymbol=function(e){if(null==e||!("symbolLayers"in e)||null==e.symbolLayers)return!1;switch(e.type){case "point-3d":return e.symbolLayers.some(b=>"object"===b.type);case "line-3d":return e.symbolLayers.some(b=>"path"===b.type);case "polygon-3d":return e.symbolLayers.some(b=>"object"===b.type||"extrude"===b.type);default:return!1}};A.symbolHasExtrudeSymbolLayer=function(e){return null!=e&&"polygon-3d"===e.type&&e.symbolLayers.some(b=>"extrude"===b.type)};Object.defineProperty(A,Symbol.toStringTag,
{value:"Module"})})},"esri/symbols/support/symbolUtils":function(){define("require exports ../../core/has ../../core/screenUtils ../../layers/support/layerUtils ../../support/arcadeOnDemand ./gfxUtils ./previewUtils ./renderUtils ./utils ./webStyleAcceptedFormats ../../widgets/Legend/styles/support/relationshipUtils ../../widgets/Legend/support/relationshipRampUtils".split(" "),function(g,A,C,B,v,F,y,H,K,z,h,c,l){function d(u,w){if(w&&(u.style.filter=z.getCSSFilterFromEffectList(w),w=w.effects))for(const E of w)if("drop-shadow"===
E?.type){0>E.offsetX?u.style.marginLeft=`${Math.abs(E.offsetX)}px`:u.style.marginRight=`${E.offsetX}px`;break}}async function f(u,w){switch(u.type){case "web-style":var {previewWebStyleSymbol:E}=await new Promise((e,b)=>g(["./previewWebStyleSymbol"],e,b));return E(u,f,w);case "label-3d":case "line-3d":case "mesh-3d":case "point-3d":case "polygon-3d":return{previewSymbol3D:E}=await new Promise((e,b)=>g(["./previewSymbol3D"],e,b)),E(u,w);case "simple-marker":case "simple-line":case "simple-fill":case "picture-marker":case "picture-fill":case "text":return{previewSymbol2D:E}=
await new Promise((e,b)=>g(["./previewSymbol2D"],e,b)),E(u,w);case "cim":return{previewCIMSymbol:E}=await new Promise((e,b)=>g(["./previewCIMSymbol"],e,b)),E(u,w)}}function k(u){return u&&"opacity"in u?u.opacity*k(u.parent):1}async function m(u,w){if(u){var E=u.sourceLayer,e=(null!=w&&(w.useSourceLayer??!1)?E:u.layer)??E;E=w?.ignoreOpacity?1:k(e);if(null!=u.symbol&&(null==w||!0!==w.ignoreGraphicSymbol))return u="web-style"===u.symbol.type?await u.symbol.fetchSymbol({...w,acceptedFormats:["web","cim"],
cache:null!=w?w.webStyleCache:null}):u.symbol.clone(),z.applyColorToSymbol(u,null,E),u;var b=w?.renderer??r(e);if(e=b&&"getSymbolAsync"in b?await b.getSymbolAsync(u,w):null){e="web-style"===e.type?await e.fetchSymbol({...w,cache:null!=w?w.webStyleCache:null}):e.clone();if(!(b&&"visualVariables"in b&&b.visualVariables?.length))return z.applyColorToSymbol(e,null,E),e;"arcadeRequiredForVisualVariables"in b&&b.arcadeRequiredForVisualVariables&&null==w?.arcade&&(w={...w},w.arcade=await F.loadArcade());
var {getColor:p,getOpacity:I,getAllSizes:R,getRotationAngle:T}=await new Promise((Q,G)=>g(["../../renderers/visualVariables/support/visualVariableUtils"],Q,G)),J=[],M=[],U=[],x=[];for(var L of b.visualVariables)switch(L.type){case "color":J.push(L);break;case "opacity":M.push(L);break;case "rotation":x.push(L);break;case "size":L.target||U.push(L)}L=(L=!!J.length&&J[J.length-1])?p(L,u,w):null;M=(M=!!M.length&&M[M.length-1])?I(M,u,w):null;null!=E&&(M=null!=M?M*E:E);w?.ignoreOpacity&&(M=1);z.applyColorToSymbol(e,
L,M);U.length&&!0!==w?.ignoreSizeVariables&&(E=R(U,u,w),await z.applySizesToSymbol(e,E));if(!0!==w?.ignoreRotationVariables)for(const Q of x)z.applyRotationToSymbol(e,T(Q,u,w),Q.axis);return e}}}function r(u){if(u)return"renderer"in u?u.renderer:void 0}let n=null;const q=[255,255,255];A.getDisplayedColor=async function(u,w){if(u){var {layer:E,sourceLayer:e}=u,b=k(E??e);if(null!=u.symbol&&(null==w||!0!==w.ignoreGraphicSymbol))return u="web-style"===u.symbol.type?await u.symbol.fetchSymbol({...w,acceptedFormats:h.defaultAcceptedFormats}):
u.symbol.clone(),z.getColorFromSymbol(u,b);var p=w?.renderer??r(E)??r(e),I=p&&"getSymbolAsync"in p?await p.getSymbolAsync(u,w):void 0;if(I){I="web-style"===I.type?await I.fetchSymbol({...w,acceptedFormats:h.defaultAcceptedFormats}):I.clone();I=z.getColorFromSymbol(I,b);if(!(p&&"visualVariables"in p)||"visualVariables"in p&&!p.visualVariables||"visualVariables"in p&&!p.visualVariables?.length)return I;"arcadeRequiredForVisualVariables"in p&&p.arcadeRequiredForVisualVariables&&null==w?.arcade&&(w={...w},
w.arcade=await F.loadArcade());var {getColor:R,getOpacity:T}=await new Promise((U,x)=>g(["../../renderers/visualVariables/support/visualVariableUtils"],U,x)),J=[],M=[];if(p.visualVariables)for(const U of p.visualVariables)switch(U.type){case "color":J.push(U);break;case "opacity":M.push(U)}p=(p=0<J.length?J[J.length-1]:null)?R(p,u,w):I;u=(I=0<M.length?M[M.length-1]:null)?T(I,u,w):null;null!=b&&(u=null!=u?u*b:b);return p?z.applyOpacityToColor(p,u):null}}};A.getDisplayedSymbol=m;A.getLegendLabel=async function(u,
w,E){if(u){var {layer:e,sourceLayer:b}=u,p=E?.renderer??r(e)??r(b);if(!p)return null;if("visualVariables"in p&&p.visualVariables?.length){const {getRampStops:R}=await new Promise((U,x)=>g(["../../widgets/Legend/support/colorRampUtils"],U,x)),{getRampStops:T}=await new Promise((U,x)=>g(["../../widgets/Legend/support/sizeRampUtils"],U,x)),{getDateFormatOptions:J}=await new Promise((U,x)=>g(["../../widgets/Legend/support/utils"],U,x));let M=null;for(const U of p.visualVariables){var I=w?J(e,U,w.timeZone):
null;let x=null;switch(U.type){case "color":x=await R(U,null,I);break;case "opacity":x=await R(U);break;case "size":U.target||(x=await T(p,U,null,E?.scale||w?.scale,w,I))}if(x?.length&&(I=x.find((L,Q)=>{const G=u.attributes[U.field];return 0===Q?G>=L.value:Q===x?.length-1?G<=L.value:L.value===G}))){M=I.label;break}}if(M)return M}switch(p.type){case "class-breaks":return w="getClassBreakInfo"in p?await p.getClassBreakInfo(u,E):null,w?.label??(w&&1<p.classBreakInfos?.length)?`${w.minValue} - ${w.maxValue}`:
null;case "unique-value":return("getUniqueValueInfo"in p?await p.getUniqueValueInfo(u,E):null)?.label}return null}};A.previewGraphic=async function(u,w){u?.layer&&v.isSubtypeGroupLayer(u.layer)&&(u=u.cloneShallow(),u.layer=u.layer.findSublayerForFeature(u)??null);const E=null===u?w?.fallbackSymbol??null:await m(u,{ignoreGraphicSymbol:u.layer?!0:!1,ignoreOpacity:w?.ignoreOpacity??!0,ignoreRotationVariables:w?.ignoreRotationVariables??!0,ignoreSizeVariables:w?.ignoreSizeVariables??!0})??w?.fallbackSymbol??
null;return E?(u=await f(E,{geometry:w.useGeometryForShape?u?.geometry??null:null,useMarkerSymbolSize:!1!==w.useMarkerSymbolSize,size:{width:B.px2pt(w.widthInPixels??16),height:B.px2pt(w.heightInPixels??16)},...("cim"===E?.type?{cimOptions:{feature:{attributes:u?.attributes??{}}}}:{})}))?"element"===(w?.format??"element")?u:u.outerHTML:null:null};A.renderColorRampPreviewHTML=function(u,w={}){var E="horizontal"===w.align;const e=w.width??(E?75:24),b=w.height??(E?24:75);var p=w.gradient??!0,I=window.devicePixelRatio,
R=e*I,T=b*I;I=document.createElement("canvas");I.width=R;I.height=T;I.ariaLabel=w.ariaLabel??null;I.style.width=`${e}px`;I.style.height=`${b}px`;const J=I.getContext("2d");var M=E?R:0;const U=E?0:T;if(p){const x=J.createLinearGradient(0,0,M,U);E=u.length;const L=1===E?0:1/(E-1);u.forEach((Q,G)=>x.addColorStop(G*L,Q.toString()));J.fillStyle=x;J.fillRect(0,0,R,T)}else{R=E?R/u.length:R;T=E?T:T/u.length;M=p=0;for(const x of u)J.fillStyle=x.toString(),J.fillRect(p,M,R,T),p=E?p+R:0,M=E?0:M+T}u=document.createElement("div");
u.style.width=`${e}px`;u.style.height=`${b}px`;d(u,w?.effectList);u.appendChild(I);return u};A.renderDotDensityPreviewHTML=function(u,w,E){const {backgroundColor:e,outline:b,dotSize:p}=u;var I=E?.swatchSize||H.SymbolSizeDefaults.size;const R=Math.round(I*I/Math.max(p,.5)**2*.8),T=window.devicePixelRatio;u=document.createElement("canvas");const J=I*T;u.width=J;u.height=J;u.style.width=`${u.width/T}px`;u.style.height=`${u.height/T}px`;const M=u.getContext("2d");e&&(M.fillStyle=e.toCss(!0),M.fillRect(0,
0,J,J),M.fill());M.fillStyle=w?.toCss(!0)??"";if(n&&n.length/2===R)for(w=0;w<2*R;w+=2)M.fillRect(n[w],n[w+1],p*T,p*T),M.fill();else for(n=[],w=0;w<2*R;w+=2){const U=Math.floor(Math.random()*(J-0+1)),x=Math.floor(Math.random()*(J-0+1));n.push(U,x);M.fillRect(U,x,p*T,p*T);M.fill()}b&&(b.color&&(M.strokeStyle=b.color.toCss(!0)),M.lineWidth=b.width,M.strokeRect(0,0,J,J));I=new Image(I,I);I.src=u.toDataURL();I.ariaLabel=E?.ariaLabel??null;I.alt=E?.ariaLabel??"";return I};A.renderPieChartPreviewHTML=function(u,
w={}){const E=w.radius||40;var e=2*Math.PI*E,b=u.length;const p=e/b,I=[],R=y.getStroke(w.outline);null!=R?.width&&(R.width*=2);(R||w.backgroundColor)&&I.push({shape:{type:"circle",cx:E,cy:E,r:E},fill:w.backgroundColor,stroke:R,offset:[0,0]});const T=w.values,J=T&&T.length===b&&100===T.reduce((U,x)=>U+x,0),M=[0];for(let U=0;U<b;U++){let x=null;J&&(x=T[U]*e/100,M.push(x+M[U]));I.push({shape:{type:"circle",cx:E,cy:E,r:E/2},fill:[0,0,0,0],stroke:{width:E,dashArray:`${(x??p)/2} ${e}`,dashoffset:`-${J?
M[U]/2:p/2*U}`,color:u[U]},offset:[0,0]})}b=null;u=2*E+(R?.width||0);if(e=w.holePercentage)R&&I.push({shape:{type:"circle",cx:E,cy:E,r:E*e},fill:null,stroke:R,offset:[0,0]}),b=u/2,b=[[{shape:{type:"circle",cx:b,cy:b,r:b},fill:q,stroke:R?{...R,color:q}:null,offset:[0,0]},{shape:{type:"circle",cx:b,cy:b,r:E*e},fill:[0,0,0],stroke:null,offset:[0,0]}]];return K.renderSymbol([I],[u,u],{effectView:w.effectList,ignoreStrokeWidth:!0,masking:b,rotations:[-90],ariaLabel:w.ariaLabel})};A.renderPreviewHTML=f;
A.renderRelationshipRampPreviewHTML=function(u,w={}){const E=u?.authoringInfo;if("relationship"!==E?.type||!E?.numClasses||!u.uniqueValueInfos)return null;const {focus:e,numClasses:b}=E,p=l.getRelationshipRampElement({focus:e,numClasses:b,infos:u.uniqueValueInfos});u=w?.node||document.createElement("div");K.renderOnce(u,()=>c.renderRelationshipRamp(p,w.id||"relationship",{opacity:w.opacity||1,effectList:w.effectList,ariaLabel:w.ariaLabel}));return u};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},
"esri/symbols/support/webStyleAcceptedFormats":function(){define(["exports"],function(g){g.defaultAcceptedFormats=["web-gltf","web","cim"];Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/support/relationshipUtils":function(){define(["exports","../../../../symbols/support/svgUtils","../../../../symbols/support/utils","../../../support/widgetUtils","../../../support/jsxFactory"],function(g,A,C,B,v){function F(K,z,h){const c=`${h}_arrowStart`;h=`${h}_arrowEnd`;
K="left"===K;const l={markerStart:null,markerEnd:null};switch(z){case "HL":K?l.markerStart=`url(#${h})`:l.markerEnd=`url(#${c})`;break;case "LL":l.markerStart=`url(#${h})`;break;case "LH":K?l.markerEnd=`url(#${c})`:l.markerStart=`url(#${h})`;break;default:l.markerEnd=`url(#${c})`}return l}function y(K,z,h={}){const {focus:c,numClasses:l,colors:d,rotation:f}=K,{opacity:k,effectList:m,ariaLabel:r}=h;K=h.size??60;h=!!c;const n=Math.sqrt(K**2+K**2)+(h?0:5),q=[],u=[];var w=[],E=(K||75)/l;for(var e=0;e<
l;e++){var b=e*E;for(var p=0;p<l;p++){var I=p*E,R=A.generateFillAttributes(d[e][p]);const T=A.generateStrokeAttributes(null);I={type:"rect",x:I,y:b,width:E,height:E};const J=A.renderDef(R);J&&q.push(J);(R=A.renderShape(I,R.fill,T,null))&&u.push(R);w.push(A.getBoundingBox(I))}}E=null;h||(E="margin: -15px -15px -18px -15px");e=F("left",c,z);b=F("right",c,z);p=A.computeBBox(w);w=A.getTransformMatrix(p,n,n,0,!1,f,!1);p=A.getTransformMatrix(p,n,n,0,!1,h?-45:null,!1);R={filter:C.getCSSFilterFromEffectList(m)??
void 0,opacity:null==k?"":`${k}`};return v.tsx("div",{class:h?H.diamondMidColRamp:H.squareTableCell,styles:R},v.tsx("svg",{"aria-label":r,focusable:!1,height:n,role:"image",style:E,width:n,xmlns:"http://www.w3.org/2000/svg"},v.tsx("defs",null,v.tsx("marker",{id:`${z}_arrowStart`,markerHeight:"10",markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"5",refY:"5"},v.tsx("polyline",{fill:"none",points:"0,0 5,5 0,10",stroke:"#555555","stroke-width":"1"})),v.tsx("marker",{id:`${z}_arrowEnd`,markerHeight:"10",
markerUnits:"strokeWidth",markerWidth:"10",orient:"auto",refX:"0",refY:"5"},v.tsx("polyline",{fill:"none",points:"5,0 0,5 5,10",stroke:"#555555","stroke-width":"1"})),q),v.tsx("g",{transform:w},u),v.tsx("g",{transform:p},v.tsx("line",{fill:"none","marker-end":e.markerEnd,"marker-start":e.markerStart,stroke:"#555555","stroke-width":"1",x1:-10,x2:-10,y1:K-15,y2:15}),v.tsx("line",{fill:"none","marker-end":b.markerEnd,"marker-start":b.markerStart,stroke:"#555555","stroke-width":"1",x1:15,x2:K-15,y1:K+
10,y2:K+10}))))}const H={diamondContainer:"esri-relationship-ramp--diamond__container",diamondLeftCol:"esri-relationship-ramp--diamond__left-column",diamondRightCol:"esri-relationship-ramp--diamond__right-column",diamondMidCol:"esri-relationship-ramp--diamond__middle-column",diamondMidColLabel:"esri-relationship-ramp--diamond__middle-column--label",diamondMidColRamp:"esri-relationship-ramp--diamond__middle-column--ramp",squareTable:"esri-relationship-ramp--square__table",squareTableRow:"esri-relationship-ramp--square__table-row",
squareTableCell:"esri-relationship-ramp--square__table-cell",squareTableLabel:"esri-relationship-ramp--square__table-label",squareTableLabelLeftBottom:"esri-relationship-ramp--square__table-label--left-bottom",squareTableLabelRightBottom:"esri-relationship-ramp--square__table-label--right-bottom",squareTableLabelLeftTop:"esri-relationship-ramp--square__table-label--left-top",squareTableLabelRightTop:"esri-relationship-ramp--square__table-label--right-top"};g.renderRelationshipRamp=function(K,z,h=
{}){const {focus:c,labels:l}=K,d=!!c;K=y(K,z,h);const f={justifyContent:"center"},k=B.isRTL();z=h.key??z;return d?v.tsx("div",{class:H.diamondContainer,key:`${z}-container`,styles:f},v.tsx("div",{class:H.diamondLeftCol},k?l.right:l.left),v.tsx("div",{class:H.diamondMidCol},v.tsx("div",{class:H.diamondMidColLabel},l.top),K,v.tsx("div",{class:H.diamondMidColLabel},l.bottom)),v.tsx("div",{class:H.diamondRightCol},k?l.left:l.right)):v.tsx("div",{class:H.squareTable,key:`${z}-container`},v.tsx("div",{class:H.squareTableRow},
v.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelRightBottom)},k?l.top:l.left),v.tsx("div",{class:H.squareTableCell}),v.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelLeftBottom)},k?l.left:l.top)),v.tsx("div",{class:H.squareTableRow},v.tsx("div",{class:H.squareTableCell}),K,v.tsx("div",{class:H.squareTableCell})),v.tsx("div",{class:H.squareTableRow},v.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelRightTop)},
k?l.right:l.bottom),v.tsx("div",{class:H.squareTableCell}),v.tsx("div",{class:B.classes(H.squareTableCell,H.squareTableLabel,H.squareTableLabelLeftTop)},k?l.bottom:l.right)))};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/relationshipRampUtils":function(){define(["exports","../../../core/lang","../../../symbols/support/gfxUtils","../../../symbols/support/previewSymbol3D"],function(g,A,C,B){function v(z){if(z){var {type:h}=z;return h.includes("3d")?B.getSymbolLayerFill(z.symbolLayers.at(0)):
"simple-line"===h||"simple-marker"===z.type&&("x"===z.style||"cross"===z.style)?(z=C.getStroke(z))&&z.color:C.getFill(z)}}function F(z,h){const c=h.HH.label,l=h.LL.label,d=h.HL.label;h=h.LH.label;switch(z){case "HH":return{top:c,bottom:l,left:d,right:h};case "HL":return{top:d,bottom:h,left:l,right:c};case "LL":return{top:l,bottom:c,left:h,right:d};case "LH":return{top:h,bottom:d,left:c,right:l};default:return{top:c,bottom:l,left:d,right:h}}}function y(z){let h=H[z];z&&null==h&&(h=H.HH);return h||
0}const H={HH:315,HL:45,LL:135,LH:225},K={2:[["HL","HH"],["LL","LH"]],3:[["HL","HM","HH"],["ML","MM","MH"],["LL","LM","LH"]],4:[["HL","HM1","HM2","HH"],["M2L","M2M1","M2M2","M2H"],["M1L","M1M1","M1M2","M1H"],["LL","LM1","LM2","LH"]]};g.getRelationshipRampColors2D=function(z,h){const c=[],l=z.length**.5;z=A.clone(z);var d=(h||"HH").split("");h=d[0];for(d="H"===d[1];z.length;){const f=[];for(;f.length<l;)f.push(z.shift());d&&f.reverse();c.push(f)}"L"===h&&c.reverse();return c};g.getRelationshipRampElement=
function(z){const {focus:h,infos:c,numClasses:l}=z;var d=K[l];const f={};c.forEach(k=>{f[k.value]={label:k.label,fill:v(k.symbol)}});z=[];for(let k=0;k<l;k++){const m=[];for(let r=0;r<l;r++)m.push(f[d[k][r]].fill);z.push(m)}d=F(h,f);return{type:"relationship-ramp",numClasses:l,focus:h,colors:z,labels:d,rotation:y(h)}};g.getRotationAngleForFocus=y;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/previewSymbol3D":function(){define("exports ../../assets ../../core/colorUtils ../../core/has ../../core/Error ../../core/Logger ../../core/screenUtils ./gfxUtils ./IconSymbol3DLayerResource ./ObjectSymbol3DLayerResource ./previewUtils ./renderUtils ./utils ./webStyleSymbolUtils".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l,d){function f(G){const N=G.outline;var S=null!=G.material?G.material.color:null;S=null!=S?S.toHex():null;if(null==N||"pattern"in N&&null!=N.pattern&&"style"===N.pattern.type&&"none"===N.pattern.style)return"fill"===G.type&&"#ffffff"===S?{color:"#bdc3c7",width:.75}:null;G=y.pt2px(N.size)||0;return{color:"rgba("+(null!=N.color?N.color.toRgba():"255,255,255,1")+")",width:Math.min(G,x),style:"pattern"in N&&null!=N.pattern&&"style"===N.pattern.type?H.dekebabifyLineStyle(N.pattern.style):
null,join:"butt",cap:"patternCap"in N?N.patternCap:"butt"}}async function k(G,N){if(G.thumbnail?.url)return G.thumbnail.url;if("icon"===N.type&&N?.resource?.href)return l.getIconHref(N);N=A.getAssetUrl("esri/images/Legend/legend3dsymboldefault.png");return G.styleOrigin&&(G.styleOrigin.styleName||G.styleOrigin.styleUrl)&&(G=await d.resolveWebStyleSymbol(G.styleOrigin,{portal:G.styleOrigin.portal}).catch(()=>null))&&"thumbnail"in G&&G.thumbnail?.url?G.thumbnail.url:N}function m(G,N=1){const S=G.a;
G=C.toHSV(G);const {r:W,g:ca,b:Z}=C.toRGB({h:G.h,s:G.s/N,v:100-(100-G.v)/N});return[W,ca,Z,S]}function r(G){return"water"===G.type?null==G.color?null:G.color:null==G.material?.color?null:G.material.color}function n(G,N=0){var S=r(G);if(!S){if("fill"===G.type)return null;N=h.adjustColorComponentBrightness(H.defaultThematicColor.r,N);return[N,N,N,100]}G=S.toRgba();for(S=0;3>S;S++)G[S]=h.adjustColorComponentBrightness(G[S],N);return G}async function q(G,N){G=G.style;return"none"===G?null:{type:"pattern",
x:0,y:0,src:await H.getPatternUrlWithColor(A.getAssetUrl(`esri/symbols/patterns/${G}.png`),N.toCss(!0)),width:5,height:5}}function u(G){return G.outline?f(G):{color:"rgba(0, 0, 0, 1)",width:1.5}}function w(G,N){G=r(G);if(!G)return null;let S;S="rgba("+(h.adjustColorComponentBrightness(G.r,N)+",");S+=h.adjustColorComponentBrightness(G.g,N)+",";S+=h.adjustColorComponentBrightness(G.b,N)+",";return S+G.a+");"}function E(G,N){N=w(G,N);if(!N)return{};if("pattern"in G&&null!=G.pattern&&"style"===G.pattern.type&&
"none"===G.pattern.style)return null;const S=Math.min(G.size?y.pt2px(G.size):.75,x);return{color:N,width:S,style:"pattern"in G&&null!=G.pattern&&"style"===G.pattern.type?H.dekebabifyLineStyle(G.pattern.style):null,cap:"cap"in G?G.cap:null,join:"join"in G?"miter"===G.join?y.pt2px(2):G.join:null}}function e(G,N,S){S=null!=S?.75*S:0;return{type:"linear",x1:S?.25*S:0,y1:S?.5*S:0,x2:S||4,y2:S?.5*S:4,colors:[{color:G,offset:0},{color:N,offset:1}]}}function b(G){const N=G.depth,S=G.height;G=G.width;return 0!==
G&&0!==N&&0!==S&&G===N&&null!=G&&null!=S&&G<S}function p(G,N,S){const W=[];if(!G)return W;switch(G.type){case "icon":switch(G.resource?.primitive??K.defaultPrimitive){case "circle":W.push({shape:{type:"circle",cx:0,cy:0,r:.5*N},fill:n(G,0),stroke:f(G)});break;case "square":W.push({shape:{type:"path",path:[{command:"M",values:[0,N]},{command:"L",values:[0,0]},{command:"L",values:[N,0]},{command:"L",values:[N,N]},{command:"Z",values:[]}]},fill:n(G,0),stroke:f(G)});break;case "triangle":W.push({shape:{type:"path",
path:[{command:"M",values:[0,N]},{command:"L",values:[.5*N,0]},{command:"L",values:[N,N]},{command:"Z",values:[]}]},fill:n(G,0),stroke:f(G)});break;case "cross":W.push({shape:{type:"path",path:[{command:"M",values:[.5*N,0]},{command:"L",values:[.5*N,N]},{command:"M",values:[0,.5*N]},{command:"L",values:[N,.5*N]}]},stroke:u(G)});break;case "x":W.push({shape:{type:"path",path:[{command:"M",values:[0,0]},{command:"L",values:[N,N]},{command:"M",values:[N,0]},{command:"L",values:[0,N]}]},stroke:u(G)});
break;case "kite":W.push({shape:{type:"path",path:[{command:"M",values:[0,.5*N]},{command:"L",values:[.5*N,0]},{command:"L",values:[N,.5*N]},{command:"L",values:[.5*N,N]},{command:"Z",values:[]}]},fill:n(G,0),stroke:f(G)})}break;case "object":switch(G.resource?.primitive??z.defaultPrimitive){case "cone":var ca=n(G,0);G=n(G,-.6);G=e(ca,G,S?Q:N);N=h.getConeShapes(N,S);W.push({shape:N[0],fill:G},{shape:N[1],fill:G});break;case "inverted-cone":S=n(G,0);G=n(G,-.6);G=e(S,G,N);N=h.getInvertedConeShapes(N);
W.push({shape:N[0],fill:G},{shape:N[1],fill:S});break;case "cube":N=h.getCubeShapes(N,S);W.push({shape:N[0],fill:n(G,0)},{shape:N[1],fill:n(G,-.3)},{shape:N[2],fill:n(G,-.5)});break;case "cylinder":ca=n(G,0);const Z=n(G,-.6);ca=e(ca,Z,S?Q:N);N=h.getCylinderShapes(N,S);W.push({shape:N[0],fill:ca},{shape:N[1],fill:ca},{shape:N[2],fill:n(G,0)});break;case "diamond":N=h.getDiamondShapes(N);W.push({shape:N[0],fill:n(G,-.3)},{shape:N[1],fill:n(G,0)},{shape:N[2],fill:n(G,-.3)},{shape:N[3],fill:n(G,-.7)});
break;case "sphere":S=n(G,0);G=n(G,-.6);G=e(S,G);G.x1=0;G.y1=0;G.x2=.25*N;G.y2=.25*N;W.push({shape:{type:"circle",cx:0,cy:0,r:.5*N},fill:G});break;case "tetrahedron":N=h.getTetrahedronShapes(N),W.push({shape:N[0],fill:n(G,-.3)},{shape:N[1],fill:n(G,0)},{shape:N[2],fill:n(G,-.6)})}}return W}function I(G){return(G="number"===typeof G?.size?G?.size:null)?y.pt2px(G):null}async function R(G,N){const S=I(N),W=N?.maxSize?y.pt2px(N.maxSize):null,ca=N?.disableUpsampling??!1,Z=[],ja=[];let ma=!1,da=0,X=0,fa=
0;G.symbolLayers.forEach(ba=>{if("icon"===ba.type||"object"===ba.type){ba&&"icon"===ba.type&&(fa=Math.max(ba.size&&y.pt2px(ba.size),fa));var la="icon"===ba.type?ba.size&&y.pt2px(ba.size):0,ia=S||la?Math.ceil(Math.min(S||la,W||U)):M,qa="icon"===ba.type?ba.angle:null;null!=N?.rotation&&(qa=(qa??0)+N.rotation);ja.push(qa);if(ba?.resource?.href){var ta=k(G,ba).then(va=>{const ya=ba?.material?.color;var za="icon"===ba.type?"multiply":"tint";return c.tintImageWithColor(va,ia,ya,za,ca)}).then(va=>{const ya=
va.width,za=va.height;da=Math.max(da,ya);X=Math.max(X,za);qa&&(ma=!0);return[{shape:{type:"image",x:0,y:0,width:ya,height:za,src:va.url},fill:null,stroke:null}]});Z.push(ta)}else ta=ia,"icon"===ba.type&&S&&(ta=la/fa*ia),la="tall"===N?.symbolConfig||N?.symbolConfig?.isTall||("object"===ba.type?b(ba):!1),da=Math.max(da,la?Q:ta),X=Math.max(X,ta),qa&&ba.resource?.primitive&&["square","triangle","x"].includes(ba.resource?.primitive)&&(ma=!0),Z.push(Promise.resolve(p(ba,ta,la)))}});const oa=[];(await Promise.allSettled(Z)).forEach(ba=>
{"fulfilled"===ba.status?oa.push(ba.value):ba.reason&&F.getLogger("esri.symbols.support.previewSymbol3D").warn("error while building swatchInfo!",ba.reason)});return c.renderSymbol(oa,[da,X],{node:N?.node,scale:!1,opacity:N?.opacity,ariaLabel:N?.ariaLabel,rotations:ja,useRotationSize:ma})}function T(G,N){const S=G.symbolLayers,W=[];G=l.isVolumetricSymbol(G);const ca=I(N),Z=(N?.maxSize?y.pt2px(N.maxSize):null)||x;let ja=0,ma=0,da;S.forEach((X,fa)=>{if(X&&("line"===X.type||"path"===X.type)){var oa=
[];switch(X.type){case "line":var ba=E(X,0);if(null==ba)break;var la=ba?.width||0;0===fa&&(da=la);X=Math.min(ca||la,Z);fa=0===fa?X:ca?la/da*X:X;la=fa>L/2?2*fa:L;ma=Math.max(ma,fa);ja=Math.max(ja,la);ba.width=fa;oa.push({shape:{type:"path",path:[{command:"M",values:[0,.5*ma]},{command:"L",values:[ja,.5*ma]}]},stroke:ba});break;case "path":ba=Math.min(ca||M,Z);fa=n(X,0);la=n(X,-.2);var ia=w(X,-.4);ia=ia?{color:ia,width:1}:{};if("quad"===X.profile){const qa=X.width;X=X.height;X=h.getPathSymbolShapes(qa&&
X?qa/X:1,0===X,0===qa);ia={...ia,join:"bevel"};oa.push({shape:X[0],fill:la,stroke:ia},{shape:X[1],fill:la,stroke:ia},{shape:X[2],fill:fa,stroke:ia})}else oa.push({shape:h.shapes.pathSymbol3DLayer[0],fill:la,stroke:ia},{shape:h.shapes.pathSymbol3DLayer[1],fill:fa,stroke:ia});ja=ma=Math.max(ma,ba)}W.push(oa)}});return Promise.resolve(c.renderSymbol(W,[ja,ma],{node:N?.node,scale:G,opacity:N?.opacity,ariaLabel:N?.ariaLabel}))}async function J(G,N){const S="mesh-3d"===G.type;G=G.symbolLayers;var W=I(N);
const ca=N?.maxSize?y.pt2px(N.maxSize):null;W=W||M;const Z=[];let ja=0,ma=0;var da=!1;for(let la=0;la<G.length;la++){var X=G.at(la);const ia=[];if(!S||"fill"===X.type){switch(X.type){case "fill":da=Math.min(W,ca||U);ja=Math.max(ja,da);ma=Math.max(ma,da);da=!0;if(S){var fa=h.shapes.meshSymbol3DFill,oa=w(X,-.4);oa=oa?{color:oa,width:1,join:"round"}:{};ia.push({shape:fa[0],fill:n(X,0),stroke:oa},{shape:fa[1],fill:n(X,-.2),stroke:oa},{shape:fa[2],fill:n(X,-.6),stroke:oa})}else{fa=n(X,0);oa="pattern"in
X?X.pattern:null;var ba=f(X);X=r(X);null!=oa&&"style"===oa.type&&"solid"!==oa.style&&X&&(fa=await q(oa,X));ia.push({shape:h.shapes.fill[0],fill:fa,stroke:ba})}break;case "line":X=E(X,0);if(null==X)break;X={stroke:X,shape:h.shapes.fill[0]};ja=Math.max(ja,M);ma=Math.max(ma,M);ia.push(X);break;case "extrude":fa={join:"round",width:1,...E(X,-.4)};oa=n(X,0);X=n(X,-.2);ba=Math.min(W,ca||U);const qa=h.getExtrudeSymbolShapes(ba);fa.width=1;ia.push({shape:qa[0],fill:X,stroke:fa},{shape:qa[1],fill:X,stroke:fa},
{shape:qa[2],fill:oa,stroke:fa});X=.7*M+.5*ba;ja=Math.max(ja,M);ma=Math.max(ma,X);break;case "water":da=r(X),X=m(da),fa=m(da,2),oa=m(da,3),ba=h.getWaterSymbolShapes(),da=!0,ia.push({shape:ba[0],fill:X},{shape:ba[1],fill:fa},{shape:ba[2],fill:oa}),X=Math.min(W,ca||U),ja=Math.max(ja,X),ma=Math.max(ma,X)}Z.push(ia)}}return c.renderSymbol(Z,[ja,ma],{node:N?.node,scale:da,opacity:N?.opacity,ariaLabel:N?.ariaLabel})}const M=h.SymbolSizeDefaults.size,U=h.SymbolSizeDefaults.maxSize,x=h.SymbolSizeDefaults.maxOutlineSize,
L=h.SymbolSizeDefaults.lineWidth,Q=h.SymbolSizeDefaults.tallSymbolWidth;g.getPatternDescriptor=q;g.getSizeFromOptions=I;g.getSymbolLayerFill=n;g.previewSymbol3D=function(G,N){if(0===G.symbolLayers.length)return Promise.reject(new v("symbolPreview: renderPreviewHTML3D","No symbolLayers in the symbol."));switch(G.type){case "point-3d":return R(G,N);case "line-3d":return T(G,N);case "polygon-3d":case "mesh-3d":return J(G,N)}return Promise.reject(new v("symbolPreview: swatchInfo3D","symbol not supported."))};
Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/symbols/support/webStyleSymbolUtils":function(){define("exports ../../core/devEnvironmentUtils ../../core/Error ../../core/urlUtils ../../portal/Portal ../../chunks/persistableUrlUtils ./jsonUtils ./StyleOrigin ./styleUtils ./Thumbnail ./typeUtils ./webStyleAcceptedFormats".split(" "),function(g,A,C,B,v,F,y,H,K,z,h,c){function l(k,m){return m.items.find(r=>r.name===k)}async function d(k,m,r,n,q){const u=null!=r?.portal?r.portal:
v.getDefault(),w={portal:u,url:B.urlToObject(k.baseUrl),origin:"portal-item"},E=l(m,k.data);if(!E)throw new C("symbolstyleutils:symbol-name-not-found",`The symbol name '${m}' could not be found`,{symbolName:m});var e=q?.acceptedFormats??c.defaultAcceptedFormats;n=n(E,e);if(!n)throw new C("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${m}' does not have an accepted format (one of ${e})`,{symbolName:m});const {url:b,format:p}=n;e=F.fromJSON(b,w);let I=E.thumbnail?.href??null;
const R=E.thumbnail?.imageData;A.isDevEnvironment()&&(e=A.adjustStaticAGOUrl(e)??"",I=A.adjustStaticAGOUrl(I));const T={portal:u,url:B.urlToObject(B.removeFile(e)),origin:"portal-item"};return K.requestJSON(e,q).then(J=>{J="cim"===p?K.makeCIMSymbolRef(J.data):J.data;if((J=y.fromJSON(J,T))&&h.isSymbol3D(J)){if(I){const M=F.fromJSON(I,w);J.thumbnail=new z.Thumbnail({url:M})}else R&&(J.thumbnail=new z.Thumbnail({url:`data:image/png;base64,${R}`}));k.styleUrl?J.styleOrigin=new H({portal:r.portal,styleUrl:k.styleUrl,
name:m}):k.styleName&&(J.styleOrigin=new H({portal:r.portal,styleName:k.styleName,name:m}))}return J})}function f(k,m,r){const n=K.Style2DUrlTemplate.replaceAll(/\{SymbolName\}/gi,k),q=null!=m.portal?m.portal:v.getDefault();return K.requestJSON(n,r).then(u=>{u=K.makeCIMSymbolRef(u.data);return y.fromJSON(u,{portal:q,url:B.urlToObject(B.removeFile(n)),origin:"portal-item"})})}g.fetchSymbolFromStyle=d;g.getStyleItemFromStyle=l;g.resolveWebStyleSymbol=function(k,m,r){const n=k.name;return null==n?Promise.reject(new C("symbolstyleutils:style-symbol-reference-name-missing",
"Missing name in style symbol reference")):"Esri2DPointSymbolsStyle"===k.styleName?f(n,m,r):K.fetchStyle(k,m,r).then(q=>d(q,n,m,K.symbolUrlFromStyleItem,r))};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/core/devEnvironmentUtils":function(){define(["exports"],function(g){const A=/^devext\.arcgis\.com$/,C=/^qaext\.arcgis\.com$/,B=/^[\w-]*\.mapsdevext\.arcgis\.com$/,v=/^[\w-]*\.mapsqa\.arcgis\.com$/,F=[/^([\w-]*\.)?[\w-]*\.zrh-dev-local\.esri\.com$/,A,C,/^jsapps\.esri\.com$/,
B,v];g.adjustStaticAGOUrl=function(y,H){return y?(H=H||globalThis.location.hostname)?null!=H.match(A)||null!=H.match(B)?y.replace("static.arcgis.com","staticdev.arcgis.com"):null!=H.match(C)||null!=H.match(v)?y.replace("static.arcgis.com","staticqa.arcgis.com"):y:y:null};g.devHostnames=F;g.isDevEnvironment=function(y){y=y||globalThis.location.hostname;return F.some(H=>null!=y?.match(H))};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/clusterUtils":function(){define(["exports",
"../../../renderers/visualVariables/SizeVariable"],function(g,A){g.getEffectiveClusterSizeVariable=function(C,B,v){var F=C.effectiveClusterRenderer;if(!(F&&"visualVariables"in F&&F.visualVariables))return null;F=F.visualVariables.find(K=>"size"===K.type);if(!("stops"in F&&F.stops))return null;const y=F.stops.find(K=>K.useMinValue),H=F.stops.find(K=>K.useMaxValue);if(null==y||null==H)return null;v=v.featuresTilingScheme.getClosestInfoForScale(v.scale).level;return(B=B.getDisplayStatistics(v,F.field))?
new A({field:F.field,minSize:C.clusterMinSize,minDataValue:B.minValue,maxSize:C.clusterMaxSize,maxDataValue:B.maxValue}):null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/colorRampUtils":function(){define(["require","exports","../../../Color","./utils"],function(g,A,C,B){function v(z,h){const c=[],l=z.length-1;5===z.length?c.push(0,2,4):c.push(0,l);return z.map((d,f)=>c.includes(f)?B.createStopLabel(d,f,l,h):null)}async function F(z,h,c){c=new C(c??
K);z=(await new Promise((l,d)=>g(["../../../renderers/visualVariables/support/visualVariableUtils"],l,d))).getOpacity(h,z);null!=z&&(c.a=z);return c}function y(z,h){const {startIndex:c,endIndex:l,weight:d}=H(z,h);if(c===l)return h[c].color;z=C.blendColors(h[c].color,h[l].color,d);return new C(z)}function H(z,h){let c=0,l=h.length-1;h.some((d,f)=>{if(z<d.value)return l=f,!0;c=f;return!1});return{startIndex:c,endIndex:l,weight:(z-h[c].value)/(h[l].value-h[c].value)}}const K=new C([64,64,64]);A.getColorFromPointCloudStops=
y;A.getRampStops=async function(z,h,c){let l=!1,d=[],f=[];if(z.stops){var k=z.stops;d=k.map(r=>r.value);(l=k.some(r=>!!r.label))&&(f=k.map(r=>r.label))}k=d[d.length-1];if(null==d[0]&&null==k)return null;const m=l?null:v(d,c);return(await Promise.all(d.map(async(r,n)=>{const q="opacity"===z.type?await F(r,z,h):(await new Promise((u,w)=>g(["../../../renderers/visualVariables/support/visualVariableUtils"],u,w))).getColor(z,r);return{value:r,color:q,label:l?f[n]:m?.[n]??""}}))).reverse()};A.getRampStopsForPointCloud=
function(z){let h=!1,c=[],l=[];c=z.map(k=>k.value);(h=z.some(k=>!!k.label))&&(l=z.map(k=>k.label??""));const d=c[c.length-1];if(null==c[0]&&null==d)return null;const f=h?null:v(c);return c.map((k,m)=>{const r=y(k,z);return{value:k,color:r,label:h?l[m]:f?.[m]??""}}).reverse()};A.getStretchRampStops=function(z,h){let c=[];if(z&&"multipart"===z.type)z.colorRamps.reverse().forEach((l,d)=>{0===d?c.push({value:h.max,color:new C(l.toColor),label:"high"}):c.push({value:null,color:new C(l.toColor),label:""});
d===z.colorRamps.length-1?c.push({value:h.min,color:new C(l.fromColor),label:"low"}):c.push({value:null,color:new C(l.fromColor),label:""})});else{let l,d;z&&"algorithmic"===z.type?(l=z.fromColor,d=z.toColor):(l=[0,0,0,1],d=[255,255,255,1]);c=[{value:h.max,color:new C(d),label:"high"},{value:h.min,color:new C(l),label:"low"}]}return c};Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/utils":function(){define("require exports ../../../core/timeUtils ../../../layers/support/fieldUtils ../../../renderers/support/numberUtils ../../../smartMapping/support/utils ../../../symbols/SimpleLineSymbol".split(" "),
function(g,A,C,B,v,F,y){async function H(h){if(!("visualVariables"in h&&h.visualVariables))return null;h=h.visualVariables.find(d=>"color"===d.type);if(!h)return null;var c=null,l=null;if(h.stops){if(1===h.stops.length)return h.stops[0].color;c=h.stops[0].value;l=h.stops[h.stops.length-1].value}c=null!=c&&null!=l?c+(l-c)/2:0;({getColor:l}=await new Promise((d,f)=>g(["../../../renderers/visualVariables/support/visualVariableUtils"],d,f)));return l(h,c)??null}function K(h,c){if(!c.field)return null;
if("featureReduction"in h)switch(h.featureReduction?.type){case "cluster":case "binning":const l=h.featureReduction.fields.find(({name:d})=>d.toLowerCase()===c.field.toLowerCase());return l&&"getField"in h?h.getField(l.onStatisticField):null}return"getField"in h?h.getField?.(c.field):null}function z(h,c){h="popupTemplate"in h?h.popupTemplate?.fieldInfos:null;if(h?.length&&c)return h.find(l=>l.fieldName?.toLowerCase()===c.toLowerCase())?.format?.dateFormat}A.createStopLabel=function(h,c,l,d){let f=
"";0===c?f="\x3c ":c===l&&(f="\x3e ");h=d?F.formatAnyDate(h,d):v.format(h);return f+h};A.getDateFormatOptions=function(h,c,l){const d=K(h,c);if(!d||!F.isAnyDateField(d)&&!B.isTimeOnlyField(d))return null;var f=z(h,d.name);if(!f&&"date"===d.type){let k=f=0;c.stops?(f=c.stops?.at(0)?.value??f,k=c.stops?.at(-1)?.value??k):"minDataValue"in c&&"maxDataValue"in c&&(f=c.minDataValue??f,k=c.maxDataValue??k);f=k-f>2*C.millisecondsPerTimeUnit.days?"short-date":"short-date-short-time"}return{fieldType:d.type,
format:f,timeZoneOptions:{layerTimeZone:"preferredTimeZone"in h?h.preferredTimeZone:null,viewTimeZone:l,datesInUnknownTimezone:"datesInUnknownTimezone"in h&&h.datesInUnknownTimezone}}};A.getMedianColor=H;A.getReferenceSizeAuthoringInfoVisualVariable=function(h){if("authoringInfo"in h)return h.authoringInfo?.visualVariables?.find(({theme:c})=>"reference-size"===c)};A.getSymbolForFlowRenderer=async function(h,c){const l=h.trailCap,d=h.trailWidth||1;h=c||await H(h)||h.color;return new y({cap:l,color:h,
width:d})};A.rgbImgSource=["data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwcdIkqhiWn5fHwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6JrzFUAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwaeIkqhiWl5/HwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu6sKxboAAAAASUVORK5CYII\x3d","data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAYAAACNiR0NAAAACXBIWXMAAAAAAAAAAAHqZRakAAAANUlEQVQ4jWPMy8v7z0BFwMLAwMAwadJEqhiWl5fPwEQVk5DAqIGjBo4aOGrgqIEQwEjtKgAATl0Hu75+IUcAAAAASUVORK5CYII\x3d"];
A.specialCharsGreaterThan="\x3e";A.specialCharsLessThan="\x3c";Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/numberUtils":function(){define(["exports","../../intl","../../intl/number"],function(g,A,C){function B(h,c){return h-c}function v(h,c){let l;l=Number(h.toFixed(c));l<h?h=l+1/10**c:(h=l,l-=1/10**c);l=Number(l.toFixed(c));h=Number(h.toFixed(c));return[l,h]}function F(h,c,l,d,f){h=H(h,c,l,d);c=null==h.next||h.next<=f;return(null==h.previous||h.previous<=
f)&&c||h.previous+h.next<=2*f}function y(h){h=String(h);var c=h.match(K);if(c?.[1])return{integer:c[1].split("").length,fractional:c[3]?c[3].split("").length:0};if(h.toLowerCase().includes("e")&&(c=h.split("e"),h=c[0],c=c[1],h&&c)){h=Number(h);c=Number(c);const l=0<c;l||(c=Math.abs(c));h=y(h);l?(h.integer+=c,h.fractional=c>h.fractional?0:h.fractional-c):(h.fractional+=c,h.integer=c>h.integer?1:h.integer-c);return h}return{integer:0,fractional:0}}function H(h,c,l,d){const f={previous:null,next:null};
if(null!=l){const k=h-l;f.previous=Math.floor(Math.abs(100*(c-l-k)/k))}null!=d&&(h=d-h,f.next=Math.floor(Math.abs(100*(d-c-h)/h)));return f}const K=/^-?(\d+)(\.(\d+))?$/i,z={maximumFractionDigits:20};g.format=function(h){return C.formatNumber(h,z)};g.numDigits=y;g.percentChange=H;g.round=function(h,c={}){h=h.slice();const {tolerance:l=2,strictBounds:d=!1,indexes:f=h.map((m,r)=>r)}=c;f.sort(B);for(c=0;c<f.length;c++){const m=f[c],r=h[m],n=0===m?null:h[m-1],q=m===h.length-1?null:h[m+1],u=y(r).fractional;
if(u){let w=0,E=!1;for(var k=void 0;w<=u&&!E;)k=v(r,w),k=d&&0===c?k[1]:k[0],E=F(r,k,n,q,l),w++;E&&(h[m]=k)}}return h};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/smartMapping/support/utils":function(){define("exports ../../intl/date ../../layers/support/fieldUtils ../../support/arcadeOnDemand ../../support/basemapUtils ../../time/constants ../../time/timeZoneUtils".split(" "),function(g,A,C,B,v,F,y){function H(f){return String(f).padStart(2,"0")}function K(f,k,m){if("date"===
k||"number"===k){"number"===k&&(f=new Date(f));k=m?f.getFullYear():f.getUTCFullYear();const r=H((m?f.getMonth():f.getUTCMonth())+1),n=H(m?f.getDate():f.getUTCDate()),q=H(m?f.getHours():f.getUTCHours()),u=H(m?f.getMinutes():f.getUTCMinutes());f=H(m?f.getSeconds():f.getUTCSeconds());f=`TIMESTAMP'${k}-${r}-${n} ${q}:${u}:${f}'`}return f}function z(f,k){if(k instanceof Date)return"date";if("number"===typeof k)return"number";if("string"===typeof k&&(f=f.getField(k),"\x3cnow\x3e"!==k.toLowerCase()&&C.isDateField(f)))return"field"}
const h={light:"streets gray topo terrain oceans osm gray-vector streets-vector topo-vector streets-relief-vector streets-navigation-vector topo-3d navigation-3d streets-3d osm-3d gray-3d".split(" "),dark:"satellite hybrid dark-gray dark-gray-vector streets-night-vector navigation-dark-3d streets-dark-3d dark-gray-3d".split(" ")},c={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864E5},l=new Set(["integer","small-integer"]);let d=null;g.castIntegerFieldToFloat=
function(f){return`cast(${f} as float)`};g.dateTypes=["date","date-only","timestamp-offset"];g.defaultBasemapGroups=h;g.defaultStatisticTypes={exclude:["median"]};g.fieldDelimiter=",";g.formatAnyDate=function(f,k){const {format:m,timeZoneOptions:r,fieldType:n}=k??{};let q;r&&({timeZone:u,timeZoneName:q}=y.getTimeZoneFormattingOptions(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,A.convertDateFormatToIntlOptions(m||"short-date-short-time"),n));if("string"===typeof f&&isNaN(Date.parse("time-only"===
n?`1970-01-01T${f}Z`:f)))return f;switch(n){case "date-only":var u=A.convertDateFormatToIntlOptions(m||"short-date");return"string"===typeof f?A.formatDateOnly(f,{...u}):A.formatDate(f,{...u,timeZone:F.utc});case "time-only":return u=A.convertDateFormatToIntlOptions(m||"short-time"),"string"===typeof f?A.formatTimeOnly(f,u):A.formatDate(f,{...u,timeZone:F.utc});case "timestamp-offset":if(!u&&"string"===typeof f&&(new Date(f)).toISOString()!==f)return f;u=(k=m||r?A.convertDateFormatToIntlOptions(m||
"short-date-short-time"):void 0)?{...k,timeZone:u,timeZoneName:q}:void 0;return"string"===typeof f?A.formatTimestamp(f,u):A.formatDate(f,u);default:return k=m||r?A.convertDateFormatToIntlOptions(m||"short-date-short-time"):void 0,A.formatDate("string"===typeof f?new Date(f):f,k?{...k,timeZone:u,timeZoneName:q}:void 0)}};g.getBasemapGroup=function(f,k=h){for(const m in k)if(k[m].includes(f))return m};g.getBasemapId=function(f,k,m=!0){let r=null;f&&("string"===typeof f?k.includes(f)&&(r=f):r=v.getWellKnownBasemapId(f));
return m?r||"gray":r};g.getDateDiffSQL=function(f,k,m,r){const {hasQueryEngine:n}=f;m=K(m,z(f,m),n);f=K(k,z(f,k),n);f=`(${m} - ${f})`;r=c[r];k="/";1>r&&(r=1/r,k="*");return{sqlExpression:1===r?f:`(${f} ${k} ${r})`,sqlWhere:null}};g.getDateType=z;g.getFieldsList=async function(f){const {field:k,field2:m,field3:r,normalizationField:n,valueExpression:q}=f;f=[];q&&(d||({arcadeUtils:f}=await B.loadArcade(),d=f),f=d.extractFieldNames(q));k&&f.push(k);m&&f.push(m);r&&f.push(r);n&&f.push(n);return f};g.getNormalizationType=
function(f){let k=f.normalizationType;k||(f.normalizationField?k="field":null!=f.normalizationTotal&&(k="percent-of-total"));return k??void 0};g.isAnyDateField=function(f){return C.isDateField(f)||C.isDateOnlyField(f)||C.isTimestampOffsetField(f)};g.isIntegerField=function(f,k){f=k&&f.getField(k);return!!f&&l.has(f.type)};g.unitValueInDays=c;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/heatmapRampUtils":function(){define(["exports","../../../renderers/support/HeatmapColorStop"],
function(g,A){g.getHeatmapRampStops=function(C){if(!C.colorStops)return[];const B=[...C.colorStops].filter(F=>0<F.color?.a);let v=B.length-1;if(B[0]){const F=B[v];F&&1!==F.ratio&&(B.push(new A({ratio:1,color:F.color})),v++)}return B.map((F,y)=>{let H="";0===y?H=C.legendOptions?.minLabel||"low":y===v&&(H=C.legendOptions?.maxLabel||"high");return{color:F.color,label:H,ratio:F.ratio}}).reverse()};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/sizeRampUtils":function(){define("require exports ../../../Color ../../../renderers/support/numberUtils ../../../smartMapping/renderers/support/referenceSizeUtils ../../../symbols/SimpleLineSymbol ../../../symbols/SimpleMarkerSymbol ../../../symbols/support/cimSymbolUtils ../../../symbols/support/typeUtils ../../../symbols/support/utils ./utils ../../support/widgetUtils ../../../support/themeUtils".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l){function d(J,M){const U=J.length-1;return J.map((x,L)=>h.createStopLabel(x,L,U,M))}function f(J,M){J=J?.authoringInfo;const U="univariate-color-size"===J?.type;let x=[12,30];if(U){const L=M[0],Q=M[M.length-1];x=M.map(G=>12+(G-L)/(Q-L)*18)}U&&"below"===J?.univariateTheme&&x.reverse();return x}function k(J,M,U,x){const L="class-breaks"===J.type;J=L?J.classBreakInfos?.[0]?.symbol?.clone():J.uniqueValueInfos?.[0]?.symbol?.clone();if(!(J&&"type"in J&&"cim"===J.type))return null;
v.updateReferenceSizeSymbol(J,{color:x??(L?null:new C(R)),innerDotSize:24/U*M||1,outerRingSize:24});return J}function m(J,M){const U=J.classBreakInfos,x=U.length;M=2>x||!(2<=M)?U[0].symbol.clone():U[x-1].symbol.clone();J.visualVariables?.some(L=>"color"===L.type)&&(M.type.includes("3d")?q(M):u(M));return M}async function r(J,M){if("flow"===J.type)return h.getSymbolForFlowRenderer(J,M);if("pie-chart"===J.type)return new y({color:null,outline:J.outline?.width?J.outline:new F});let U=null,x=null;"simple"===
J.type?U=J.symbol:"class-breaks"===J.type?(U=(J=J.classBreakInfos)&&J[0]&&J[0].symbol,x=1<J.length):"unique-value"===J.type&&(J=J.uniqueValueInfos,U=J?.[0]?.symbol,x=null!=J&&1<J.length);if(!U||n(U))return null;U=U.clone();if(M||x)U.type.includes("3d")?q(U):u(U);return U}function n(J){return K.isSymbol3D(J)?J.symbolLayers?.some(M=>"fill"===M?.type)??!1:J?.type.includes("fill")??!1}function q(J){"line-3d"===J.type?J.symbolLayers.forEach(M=>{M.material={color:T}}):J.symbolLayers.forEach(M=>{"icon"!==
M.type||M.resource?.href?M.material={color:R}:(M.material={color:I},M.outline={color:T,size:1.5})})}function u(J){const M=l.isDarkTheme();if("cim"===J.type)H.applyCIMSymbolColor(J,new C(R));else if(J.type.includes("line"))J.color=T;else if(J.color=M?T:I,"simple-marker"===J.type)J.outline?"#ffffff"===J.outline?.color?.toHex()&&(J.outline.color=T):J.outline={color:T,width:1.5}}async function w(J,M,U,x){const L=(await new Promise((N,S)=>g(["../../../renderers/visualVariables/support/visualVariableUtils"],
N,S))).getSizeRangeAtScale(J,U,x),Q=L&&E(L);if(L&&Q){var G=Q.map(N=>{const S=L.minSize,W=L.maxSize,ca=J.minDataValue,Z=J.maxDataValue;return N<=S?ca:N>=W?Z:(N-S)/(W-S)*(Z-ca)+ca});G=B.round(G);for(let N=1;N<G.length-1;N++){const S=await e(J,M,G[N],G[N-1],U,x);S&&(G[N]=S[0],Q[N]=S[1])}return G}}function E(J){const M=J.minSize;J=(J.maxSize-M)/4;const U=[];for(let x=0;5>x;x++)U.push(M+J*x);return U}async function e(J,M,U,x,L,Q){const G=await b(J,M,U,L,Q);x=await b(J,M,x,L,Q);var N=B.numDigits(U),S=N.fractional,
W=N.integer;let ca=N=null;0<U&&1>U&&(N=10**S,U*=N,W=B.numDigits(U).integer);for(S=W-1;0<=S;S--){var Z=10**S;W=Math.floor(U/Z)*Z;Z*=Math.ceil(U/Z);null!=N&&(W/=N,Z/=N);let ja=(W+Z)/2;[,ja]=B.round([W,ja,Z],{indexes:[1]});const ma=await b(J,M,W,L,Q),da=await b(J,M,Z,L,Q),X=await b(J,M,ja,L,Q),fa=B.percentChange(G,ma,x,null),oa=B.percentChange(G,da,x,null),ba=B.percentChange(G,X,x,null);let la=20>=fa.previous,ia=20>=oa.previous;la&&ia&&(fa.previous<=oa.previous?(la=!0,ia=!1):(ia=!0,la=!1));la?ca=[W,
ma]:ia?ca=[Z,da]:20>=ba.previous&&(ca=[ja,X]);if(ca)break}return ca}async function b(J,M,U,x,L){const {getSize:Q}=await new Promise((G,N)=>g(["../../../renderers/visualVariables/support/visualVariableUtils"],G,N));return Q(J,U,{scale:x,view:L,shape:"simple-marker"===M.type?M.style:null})}function p(J,M){J=J.clone();if(K.isSymbol3D(J))z.isVolumetricSymbol(J)||J.symbolLayers.forEach(U=>{"fill"!==U.type&&(U.size=M)});else if("esri.symbols.SimpleMarkerSymbol"===J.declaredClass)J.size=M;else if("esri.symbols.PictureMarkerSymbol"===
J.declaredClass){const U=J.width,x=J.height;J.height=M;J.width=U/x*M}else"esri.symbols.SimpleLineSymbol"===J.declaredClass?J.width=M:"esri.symbols.TextSymbol"===J.declaredClass&&J.font&&(J.font.size=M);return J}const I=[255,255,255],R=[200,200,200],T=[128,128,128];A.getRampStops=async function(J,M,U,x,L,Q,G){var N=M.legendOptions?.customValues;const S=G||await r(J,U);G=M.stops;var W=null!=M.minSize&&null!=M.maxSize;const ca=G&&1<G.length;var Z=!!M.target;if(S&&(N||W||ca&&!Z)){var ja=z.isVolumetricSymbol(S),
ma=!1,da=W=null;W=ja&&!ca?B.round([M.minDataValue,M.maxDataValue]):N??await w(M,S,x,L?.type);N=J?.authoringInfo;var X=(Z="univariate-color-size"===N?.type)&&"above-and-below"===N?.univariateTheme,fa=!!h.getReferenceSizeAuthoringInfoVisualVariable(J);!W&&ca&&(W=G.map(ia=>ia.value),ma=G.some(ia=>!!ia.label),"flow"===J.type&&(W=B.round(W)),ma&&(da=G.map(ia=>ia.label)));ja&&null!=W&&2<W?.length&&!X&&(W=[W[0],W[W.length-1]]);if(!W)return null;Z&&5!==W?.length&&(W=E({minSize:W[0],maxSize:W[W.length-1]}));
var oa=ja?f(J,W):null,ba=z.getSymbolOutlineSize(S),la=ma?null:d(W,Q);return(await Promise.all(W.map(async(ia,qa)=>{const ta=ja?oa[qa]:await b(M,S,ia,x,L?.type),va=!fa||"class-breaks"!==J.type&&"unique-value"!==J.type?p(X&&"class-breaks"===J.type?m(J,qa):S,ta):k(J,ta,M.maxSize,U)??S;return{value:ia,symbol:va,label:ma?da[qa]:la[qa],size:fa?24:ta,outlineSize:ba}}))).reverse()}};A.getReferenceSizeSymbol=k;A.realWorldMaxSize=30;A.realWorldMinSize=12;Object.defineProperty(A,Symbol.toStringTag,{value:"Module"})})},
"esri/widgets/smartMapping/support/utils":function(){define("exports ../../../Color ../../../intl/date ../../../intl/number ../../../renderers/support/utils ../../../renderers/visualVariables/SizeVariable".split(" "),function(g,A,C,B,v,F){g.formatDateLabel=function(y){return C.formatDate(new Date(y),v.timelineDateFormatOptions)};g.formatNumberLabel=function(y){const H=Math.floor(Math.log10(Math.abs(y)))+1;return B.formatNumber(y,{notation:1E6<=Math.abs(y)?"compact":"standard",minimumSignificantDigits:2,
maximumSignificantDigits:4>H||6<H?4:H})};g.getDeviationValues=function(y,H,K){if(null==H||null==y)return[];const z=[];for(let h=-1*K;h<=K;h++)0!==h&&z.push(H+h*y);return z};g.getDynamicPathForSizeStops=function(y){const {max:H,min:K,padding:z,pathHeight:h,pathWidth:c,stops:l}=y,d=H-K;let f=`M0 0 L${c} 0 `,k;y=3===l.length?[l[0],l[1],l[2]]:[l[0],l[2],l[4]];const m=Math.min.apply(Math,y.map(n=>n.size)),r=Math.max(Math.abs(y[0].size-y[1].size),Math.abs(y[2].size-y[1].size));y.reverse();y.forEach(({size:n,
value:q},u)=>{q=Math.round(h-(q-K)/d*h);k=Math.round((n-m)/r*100)/100*c;0===k&&(k=z*c);0===u&&(f+=`L${k} 0 `);f+=`L${k} ${q} `});return f+=`L${k} ${h} L0 ${h} L0 0 Z`};g.getFillFromColor=function(y){return y instanceof A?y.toCss(!0):A.fromString(y??"").toCss(!0)};g.getPathForSizeStops=function(y){const {bottomValue:H,bottomWidth:K,max:z,min:h,pathHeight:c,pathWidth:l,topValue:d,topWidth:f}=y;y=f*l;const k=K*l,m=z-h;return`M${y} 0 L${y} ${Math.round(c-(d-h)/m*c)} L${k} ${Math.round(c-(H-h)/m*c)} L${k} ${c} L0 ${c} L0 0 Z`};
g.getSizesFromVariable=function(y){let H=y.maxSize;y=y.minSize;H instanceof F&&(H=H.stops[0].size);y instanceof F&&(y=y.stops[0].size);return[H,y]};g.getStopChanges=function(y,H,K){const z=K.length-1;if(0>z)return[];const h=K[0],c=K[z]-h,l=H-y,d=[];for(let f=1;f<z;f++)d.push({index:f,value:(K[f]-h)/c*l+y});d.unshift({index:0,value:y});d.push({index:z,value:H});return d};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/renderers/support/utils":function(){define("exports ../../core/arrayUtils ../../core/Logger ../../core/MapUtils ../../intl/date ../../layers/support/fieldUtils ./numberUtils ../visualVariables/support/ColorStop ../../smartMapping/support/utils ../../symbols/support/utils ../../widgets/Legend/support/colorRampUtils ../../widgets/Legend/support/heatmapRampUtils".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){async function l(q,u,w){B.getOrCreateMapValue(q,u,()=>[]).push(...w)}async function d(q,u,w){q=B.getOrCreateMapValue(q,u,()=>new Map);for(const E of w)q.set(E.value,E.color)}function f(q){let u=q.minValue,w=q.maxValue;const E=q.isFirstBreak?"":m.gt+" ";q="percent-of-total"===q.normalizationType?m.pct:"";u=null==u?"":y.format(u);w=null==w?"":y.format(w);return E+u+q+" "+m.ld+" "+w+q}function k(q,u){return"normalizationField"in q&&q.normalizationField?{type:"normalized-field",
field:q.field,normalizationField:q.normalizationField}:"field"in q&&q.field?{type:"field",field:q.field}:"valueExpression"in q&&q.valueExpression?{type:"expression",expression:q.valueExpression,title:q.valueExpressionTitle,returnType:u}:null}const m={lte:"\x3c\x3d",gte:"\x3e\x3d",lt:"\x3c",gt:"\x3e",pct:"%",ld:"\u2013"},r={millisecond:0,second:1,minute:2,hour:3,day:4,month:5,year:6},n=v.convertDateFormatToIntlOptions("short-date");g.calculateDateFormatInterval=function(q){q=q.map(b=>new Date(b));
const u=q.length;let w=Infinity,E=null;for(let b=0;b<u-1;b++){const p=q[b];let I=Infinity,R=null;for(let T=b+1;T<u;T++){var e=q[T];e=p.getFullYear()!==e.getFullYear()&&"year"||p.getMonth()!==e.getMonth()&&"month"||p.getDate()!==e.getDate()&&"day"||p.getHours()!==e.getHours()&&"hour"||p.getMinutes()!==e.getMinutes()&&"minute"||p.getSeconds()!==e.getSeconds()&&"second"||"millisecond";const J=r[e];J<I&&(I=J,R=e)}I<w&&(w=I,E=R)}return E};g.createClassBreakLabel=f;g.createColorStops=function(q){const {values:u,
colors:w,labelIndexes:E,isDate:e}=q;return u.map((b,p)=>{var I=null;if(!E||E.includes(p)){const R=e?v.formatDate(b):y.format(b);R&&(I="",0===p?I=m.lt+" ":p===u.length-1&&(I=m.gt+" "),I+=R)}return new H({value:b,color:w[p],label:I})})};g.createUniqueValueLabel=function(q){const {value:u,domain:w,fieldInfo:E,dateFormatOptions:e}=q;q=String(u);const b=w&&"codedValues"in w&&w.codedValues?w.getName(u):null;b?q=b:null!=u&&E&&(K.isAnyDateField(E)||F.isTimeOnlyField(E))?q=K.formatAnyDate(u,e??{fieldType:E.type}):
"number"===typeof u&&(q=y.format(u));return q};g.dateFormatIntervalOptions={millisecond:"long-month-day-year-long-time",second:"long-month-day-year-long-time",minute:"long-month-day-year-short-time",hour:"long-month-day-year-short-time",day:"long-month-day-year",month:"long-month-day-year",year:"year"};g.getAttribute=k;g.getAttributes=function(q,u){const w=[];if("class-breaks"===q.type||"heatmap"===q.type)w.push(k(q,"number"));else if("unique-value"===q.type){var E=q.authoringInfo;if(E&&"relationship"===
E.type){if(E.field1&&E.field2){var e=E.field2.field;const b=E.field2.normalizationField;w.push(k({field:E.field1.field,normalizationField:E.field1.normalizationField}));w.push(k({field:e,normalizationField:b}))}}else e=q.uniqueValueInfos?.[0],E=null,e?.value&&(e=typeof e.value,"string"===e||"number"===e)&&(E=e),w.push(k(q,E)),[q.field2,q.field3].forEach(b=>b&&w.push({type:"field",field:b}))}else"attributes"in q&&q.attributes?.forEach(b=>w.push(k(b,"number")));(q=u?u(q):"visualVariables"in q?q.visualVariables:
null)&&q.forEach(b=>w.push(k(b,"number")));return A.unique(w.filter(A.isSome),(b,p)=>"field"===b.type&&"field"===p.type?b.field===p.field:"normalized-field"===b.type&&"normalized-field"===p.type?b.field===p.field&&b.normalizationField===p.normalizationField:"expression"===b.type&&"expression"===p.type?b.expression===p.expression:!1)};g.getColorsForRendererValues=async function(q){const u=new Map;if(!q)return u;if("unique-value"!==q.type||q.authoringInfo?.type)if("class-breaks"===q.type){var w=q.classBreakInfos.map(b=>
({value:b.minValue,color:z.getColorFromSymbol(b.symbol,null)})).reverse();const {field:E,valueExpression:e}=q;await d(u,E??e,w)}else"simple"===q.type&&await d(u,"default",[{value:"default",color:z.getColorFromSymbol(q.symbol,null)}]);else{w=(q.uniqueValueInfos??[]).map(T=>({value:T.value,color:z.getColorFromSymbol(T.symbol,null)}));const {field:E,field2:e,field3:b,valueExpression:p,fieldDelimiter:I}=q,R=[E,e,b].filter(Boolean).join(I||"");(R||p)&&await d(u,R||p,w)}"defaultSymbol"in q&&q.defaultSymbol&&
await d(u,"default",[{value:"default",color:z.getColorFromSymbol(q.defaultSymbol,null)}]);if("visualVariables"in q&&q.visualVariables){q=q.visualVariables.filter(E=>"color"===E.type);for(const E of q)q=await h.getRampStops(E)??[],await d(u,E.field||E.valueExpression,q)}return u};g.getColorsFromRenderer=async function(q){const u=new Map;if(!q)return u;if("visualVariables"in q&&q.visualVariables)for(var w of q.visualVariables)if("color"===w.type){const E=(await h.getRampStops(w)??[]).map(e=>e.color);
await l(u,w.field||w.valueExpression,E)}if("heatmap"===q.type)w=c.getHeatmapRampStops(q).map(E=>E.color),await l(u,q.field||q.valueExpression,w);else if("pie-chart"===q.type){for(const E of q.attributes)await l(u,E.field||E.valueExpression,[E.color]);await l(u,"default",[q?.othersCategory?.color,z.getColorFromSymbol(q.backgroundFillSymbol,null)])}else if("dot-density"===q.type){for(const E of q.attributes)await l(u,E.field||E.valueExpression,[E.color]);await l(u,"default",[q.backgroundColor])}else if("unique-value"===
q.type)if("predominance"===q.authoringInfo?.type)for(const E of q.uniqueValueInfos??[])await l(u,E.value.toString(),[z.getColorFromSymbol(E.symbol,null)]);else{w=(q.uniqueValueInfos??[]).map(I=>z.getColorFromSymbol(I.symbol,null));const {field:E,field2:e,field3:b,valueExpression:p}=q;(E||p)&&await l(u,E||p,w);e&&await l(u,e,w);b&&await l(u,b,w)}else if("class-breaks"===q.type){w=q.classBreakInfos.map(b=>z.getColorFromSymbol(b.symbol,null));const {field:E,valueExpression:e}=q;await l(u,E??e,w)}else"simple"===
q.type&&await l(u,"default",[z.getColorFromSymbol(q.symbol,null)]);"defaultSymbol"in q&&q.defaultSymbol&&await l(u,"default",[z.getColorFromSymbol(q.defaultSymbol,null)]);u.forEach((E,e)=>{E=A.unique(E.filter(Boolean),(b,p)=>JSON.stringify(b)===JSON.stringify(p));u.set(e,E)});return u};g.setLabelsForClassBreaks=function(q){const u=q.classBreakInfos,w=q.normalizationType;let E=[];if(u?.length)if("standard-deviation"===q.classificationMethod)C.getLogger("esri.renderers.support.utils").warn("setLabelsForClassBreaks",
"cannot set labels for class breaks generated using 'standard-deviation' method.");else if(q.round){E.push(u[0].minValue);for(const e of u)E.push(e.maxValue);E=y.round(E);u.forEach((e,b)=>{e.label=f({minValue:0===b?E[0]:E[b],maxValue:E[b+1],isFirstBreak:0===b,normalizationType:w})})}else u.forEach((e,b)=>{e.label=f({minValue:e.minValue,maxValue:e.maxValue,isFirstBreak:0===b,normalizationType:w})})};g.timelineDateFormatOptions=n;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/card/CardView":function(){define("require ../../../../chunks/tslib.es6 ../../../../intl ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ./LegendElement ../../../../chunks/componentsUtils ../../../support/widgetUtils ../../../support/decorators/messageBundle ../../../support/jsxFactory ../../../../intl/substitute".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l,d,f,k){C=class extends K{constructor(m,r){super(m,r);this._hasIndicators=!1;this.activeLayerInfos=null;this.headingLevel=3;this.layout="stack";this.messagesCommon=this.messages=null;this.type="card";this.view=null}loadDependencies(){return c.loadCalciteComponents({carousel:()=>new Promise((m,r)=>g(["../../../../chunks/index63"],m,r)),"carousel-item":()=>new Promise((m,r)=>g(["../../../../chunks/index64"],m,r))})}render(){const m=(this._hasIndicators="auto"===this.layout&&
this.view&&768>=this.view.container.clientWidth||"stack"===this.layout)?this._renderCarousel():this._renderLayers();return f.tsx("div",{class:this.classes(z.css.base,{[z.css.stacked]:this._hasIndicators})},m||f.tsx("div",{class:z.css.message},this.messages.noLegend))}_renderCarousel(){const m=[],r=this.activeLayerInfos;if(r)for(const n of r)this._renderSections(n,m);return m?.length?f.tsx("calcite-carousel",{class:z.css.carousel,label:this.messages.carousel},m.map((n,q)=>f.tsx("calcite-carousel-item",
{class:z.css.carouselItem,key:q,label:k.substitute(this.messagesCommon.pagination.pageText,{index:q+1,total:m.length})},n))):null}_renderLayers(){const m=this.activeLayerInfos?.toArray()?.map(r=>this._renderLegendForLayer(r)).filter(Boolean);return m?.length?m:null}_renderLegendForLayer(m){if(!m.ready)return null;if(m.children.length){const r=m.children.toArray().map(this._renderLegendForLayer,this);return f.tsx("section",{class:this.classes(z.css.service,z.css.groupLayer),key:m.layer.uid},f.tsx("div",
{class:z.css.serviceCaptionContainer},m.title),r)}return this._renderLegendElementsForLayer(m)}_renderLegendElementsForLayer(m){var r=m.legendElements?.filter(Boolean);if(!r?.length)return null;r=r.map(n=>f.tsx(h,{activeLayerInfo:m,effectList:m.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${m.layer.uid}-${n.type}`,layer:m.layer,legendElement:n,messages:this.messages}));return f.tsx("section",{class:this.classes(z.css.service,{[z.css.groupLayerChild]:!!m.parent}),
key:m.layer.uid},f.tsx("div",{class:z.css.serviceCaptionContainer},f.tsx("div",{class:z.css.serviceCaptionText},m.title)),f.tsx("div",{class:z.css.serviceContent},r))}_renderSections(m,r){if(m.ready){if(m.children.length)for(var n of m.children)this._renderSections(n,r);n=m.legendElements;if(n?.length)for(const q of n)(n=f.tsx(h,{activeLayerInfo:m,effectList:m.effectList,hasIndicators:this._hasIndicators,headingLevel:this.headingLevel,isChild:!1,key:`${m.layer.uid}-${q.type}`,layer:m.layer,legendElement:q,
messages:this.messages}))&&r.push(n)}}};A.__decorate([B.property()],C.prototype,"activeLayerInfos",void 0);A.__decorate([B.property()],C.prototype,"headingLevel",void 0);A.__decorate([B.property()],C.prototype,"layout",void 0);A.__decorate([B.property(),d.messageBundle("esri/widgets/Legend/t9n/Legend")],C.prototype,"messages",void 0);A.__decorate([B.property(),d.messageBundle("esri/t9n/common")],C.prototype,"messagesCommon",void 0);A.__decorate([B.property({readOnly:!0})],C.prototype,"type",void 0);
A.__decorate([B.property()],C.prototype,"view",void 0);return C=A.__decorate([H.subclass("esri.widgets.Legend.styles.card.CardView")],C)})},"esri/widgets/Legend/styles/card/css":function(){define(["exports"],function(g){g.css={activated:"esri-legend--card__carousel-indicator--activated",base:"esri-legend--card",stacked:"esri-legend--stacked",carouselTitle:"esri-legend--card__carousel-title",indicator:"esri-legend--card__carousel-indicator",intervalSeparator:"esri-legend--card__interval-separator",
imageryLayerStretchedImage:"esri-legend--card__imagery-layer-image--stretched",imageLabel:"esri-legend--card__image-label",layerCaption:"esri-legend--card__layer-caption",labelElement:"esri-legend--card__label-element",layerRow:"esri-legend--card__layer-row",labelCell:"esri-legend--card__label-cell",message:"esri-legend--card__message",rampLabel:"esri-legend--card__ramp-label",section:"esri-legend--card__section",relationshipSection:"esri-legend--card__relationship-section",serviceCaptionText:"esri-legend--card__service-caption-text",
serviceContent:"esri-legend--card__service-content",service:"esri-legend--card__service",groupLayer:"esri-legend--card__group-layer",groupLayerChild:"esri-legend--card__group-layer-child",symbol:"esri-legend--card__symbol",sizeRampRow:"esri-legend--card__size-ramp-row",symbolRow:"esri-legend--card__symbol-row",symbolCell:"esri-legend--card__symbol-cell",carousel:"esri-legend--card__carousel",carouselItem:"esri-legend--card__carousel-item",indicatorContainer:"esri-legend--card__carousel-indicator-container",
intervalSeparatorsContainer:"esri-legend--card__interval-separators-container",relationshipLabelContainer:"esri-legend--card__relationship-label-container",labelContainer:"esri-legend--card__label-container",serviceCaptionContainer:"esri-legend--card__service-caption-container",symbolContainer:"esri-legend--card__symbol-container",colorRampContainer:"esri-legend--card__color-ramp-container",sizeRampContainer:"esri-legend--card__size-ramp-container",sizeRampPreview:"esri-legend--card__size-ramp-preview",
pieChartRampPreview:"esri-legend--card__pie-chart-ramp-preview",rampContainer:"esri-legend__ramps",sizeRampHorizontal:"esri-legend__size-ramp--horizontal",rampLabelsContainer:"esri-legend__ramp-labels",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",univariateAboveAndBelowColorRamp:"esri-univariate-above-and-below-ramp__color--card"};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/card/LegendElement":function(){define("../../../../chunks/tslib.es6 ../../../../Color ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../symbols/support/utils ../../../Widget ./ColorRamp ./css ./SizeRamp ./UnivariateAboveAndBelowRamp ./UnivariateColorSizeRamp ../support/relationshipUtils ../support/utils ../../support/styleUtils ../../../support/Heading ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l,d,f,k,m,r,n,q){var u;B=u=class extends K{constructor(w,E){super(w,E);this.effectList=null;this.hasIndicators=!1;this.headingLevel=3;this.isChild=!1;this.legendElement=null}render(){const w=this._renderLegendElement();var E=k.getLegendElementTitle(this.legendElement,this.messages);E=this.hasIndicators&&!this.isChild?q.tsx("div",null,q.tsx(r.Heading,{class:h.css.carouselTitle,level:this.headingLevel},this.activeLayerInfo.title),q.tsx(r.Heading,{class:h.css.layerCaption,
level:r.incrementHeadingLevel(this.headingLevel)},E)):E?q.tsx(r.Heading,{class:h.css.layerCaption,level:this.headingLevel},E):null;return q.tsx("section",{"aria-labelledby":this.key,class:h.css.section,id:`${this.key}-panel`,key:this.key,role:"tabpanel",tabIndex:0},E,w)}_renderLegendElement(){switch(this.legendElement.type){case "symbol-table":return this._renderSymbolTable(this.legendElement);case "size-ramp":return q.tsx(c,{hasIndicators:this.hasIndicators,key:this.key,legendElement:this.legendElement,
messages:this.messages,opacity:this.layer.opacity});case "color-ramp":case "opacity-ramp":case "heatmap-ramp":case "stretch-ramp":return q.tsx(z,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case "relationship-ramp":return f.renderRelationshipRamp(this.legendElement,this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case "pie-chart-ramp":return q.tsx("div",
{afterCreate:m.attachToNode,bind:this.legendElement.preview,class:h.css.pieChartRampPreview,key:`${this.key}-preview`});case "univariate-above-and-below-ramp":return q.tsx(l,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case "univariate-color-size-ramp":return q.tsx(d,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(w){const E=
w.infos.map(b=>this._renderElementInfo(b,w.legendType)).filter(Boolean);if(!E.length)return null;const e=this.activeLayerInfo.legendElements.some(({type:b})=>"relationship-ramp"===b);return q.tsx("div",{class:this.classes({[h.css.labelContainer]:!E[0]?.properties?.classes?.[h.css.symbolRow]&&!e,[h.css.relationshipLabelContainer]:e})},E)}_renderElementInfo(w,E){var {layer:e}=this,b="label"in w?w.label:null;const p=`${this.key}-${b}`;if("type"in w&&w.type)return q.tsx(u,{activeLayerInfo:this.activeLayerInfo,
effectList:this.effectList,hasIndicators:this.hasIndicators,headingLevel:this.headingLevel,isChild:!0,key:p,layer:e,legendElement:w,messages:this.messages});if(!("preview"in w&&w.preview||"src"in w&&w.src))return null;E=m.isImageryStretchedLegend(e,E);b=m.getTitle(this.messages,b,!1)||"";if("src"in w&&w.src)return q.tsx("div",{class:h.css.layerRow,key:`${p}-row`},this._renderImage(w,e,E),q.tsx("div",{class:h.css.imageLabel},b));if("symbol"in w&&w.preview){if(!w.symbol?.type.includes("simple-fill")){if(!w.label)return q.tsx("div",
{afterCreate:m.attachToNode,bind:w.preview,key:`${p}-row`});e={[h.css.symbolCell]:this.hasIndicators};return q.tsx("div",{class:this.classes(h.css.layerRow,{[h.css.symbolRow]:this.hasIndicators}),key:`${p}-row`},q.tsx("div",{afterCreate:m.attachToNode,bind:w.preview,class:this.classes(e)}),q.tsx("div",{class:this.classes(h.css.imageLabel,{[h.css.labelCell]:this.hasIndicators})},b))}return q.tsx("div",{class:h.css.layerRow,key:`${p}-row`},q.tsx("div",{class:h.css.labelElement,styles:this._getBackgroundStyles(w)},
b))}return null}_getBackgroundStyles(w){var E=w.symbol,e=E.color;const b=!!e?.a;var p="outline"in E?E.outline:null;E=!!p?.color?.a;e=b&&e?new A([e.r,e.g,e.b,e.a*this.layer.opacity]):new A([255,255,255,0]);p=E&&p.color?new A([p.color.r,p.color.g,p.color.b,p.color.a*this.layer.opacity]):new A([255,255,255,0]);var I=w.symbol.color?.isBright??!0;w=I?"black":"white";I=I?"rgba(255, 255, 255, .6)":"rgba(0, 0, 0, .6)";return{background:b?e.toCss(!0):"none",color:w,textShadow:`-1px -1px 0 ${I},\n                  1px -1px 0 ${I},\n                  -1px 1px 0 ${I},\n                  1px 1px 0 ${I}`,
border:E?`1px solid ${p.toCss(!0)}`:"none",filter:H.getCSSFilterFromEffectList(this.effectList)??void 0}}_renderImage(w,E,e){const {label:b,src:p,opacity:I}=w;e={[h.css.imageryLayerStretchedImage]:e,[h.css.symbol]:!e};E={opacity:`${I??E.opacity}`};const R=m.getTitle(this.messages,b,!1);return q.tsx("img",{alt:R,"aria-label":R,border:0,class:this.classes(e),height:w.height,src:p,styles:E,width:w.width})}};g.__decorate([C.property()],B.prototype,"activeLayerInfo",void 0);g.__decorate([C.property()],
B.prototype,"effectList",void 0);g.__decorate([C.property()],B.prototype,"hasIndicators",void 0);g.__decorate([C.property()],B.prototype,"headingLevel",void 0);g.__decorate([C.property()],B.prototype,"isChild",void 0);g.__decorate([C.property()],B.prototype,"layer",void 0);g.__decorate([C.property()],B.prototype,"legendElement",void 0);g.__decorate([C.property()],B.prototype,"messages",void 0);return B=u=g.__decorate([y.subclass("esri.widgets.Legend.styles.card.LegendElement")],B)})},"esri/widgets/Legend/styles/card/ColorRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../../symbols/support/svgUtils ../../../../symbols/support/utils ../../../Widget ./css ../support/utils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l){C=class extends K{constructor(d,f){super(d,f);this.legendElement=this.effectList=null;this.opacity=1}render(){const d=this.legendElement.infos.slice().reverse();return l.tsx("div",{class:this.classes(z.css.layerRow,z.css.colorRampContainer)},this._renderRampLabel(d[0]),l.tsx("div",{class:z.css.symbolContainer},this._renderPreview(d),this._renderMiddleStopRampLabel(d)),this._renderRampLabel(d.at(-1)))}_renderPreview(d){var {opacity:f}=this;const k="heatmap-ramp"===
this.legendElement.type,m=d.length-1,r=2<m&&!k?25*m:100;var n=r+20;d=[[{shape:{type:"path",path:"M0 12.5 L10 0 L10 25 Z"},fill:d[0].color,stroke:{width:0}},{shape:{type:"rect",x:10,y:0,width:r,height:25},fill:{type:"linear",x1:10,y1:0,x2:r+10,y2:0,colors:d.map((q,u)=>({color:q.color,offset:k&&"ratio"in q?q.ratio:u/m}))},stroke:{width:0}},{shape:{type:"path",path:`M${r+10} 0 L${n} ${12.5} L${r+10} ${25} Z`},fill:d[d.length-1].color,stroke:{width:0}}]];n=y.renderSVG(d,n,25);f={filter:H.getCSSFilterFromEffectList(this.effectList)??
void 0,opacity:null==f?void 0:`${f}`};return l.tsx("div",{styles:f},n)}_renderMiddleStopRampLabel(d){return(d=0!==d.length%2?d[d.length/2|0]:null)?l.tsx("div",{class:z.css.intervalSeparatorsContainer},l.tsx("div",{class:z.css.intervalSeparator},"|"),this._renderRampLabel(d)):null}_renderRampLabel(d){return l.tsx("div",{class:z.css.rampLabel},h.getRampStopLabel(d,this.legendElement.type,this.messages))}};g.__decorate([A.property()],C.prototype,"effectList",void 0);g.__decorate([A.property()],C.prototype,
"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);g.__decorate([A.property()],C.prototype,"opacity",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.card.ColorRamp")],C)})},"esri/widgets/Legend/styles/support/utils":function(){define(["exports","../../support/styleUtils"],function(g,A){g.getLegendElementTitle=function(C,B){if(!C.title||"string"===typeof C.title)return C.title;const v="color-ramp"===C.type||"opacity-ramp"===C.type;C=C.title;B=A.getTitle(B,
C,v);return A.isRendererTitle(C,v)&&C.title?`${C.title} (${B})`:B};g.getRampStopLabel=function(C,B,v){switch(B){case "heatmap-ramp":return v[C.label]||C.label;case "stretch-ramp":return A.getStretchStopLabel(C,v);default:return C.label}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/support/styleUtils":function(){define(["exports","../../../intl","../../../core/string","../../../intl/substitute","../../../intl/number"],function(g,A,C,B,v){g.attachToNode=function(F){F.appendChild(this)};
g.getStretchStopLabel=function(F,y){return F.label?y[F.label]+": "+("string"===typeof F.value?F.value:v.formatNumber(F.value??0,{style:"decimal",notation:F.value?.toString().toLowerCase().includes("e")?"scientific":"standard"})):""};g.getTitle=function(F,y,H){if(y){if("number"===typeof y)return y;if("string"===typeof y)return C.stripHTML(y);if("value"in y||"unit"in y)return B.substitute(F.dotValue,y);if("colorName"in y&&"bandName"in y)return F[y.colorName]+": "+(F[y.bandName]||y.bandName);if("showCount"in
y)return y.showCount?F.clusterCountTitle:void 0;var K=null;H?K=y.ratioPercentTotal?"showRatioPercentTotal":y.ratioPercent?"showRatioPercent":y.ratio?"showRatio":y.normField?"showNormField":y.field?"showField":null:H||(K=y.normField?"showNormField":y.normByPct?"showNormPct":y.field?"showField":null);return K?B.substitute("showField"===K?"{field}":F[K],{field:y.field,normField:y.normField}):void 0}};g.isImageryStretchedLegend=function(F,y){return!!(y&&"Stretched"===y&&"version"in F&&"number"===typeof F.version&&
10.3<=F.version&&"esri.layers.ImageryLayer"===F.declaredClass)};g.isRendererTitle=function(F,y){return!y};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/card/SizeRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/screenUtils ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){const l=window.devicePixelRatio;B=class extends H{constructor(d,f){super(d,f);this.hasIndicators=!1;this.legendElement=null;this.opacity=1}render(){const {legendElement:d,hasIndicators:f,opacity:k}=this;var m=d.infos;const {label:r,...n}=m.at(0),{label:q,...u}=m.at(-1);m=n.preview;let w=u.preview;const E={"flex-direction":f?"column":"row-reverse"};m&&(m=m.cloneNode(!0),m.style.display="flex");w&&(w=w.cloneNode(!0),w.style.display="flex");const e={opacity:null!=k?
`${k}`:""};return c.tsx("div",{class:this.classes(K.css.layerRow,{[K.css.sizeRampRow]:f})},c.tsx("div",{class:K.css.rampLabel},f?r:q),c.tsx("div",{class:K.css.sizeRampContainer,styles:E},c.tsx("div",{afterCreate:z.attachToNode,bind:m,class:K.css.sizeRampPreview,styles:e}),this._renderSizeRampLines(d),c.tsx("div",{afterCreate:z.attachToNode,bind:w,class:K.css.sizeRampContainer,styles:e})),c.tsx("div",{class:K.css.rampLabel},f?q:r))}_renderSizeRampLines(d){d=d.infos;var f=d[0],k=d.at(-1),m=f.symbol;
d=this.hasIndicators;f=A.pt2px(f.size+f.outlineSize)*l;k=A.pt2px(k.size+k.outlineSize)*l;const r=d?f:f+50*l,n=d?f/2+50*l:f;if(m)if(m.type.includes("3d"))if(m.symbolLayers?.length){var q=m.symbolLayers.at(-1)?.resource?.primitive;q="triangle"===q||"cone"===q||"tetrahedron"===q}else q=void 0;else q="triangle"===m.style;else q=void 0;m?m.type.includes("3d")?m.symbolLayers?.length?(m=m.symbolLayers.at(-1).resource?.primitive,m="circle"===m||"cross"===m||"kite"===m||"sphere"===m||"cube"===m||"diamond"===
m):m=void 0:(m=m.style,m="circle"===m||"diamond"===m||"cross"===m):m=void 0;const u=document.createElement("canvas");u.width=r;u.height=n;u.style.width=`${u.width/l}px`;u.style.height=`${u.height/l}px`;const w=u.getContext("2d");if(d){w.beginPath();var E=r/2-k/2;w.moveTo(0,0);w.lineTo(E,n);E=r/2+k/2;w.moveTo(r,0);w.lineTo(E,n)}else w.beginPath(),w.moveTo(0,n/2-k/2),w.lineTo(r,0),w.moveTo(0,n/2+k/2),w.lineTo(r,n);w.strokeStyle="#ddd";w.stroke();return c.tsx("div",{afterCreate:z.attachToNode,bind:u,
styles:d?{display:"flex",marginTop:`-${q?0:m?f/2:0}px`,marginBottom:`-${q?k:m?k/2:0}px`}:{display:"flex",marginRight:`-${q?0:m?f/2:0}px`,marginLeft:`-${q?0:m?k/2:0}px`}})}};g.__decorate([C.property()],B.prototype,"hasIndicators",void 0);g.__decorate([C.property()],B.prototype,"legendElement",void 0);g.__decorate([C.property()],B.prototype,"messages",void 0);g.__decorate([C.property()],B.prototype,"opacity",void 0);return B=g.__decorate([y.subclass("esri.widgets.Legend.styles.card.SizeRamp")],B)})},
"esri/widgets/Legend/styles/card/UnivariateAboveAndBelowRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../support/univariateUtils ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(g,A,C,B,v,F,y,H,K,z,h,c){C=class extends y{constructor(l,d){super(l,
d);this.legendElement=this.effectList=null;this.opacity=1}render(){const {legendElement:l,opacity:d,effectList:f,key:k}=this,{sizeRampElement:m,colorRampElement:r}=K.getUnivariateAboveAndBelowRampElements(l,d,"horizontal");if(!m)return null;var n=K.getUnivariateSizeRampSize(m,"full",!0,"horizontal"),q=K.getUnivariateColorRampSize(m,"above",!0,"horizontal"),u=K.getUnivariateColorRampSize(m,"below",!0,"horizontal"),w=this.messages?.previewColorRampAriaLabel;q=K.getUnivariateColorRampPreview(r,{width:q,
height:12,rampAlignment:"horizontal",opacity:d,type:"above",effectList:f,ariaLabel:w});u=K.getUnivariateColorRampPreview(r,{width:u,height:12,rampAlignment:"horizontal",opacity:d,type:"below",effectList:f,ariaLabel:w});w=K.getUnivariateColorRampMargin(m,"card");var E=m.infos.map(p=>p.label);const e=E.length-1;E=E.map((p,I)=>0===I||I===e?c.tsx("div",{key:I},p):null);const b={marginTop:"3px",display:"flex"};h.isRTL(this.container)?b.marginRight=`${w}px`:b.marginLeft=`${w}px`;n={width:`${n}px`,display:"flex",
flexDirection:"row",justifyContent:"space-between"};return c.tsx("div",{class:H.css.layerRow,key:`${k}-container`,styles:{display:"flex",flexDirection:"column"}},c.tsx("div",{class:this.classes(H.css.symbolContainer,H.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},m.infos.map((p,I)=>c.tsx("div",{afterCreate:z.attachToNode,bind:p.preview,class:H.css.symbol,key:I}))),q?c.tsx("div",{class:H.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:b},c.tsx("div",{afterCreate:z.attachToNode,
bind:q}),c.tsx("div",{afterCreate:z.attachToNode,bind:u})):null,c.tsx("div",{class:H.css.layerInfo},c.tsx("div",{class:H.css.rampLabelsContainer,styles:n},E)))}};g.__decorate([A.property()],C.prototype,"effectList",void 0);g.__decorate([A.property()],C.prototype,"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);g.__decorate([A.property()],C.prototype,"opacity",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.card.UnivariateAboveAndBelowRamp")],
C)})},"esri/widgets/Legend/styles/support/univariateUtils":function(){define("exports ../../../../core/screenUtils ../../../../libs/maquette/projection ../../../../libs/maquette/projector ../../../../symbols/support/symbolUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(g,A,C,B,v,F,y){function H(d="vertical"){return"vertical"===d?y.tsx("svg",{height:"4",width:"10"},y.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"0",x2:"10",y1:"2",y2:"2"})):y.tsx("svg",
{height:"10",width:"10"},y.tsx("line",{style:"stroke:rgb(200, 200, 200);stroke-width:1",x1:"5",x2:"5",y1:"0",y2:"10"}))}function K(d,f="vertical"){const k=document.createElement("div");k.style.height="20px";k.className=l.univariateAboveAndBelowSymbol;null!=d&&(k.style.opacity=d.toString());c.append(k,H.bind(null,f));return k}function z(d,f,k="vertical",m){d.infos.forEach((r,n)=>{if(m&&2===n)r.preview=K(f,k);else{n=A.pt2px(r.size)+("horizontal"===k?20:10);const q=r.preview,u="div"===q?.tagName.toLowerCase(),
w=u?q:document.createElement("div");w.className=l.univariateAboveAndBelowSymbol;"horizontal"===k?w.style.width=`${n}px`:w.style.height=`${n}px`;!u&&q&&w.appendChild(q);r.preview=w}})}function h(d,f,k,m="vertical"){let r=0;d=d.infos;const n=Math.floor(d.length/2);var q="full"===f||"above"===f?0:n;for(f="full"===f||"below"===f?d.length-1:n;q<=f;q++)if(k&&q===n)r+="horizontal"===m?10:20;else{const u=A.pt2px(d[q].size)+("horizontal"===m?20:10);r+=u}return Math.round(r)}const c=B.createProjector(),l={univariateAboveAndBelowSymbol:"esri-univariate-above-and-below-ramp__symbol",
colorRamp:"esri-legend__color-ramp"};g.getUnivariateAboveAndBelowRampElements=function(d,f,k="vertical"){var m=d.infos;d=m.find(({type:r})=>"size-ramp"===r);m=m.find(({type:r})=>"color-ramp"===r);d&&(d={...d},d.infos=[...d.infos],z(d,f,k,!0));m&&(m={...m},m.infos=[...m.infos]);"horizontal"===k&&(d?.infos.reverse(),m?.infos.reverse());return{sizeRampElement:d,colorRampElement:m}};g.getUnivariateColorRampMargin=function(d,f="classic"){d=d.infos;return"classic"===f?(A.pt2px(d[0].size)+10)/2:(A.pt2px(d[0].size)-
A.pt2px(d[d.length-1].size))/2};g.getUnivariateColorRampPreview=function(d,f){if(!d)return null;d=d.infos.map(k=>k.color);d=v.renderColorRampPreviewHTML("full"===f.type?d:"above"===f.type?d.slice(0,3):d.slice(2,5),{width:f.width,height:f.height,align:f.rampAlignment,effectList:f.effectList,ariaLabel:f.ariaLabel});d.className=l.colorRamp;null!=f.opacity&&(d.style.opacity=f.opacity.toString());return d};g.getUnivariateColorRampSize=function(d,f,k,m="vertical"){const r=h(d,f,k,m);d=d.infos;var n=Math.floor(d.length/
2);const q="full"===f||"above"===f?0:n;n="full"===f||"below"===f?d.length-1:n;k=k?"vertical"===m?20:10:0;m="vertical"===m?10*("full"===f?2:1):20*("full"===f?2:1);return Math.round(r-(A.pt2px("full"===f?d[q].size+d[n].size:"above"===f?d[q].size:d[n].size)/2+k/2+m/2))};g.getUnivariateColorSizeRampElements=function(d,f="vertical"){var k=d.infos;d=k.find(({type:m})=>"size-ramp"===m);k=k.find(({type:m})=>"color-ramp"===m);d&&(d={...d},d.infos=[...d.infos],z(d,null,f,!1));k&&(k={...k},k.infos=[...k.infos]);
"horizontal"===f&&(d?.infos.reverse(),k?.infos.reverse());return{sizeRampElement:d,colorRampElement:k}};g.getUnivariateSizeRampSize=h;g.univariateColorRampContainerStyles={marginLeft:"3px"};g.univariateColorRampStyles={display:"table-cell",verticalAlign:"middle"};g.univariateRampContainerStyles={display:"flex",alignItems:"flex-start"};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/card/UnivariateColorSizeRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../support/univariateUtils ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){C=class extends y{constructor(l,d){super(l,d);this.legendElement=this.effectList=null;this.opacity=1}render(){const {legendElement:l,opacity:d,effectList:f,key:k}=this,{sizeRampElement:m,colorRampElement:r}=K.getUnivariateColorSizeRampElements(l,"horizontal");if(!m)return null;var n=K.getUnivariateSizeRampSize(m,"full",!1,"horizontal"),q=K.getUnivariateColorRampSize(m,"full",!1,"horizontal");q=K.getUnivariateColorRampPreview(r,{width:q,height:12,rampAlignment:"horizontal",
opacity:d,type:"full",effectList:f,ariaLabel:this.messages?.previewColorRampAriaLabel});const u=K.getUnivariateColorRampMargin(m,"card"),w=m.infos.length-1,E=m.infos.map((b,p)=>0===p||p===w?c.tsx("div",{key:p},b.label):null),e={marginTop:"3px",display:"flex"};h.isRTL(this.container)?e.marginRight=`${u}px`:e.marginLeft=`${u}px`;n={width:`${n}px`,display:"flex",flexDirection:"row",justifyContent:"space-between"};return c.tsx("div",{class:H.css.layerRow,key:`${k}-container`,styles:{display:"flex",flexDirection:"column"}},
c.tsx("div",{class:this.classes(H.css.symbolContainer,H.css.sizeRampHorizontal),styles:{display:"flex",flexDirection:"row"}},m.infos.map((b,p)=>c.tsx("div",{afterCreate:z.attachToNode,bind:b.preview,class:H.css.symbol,key:p}))),c.tsx("div",{class:H.css.univariateAboveAndBelowColorRamp,key:"color-ramp-preview",styles:e},c.tsx("div",{afterCreate:z.attachToNode,bind:q})),c.tsx("div",{class:H.css.layerInfo},c.tsx("div",{class:H.css.rampLabelsContainer,styles:n},E)))}};g.__decorate([A.property()],C.prototype,
"effectList",void 0);g.__decorate([A.property()],C.prototype,"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);g.__decorate([A.property()],C.prototype,"opacity",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.card.UnivariateColorSizeRamp")],C)})},"esri/widgets/support/Heading":function(){define(["exports","../../core/mathUtils","./globalCss","./widgetUtils","./jsxFactory"],function(g,A,C,B,v){g.Heading=function({level:F,class:y,...H},K){F=A.clamp(Math.ceil(F),
1,6);return v.tsx(`h${F}`,{...H,"aria-level":String(F),class:B.classes(C.globalCss.heading,y),role:"heading"},K)};g.incrementHeadingLevel=function(F,y=1){return A.clamp(Math.ceil(F+y),1,6)};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/support/globalCss":function(){define(["exports"],function(g){g.globalCss={anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",
buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",
menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",
widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/classic/ClassicView":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ./LegendElement ../../../support/globalCss ../../../support/Heading ../../../support/widgetUtils ../../../support/decorators/messageBundle ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l,d){const f=`${H.legend}__`;C=class extends y{constructor(k,m){super(k,m);this.activeLayerInfos=null;this.headingLevel=3;this.messages=null;this.type="classic"}render(){const k=this.activeLayerInfos?.toArray().map(m=>this._renderLegendForLayer(m)).filter(Boolean);return k?.length?d.tsx("section",null,k):d.tsx("div",{class:H.css.message,key:"no-legend"},this.messages.noLegend)}_renderLegendForLayer(k,m){if(!k.ready)return null;const r=`${k.layer.uid}-version-${k.version}`;
m=`${f}${m?`${m}-`:""}${r}`;const n=k.title?h.Heading({level:this.headingLevel,class:this.classes(z.globalCss.heading,H.css.label)},k.title):null;return k.children.length?(k=k.children.toArray().map(q=>this._renderLegendForLayer(q,r)),d.tsx("section",{class:this.classes(H.css.service,H.css.groupLayer),key:m},n,k)):this._renderLegendElementsForLayer(k,n,m)}_renderLegendElementsForLayer(k,m,r){var n=k.legendElements?.filter(Boolean);if(!n?.length)return null;n=n.map(q=>d.tsx(K,{effectList:k.effectList,
isChild:!1,key:`${r}-${q.type}`,layer:k.layer,legendElement:q,messages:this.messages}));return d.tsx("section",{class:this.classes(H.css.service,{[H.css.groupLayerChild]:!!k.parent}),key:r},m,d.tsx("div",{class:H.css.layer},n))}};g.__decorate([A.property()],C.prototype,"activeLayerInfos",void 0);g.__decorate([A.property()],C.prototype,"headingLevel",void 0);g.__decorate([A.property(),l.messageBundle("esri/widgets/Legend/t9n/Legend")],C.prototype,"messages",void 0);g.__decorate([A.property({readOnly:!0})],
C.prototype,"type",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.classic.ClassicView")],C)})},"esri/widgets/Legend/styles/classic/css":function(){define(["exports"],function(g){g.css={service:"esri-legend__service",label:"esri-legend__service-label",layer:"esri-legend__layer",groupLayer:"esri-legend__group-layer",groupLayerChild:"esri-legend__group-layer-child",layerTable:"esri-legend__layer-table",layerTableSizeRamp:"esri-legend__layer-table--size-ramp",layerChildTable:"esri-legend__layer-child-table",
layerCaption:"esri-legend__layer-caption",layerBody:"esri-legend__layer-body",layerRow:"esri-legend__layer-row",layerCell:"esri-legend__layer-cell",layerInfo:"esri-legend__layer-cell esri-legend__layer-cell--info",imageryLayerStretchedImage:"esri-legend__imagery-layer-image--stretched",imageryLayerCellStretched:"esri-legend__imagery-layer-cell--stretched",imageryLayerInfoStretched:"esri-legend__imagery-layer-info--stretched",symbolContainer:"esri-legend__layer-cell esri-legend__layer-cell--symbols",
symbol:"esri-legend__symbol",rampContainer:"esri-legend__ramps",sizeRamp:"esri-legend__size-ramp",colorRamp:"esri-legend__color-ramp",opacityRamp:"esri-legend__opacity-ramp",borderlessRamp:"esri-legend__borderless-ramp",rampTick:"esri-legend__ramp-tick",rampFirstTick:"esri-legend__ramp-tick-first",rampLastTick:"esri-legend__ramp-tick-last",rampLabelsContainer:"esri-legend__ramp-labels",rampLabel:"esri-legend__ramp-label",message:"esri-legend__message",univariateAboveAndBelowLabel:"esri-univariate-above-and-below-ramp__label"};
g.legend="esri-legend";Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Legend/styles/classic/LegendElement":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./ColorRamp ./css ./SizeRamp ./UnivariateAboveAndBelowRamp ./UnivariateColorSizeRamp ../support/relationshipUtils ../support/utils ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c,l,d,f,k,m){var r;C=r=class extends y{constructor(n,q){super(n,q);this.effectList=null;this.isChild=!1;this.legendElement=null}render(){const n=this._renderLegendElement();var q=d.getLegendElementTitle(this.legendElement,this.messages);const u=this.isChild?K.css.layerChildTable:K.css.layerTable;q=q?m.tsx("div",{class:K.css.layerCaption},q):null;return m.tsx("section",{class:this.classes(u,{[K.css.layerTableSizeRamp]:"size-ramp"===this.legendElement.type||!this.isChild}),
key:`${this.key}-table`},q,n)}_renderLegendElement(){switch(this.legendElement.type){case "symbol-table":return this._renderSymbolTable(this.legendElement);case "size-ramp":return m.tsx(z,{key:this.key,legendElement:this.legendElement,messages:this.messages});case "color-ramp":case "opacity-ramp":case "heatmap-ramp":case "stretch-ramp":return m.tsx(H,{key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case "relationship-ramp":return l.renderRelationshipRamp(this.legendElement,
this.id,{opacity:this.layer.opacity,effectList:this.effectList,ariaLabel:this.messages.previewRelationshipRampAriaLabel,key:this.key});case "pie-chart-ramp":return m.tsx("div",{afterCreate:f.attachToNode,bind:this.legendElement.preview,key:`${this.key}-preview`});case "univariate-above-and-below-ramp":return m.tsx(h,{effectList:this.effectList,key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});case "univariate-color-size-ramp":return m.tsx(c,{effectList:this.effectList,
key:this.key,legendElement:this.legendElement,messages:this.messages,opacity:this.layer.opacity});default:return null}}_renderSymbolTable(n){const q=n.infos.map(u=>this._renderElementInfo(u,n.legendType)).filter(Boolean);return q.length?m.tsx("div",{class:K.css.layerBody},q):null}_renderElementInfo(n,q){var {layer:u}=this;const w="label"in n?n.label:null,E=`${this.key}-${w}`;if("type"in n&&n.type)return m.tsx(r,{effectList:this.effectList,isChild:!0,key:E,layer:u,legendElement:n,messages:this.messages});
if(!("preview"in n&&n.preview||"src"in n&&n.src))return null;q=f.isImageryStretchedLegend(u,q);u={[K.css.imageryLayerInfoStretched]:q};return m.tsx("div",{class:K.css.layerRow,key:`${E}-row`},m.tsx("div",{class:this.classes(K.css.symbolContainer,{[K.css.imageryLayerInfoStretched]:q})},this._renderPreview(n,q)),m.tsx("div",{class:this.classes(K.css.layerInfo,u)},f.getTitle(this.messages,w,!1)||""))}_renderPreview(n,q){const {layer:u}=this;return"preview"in n&&n.preview?m.tsx("div",{afterCreate:f.attachToNode,
bind:n.preview,class:K.css.symbol}):"src"in n&&n.src?this._renderImage(n,u,q):null}_renderImage(n,q,u){const {label:w,src:E,opacity:e}=n;u={[K.css.imageryLayerStretchedImage]:u,[K.css.symbol]:!u};q={opacity:`${e??q.opacity}`};const b=f.getTitle(this.messages,w,!1);return m.tsx("img",{alt:b,"aria-label":b,border:0,class:this.classes(u),height:n.height,src:E,styles:q,width:n.width})}};g.__decorate([A.property()],C.prototype,"effectList",void 0);g.__decorate([A.property()],C.prototype,"isChild",void 0);
g.__decorate([A.property()],C.prototype,"layer",void 0);g.__decorate([A.property()],C.prototype,"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);return C=r=g.__decorate([F.subclass("esri.widgets.Legend.styles.classic.LegendElement")],C)})},"esri/widgets/Legend/styles/classic/ColorRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../support/utils ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){C=class extends y{constructor(l,d){super(l,d);this.legendElement=null;this.opacity=1}get _preview(){const l=this.legendElement.preview;if(!l)return null;l.className=`${H.css.colorRamp} ${"opacity-ramp"===this.legendElement.type?H.css.opacityRamp:""}`;null!=this.opacity&&(l.style.opacity=this.opacity.toString());return l}render(){const {legendElement:l,_preview:d}=this;if(!d)return null;const f={height:d.style.height};return c.tsx("div",{class:H.css.layerRow,key:`${this.key}-row`},
c.tsx("div",{class:H.css.symbolContainer,styles:{width:"24px"}},c.tsx("div",{afterCreate:z.attachToNode,bind:d,class:H.css.rampContainer})),c.tsx("div",{class:H.css.layerInfo},c.tsx("div",{class:H.css.rampLabelsContainer,styles:f},l.infos.map((k,m)=>this._renderRampLabel(k,m,l.type)))))}_renderRampLabel(l,d,f){return c.tsx("div",{class:l.label?H.css.rampLabel:void 0,key:`${this.key}-stop-${l.label??d}-label`},K.getRampStopLabel(l,f,this.messages))}};g.__decorate([A.property()],C.prototype,"_preview",
null);g.__decorate([A.property()],C.prototype,"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);g.__decorate([A.property()],C.prototype,"opacity",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.classic.ColorRamp")],C)})},"esri/widgets/Legend/styles/classic/SizeRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h){C=class extends y{constructor(c,l){super(c,l);this.legendElement=null}render(){const c=this.legendElement.infos.map(l=>this._renderRow(l)).filter(Boolean);return c.length?h.tsx("div",{class:H.css.layerBody},c):null}_renderRow(c){return c.preview?h.tsx("div",{class:H.css.layerRow,key:`${this.key}-${c.label}-row`},h.tsx("div",{class:this.classes(H.css.symbolContainer,H.css.sizeRamp)},h.tsx("div",{afterCreate:K.attachToNode,bind:c.preview,class:H.css.symbol})),h.tsx("div",
{class:H.css.layerInfo},K.getTitle(this.messages,c.label,!1)||"")):null}};g.__decorate([A.property()],C.prototype,"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.classic.SizeRamp")],C)})},"esri/widgets/Legend/styles/classic/UnivariateAboveAndBelowRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../support/univariateUtils ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),
function(g,A,C,B,v,F,y,H,K,z,h,c){C=class extends y{constructor(l,d){super(l,d);this.legendElement=this.effectList=null;this.opacity=1}render(){const {legendElement:l,opacity:d,effectList:f,key:k}=this,{sizeRampElement:m,colorRampElement:r}=K.getUnivariateAboveAndBelowRampElements(l,d);if(!m)return null;var n=this.messages.previewColorRampAriaLabel,q=K.getUnivariateColorRampSize(m,"above",!0),u=K.getUnivariateColorRampSize(m,"below",!0);const w=K.getUnivariateColorRampPreview(r,{width:12,height:q,
rampAlignment:"vertical",opacity:d,type:"above",effectList:f,ariaLabel:n});n=K.getUnivariateColorRampPreview(r,{width:12,height:u,rampAlignment:"vertical",opacity:d,type:"below",effectList:f,ariaLabel:n});var E=K.getUnivariateColorRampMargin(m);const e=m.infos.map(J=>J.label),b=e.map((J,M)=>{const U=2===M;return 0===M?c.tsx("div",{class:J?w?H.css.univariateAboveAndBelowLabel:H.css.rampLabel:void 0,key:`${k}-color-ramp-above-label-${J??M}`},J):U?c.tsx("div",null):null}),p=e.length-1,I=Math.floor(e.length/
2),R=e.map((J,M)=>{const U=M===p;return M===I||U?c.tsx("div",{class:J?w?H.css.univariateAboveAndBelowLabel:H.css.rampLabel:void 0,key:`${k}-color-ramp-below-label-${J??M}`},J):null}),T={display:"table-cell",verticalAlign:"middle"};E={marginTop:`${E}px`};q={height:`${q}px`};u={height:`${u}px`};return c.tsx("div",{key:`${k}-container`,styles:K.univariateRampContainerStyles},c.tsx("div",{class:H.css.layerBody},m.infos.map((J,M)=>c.tsx("div",{class:this.classes(H.css.layerRow,H.css.sizeRamp),key:`${k}-row-${M}`},
c.tsx("div",{afterCreate:z.attachToNode,bind:J.preview,class:H.css.symbol,styles:T}),w||0!==M%2?null:c.tsx("div",{class:H.css.layerInfo},e[M])))),w?c.tsx("div",{styles:E},c.tsx("div",{styles:K.univariateColorRampContainerStyles},c.tsx("div",{styles:K.univariateColorRampStyles},c.tsx("div",{afterCreate:z.attachToNode,bind:w,class:H.css.rampContainer})),c.tsx("div",{styles:K.univariateColorRampStyles},c.tsx("div",{class:H.css.rampLabelsContainer,styles:q},b))),c.tsx("div",{styles:K.univariateColorRampContainerStyles},
c.tsx("div",{styles:K.univariateColorRampStyles},c.tsx("div",{afterCreate:z.attachToNode,bind:n,class:H.css.rampContainer})),c.tsx("div",{styles:K.univariateColorRampStyles},c.tsx("div",{class:H.css.rampLabelsContainer,styles:u},R)))):null)}};g.__decorate([A.property()],C.prototype,"effectList",void 0);g.__decorate([A.property()],C.prototype,"legendElement",void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);g.__decorate([A.property()],C.prototype,"opacity",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.classic.UnivariateAboveAndBelowRamp")],
C)})},"esri/widgets/Legend/styles/classic/UnivariateColorSizeRamp":function(){define("../../../../chunks/tslib.es6 ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass ../../../Widget ./css ../support/univariateUtils ../../support/styleUtils ../../../support/widgetUtils ../../../support/jsxFactory".split(" "),function(g,A,C,B,v,F,y,H,K,z,h,c){C=class extends y{constructor(l,
d){super(l,d);this.legendElement=this.effectList=null;this.opacity=1}render(){const {legendElement:l,opacity:d,effectList:f,key:k}=this,{sizeRampElement:m,colorRampElement:r}=K.getUnivariateColorSizeRampElements(l);if(!m)return null;var n=K.getUnivariateColorRampMargin(m),q=K.getUnivariateColorRampSize(m,"full",!1);const u=K.getUnivariateColorRampPreview(r,{width:12,height:q,rampAlignment:"vertical",opacity:d,type:"full",effectList:f,ariaLabel:this.messages?.previewColorRampAriaLabel}),w=m.infos.length-
1,E=m.infos.map((b,p)=>0===p||p===w?c.tsx("div",{class:b.label?r?H.css.univariateAboveAndBelowLabel:H.css.rampLabel:void 0,key:`${k}-color-ramp-label-${b.label??p}`},b.label):null),e={display:"table-cell",verticalAlign:"middle"};n={marginTop:`${n}px`};q={height:`${q}px`};return c.tsx("div",{key:`${k}-container`,styles:K.univariateRampContainerStyles},c.tsx("div",{class:H.css.layerBody},m.infos.map((b,p)=>c.tsx("div",{class:this.classes(H.css.layerRow,H.css.sizeRamp),key:`${k}-row-${p}`},c.tsx("div",
{afterCreate:z.attachToNode,bind:b.preview,class:H.css.symbol,styles:e})))),c.tsx("div",{styles:n},c.tsx("div",{styles:K.univariateColorRampContainerStyles},c.tsx("div",{styles:K.univariateColorRampStyles},c.tsx("div",{afterCreate:z.attachToNode,bind:u,class:H.css.rampContainer})),c.tsx("div",{styles:K.univariateColorRampStyles},c.tsx("div",{class:H.css.rampLabelsContainer,styles:q},E)))))}};g.__decorate([A.property()],C.prototype,"effectList",void 0);g.__decorate([A.property()],C.prototype,"legendElement",
void 0);g.__decorate([A.property()],C.prototype,"messages",void 0);g.__decorate([A.property()],C.prototype,"opacity",void 0);return C=g.__decorate([F.subclass("esri.widgets.Legend.styles.classic.UnivariateColorSizeRamp")],C)})},"*noref":1}});
define("../chunks/tslib.es6 ../core/reactiveUtils ../core/accessorSupport/decorators/property ../core/accessorSupport/decorators/cast ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Legend/LegendViewModel ./Legend/styles/card/CardView ./Legend/styles/classic/ClassicView ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/jsxFactory".split(" "),function(g,A,C,B,v,F,y,H,K,z,h,c,l,d,f){v=class extends H{constructor(k,m){super(k,
m);this.headingLevel=3;this.messages=null;this.style=new h;this.viewModel=new K}initialize(){this.addHandles([A.on(()=>this.view,"resize",()=>this.scheduleRender()),A.on(()=>this.activeLayerInfos,"change",()=>this._refreshActiveLayerInfos(this.activeLayerInfos)),A.watch(()=>this.headingLevel,k=>{const {style:m}=this;m&&(m.headingLevel=k)}),A.watch(()=>this.style,(k,m)=>{m&&k!==m&&m.destroy();k&&(k.activeLayerInfos=this.activeLayerInfos,"card"===k.type&&(k.view=this.view),k.headingLevel=this.headingLevel)},
A.initial)])}get activeLayerInfos(){return this.viewModel.activeLayerInfos}set activeLayerInfos(k){this.viewModel.activeLayerInfos=k}get basemapLegendVisible(){return this.viewModel.basemapLegendVisible}set basemapLegendVisible(k){this.viewModel.basemapLegendVisible=k}get groundLegendVisible(){return this.viewModel.groundLegendVisible}set groundLegendVisible(k){this.viewModel.groundLegendVisible=k}get hideLayersNotInCurrentView(){return this.viewModel.hideLayersNotInCurrentView}set hideLayersNotInCurrentView(k){this.viewModel.hideLayersNotInCurrentView=
k}get keepCacheOnDestroy(){return this.viewModel.keepCacheOnDestroy}set keepCacheOnDestroy(k){this.viewModel.keepCacheOnDestroy=k}get respectLayerDefinitionExpression(){return this.viewModel.respectLayerDefinitionExpression}set respectLayerDefinitionExpression(k){this.viewModel.respectLayerDefinitionExpression=k}get respectLayerVisibility(){return this.viewModel.respectLayerVisibility}set respectLayerVisibility(k){this.viewModel.respectLayerVisibility=k}get icon(){return"legend"}set icon(k){this._overrideIfSome("icon",
k)}get label(){return this.messages?.widgetLabel??""}set label(k){this._overrideIfSome("label",k)}get layerInfos(){return this.viewModel.layerInfos}set layerInfos(k){this.viewModel.layerInfos=k}castStyle(k){if(k instanceof z||k instanceof h)return k;if("string"===typeof k)return"card"===k?new z:new h;if(k&&"string"===typeof k.type){const m={...k};delete m.type;return"card"===k.type?new z(m):new h(m)}return new h}get view(){return this.viewModel.view}set view(k){this.viewModel.view=k}render(){return f.tsx("div",
{class:this.classes("esri-legend",c.globalCss.widget,this.style instanceof h?c.globalCss.panel:null)},this.style.render())}_refreshActiveLayerInfos(k){k.forEach(m=>{this.removeHandles(`version_${m.layer.uid}`);this._renderOnActiveLayerInfoChange(m)});this.scheduleRender()}_renderOnActiveLayerInfoChange(k){var m=A.watch(()=>k.version,()=>this.scheduleRender());this.addHandles(m,`version_${k.layer.uid}`);m=A.on(()=>k.children,"change",()=>k.children.forEach(r=>this._renderOnActiveLayerInfoChange(r)),
A.initial);this.addHandles(m,`version_${k.layer.uid}`);k.children.forEach(r=>this._renderOnActiveLayerInfoChange(r))}};g.__decorate([C.property()],v.prototype,"activeLayerInfos",null);g.__decorate([C.property()],v.prototype,"basemapLegendVisible",null);g.__decorate([C.property()],v.prototype,"groundLegendVisible",null);g.__decorate([C.property()],v.prototype,"headingLevel",void 0);g.__decorate([C.property()],v.prototype,"hideLayersNotInCurrentView",null);g.__decorate([C.property()],v.prototype,"keepCacheOnDestroy",
null);g.__decorate([C.property()],v.prototype,"respectLayerDefinitionExpression",null);g.__decorate([C.property()],v.prototype,"respectLayerVisibility",null);g.__decorate([C.property()],v.prototype,"icon",null);g.__decorate([C.property()],v.prototype,"label",null);g.__decorate([C.property()],v.prototype,"layerInfos",null);g.__decorate([C.property(),d.messageBundle("esri/widgets/Legend/t9n/Legend")],v.prototype,"messages",void 0);g.__decorate([C.property()],v.prototype,"style",void 0);g.__decorate([B.cast("style")],
v.prototype,"castStyle",null);g.__decorate([C.property()],v.prototype,"view",null);g.__decorate([C.property()],v.prototype,"viewModel",void 0);return v=g.__decorate([y.subclass("esri.widgets.Legend")],v)});