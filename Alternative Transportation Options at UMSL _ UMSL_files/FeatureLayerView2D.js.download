// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.32/esri/copyright.txt for details.
//>>built
require({cache:{"esri/AggregateGraphic":function(){define("./chunks/tslib.es6 ./Graphic ./core/accessorSupport/decorators/property ./core/has ./core/Logger ./core/RandomLCG ./core/accessorSupport/decorators/subclass".split(" "),function(g,k,n,m,l,z,w){k=class extends k{constructor(){super(...arguments);this.isAggregate=!0}getEffectivePopupTemplate(A){return this.popupTemplate?this.popupTemplate:(A=this.sourceLayer?.featureReduction)&&"popupTemplate"in A&&A.popupEnabled?A.popupTemplate:null}getObjectId(){return this.attributes.aggregateId}};
g.__decorate([n.property({type:Boolean})],k.prototype,"isAggregate",void 0);return k=g.__decorate([w.subclass("esri.AggregateGraphic")],k)})},"esri/TrackGraphic":function(){define("./chunks/tslib.es6 ./Graphic ./core/accessorSupport/decorators/property ./core/has ./core/Logger ./core/RandomLCG ./core/accessorSupport/decorators/subclass".split(" "),function(g,k,n,m,l,z,w){k=class extends k{constructor(){super(...arguments);this.isAggregate=!0}getEffectivePopupTemplate(A){if(this.popupTemplate)return this.popupTemplate;
A=this.sourceLayer?.trackInfo;return A?.enabled&&A.popupEnabled?A.popupTemplate:null}getObjectId(){return this.attributes.aggregateId}};g.__decorate([n.property({type:Boolean})],k.prototype,"isAggregate",void 0);return k=g.__decorate([w.subclass("esri.TrackGraphic")],k)})},"esri/layers/effects/FeatureEffectView":function(){define("../../chunks/tslib.es6 ../../core/Accessor ../../core/has ../../core/accessorSupport/decorators/property ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ./EffectView".split(" "),
function(g,k,n,m,l,z,w,A){k=class extends k{constructor(v){super(v);this._filter=null;this.duration=n("mapview-transitions-duration");this._excludedEffectView=new A.EffectView(v);this._includedEffectView=new A.EffectView(v)}get excludedEffects(){return this._excludedEffectView.effects}set featureEffect(v){this._get("featureEffect")!==v&&this._transitionTo(v)}get filter(){return this._filter||this.featureEffect?.filter||null}get hasEffects(){return this._excludedEffectView.hasEffects||this._includedEffectView.hasEffects}get includedEffects(){return this._includedEffectView.effects}set scale(v){this._set("scale",
v);this._excludedEffectView.scale=v;this._includedEffectView.scale=v}get transitioning(){return this._excludedEffectView.transitioning||this._includedEffectView.transitioning}get transitioningToEmpty(){return!this._excludedEffectView.final&&!this._includedEffectView.final}transitionStep(v,t){this._set("scale",t);this.transitioning?(this._includedEffectView.transitionStep(v,t),this._excludedEffectView.transitionStep(v,t),this.transitioning||(this._filter=null)):(this._excludedEffectView.scale=t,this._includedEffectView.scale=
t)}endTransition(){this._includedEffectView.endTransition();this._excludedEffectView.endTransition();this._filter=null}_transitionTo(v){const t=this._get("featureEffect"),h=v?.includedEffect,f=v?.excludedEffect,r=this._includedEffectView.canTransitionTo(h)&&this._excludedEffectView.canTransitionTo(f);this._includedEffectView.effect=h;this._excludedEffectView.effect=f;this._set("featureEffect",v);this._filter=v?.filter||t?.filter||null;r||this.endTransition()}};g.__decorate([m.property()],k.prototype,
"_filter",void 0);g.__decorate([m.property()],k.prototype,"_excludedEffectView",void 0);g.__decorate([m.property()],k.prototype,"_includedEffectView",void 0);g.__decorate([m.property()],k.prototype,"duration",void 0);g.__decorate([m.property()],k.prototype,"excludedEffects",null);g.__decorate([m.property()],k.prototype,"featureEffect",null);g.__decorate([m.property()],k.prototype,"filter",null);g.__decorate([m.property()],k.prototype,"hasEffects",null);g.__decorate([m.property()],k.prototype,"includedEffects",
null);g.__decorate([m.property({value:0})],k.prototype,"scale",null);g.__decorate([m.property()],k.prototype,"transitioning",null);g.__decorate([m.property()],k.prototype,"transitioningToEmpty",null);return k=g.__decorate([w.subclass("esri.layers.effects.FeatureEffectView")],k)})},"esri/layers/support/timeSupport":function(){define(["exports","../../support/timeUtils"],function(g,k){g.combineTimeExtent=function(n,m,l){if(null==n?.timeInfo)return null;const {datesInUnknownTimezone:z=!1,timeOffset:w,
useViewTime:A}=n;n=n.timeExtent;z&&(n=k.toLocalTimeExtent(n));m=A?m&&n?m.intersection(n):m||n:n;if(!m||m.isEmpty||m.isAllTime)return m;w&&(m=m.offset(-w.value,w.unit));z&&(m=k.toUTCTimeExtent(m));return m.equals(l)?l:m};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/support/timeUtils":function(){define("exports ../core/arrayUtils ../core/lang ../core/timeUtils ../time/TimeExtent ../webmap/utils ../webscene/utils".split(" "),function(g,k,n,m,l,z,w){function A(f){return void 0!==
f.timeInfo}async function v(f,r){return f.widgets?.timeSlider?.fullTimeExtent??t(f.allLayers,r)}async function t(f,r){if(0===f.length)return l.allTime;await Promise.all(f.map(u=>u.load({signal:r})));var c=f.filter(A),p=f.filter(u=>!A(u)&&null!=u.visibilityTimeExtent);if(0===c.length&&0===p.length)return l.allTime;f=[];const x=[];for(const u of c)"feature"!==u?.type&&"map-image"!==u?.type||!u.timeInfo?.hasLiveData?x.push(u):f.push(u);c=u=>null==u||u.isAllTime;p=[...x.map(u=>{const E=u.timeInfo?.fullTimeExtent;
({visibilityTimeExtent:u}=u);return E?.intersection(u)??u}),...p.map(u=>u.visibilityTimeExtent)];if(p.some(c))return l.allTime;f=f.map(async u=>{const E=(await u.fetchRecomputedExtents({signal:r}))?.timeExtent??u.timeInfo?.fullTimeExtent;({visibilityTimeExtent:u}=u);return E?.intersection(u)??u});f=(await Promise.allSettled(f)).map(u=>"fulfilled"===u.status?u.value:null);if(f.some(c))return l.allTime;f=[...f,...p].filter(k.isSome);return 0===f.length?l.allTime:f.reduce((u,E)=>u.union(E))}function h(f,
r){f=f.currentTimeExtent;if(!f)return null;const {start:c,end:p}=f;f=c??p??null;switch(r){case "time-window":return new l({start:c,end:p});case "cumulative-from-start":return new l({start:null,end:f});case "cumulative-from-end":return new l({start:f,end:null});case "instant":return new l({start:f,end:f})}}g.getTimeExtentFromLayers=t;g.getTimeSliderSettingsFromWebDocument=async function(f,r){if(!z.isWebMap(f)&&!w.isWebScene(f))return null;await f.load({signal:r});var c=f?.widgets?.timeSlider;if(!c)return null;
f=await v(f,r);r=c.loop;var p=c.numThumbs??2;var x=c.currentTimeExtent;if(x){const {start:E,end:H}=x;p=null!=E&&null!=H&&E.getTime()===H.getTime()?"instant":2===p?"time-window":null==E||0===E.getTime()?"cumulative-from-start":"cumulative-from-end"}else p=2===p?"time-window":"cumulative-from-start";x=c.stopDelay??2E3;{const {numStops:E,stopInterval:H,stops:O}=c;var u=O?{dates:n.clone(O)}:H?{interval:H.clone()}:{count:E??5}}c=h(c,p);return{fullTimeExtent:f,loop:r,mode:p,playRate:x,stops:u,timeExtent:c}};
g.toLocalTimeExtent=function(f){if(!f)return f;const {start:r,end:c}=f;return new l({start:null!=r?m.offsetDate(r,r.getTimezoneOffset(),"minutes"):r,end:null!=c?m.offsetDate(c,c.getTimezoneOffset(),"minutes"):c})};g.toUTCTimeExtent=function(f){if(!f)return f;const {start:r,end:c}=f;return new l({start:null!=r?m.offsetDate(r,-r.getTimezoneOffset(),"minutes"):r,end:null!=c?m.offsetDate(c,-c.getTimezoneOffset(),"minutes"):c})};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/webscene/utils":function(){define(["exports",
"../support/tagSymbols"],function(g,k){g.isWebScene=function(n){return null!=n&&"object"===typeof n&&k.WebSceneTag in n};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/support/tagSymbols":function(){define(["exports"],function(g){const k=Symbol("WebScene");g.WebSceneTag=k;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AggregateFeatureSet":function(){define("../../chunks/tslib.es6 ../../AggregateGraphic ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ../../geometry/SpatialReference ./FeatureSet".split(" "),
function(g,k,n,m,l,z,w,A,v,t){m=class extends t{constructor(){super(...arguments);this.features=[]}readFeatures(h,f){f=v.fromJSON(f.spatialReference);const r=[];for(let x=0;x<h.length;x++){var c=h[x];const u=k.fromJSON(c);var p=c.geometry?.spatialReference;null==u.geometry||p||(u.geometry.spatialReference=f);c=c.aggregateGeometries;p=u.aggregateGeometries;if(c&&null!=p)for(const E in p){const H=p[E],O=c[E]?.spatialReference;null==H||O||(H.spatialReference=f)}r.push(u)}return r}};g.__decorate([n.property({type:[k],
json:{write:!0}})],m.prototype,"features",void 0);g.__decorate([w.reader("features")],m.prototype,"readFeatures",null);return m=g.__decorate([A.subclass("esri.rest.support.AggregateFeatureSet")],m)})},"esri/rest/support/AttributeBinsFeatureSet":function(){define("../../chunks/tslib.es6 ../../AttributeBinsGraphic ../../core/Clonable ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/reader ../../core/accessorSupport/decorators/subclass ./FeatureSet".split(" "),
function(g,k,n,m,l,z,w,A,v,t){n=class extends n.ClonableMixin(t){constructor(){super(...arguments);this.features=[]}readFeatures(h,f){return this.readFeaturesWithClass(h,f,k)}};g.__decorate([m.property({type:[k],json:{write:!0}})],n.prototype,"features",void 0);g.__decorate([A.reader("features")],n.prototype,"readFeatures",null);return n=g.__decorate([v.subclass("esri.rest.support.AttributeBinsFeatureSet")],n)})},"esri/AttributeBinsGraphic":function(){define("./chunks/tslib.es6 ./Graphic ./core/Clonable ./core/lang ./core/accessorSupport/decorators/property ./core/has ./core/Logger ./core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w,A){var v;k=v=class extends n.ClonableMixin(k){constructor(t){super(t);this.stackedAttributes=null}cloneShallow(){return new v({...super.cloneShallow(),stackedAttributes:this.stackedAttributes})}toJSON(){return{...super.toJSON(),stackedAttributes:m.clone(this.stackedAttributes)}}};g.__decorate([l.property()],k.prototype,"stackedAttributes",void 0);return k=v=g.__decorate([A.subclass("esri.AttributeBinsGraphic")],k)})},"esri/rest/support/AttributeBinsQuery":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/jsonMap ../../core/JSONSupport ../../core/Logger ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ../../geometry/SpatialReference ../../geometry/support/jsonUtils ../../geometry/support/typeUtils ../../layers/graphics/data/queryUtils ./AutoIntervalBinParameters ./BinParametersBase ./DateBinParameters ./FixedBoundariesBinParameters ./FixedIntervalBinParameters ./spatialRelationships ./StatisticDefinition ../../time/TimeExtent ../../time/timeZoneUtils".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f,r,c,p,x,u,E,H,O,J,S,T,B){n=new n.JSONMap({asc:"ascending",desc:"descending"});x={base:u,key:"type",typeMap:{"auto-interval":x,date:E,"fixed-boundaries":H,"fixed-interval":O}};k=class extends k.ClonableMixin(m){constructor(d){super(d);this.binParameters=null;this.binOrder="ascending";this.cacheHint=void 0;this.defaultSpatialReference=this.datumTransformation=null;this.distance=void 0;this.returnDistinctValues=this.outStatistics=this.outSpatialReference=this.lowerBoundaryAlias=
this.geometry=null;this.spatialRelationship="intersects";this.units=this.upperBoundaryAlias=this.timeExtent=null;this.where="1\x3d1"}set outTimeZone(d){this._set("outTimeZone",d);d&&!B.isTimeZoneValid(d)&&l.getLogger(this).warn("#outTimeZone",`the parsed value '${d}' may not be a valid IANA time zone`)}};g.__decorate([z.property({types:x,json:{name:"bin",write:!0}})],k.prototype,"binParameters",void 0);g.__decorate([t.enumeration(n)],k.prototype,"binOrder",void 0);g.__decorate([z.property({type:Boolean,
json:{write:!0}})],k.prototype,"cacheHint",void 0);g.__decorate([z.property({json:{write:!0}})],k.prototype,"datumTransformation",void 0);g.__decorate([z.property({type:f,json:{name:"defaultSR",write:!0}})],k.prototype,"defaultSpatialReference",void 0);g.__decorate([z.property({type:Number,json:{write:{overridePolicy(d){return{enabled:0<d}}}}})],k.prototype,"distance",void 0);g.__decorate([z.property({types:c.geometryTypes,json:{read:r.fromJSON,write:!0}})],k.prototype,"geometry",void 0);g.__decorate([z.property({type:String,
json:{write:!0}})],k.prototype,"lowerBoundaryAlias",void 0);g.__decorate([z.property({type:f,json:{name:"outSR",write:!0}})],k.prototype,"outSpatialReference",void 0);g.__decorate([z.property({type:[S],json:{write:{enabled:!0,overridePolicy(){return{enabled:null!=this.outStatistics&&0<this.outStatistics.length}}}}})],k.prototype,"outStatistics",void 0);g.__decorate([z.property({value:null,json:{name:"outTimeReference",read:{reader:d=>d.ianaTimeZone},write:{writer:(d,D,I)=>{d&&(D[I]={ianaTimeZone:d})}}}})],
k.prototype,"outTimeZone",null);g.__decorate([z.property({type:Boolean,json:{write:!0}})],k.prototype,"returnDistinctValues",void 0);g.__decorate([t.enumeration(J.spatialRelKebabDict,{name:"spatialRel"})],k.prototype,"spatialRelationship",void 0);g.__decorate([z.property({type:T,json:{write:!0}})],k.prototype,"timeExtent",void 0);g.__decorate([z.property({type:String,json:{write:!0}})],k.prototype,"upperBoundaryAlias",void 0);g.__decorate([z.property({type:String,json:{read:p.unitsKebabDict.read,
write:{writer:p.unitsKebabDict.write,overridePolicy(d){return{enabled:null!=d&&null!=this.distance}}}}})],k.prototype,"units",void 0);g.__decorate([z.property({type:String,json:{write:!0}})],k.prototype,"where",void 0);g=k=g.__decorate([h.subclass("esri.rest.support.AttributeBinsQuery")],k);k.from=w.ensureType(k);return g})},"esri/rest/support/AutoIntervalBinParameters":function(){define("../../chunks/tslib.es6 ../../core/object ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./BinParametersBase ./NormalizationBinParametersMixin".split(" "),
function(g,k,n,m,l,z,w,A,v,t){function h(f,r,c){k.setDeepValue(c,f instanceof Date?f.getTime():f,r)}l=class extends t.NormalizationBinParametersMixin(v){constructor(f){super(f);this.start=this.end=this.numBins=null;this.type="auto-interval"}};g.__decorate([n.property({type:Number,json:{name:"parameters.numberOfBins",write:!0}})],l.prototype,"numBins",void 0);g.__decorate([n.property({json:{name:"parameters.end",write:{writer:h}}})],l.prototype,"end",void 0);g.__decorate([n.property({json:{name:"parameters.start",
write:{writer:h}}})],l.prototype,"start",void 0);g.__decorate([w.enumeration({autoIntervalBin:"auto-interval"},{readOnly:!0})],l.prototype,"type",void 0);g=l=g.__decorate([A.subclass("esri.rest.support.AutoIntervalBinParameters")],l);l.from=m.ensureType(l);return g})},"esri/rest/support/BinParametersBase":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./AttributeBinsGrouping".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h){z=new n.JSONMap({esriFieldTypeSmallInteger:"small-integer",esriFieldTypeInteger:"integer",esriFieldTypeSingle:"single",esriFieldTypeDouble:"double",esriFieldTypeLong:"long",esriFieldTypeDate:"date",esriFieldTypeDateOnly:"date-only",esriFieldTypeTimeOnly:"time-only",esriFieldTypeTimestampOffset:"timestamp-offset"});n=new n.JSONMap({naturalLog:"natural-log",squareRoot:"square-root"});k=class extends k.ClonableMixin(m){constructor(f){super(f);this.transformation=this.stackBy=
this.splitBy=this.hideUpperBound=this.firstDayOfWeek=this.field=this.expressionValueType=this.expression=null}};g.__decorate([l.property({type:String,json:{name:"onExpression.value",write:!0}})],k.prototype,"expression",void 0);g.__decorate([v.enumeration(z,{name:"onExpression.valueType"})],k.prototype,"expressionValueType",void 0);g.__decorate([l.property({type:String,json:{name:"onField",write:!0}})],k.prototype,"field",void 0);g.__decorate([l.property({type:String,json:{write:!0}})],k.prototype,
"firstDayOfWeek",void 0);g.__decorate([l.property({type:String,json:{write:!0}})],k.prototype,"hideUpperBound",void 0);g.__decorate([l.property({type:h,json:{write:{overridePolicy(){return{enabled:null!=this.splitBy?.value||null!=this.splitBy?.type}}}}})],k.prototype,"splitBy",void 0);g.__decorate([l.property({type:h,json:{write:{target:{stackBy:{type:h},jsonStyle:{type:String}},writer:(f,r)=>{f&&(r.stackBy=f.toJSON(),null!=f.responseType&&(r.jsonStyle=f.responseType))},overridePolicy(){return{enabled:null!=
this.stackBy?.value||null!=this.stackBy?.type}}},read:{source:["stackBy","jsonStyle"],reader:(f,r)=>h.fromJSON({...r.stackBy,responseType:r.jsonStyle})}}})],k.prototype,"stackBy",void 0);g.__decorate([v.enumeration(n)],k.prototype,"transformation",void 0);return k=g.__decorate([t.subclass("esri.rest.support.BinParametersBase")],k)})},"esri/rest/support/AttributeBinsGrouping":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w,A,v,t){n=new n.JSONMap({esriFieldTypeInteger:"integer",esriFieldTypeString:"string"});k=class extends k.ClonableMixin(m){constructor(h){super(h);this.valueType=this.value=this.type=this.responseType=this.alias=null}};g.__decorate([l.property({type:String,json:{name:"outAlias",write:!0}})],k.prototype,"alias",void 0);g.__decorate([l.property({type:String})],k.prototype,"responseType",void 0);g.__decorate([l.property({type:String,json:{write:!0}})],k.prototype,"type",void 0);
g.__decorate([l.property({type:String,json:{write:!0}})],k.prototype,"value",void 0);g.__decorate([v.enumeration(n)],k.prototype,"valueType",void 0);g=k=g.__decorate([t.subclass("esri.rest.support.AttributeBinsGrouping")],k);k.from=z.ensureType(k);return g})},"esri/rest/support/DateBinParameters":function(){define("../../chunks/tslib.es6 ../../core/object ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./BinParametersBase ./DateBinTimeInterval".split(" "),
function(g,k,n,m,l,z,w,A,v,t){function h(r,c,p){k.setDeepValue(p,"string"===typeof r?r:r?.getTime(),c)}function f(r,c){return(r=r.parameters[c])?"string"===typeof r?r:new Date(r):null}l=class extends v{constructor(r){super(r);this.snapToData=this.start=this.returnFullIntervalBin=this.offset=this.interval=this.end=null;this.type="date"}};g.__decorate([n.property({cast:r=>null!=r?"string"===typeof r?r:new Date(r):null,json:{name:"parameters.end",read:{reader:(r,c)=>f(c,"end")},write:{writer:h}}})],
l.prototype,"end",void 0);g.__decorate([n.property({type:t,json:{name:"parameters",write:!0}})],l.prototype,"interval",void 0);g.__decorate([n.property({type:t,json:{name:"parameters.offset",write:!0}})],l.prototype,"offset",void 0);g.__decorate([n.property({type:Boolean,json:{name:"parameters.returnFullIntervalBin",write:!0}})],l.prototype,"returnFullIntervalBin",void 0);g.__decorate([n.property({cast:r=>null!=r?"string"===typeof r?r:new Date(r):null,json:{name:"parameters.start",read:{reader:(r,
c)=>f(c,"start")},write:{writer:h}}})],l.prototype,"start",void 0);g.__decorate([n.property({type:String,json:{name:"parameters.snapToData",write:!0}})],l.prototype,"snapToData",void 0);g.__decorate([w.enumeration({dateBin:"date"},{readOnly:!0})],l.prototype,"type",void 0);g=l=g.__decorate([A.subclass("esri.rest.support.DateBinParameters")],l);l.from=m.ensureType(l);return g})},"esri/rest/support/DateBinTimeInterval":function(){define("../../chunks/tslib.es6 ../../core/Clonable ../../core/jsonMap ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w,A,v,t){n=n.strict()({year:"years",quarter:"quarters",month:"months",week:"weeks",day:"days",hour:"hours",minute:"minutes",second:"seconds"});k=class extends k.ClonableMixin(m){constructor(h){super(h);this.unit=this.value=null}};g.__decorate([l.property({type:Number,json:{name:"number",write:!0}})],k.prototype,"value",void 0);g.__decorate([v.enumeration(n)],k.prototype,"unit",void 0);g=k=g.__decorate([t.subclass("esri.rest.support.DateBinTimeInterval")],k);k.from=z.ensureType(k);
return g})},"esri/rest/support/FixedBoundariesBinParameters":function(){define("../../chunks/tslib.es6 ../../core/object ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./BinParametersBase".split(" "),function(g,k,n,m,l,z,w,A,v){l=class extends v{constructor(t){super(t);this.boundaries=[];this.type="fixed-boundaries"}};g.__decorate([n.property({json:{name:"parameters.boundaries",
write:{writer:function(t,h,f){k.setDeepValue(f,t&&t[0]instanceof Date?t.map(r=>r.getTime()):t,h)}}}})],l.prototype,"boundaries",void 0);g.__decorate([w.enumeration({fixedBoundariesBin:"fixed-boundaries"},{readOnly:!0})],l.prototype,"type",void 0);g=l=g.__decorate([A.subclass("esri.rest.support.FixedBoundariesBinParameters")],l);l.from=m.ensureType(l);return g})},"esri/rest/support/FixedIntervalBinParameters":function(){define("../../chunks/tslib.es6 ../../core/object ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/enumeration ../../core/accessorSupport/decorators/subclass ./BinParametersBase ./NormalizationBinParametersMixin".split(" "),
function(g,k,n,m,l,z,w,A,v,t){function h(f,r,c){k.setDeepValue(c,f instanceof Date?f.getTime():f,r)}l=class extends t.NormalizationBinParametersMixin(v){constructor(f){super(f);this.start=this.interval=this.end=null;this.type="fixed-interval"}};g.__decorate([n.property({json:{name:"parameters.end",write:{writer:h}}})],l.prototype,"end",void 0);g.__decorate([n.property({type:Number,json:{name:"parameters.interval",write:!0}})],l.prototype,"interval",void 0);g.__decorate([n.property({json:{name:"parameters.start",
write:{writer:h}}})],l.prototype,"start",void 0);g.__decorate([w.enumeration({fixedIntervalBin:"fixed-interval"},{readOnly:!0})],l.prototype,"type",void 0);g=l=g.__decorate([A.subclass("esri.rest.support.FixedIntervalBinParameters")],l);l.from=m.ensureType(l);return g})},"esri/views/2d/layers/LayerView2D":function(){define("exports ../../../chunks/tslib.es6 ../../../core/Collection ../../../core/collectionUtils ../../../core/Error ../../../core/reactiveUtils ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../linkChart/utils ../engine/Container ./support/HighlightCounter ./support/util ../support/highlightOptionsUtils ../../layers/support/ClipRect ../../layers/support/Geometry ../../layers/support/Path ../../support/HighlightOptions ../../support/layerViewUtils".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f,r,c,p,x,u,E,H,O,J){const S=n.ofType({key:"type",base:null,typeMap:{rect:u,path:H,geometry:E}}),T=new (n.ofType(O));g.LayerView2DMixin=B=>{B=class extends B{constructor(){super(...arguments);this._highlightCounter=new c.HighlightCounter;this.attached=!1;this.clips=new S;this.highlights=null;this.lastUpdateId=-1;this.updateRequested=this.moving=!1;this._visibleAtCurrentScale=!0}initialize(){const d=this.view?.spatialReferenceLocked??!0;this.view?.spatialReference&&d&&
!this.spatialReferenceSupported?this.addResolvingPromise(Promise.reject(new l("layerview:spatial-reference-incompatible","The spatial reference of this layer does not meet the requirements of the view",{layer:this.layer}))):(this.container||(this.container=new r.Container),this.container.fadeTransitionEnabled=!0,this.container.visible=!1,this.container.endTransitions(),this.addHandles([z.watch(()=>this.suspended,D=>{this.container&&(this.container.visible=!D)},z.syncAndInitial),z.watch(()=>this.updateSuspended,
D=>{this.view&&!D&&this.updateRequested&&this.view.requestUpdate()},z.syncAndInitial),z.watch(()=>this.layer?.opacity??1,D=>{this.container&&(this.container.opacity=D)},z.syncAndInitial),z.watch(()=>this.layer&&"blendMode"in this.layer?this.layer.blendMode:"normal",D=>{this.container&&(this.container.blendMode=D)},z.syncAndInitial),z.watch(()=>this.layer&&"effect"in this.layer?this.layer.effect:null,D=>{this.container&&(this.container.effect=D)},z.syncAndInitial),z.watch(()=>this._mergedHighlights.items.map(D=>
({name:D.name,options:{fillColor:D.color,haloColor:D.haloColor,fillOpacity:D.fillOpacity,haloOpacity:D.haloOpacity,haloWidth:D.haloWidth,haloBlur:D.haloBlur}})),()=>{this.container.highlightGradient=p.createOrReuseHighlightGradient(this.container.highlightGradient,this._mergedHighlights.items)},z.syncAndInitial),z.watch(()=>this._mergedHighlights.items.map(D=>D.name),()=>{this._processHighlight()}),z.on(()=>this.clips,"change",()=>{this.container&&(this.container.clips=this.clips)},z.syncAndInitial),
z.watch(()=>({scale:this.view?.scale,scaleRange:this.layer&&"effectiveScaleRange"in this.layer?this.layer.effectiveScaleRange:null}),({scale:D,scaleRange:I})=>{D=J.isInEffectiveScaleRange(I,D);D!==this._visibleAtCurrentScale&&(this._visibleAtCurrentScale=D)},z.syncAndInitial)],"constructor"),this.view?.whenLayerView?this.view.whenLayerView(this.layer).then(D=>{D===this&&this.processAttach()},()=>{}):this.when().then(()=>{this.processAttach()},()=>{}))}destroy(){this.processDetach();this.updateRequested=
!1}get highlightOptions(){return x.getDefaultHighlightOptions(this)}set highlightOptions(d){x.setDefaultHighlightOptions(this,d)}get hasHighlight(){return 0<this._highlightCounter.size}get _mergedHighlights(){if(!this.view)return T;if(!this.highlights)return this.view.highlights;const d=this.view.highlights.clone();for(const D of this.highlights){const I=d.find(Q=>Q.name===D.name);I&&I.assignFrom(D)}return d}get highlightIds(){return Array.from(this._highlightCounter.objectIds)}get scheduler(){return this.view.scheduler}get spatialReferenceSupported(){const d=
this.view?.spatialReference;return null==d||this.supportsSpatialReference(d)}get updating(){return this.spatialReferenceSupported&&(!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())||!!this._updatingHandles?.updating||this.container.transitioning)}get visibleAtCurrentScale(){return this._visibleAtCurrentScale}processAttach(){this.isResolved()&&!this.attached&&!this.destroyed&&this.spatialReferenceSupported&&(this.attach(),this.attached=!0,this.requestUpdate())}processDetach(){this.attached&&
(this.attached=!1,this.removeHandles("attach"),this.detach(),this.updateRequested=!1)}requestUpdate(){this.destroyed||this.updateRequested||(this.updateRequested=!0,this.updateSuspended||this.view.requestUpdate())}processUpdate(d){this.isFulfilled()&&!this.isResolved()?this.updateRequested=!1:(this._set("updateParameters",d),this.updateRequested&&!this.updateSuspended&&(this.updateRequested=!1,this.update(d)))}hitTest(d,D){return Promise.resolve(null)}supportsSpatialReference(d){return!0}canResume(){if(!this.spatialReferenceSupported)return!1;
switch(this.layer?.type){case "link-chart":case "knowledge-graph-sublayer":case "graphics":break;default:if(f.isLinkChartView(this.view)&&!this.view.inGeographicLayout)return!1}return super.canResume()?this.visibleAtCurrentScale:!1}getSuspendInfo(){const d=super.getSuspendInfo(),D=!this.spatialReferenceSupported;D&&(d.spatialReferenceNotSupported=D);return d}addAttachHandles(d){this.addHandles(d,"attach")}_addHighlights(d,D){this._highlightCounter.add(d,D)&&this._processHighlight()}_removeHighlights(d,
D){this._highlightCounter.delete(d,D)&&this._processHighlight()}_processHighlight(){}_getHighlights(){const d=[];for(const [D,I]of this._highlightCounter.highlightNamesByObjectId){const Q=this._getHighlightBits(I);d.push({objectId:D,highlightFlags:Q})}return d}_getHighlightBits(d){d=new Set(d);let D=1,I=0;if(!this.view)return 0;const Q=this._mergedHighlights;for(const {name:L}of Q)d.delete(L)&&(I=D),D<<=1;return I}};k.__decorate([w.property()],B.prototype,"attached",void 0);k.__decorate([w.property({type:S,
set(d){d=m.referenceSetter(d,this._get("clips"),S);this._set("clips",d)}})],B.prototype,"clips",void 0);k.__decorate([w.property()],B.prototype,"container",void 0);k.__decorate([w.property({type:O})],B.prototype,"highlightOptions",null);k.__decorate([w.property({type:n.ofType(O)})],B.prototype,"highlights",void 0);k.__decorate([w.property()],B.prototype,"_mergedHighlights",null);k.__decorate([w.property()],B.prototype,"moving",void 0);k.__decorate([w.property({readOnly:!0})],B.prototype,"spatialReferenceSupported",
null);k.__decorate([w.property({readOnly:!0})],B.prototype,"updateParameters",void 0);k.__decorate([w.property()],B.prototype,"updateRequested",void 0);k.__decorate([w.property()],B.prototype,"updating",null);k.__decorate([w.property()],B.prototype,"view",void 0);k.__decorate([w.property()],B.prototype,"_visibleAtCurrentScale",void 0);k.__decorate([w.property({readOnly:!0})],B.prototype,"visibleAtCurrentScale",null);return B=k.__decorate([h.subclass("esri.views.2d.layers.LayerView2D")],B)};Object.defineProperty(g,
Symbol.toStringTag,{value:"Module"})})},"esri/linkChart/utils":function(){define(["exports"],function(g){g.isLinkChartView=function(k){return null!=k&&"object"===typeof k&&"2d"===k.type&&"linkchart"===k.view2dType};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/HighlightCounter":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/MapUtils ../../../../core/ReactiveMap ../../../../core/Logger ../../../../core/has ../../../../core/RandomLCG ../../../../core/Error ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w,A,v,t){function*h(f){for(const [r,c]of f)yield[r,c.keys()]}g.HighlightCounter=class extends n{constructor(){super(...arguments);this._idToCounters=new l}get size(){return this._idToCounters.size}get objectIds(){return this._idToCounters.keys()}get highlightNamesByObjectId(){return h(this._idToCounters)}add(f,r){let c=!1;for(const p of f){f=m.getOrCreateMapValue(this._idToCounters,p,()=>{c=!0;return new Map});const x=f.get(r)??0;x||(c=!0);f.set(r,x+1)}return c}delete(f,r){let c=
!1;for(const p of f){f=this._idToCounters.get(p);if(!f)continue;let x=f.get(r);null!=x&&(x--,0<x?f.set(r,x):(f.delete(r),c=!0),0===f.size&&(this._idToCounters.delete(p),c=!0))}return c}};g.HighlightCounter=k.__decorate([t.subclass("esri.views.2d.layers.support.HighlightCounter")],g.HighlightCounter);Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/ClipRect":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(g,k,n,m,l,z,w){var A;n=A=class extends w{constructor(v){super(v);this.type="rect";this.bottom=this.top=this.right=this.left=null}clone(){return new A({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}commitVersionProperties(){this.commitProperty("left");this.commitProperty("right");this.commitProperty("top");this.commitProperty("bottom")}};g.__decorate([k.property({type:[Number,String],json:{write:!0}})],n.prototype,"left",void 0);g.__decorate([k.property({type:[Number,String],
json:{write:!0}})],n.prototype,"right",void 0);g.__decorate([k.property({type:[Number,String],json:{write:!0}})],n.prototype,"top",void 0);g.__decorate([k.property({type:[Number,String],json:{write:!0}})],n.prototype,"bottom",void 0);return n=A=g.__decorate([z.subclass("esri.views.layers.support.ClipRect")],n)})},"esri/views/layers/support/ClipArea":function(){define("../../../chunks/tslib.es6 ../../../core/JSONSupport ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w){k=class extends k{get version(){this.commitVersionProperties();return(this._get("version")||0)+1}};g.__decorate([n.property({readOnly:!0})],k.prototype,"version",null);return k=g.__decorate([w.subclass("esri.views.layers.support.ClipArea")],k)})},"esri/views/layers/support/Geometry":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ../../../geometry/Extent ../../../geometry/Geometry ../../../geometry/Polygon ../../../geometry/support/jsonUtils ./ClipArea".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h){var f;n={base:A,key:"type",typeMap:{extent:w,polygon:v}};h=f=class extends h{constructor(r){super(r);this.type="geometry";this.geometry=null}clone(){return new f({geometry:this.geometry?.clone()??null})}commitVersionProperties(){this.commitProperty("geometry")}};g.__decorate([k.property({types:n,json:{read:t.fromJSON,write:!0}})],h.prototype,"geometry",void 0);return h=f=g.__decorate([z.subclass("esri.views.layers.support.Geometry")],h)})},"esri/views/layers/support/Path":function(){define("../../../chunks/tslib.es6 ../../../core/accessorSupport/decorators/property ../../../core/has ../../../core/Logger ../../../core/RandomLCG ../../../core/accessorSupport/decorators/subclass ./ClipArea".split(" "),
function(g,k,n,m,l,z,w){n=class extends w{constructor(A){super(A);this.type="path";this.path=[]}commitVersionProperties(){this.commitProperty("path")}};g.__decorate([k.property({type:[[[Number]]],json:{write:!0}})],n.prototype,"path",void 0);return n=g.__decorate([z.subclass("esri.views.layers.support.Path")],n)})},"esri/views/2d/layers/features/FeatureContainer":function(){define("exports ../../../../core/has ../../../../core/promiseUtils ../../../../core/support/UpdatingHandles ../../engine/AFeatureContainer ../../engine/webgl/enums ../../engine/webgl/shaderGraph/techniques/FeatureInstanceStore ../../engine/webgl/shaderGraph/techniques/TechniqueRegistry ../../engine/webgl/shaderGraph/techniques/TechniqueType ./RenderState ../support/util".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h){class f{constructor(c,p){this.id=c;this.version=p;this._resolver=n.createResolver();this._done=!1}get done(){return this._done}get promise(){return this._resolver.promise}end(){this._resolver.resolve();this._done=!0}destroy(){this._resolver.reject()}}class r extends l.AFeatureContainer{constructor(c){super(c.view.featuresTilingScheme);this.updatingHandles=new m.UpdatingHandles;this._hitTestsRequests=[];this._store=new w;this._visibleTiles=new Set;this._subscriptions=
new Map;this._updateStatisticsRequests=[];this._shouldUnlockAttributeView=this._lockStatisticUpdates=!1;this._layerView=c;this.addTransitionable(this._layerView.featureEffectView)}renderChildren(c){this._updateAttributeView();this._renderState?.update(this.attributeView.currentEpoch);if(this._renderState){const p=Array.from(this._renderState.tiles()).filter(x=>x.needsUpload);p.length&&(p[Math.floor(Math.random()*p.length)].upload(),2<=p.length&&this.requestRender());for(const x of this._renderState.tiles())x.tryReady(this.attributeView.currentEpoch)&&
(this._subscriptions.get(x.key.id)?.end(),this._layerView.requestUpdate(),this.hasLabels&&this._layerView.view.labelManager.requestUpdate(),this.requestRender())}for(const p of this.children)p.setTransform(c.state);super.renderChildren(c);switch(c.drawPhase){case z.WGLDrawPhase.MAP:return this._renderMapPhase(c);case z.WGLDrawPhase.HIGHLIGHT:return this._renderHighlightPhase(c);case z.WGLDrawPhase.LABEL:return this._renderLabelPhase(c)}}subscriptions(){return this._subscriptions.values()}get _instanceStore(){return this._store}get instanceStore(){return this._store}get layerView(){return this._layerView}get hasLabels(){return 0<
this._layerView.labelingCollisionInfos.length}get hasHighlight(){return this._layerView.hasHighlight}get _layer(){return this._layerView.layer}_getHeatmapInstance(c){if(null==this._instanceStore||!(c.drawPhase&A.Techniques.heatmap.drawPhase))return null;for(const p of this._instanceStore.values())if(p.techniqueRef.type===v.TechniqueType.Heatmap)return p;return null}get children(){return this._renderState?Array.from(this._renderState.tiles()).filter(c=>this._visibleTiles.has(c.key.id)):[]}updateAttributeView(c){this.requestRender();
this.attributeView.requestUpdate(c);this.hasLabels&&this._layerView.view.labelManager.requestUpdate()}updateSubscriptions(c){for(const {tileId:p,version:x}of c.subscribe)if(this._subscriptions.has(p))this._subscriptions.get(p).version=x;else{const u=new f(p,x);this._subscriptions.set(p,u);this.updatingHandles.addPromise(u.promise)}for(const p of c.unsubscribe)this._subscriptions.get(p)?.destroy(),this._subscriptions.delete(p),this.removeTile(p)}isDone(c){return this._renderState?this._renderState.isTileDone(c):
!1}async updateRenderState(c){k("esri-2d-update-debug")&&console.debug(`Version[${c}] FeatureContainer.updateRenderState`);this._renderStateNext=new t.RenderState(()=>this._stage,p=>this._subscriptions.get(p)?.version,c,this.tileInfoView)}getDisplayStatistics(c,p){return(c=this._statisticsByLevel.get(c))?c.get(p):null}updateStatistics(c,p){if(this._lockStatisticUpdates)this._updateStatisticsRequests.push({level:c,statistics:p});else{var x=this._statisticsByLevel.get(c);x||(x=new Map,this._statisticsByLevel.set(c,
x));for(const u of p)x.set(u.fieldName,{minValue:u.minValue,maxValue:u.maxValue})}}lockForOverrides(){this._renderState?.lockUploads();this._lockStatisticUpdates=!0;this.attributeView.locked||(this.attributeView.lockTextureUploads(),this._shouldUnlockAttributeView=!0)}unlockForOverrides(){this._renderState?.unlockUploads();this._shouldUnlockAttributeView&&(this.attributeView.unlockTextureUploads(),this._shouldUnlockAttributeView=!1);this._lockStatisticUpdates=!1;for(const c of this._updateStatisticsRequests)this.updateStatistics(c.level,
c.statistics);this._updateStatisticsRequests=[];this._renderState?.flush();this.requestRender()}trySwapRenderState(){this._renderStateNext&&(k("esri-2d-update-debug")&&console.debug(`Version[${this._renderStateNext.version}] FeatureContainer.update.swapRenderState`),this._renderState?.destroy(),this._renderState=this._renderStateNext,this._renderState.flush(),this._renderStateNext=null);this.requestRender()}setVisibleTiles(c){this._visibleTiles=c}async onMessage(c,p){n.throwIfAborted(p);p=c.inner;
if(this._subscriptions.has(p.id)){var x=this._subscriptions.get(p.id);if(x.version!==p.subscriptionVesrion)k("esri-2d-update-debug")&&console.debug(`Version[${`${p.subscriptionVesrion} != ${x.version}`}] Tile[${p.id}] FeatureContainer - Dropping message, outdated version]`,p);else{x=this._renderStateNext??this._renderState;if(!x)throw Error("InternalError: No renderState defined");x.version!==p.version&&console.error(`InternalError: Version mismatch. [renderState: ${x.version}, message: ${p.version}]`);
x.enqueueUpdate(c);this.requestRender();this._layerView.view.labelManager.requestUpdate();this._layerView.requestUpdate()}}}removeTile(c){if(this._renderState||this._renderStateNext)this._renderState&&this._renderState.removeTile(c),this._renderStateNext&&this._renderStateNext.removeTile(c)}hitTest(c){let p=this._hitTestsRequests.find(({x:u,y:E})=>u===c.x&&E===c.y);const x=n.createResolver();p?p.resolvers.push(x):(p={x:c.x,y:c.y,resolvers:[x]},this._hitTestsRequests.push(p));this.requestRender();
return x.promise}getSortKeys(c){c=new Set(c);const p=new Map;for(const x of this.children)if(x.getSortKeys(c).forEach((u,E)=>p.set(E,u)),p.size===c.size)break;return p}get hasAnimation(){return this.hasLabels}doRender(c){const {minScale:p,maxScale:x}=this._layer.effectiveScaleRange,u=c.state.scale;u<=(p||Infinity)&&u>=x&&super.doRender(c)}afterRender(c){super.afterRender(c);this._hitTestsRequests.length&&this.requestRender()}setStencilReference(c){if(null!=this._getHeatmapInstance(c))for(const p of this.children)p.stencilRef=
A.Techniques.heatmap.getStencilReference(p);else super.setStencilReference(c)}_renderMapPhase(c){this._layerView.featureEffectView.hasEffects?(this._renderOutsideEffect(c),this._renderInsideEffect(c)):this._renderFeatures(c,z.FeatureSelection.All);0<this._hitTestsRequests.length&&this._renderHittest(c)}_renderHighlightPhase(c){this.hasHighlight&&h.renderHighlight(c,!1,p=>{this._renderFeatures(p,z.FeatureSelection.Highlight)})}_renderLabelPhase(c){this._renderFeatures(c,z.FeatureSelection.All)}_renderInsideEffect(c){const p=
c.painter.effects.insideEffect;p.bind(c);this._renderFeatures(c,z.FeatureSelection.InsideEffect);p.draw(c,this._layerView.featureEffectView.includedEffects);p.unbind()}_renderOutsideEffect(c){const p=c.painter.effects.outsideEffect;p.bind(c);this._renderFeatures(c,z.FeatureSelection.OutsideEffect);p.draw(c,this._layerView.featureEffectView.excludedEffects);p.unbind()}_renderHittest(c){const {context:p}=c,x=c.painter.effects.hittest,u=p.getBoundFramebufferObject(),E=p.getViewport(),H=c.passOptions,
O=c.drawPhase;x.bind(c);c.passOptions=x.createOptions(c,this._hitTestsRequests);c.drawPhase=z.WGLDrawPhase.HITTEST;const {distance:J,smallSymbolDistance:S}=c.passOptions,T=Math.max(J,S);for(const B of this.children)B.visible&&B.containsScreenPoint(c.state,c.passOptions.position,2*T)&&this._renderTile(B,c,z.FeatureSelection.All);x.draw(c);x.unbind();p.bindFramebuffer(u);p.restoreViewport(E);c.passOptions=H;c.drawPhase=O}_renderFeatures(c,p){const x=this._getHeatmapInstance(c);null!=x?this._renderHeatmapFeatures(c,
p,x):this._renderGeometryFeatures(c,p)}_renderGeometryFeatures(c,p){for(const x of this.children)x.visible&&this._renderTile(x,c,p)}_renderHeatmapFeatures(c,p,x){for(const u of this.children)u.visible&&this._renderTile(u,c,p,v.TechniqueType.Heatmap);x.techniqueRef.renderResolvePass(c,x)}_renderTile(c,p,x,u){const E=k("featurelayer-strict-draw-order")?z.FeatureBatchingStrategy.STRICT_ORDER:k("featurelayer-force-marker-text-draw-order")?z.FeatureBatchingStrategy.STRICT_MARKERS_AND_TEXT:z.FeatureBatchingStrategy.BATCHING;
c=c.getDisplayList(this._instanceStore,E);p.selection=x;c?.render(p,u)}}g.FeatureContainer=r;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/engine/webgl/shaderGraph/techniques/FeatureInstanceStore":function(){define(["../../../../../../core/string","./TechniqueInstance","./mesh/instanceIdUtils"],function(g,k,n){class m{constructor(){this._instanceById=new Map}destroy(){this._instanceById.clear()}get size(){return this._instanceById.size}entries(){return this._instanceById.entries()}updateStart(){this._instanceByIdNext=
new Map;this._shaderCountByMesh=new Map;this._shaderIndices=new Map}updateEnd(){if(!this._instanceByIdNext)throw Error("InternalError: Found updateEnd call without corresponding updateStart");for(var l of this._instanceById.keys())this._instanceByIdNext.has(l)||this._instanceById.delete(l);for(const [z,w]of this._instanceByIdNext.entries())(l=this._instanceById.get(z))?l.setInput(w.getInput()):this._instanceById.set(z,w);this._shaderIndices=this._shaderCountByMesh=this._instanceByIdNext=null}values(){return this._instanceById.values()}ensureInstance(l,
z){if("object"===typeof z&&"optionalAttributes"in z&&"uniforms"in z){var w=`${l.type}.${JSON.stringify(z.optionalAttributes)}`;const A=w+`.${JSON.stringify(z.uniforms)}`;let v=0;null!=this._instanceByIdNext&&(this._shaderIndices.has(A)?v=this._shaderIndices.get(A):(v=this._shaderCountByMesh.get(w)??0,this._shaderCountByMesh.set(w,v+1),this._shaderIndices.set(A,v)));w+=`.${v}`}else w=`${l.type}.${JSON.stringify(z)}`;w=g.numericHash(w);if(this._instanceByIdNext)return l=new k.FeatureTechniqueInstance(n.castInstanceId(w),
l,z),this._instanceByIdNext.set(w,l),l;this._instanceById.has(w)||(l=new k.FeatureTechniqueInstance(n.castInstanceId(w),l,z),this._instanceById.set(w,l));return this._instanceById.get(w)}getInstance(l){const z=this._instanceById.get(l);if(null==z)throw Error(`InternalError: Unable to get instance for ${l}`);return z}}return m})},"esri/views/2d/layers/features/RenderState":function(){define("exports ../../../../core/CircularArray ../../../../core/Error ../../../../core/has ../../../../core/Logger ../../../../geometry/support/aaBoundingRect ../../tiling/TileInfoView ../../tiling/TileKey ../../tiling/TileQueue ../../tiling/TileStrategy ../../engine/webgl/FeatureTile".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h){class f{constructor(r,c,p,x){this.getStage=r;this.getSubscriptionVersion=c;this.version=p;this._tileInfoView=x;this._pendingUpdates=new k(1E3);this._locked=!1;this._tiles=new Map}destroy(){for(const r of this.tiles())r.destroy();this._pendingUpdates.clear();this._tiles.clear()}tiles(){return this._tiles.values()}size(){return this._tiles.size}setTiles(r){this._tiles.clear();for(const c of r)this._tiles.set(c.key.id,c)}lockUploads(){this._locked=!0}unlockUploads(){this._locked=
!1;this.flush()}enqueueUpdate(r){this._pendingUpdates.enqueue(r)}update(r){if(!this._locked)for(;this._pendingUpdates.size;){const c=this._pendingUpdates.peek();if(null==c||c.inner.attributeEpoch>r)break;this._updateTile(c);this._pendingUpdates.dequeue()}}removeTile(r){const c=this._tiles.get(r);m("esri-2d-update-debug")&&console.debug(`Tile[${r}] RenderState.removeTile`);c?.destroy();this._tiles.delete(r)}isTileDone(r){return(r=this._tiles.get(r.id))?r.isReady:!1}flush(){for(;this._pendingUpdates.size;){const r=
this._pendingUpdates.dequeue();null!=r&&this._updateTile(r)}for(const r of this._tiles.values())r.upload()}_updateTile(r){const {inner:c,objectIdMap:p}=r;r=this.getSubscriptionVersion(c.id);if(r!==c.subscriptionVesrion)m("esri-2d-update-debug")&&console.debug(`Version[${`${c.subscriptionVesrion} != ${r}`}] Tile[${c.id}] FeatureContainer - Dropping message, outdated version]`,c);else if(m("esri-2d-update-debug")&&console.debug(`Version[${c.version}] Tile[${c.id}] Chunk[${c.debugInfo?.chunkId??"\x3cEnsureEnd\x3e"}] RenderState.updateTile [${c.type}]`,
c),r=this._ensureTile(c.id),"update"===c.type){const [O,...J]=c.modify;r.onMessage({type:"update",modify:O,remove:c.remove,end:c.end,attributeEpoch:c.attributeEpoch,objectIdMap:p});for(var x of J){var u=this._tiles.get(x.tileId);if(u)u.onMessage({type:"update",modify:x,remove:c.remove,end:!1,isPixelBuffer:!0,attributeEpoch:null,objectIdMap:p})}}else if(null==c.append)r.onMessage({type:"append",clear:c.clear,debugInfo:c.debugInfo,end:c.end,attributeEpoch:c.attributeEpoch,objectIdMap:p});else{var [E,
...H]=c.append;r.onMessage({type:"append",clear:c.clear,append:E,debugInfo:c.debugInfo,end:c.end,attributeEpoch:c.attributeEpoch,objectIdMap:p});for(u of H)if(x=this._tiles.get(u.tileId))x.onMessage({type:"update",modify:u,remove:[],sort:!1,end:!1,isPixelBuffer:!0,attributeEpoch:null,objectIdMap:p})}}_ensureTile(r){if(!this._tiles.has(r)){const c=this._createTile(r);this._copyPixelBufferedEntitiesInto(c);this._tiles.set(r,c)}return this._tiles.get(r)}_createTile(r){m("esri-2d-update-debug")&&console.debug(`Version[${this.version}] Tile[${r}] RenderState.createTile`);
r=new A(r);var c=this._tileInfoView.getTileBounds(z.create(),r);const p=this._tileInfoView.getTileResolution(r.level);r=new h.FeatureTile(r,p,c[0],c[3],!0);r.stage=this.getStage();r.stage||(c=new n("featurelayerview:webgl","Cannot create tile with empty stage"),l.getLogger("esri.views.2d.layers.features.RenderState").error(c));return r}_copyPixelBufferedEntitiesInto(r){let c=7;const p=this._tileInfoView.getLODInfoAt(r.key);for(let u=-1;1>=u;u++)for(let E=-1;1>=E;E++)if(0!==u||0!==E){var x=r.key.getNormalizedNeighbor(E,
u,p).id;x=this._tiles.get(x);null!=x&&r.copyPixelBufferedEntitesFrom(x,1<<c,E,u);c--}}}g.RenderState=f;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/FeaturePipelineWorkerProxy":function(){define(["exports","../../../../core/workers/workers"],function(g,k){class n{constructor(m){this._connection=m;this.pipeline=this._connection.createInvokeProxy();this.features=this._connection.createInvokeProxy("features");this.aggregates=this._connection.createInvokeProxy("aggregates");
this.streamMessenger=this._connection.createInvokeProxy("streamMessenger")}destroy(){this._connection.destroy()}get closed(){return this._connection.closed}}g.FeaturePipelineWorkerProxy=n;g.createFeaturePipelineWorkerProxy=async function(m){m=await k.open("FeaturePipelineWorker",{client:m,strategy:"dedicated"});return new n(m)};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/FeatureSourceEventLog":function(){define("exports ../../../../chunks/tslib.es6 ../../../../core/Accessor ../../../../core/CircularArray ../../../../core/Evented ../../../../core/ReactiveMap ../../../../core/accessorSupport/decorators/property ../../../../core/has ../../../../core/Logger ../../../../core/RandomLCG ../../../../core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h){g.FeatureSourceEventLog=class extends n{constructor(){super(...arguments);this.events=new l;this._updatingStrategy=!0;this._tileToEvent=new z;this._fetchStatus={outstanding:0,done:0}}get hasAllData(){return!this._updatingStrategy&&this._hasAllTileData()}get willQueryAllFeatures(){return this._strategyInfo?.willQueryAllFeatures??!1}get willQueryFullResolutionGeometry(){return this._strategyInfo?.willQueryAllFeatures??!1}onEvent(f){switch(f.type){case "subscribe":case "unsubscribe":case "loaded":case "error":this._handleTileEvent(f);
break;case "updateStrategyStart":this._updatingStrategy=!0;this._fetchStatus={done:0,outstanding:0};this._strategyInfo=f.about;break;case "updateStrategyEnd":this._updatingStrategy=!1;break;case "updateFieldsStart":this._fetchStatus={done:0,outstanding:0};break;case "updateFieldsError":this.events.emit("error",f);break;case "fetchStart":this._fetchStatus.outstanding+=1;this.events.emit("status",this._fetchStatus);break;case "fetchEnd":this._fetchStatus.done+=1,this.events.emit("status",this._fetchStatus),
f.done&&(this._fetchStatus={done:0,outstanding:0})}}_hasAllTileData(){for(const f of this._tileToEvent.values())if("loaded"!==f.peekLast()?.type)return!1;return!0}_handleTileEvent(f){switch(f.type){case "subscribe":var r=new m(10);r.enqueue(f);this._tileToEvent.set(f.tile,r);break;case "unsubscribe":this._tileToEvent.delete(f.tile);break;case "loaded":r=this._tileToEvent.get(f.tile);if(!r)break;r.enqueue(f);this._tileToEvent.set(f.tile,r);break;case "error":if(r=this._tileToEvent.get(f.tile))r.enqueue(f),
this._tileToEvent.set(f.tile,r),this.events.emit("error",f)}}};k.__decorate([w.property({readOnly:!0})],g.FeatureSourceEventLog.prototype,"hasAllData",null);k.__decorate([w.property()],g.FeatureSourceEventLog.prototype,"willQueryAllFeatures",null);k.__decorate([w.property()],g.FeatureSourceEventLog.prototype,"willQueryFullResolutionGeometry",null);k.__decorate([w.property()],g.FeatureSourceEventLog.prototype,"_updatingStrategy",void 0);k.__decorate([w.property()],g.FeatureSourceEventLog.prototype,
"_strategyInfo",void 0);k.__decorate([w.property()],g.FeatureSourceEventLog.prototype,"_tileToEvent",void 0);g.FeatureSourceEventLog=k.__decorate([h.subclass("esri.views.2d.layers.features.FeatureSourceEventLog")],g.FeatureSourceEventLog);Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/CatalogFootprintLayerAdapter":function(){define("exports ../../../../../core/lang ../../../../../layers/support/arcgisLayerUrl ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w,A){class v{constructor(t){this.layer=t}getLabelingDeconflictionInfo(t){t=this.layer;const h=l.getLayerDeconflictionEnabled(t);return[{vvEvaluators:{0:l.createLabelVVEvaluator(t.renderer)},deconflictionEnabled:h}]}async createServiceOptions(t){var h=this.layer;const {capabilities:f,editingInfo:r,objectIdField:c,globalIdField:p,datesInUnknownTimezone:x,dateFieldsTimeZone:u,orderBy:E,parsedUrl:H}=h,O=h.fieldsIndex.toJSON(),J=m.getServiceGeometryType(h),S=h.timeInfo?.toJSON();h=
h.spatialReference.toJSON();const T=k.clone(H);let B=c;if(E?.length){var d=!E[0].valueExpression&&E[0].field;d&&(B=d)}d=n.isHostedAgolService(T.path);t=t.spatialReference.toJSON();return{type:"feature-service",source:T,isSourceHosted:d,orderByFields:B,outSpatialReference:t,metadata:{timeReferenceUnknownClient:x,dateFieldsTimeZone:u,globalIdField:p,fieldsIndex:O,geometryType:J,objectIdField:c,timeInfo:S,spatialReference:h,outSpatialReference:t,subtypeField:null,subtypes:null,typeIdField:null,types:null},
queryMetadata:{maxRecordCount:f.query.maxRecordCount,supportsCompactGeometry:f.query.supportsCompactGeometry,supportsDefaultSpatialReference:f.query.supportsDefaultSpatialReference,supportsFormatPBF:f.query.supportsFormatPBF,supportsMaxRecordCountFactor:f.query.supportsMaxRecordCountFactor,supportsQuantization:f.query.supportsQuantization,lastEditDate:r?.lastEditDate?.getTime(),snapshotInfo:null}}}createSourceSchema(t,h){const {definitionExpression:f,displayFilterInfo:r,customParameters:c,timeExtent:p,
apiKey:x}=this.layer;return z.createFeatureSourceSchema({definitionExpression:f,displayFilterInfo:r,customParameters:c,timeExtent:p},t,h,x)}createProcessorSchema(t,h,f){const {fields:r,geometryType:c,orderBy:p,objectIdField:x,renderer:u,labelingInfo:E,labelsVisible:H}=this.layer,O={featureReduction:null,fields:r.map(J=>J.toJSON()),geometryType:c,labelingInfo:E,labelsVisible:H,objectIdField:x,orderBy:p??"default",renderer:u?.clone()};return w.createSimpleProcessorSchema(t,h,O,f)}get hasRequiredSupport(){return A.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(t){return[()=>
this.layer.apiKey,()=>this.layer.customParameters,()=>this.layer.definitionExpression,()=>this.layer.outFields,()=>this.layer.renderer,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>this.layer.orderBy]}setGraphicOrigin(t){t.origin={type:"catalog",layer:this.layer}}}g.CatalogFootprintLayerAdapter=v;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/geometryUtils":function(){define(["exports"],function(g){g.getServiceGeometryType=
function(k){switch(k.geometryType){case "point":return"esriGeometryPoint";case "polyline":return"esriGeometryPolyline";case "mesh":case "polygon":return"esriGeometryPolygon";case "multipatch":return"esriGeometryMultiPatch";case "multipoint":return"esriGeometryMultipoint";default:return null}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/labelingUtils":function(){define(["exports","../../../../../core/screenUtils","./featureReductionUtils",
"../../support/visualVariableSimpleUtils"],function(g,k,n,m){function l(z){return w=>k.pt2px(m.getSizeForValueSimple(w,z))}g.createLabelVVEvaluator=function(z){z=null!=z&&"visualVariables"in z&&z.visualVariables;if(!z)return null;for(const w of z)if("size"===w.type)return l(w);return null};g.getFeatureReductionDeconflictionEnabled=function(z,w){z=n.getEffectiveFeatureReduction(z,w);if(z?.labelsVisible&&z.labelingInfo?.length)return z.labelingInfo.every(A=>"none"!==A.deconflictionStrategy)};g.getLayerDeconflictionEnabled=
function(z){return(z.labelsVisible&&z.labelingInfo?.every(w=>"none"!==w.deconflictionStrategy))??!1};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/featureReductionUtils":function(){define(["exports"],function(g){g.getEffectiveFeatureReduction=function(k,n){return(k=k.featureReduction)&&"selection"!==k.type?!("maxScale"in k&&k.maxScale)||k.maxScale<n.scale?k:null:null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/visualVariableSimpleUtils":function(){define(["exports",
"../../../../core/mathUtils","../../../../renderers/support/lengthUtils","../../../../renderers/visualVariables/support/sizeVariableUtils"],function(g,k,n,m){function l(v,t){switch(t.transformationType){case m.TransformationType.Additive:var h=z(t.minSize,v);return v+(h||t.minDataValue);case m.TransformationType.Constant:return h=t.stops,h=h?.length&&h[0].size,null==h&&(h=t.minSize),z(h,v);case m.TransformationType.ClampedLinear:h=t.minDataValue;var f=t.maxDataValue,r=(v-h)/(f-h),c=z(t.minSize,v);
t=z(t.maxSize,v);v=v<=h?c:v>=f?t:c+r*(t-c);return v;case m.TransformationType.Proportional:return h=v/t.minDataValue,f=z(t.minSize,v),v=z(t.maxSize,v),k.clamp(h*f,f,v);case m.TransformationType.Stops:{const [p,x,u]=w(v,t.cache.ipData);p===x?v=z(t.stops[p].size,v):(h=z(t.stops[p].size,v),v=z(t.stops[x].size,v),v=h+(v-h)*u)}return v;case m.TransformationType.RealWorldSize:return h=n.meterIn[t.valueUnit],f=z(t.minSize,v),r=z(t.maxSize,v),{valueRepresentation:t}=t,c=null,c="area"===t?2*Math.sqrt(v/A)/
h:"radius"===t||"distance"===t?2*v/h:v/h,k.clamp(c,f,r);case m.TransformationType.Identity:return v;case m.TransformationType.Unknown:return null}}function z(v,t){return"number"===typeof v?v:l(t,v)}function w(v,t){if(t){var h=0,f=t.length-1;t.some((r,c)=>{if(v<r)return f=c,!0;h=c;return!1});return[h,f,(v-t[h])/(t[f]-t[h])]}}const A=Math.PI;g.getSizeForValueSimple=l;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schema/SourceSchema":function(){define(["exports",
"../../../../../core/sql"],function(g,k){g.createFeatureSourceSchema=function(n,m,l,z){const w=k.sqlAnd(n.definitionExpression,null!=n.subtypeCode?`${n.subtypeField} = ${n.subtypeCode}`:null),A=n.customParameters??{},v=m.displayFilterEnabled&&n.displayFilterInfo?n.displayFilterInfo.toJSON():null;z&&(A.token=z);return{type:"feature",mutable:{sourceRefreshVersion:l,availableFields:m.availableFields,displayFilterInfo:v,dataFilter:{definitionExpression:w,customParameters:A,gdbVersion:n.gdbVersion,historicMoment:n.historicMoment?.getTime(),
queryScaleRanges:n.queryScaleRanges??[],timeExtent:n.timeExtent?.toJSON()}}}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schema/processor/SimpleProcessorSchema":function(){define("exports ../../../../../../core/screenUtils ../../../../../../layers/support/OrderByInfo ../../../../engine/webgl/shaderGraph/techniques/TechniqueType ./LabelMatcherSchema ./MatcherSchema ./StorageSchema ./VisualVariablesSchema".split(" "),function(g,k,n,m,l,z,w,A){async function v(u,
E){var H=E.renderer;const O=A.createVisualVariableUniforms(H);H=await z.createMatcherSchema(u,H);u=await l.createLabelMatcherSchema(u,E,O);return{symbology:H,labels:u}}function t(u,E){return u.fields.map(H=>({...H.toJSON(),type:h(H,E)}))}function h(u,E){const {onStatisticExpression:H,onStatisticField:O,statisticType:J}=u;switch(J){case "min":case "max":case "avg":case "avg_angle":case "sum":case "count":return"esriFieldTypeDouble";case "mode":return H?({returnType:u}=H,u?"string"===u?"esriFieldTypeString":
"esriFieldTypeDouble":"esriFieldTypeString"):(u=E.find(S=>S.name===O))?u.type:"esriFieldTypeString"}}async function f(u,E,H,O,J){O=t(u,O.fields);var S=u.renderer;const T=await z.createMatcherSchema(E,S),B=w.createStorageSchema(S,[null,null]);S=A.createVisualVariableUniforms(S);E=await l.createLabelMatcherSchema(E,{geometryType:"polygon",labelingInfo:u.labelingInfo,labelsVisible:u.labelsVisible},S);S=x(T);u="geohash"===u.binType?{type:"geohash",fixBinLevel:u.fixedBinLevel??3}:{type:"grid",size:k.pt2px(u.size),
fixedBinLevel:u.fixedBinLevel};return{storage:B,mesh:{properties:{sortKey:null,timeZone:H.timeZone,returnMeshObjectId:S,displayRefreshVersion:J,currentUser:H.currentUser},strategy:{type:"binning",fields:O,index:u,featureFilter:H.filters[0]},factory:{labels:E,symbology:T}},expressionProperties:{timeExtent:H.timeExtent?.toJSON()}}}async function r(u,E,H,O,J){const S=t(u,O.fields),T={type:"cluster",feature:await z.createMatcherSchema(E,u.effectiveFeatureRenderer),cluster:await z.createMatcherSchema(E,
u.effectiveClusterRenderer)};var B=A.createVisualVariableUniforms(u.effectiveFeatureRenderer);E={type:"cluster",feature:await l.createLabelMatcherSchema(E,O,B),cluster:await l.createLabelMatcherSchema(E,{geometryType:"point",labelingInfo:u.labelingInfo,labelsVisible:u.labelsVisible},B)};O=w.createStorageSchema(u.effectiveFeatureRenderer,[null,null]);B=x(T);return{storage:O,mesh:{properties:{sortKey:null,timeZone:H.timeZone,displayRefreshVersion:J,returnMeshObjectId:B,currentUser:H.currentUser},strategy:{type:"cluster",
fields:S,featureFilter:H.filters[0],clusterRadius:k.pt2px(u.clusterRadius/2)},factory:{labels:E,symbology:T}},expressionProperties:{timeExtent:H.timeExtent?.toJSON()}}}async function c(u,E,H,O,J){const S=t(u,O.fields),T={type:"track",previousObservation:await z.createMatcherSchema(E,u.previousObservations.renderer),latestObservation:await z.createMatcherSchema(E,u.latestObservations.renderer),trackLine:await z.createMatcherSchema(E,u.trackLines.renderer)};E={type:"track",previousObservation:await l.createLabelMatcherSchema(E,
{geometryType:O.geometryType,labelingInfo:u.previousObservations.labelingInfo,labelsVisible:u.previousObservations.labelsVisible},A.createVisualVariableUniforms(u.previousObservations.renderer)),latestObservation:await l.createLabelMatcherSchema(E,{geometryType:O.geometryType,labelingInfo:u.latestObservations.labelingInfo,labelsVisible:u.latestObservations.labelsVisible},A.createVisualVariableUniforms(u.latestObservations.renderer)),trackLine:await l.createLabelMatcherSchema(E,{geometryType:"polyline",
labelingInfo:u.trackLines.labelingInfo,labelsVisible:u.trackLines.labelsVisible},A.createVisualVariableUniforms(u.trackLines.renderer))};O=w.createTrackStorageSchema(u,[null,null]);const B=x(T);return{storage:O,mesh:{properties:{sortKey:null,timeZone:H.timeZone,returnMeshObjectId:B,displayRefreshVersion:J,currentUser:H.currentUser},strategy:{type:"track",featureFilter:H.filters[0],fields:S,maxDisplayDuration:u.maxDisplayDuration?.toMilliseconds()??0,maxDisplayObservationsPerTrack:u.maxDisplayObservationsPerTrack,
showLatestObservation:u.latestObservations.visible,showPreviousObservations:u.previousObservations.visible,showTrackLine:u.trackLines.visible,timeField:u.timeField},factory:{labels:E,symbology:T}},expressionProperties:{timeExtent:H.timeExtent?.toJSON()}}}function p(u){return u.techniqueType===m.TechniqueType.AnimatedMarker}function x(u){return"simple"===u.type&&u.meshes.some(p)||"interval"===u.type&&(u.intervals.some(E=>E.meshes.some(p))||u.backgroundFill.some(p))||"map"===u.type&&(u.map.some(E=>
E.symbol.some(p))||u.backgroundFill.some(p))?!0:!1}g.createSimpleProcessorSchema=async function(u,E,H,O){var J=H.featureReduction;if(J)switch(J.type){case "binning":return f(J,u,E,H,O);case "cluster":return r(J,u,E,H,O)}if(H.trackInfo?.enabled)return c(H.trackInfo,u,E,H,O);J=H.orderBy;var S=H.renderer;S=null!=S&&"unique-value"===S.type&&S.orderByClassesEnabled;"default"!==J||S||(J=[new n({field:H.objectIdField,order:"descending"})]);"default"!==J&&J?.length?(J=J[0],S="ascending"===J.order?"asc":"desc",
J=J.field?{field:J.field,order:S}:J.valueExpression?{expression:J.valueExpression,order:S}:null):J=S?{byRenderer:!0,order:"asc"}:null;S=w.createStorageSchema(H.renderer,E.filters);u=await v(u,H);H=x(u.symbology);return{storage:S,mesh:{properties:{sortKey:J,timeZone:E.timeZone,returnMeshObjectId:H,displayRefreshVersion:O,currentUser:E.currentUser},strategy:{type:"feature"},factory:u},expressionProperties:{timeExtent:E.timeExtent?.toJSON()}}};g.getAggregateFields=t;Object.defineProperty(g,Symbol.toStringTag,
{value:"Module"})})},"esri/views/2d/layers/features/schema/processor/LabelMatcherSchema":function(){define(["exports","../../../../../../layers/support/labelingInfo","../../layerAdapters/geometryUtils","./symbols/SymbolSchema"],function(g,k,n,m){async function l(z,w,A,v){z=await m.createSymbolMeshSchemas(w,{path:`${A}`,schemaOptions:z,uniforms:v});return{maxScale:w.maxScale,minScale:w.minScale,expression:w.labelExpressionInfo?.expression??w.labelExpression,where:w.where,meshes:z}}g.createLabelMatcherSchema=
async function(z,w,A){var v=w.labelsVisible&&w.labelingInfo||[];w=n.getServiceGeometryType(w);v=k.validateLabelingInfo(v,w);return{type:"label",classes:await Promise.all(v.map((t,h)=>l(z,t,h,A)))}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schema/processor/symbols/SymbolSchema":function(){define("exports ../../../../../../../core/Logger ../../../../../../../core/screenUtils ../../../../../../../renderers/support/heatmapUtils ../../../../../../../symbols/SimpleFillSymbol ../../../../../../../symbols/SimpleLineSymbol ../../../../../../../symbols/SimpleMarkerSymbol ../../../../../../../symbols/cim/CIMSymbolHelper ../../../../../../../symbols/cim/enums ../../../../../../../symbols/cim/SDFHelper ../../../../../engine/webgl/alignmentUtils ../../../../../engine/webgl/color ../../../../../engine/webgl/definitions ../../../../../engine/webgl/shaderGraph/techniques/TechniqueRegistry ../schemaUtils ../VisualVariablesSchema ./ComplexSymbolSchema ./utils".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f,r,c,p,x,u,E){async function H(d,D){if(!d)return[];switch(d.type){case "simple-fill":return T(d,D);case "picture-fill":{var {outline:I}=d;const {uniforms:da,schemaOptions:ia}=D;var {store:Q}=ia,L=[];const sa=A.CIMSymbolHelper.createPictureFillRasterizationParam(d);if(sa){var {width:P,height:R,xoffset:e,yoffset:M,xscale:ca,yscale:Z}=d;d={color:[255,255,255,255],sprite:sa,height:R,aspectRatio:P/R,offsetX:e,offsetY:M,scaleX:ca,scaleY:Z,angle:0,applyRandomOffset:!1,sampleAlphaOnly:!1,
scaleProportionally:!1,effects:null,scaleInfo:null};"solid"===I?.style?d=[Q.ensureInstance(c.Techniques.complexOutlineFill,{uniforms:{visualVariableColor:da.visualVariableColor,visualVariableOpacity:da.visualVariableOpacity,visualVariableSizeScaleStops:da.visualVariableSizeOutlineScaleStops,visualVariableSizeMinMaxValue:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null},optionalAttributes:{zoomRange:!1}}).createMeshInfo({...d,...S(I,!!da.visualVariableSizeOutlineScaleStops)})]:(Q=
Q.ensureInstance(c.Techniques.complexFill,{uniforms:{visualVariableColor:da.visualVariableColor,visualVariableOpacity:da.visualVariableOpacity},optionalAttributes:{zoomRange:!1}}),L.push(Q.createMeshInfo(d)),I&&L.push(...B(I,D,!0)),d=L)}else d=[]}return d;case "simple-marker":return J(d,D);case "picture-marker":{const {uniforms:da,schemaOptions:ia}=D;({store:D}=ia);D=D.ensureInstance(c.Techniques.marker,{uniforms:{visualVariableColor:da.visualVariableColor,visualVariableOpacity:da.visualVariableOpacity,
visualVariableSizeMinMaxValue:da.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:da.visualVariableSizeScaleStops,visualVariableSizeStops:da.visualVariableSizeStops,visualVariableSizeUnitValue:da.visualVariableSizeUnitValue,visualVariableRotation:da.visualVariableRotation},optionalAttributes:{zoomRange:!1}});d=(I=A.CIMSymbolHelper.createPictureMarkerRasterizationParam(d))?[D.createMeshInfo({type:"picture",color:[255,255,255,255],height:d.height,width:d.width,offsetX:d.xoffset,offsetY:d.yoffset,
angle:d.angle,alignment:E.hasRotationVVUniform(da)?v.Alignment.MAP:v.Alignment.SCREEN,outlineColor:null,outlineSize:0,referenceSize:d.height,sprite:I,overrideOutlineColor:!1,hasSizeVV:E.hasSizeVVUniform(da),placement:null,effects:null,transforms:null,scaleInfo:null,minPixelBuffer:x.getMaxSizeVVSize(da)})]:[]}return d;case "simple-line":return B(d,D,!1);case "text":const {uniforms:Y,schemaOptions:oa}=D;({store:D}=oa);return[D.ensureInstance(c.Techniques.text,{uniforms:{visualVariableColor:Y.visualVariableColor,
visualVariableOpacity:Y.visualVariableOpacity,visualVariableRotation:Y.visualVariableRotation,visualVariableSizeMinMaxValue:Y.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:Y.visualVariableSizeScaleStops,visualVariableSizeStops:Y.visualVariableSizeStops,visualVariableSizeUnitValue:Y.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!1,clipAngle:!1,referenceSymbol:!1}}).createMeshInfo({boxBackgroundColor:d.backgroundColor?.toArray(),boxBorderLineColor:d.borderLineColor?.toArray(),
boxBorderLineSize:d.borderLineSize??0,color:d.color?.toArray()??[0,0,0,0],offsetX:d.xoffset,offsetY:d.yoffset,postAngle:d.angle,fontSize:d.font.size,decoration:d.font.decoration,haloColor:d.haloColor?.toArray()??[0,0,0,0],haloSize:d.haloSize??0,outlineColor:[0,0,0,0],outlineSize:0,lineWidth:d.lineWidth,lineHeightRatio:d.lineHeight,horizontalAlignment:d.horizontalAlignment,verticalAlignment:d.verticalAlignment,useCIMAngleBehavior:!1,glyphs:{type:"text-rasterization-param",resource:{type:"text",font:d.font.toJSON(),
textString:d.text,symbol:A.CIMSymbolHelper.createCIMTextSymbolfromTextSymbol(d)},overrides:[]},referenceSize:null,effects:null,placement:null,scaleInfo:null,transforms:null,scaleFactor:1,minPixelBuffer:x.getMaxSizeVVSize(Y),repeatLabel:null,repeatLabelDistance:null,allowOverrun:null,labelPosition:null})];case "label":const {schemaOptions:W,uniforms:fa}=D;({store:L}=W);D=d.symbol;const {allowOverrun:pa,repeatLabel:ja,repeatLabelDistance:la}=d;I={maxScale:d.maxScale??0,minScale:d.minScale??0};L=L.ensureInstance(c.Techniques.label,
{uniforms:{visualVariableColor:null,visualVariableOpacity:null,visualVariableRotation:fa.visualVariableRotation,visualVariableSizeMinMaxValue:fa.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:fa.visualVariableSizeScaleStops,visualVariableSizeStops:fa.visualVariableSizeStops,visualVariableSizeUnitValue:fa.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!0,clipAngle:!0,referenceSymbol:!0}});const [ma,na]=h.getAlignmentFromPlacement(d.labelPlacement);return[L.createMeshInfo({boxBackgroundColor:D.backgroundColor?.toArray(),
boxBorderLineColor:D.borderLineColor?.toArray(),boxBorderLineSize:D.borderLineSize??0,color:D.color?.toArray()??[0,0,0,0],offsetX:D.xoffset,offsetY:D.yoffset,postAngle:D.angle,fontSize:D.font.size,decoration:D.font.decoration,outlineColor:[0,0,0,0],outlineSize:0,haloColor:D.haloColor?.toArray()??[0,0,0,0],haloSize:D.haloSize??0,lineWidth:D.lineWidth,lineHeightRatio:D.lineHeight,horizontalAlignment:ma,verticalAlignment:na,repeatLabel:ja,repeatLabelDistance:n.pt2px(la),allowOverrun:pa,labelPosition:d.labelPosition,
scaleInfo:I,minPixelBuffer:x.getMaxSizeVVSize(fa),useCIMAngleBehavior:!1,glyphs:{type:"text-rasterization-param",resource:{type:"text",font:D.font.toJSON(),textString:D.text,symbol:A.CIMSymbolHelper.createCIMTextSymbolfromTextSymbol(D),primitiveName:"label-override"},useLegacyLabelEvaluationRules:null==d.labelExpressionInfo?.expression,overrides:[{type:"CIMPrimitiveOverride",valueExpressionInfo:{type:"CIMExpressionInfo",expression:d.labelExpressionInfo?.expression??d.labelExpression,returnType:"String"},
primitiveName:"label-override",propertyName:"textString",defaultValue:""}]},referenceSize:null,effects:null,placement:null,transforms:null,scaleFactor:1})];case "cim":return u.createComplexSymbolInstances(d.data,D);case "web-style":return d=await d.fetchCIMSymbol(),u.createComplexSymbolInstances(d.data,D);case "line-3d":return k.getLogger("esri.views.layers.FeatureLayerView").warn("unsupported-symbol",`Symbol of type "${d.type}" unsupported in MapView. Defaulting to simple-line`),B(new z,D,!1);case "point-3d":return k.getLogger("esri.views.layers.FeatureLayerView").warn("unsupported-symbol",
`Symbol of type "${d.type}" unsupported in MapView. Defaulting to simple-marker`),J(new w,D);case "polygon-3d":return k.getLogger("esri.views.layers.FeatureLayerView").warn("unsupported-symbol",`Symbol of type "${d.type}" unsupported in MapView. Defaulting to simple-fill`),T(new l,D);case "mesh-3d":case "label-3d":return k.getLogger("esri.views.layers.FeatureLayerView").warn("unsupported-symbol",`Symbol of type "${d.type}" unsupported in MapView. Ignoring`),[];case "CIMSymbolReference":throw Error("InternalError: CIMSymbolReference should already be resolved");
}}function O(d){if("path"===d.style){if(null==d.path)throw Error("Symbol with a style of type path must define a path");return{type:"sprite-rasterization-param",overrides:[],resource:{type:"path",path:d.path,asFill:!0}}}const D=A.CIMSymbolHelper.fromSimpleMarker(d);if("outline"in d&&d.outline&&"none"!==d.outline.style&&"solid"!==d.outline.style){if(!D||!D.symbolLayers)throw Error("Error handling marker! ");return{type:"sprite-rasterization-param",resource:D.symbolLayers[0],overrides:[]}}return{type:"sprite-rasterization-param",
resource:t.getSDFInfo(D),overrides:[]}}async function J(d,D){const {uniforms:I,schemaOptions:Q}=D;var {store:L}=Q;if("path"===d.style||d.outline&&"solid"!==d.outline.style&&"none"!==d.outline.style){L=A.CIMSymbolHelper.fromSimpleMarker(d);if(!L||!L.symbolLayers)throw Error("Error handling marker! ");I.visualVariableRotation&&(L.angleAlignment="Map");if("path"!==d.style){var P=L.symbolLayers[0];if(E.hasSizeVVUniform(D.uniforms)){var R=x.getMaxSizeVVSize(D.uniforms,0,1);R>P.size&&(d=R/P.size,P.size=
R,P=P.markerGraphics?.[0].symbol,(P.symbolLayers&&P.symbolLayers[0]).width*=d)}}return u.createComplexSymbolInstances({type:"CIMSymbolReference",symbol:L},D)}D=L.ensureInstance(c.Techniques.marker,{uniforms:{visualVariableColor:I.visualVariableColor,visualVariableOpacity:I.visualVariableOpacity,visualVariableSizeMinMaxValue:I.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:I.visualVariableSizeScaleStops,visualVariableSizeStops:I.visualVariableSizeStops,visualVariableSizeUnitValue:I.visualVariableSizeUnitValue,
visualVariableRotation:I.visualVariableRotation},optionalAttributes:{zoomRange:!1}});L=O(d);P=d.color?.toArray()??[0,0,0,0];"CIMVectorMarker"===L.resource.type&&(P=[255,255,255,255]);R=d.size;const e=null!=I.visualVariableColor&&("cross"===d.style||"x"===d.style);return[D.createMeshInfo({type:"simple",color:P,height:R,width:R*("triangle"===d.style?124/116:1),offsetX:d.xoffset,offsetY:d.yoffset,angle:d.angle,alignment:E.hasRotationVVUniform(I)?v.Alignment.MAP:v.Alignment.SCREEN,outlineColor:d.outline?.color?.toArray()??
[0,0,0,0],outlineSize:d.outline?.width??1,referenceSize:R,sprite:L,overrideOutlineColor:e,hasSizeVV:E.hasSizeVVUniform(I),placement:null,effects:null,transforms:null,scaleInfo:null,minPixelBuffer:x.getMaxSizeVVSize(I)})]}function S(d,D){const I=d.width;return{outlineColor:d.color?.toArray()||[0,0,0,1],width:I,referenceWidth:I,capType:d.cap??"round",joinType:d.join??"round",miterLimit:d.miterLimit,hasSizeVV:D}}async function T(d,D){if("cim"===d.type)return u.createComplexSymbolInstances(d.data,D);
var {style:I}=d;if(I&&"none"!==I&&"solid"!==I){{const {uniforms:P,schemaOptions:R}=D;var {store:Q}=R;I=d.color?.toArray()??[0,0,0,0];var L={type:"sprite-rasterization-param",resource:{type:"fill-style",style:d.style},overrides:[]};"solid"===d.outline?.style?d=[Q.ensureInstance(c.Techniques.patternOutlineFill,{uniforms:{visualVariableColor:P.visualVariableColor,visualVariableOpacity:P.visualVariableOpacity,visualVariableSizeScaleStops:P.visualVariableSizeOutlineScaleStops,visualVariableSizeMinMaxValue:null,
visualVariableSizeStops:null,visualVariableSizeUnitValue:null},optionalAttributes:{zoomRange:!1}}).createMeshInfo({color:I,...S(d.outline,!!P.visualVariableSizeOutlineScaleStops),sprite:L,scaleInfo:null,effects:null})]:(I=[],Q=Q.ensureInstance(c.Techniques.patternFill,{uniforms:{visualVariableColor:P.visualVariableColor,visualVariableOpacity:P.visualVariableOpacity},optionalAttributes:{zoomRange:!1}}).createMeshInfo({color:d.color?.toArray()??[0,0,0,0],sprite:L,scaleInfo:null,effects:null}),I.push(Q),
d.outline&&I.push(...B(d.outline,D,!0)),d=I)}return d}{const {uniforms:P,schemaOptions:R}=D;({store:Q}=R);L=d.color?.toArray()??[0,0,0,0];"none"!==d.style&&"solid"===d.outline?.style?d=[Q.ensureInstance(c.Techniques.outlineFill,{uniforms:{visualVariableColor:P.visualVariableColor,visualVariableOpacity:P.visualVariableOpacity,visualVariableSizeScaleStops:P.visualVariableSizeOutlineScaleStops,visualVariableSizeMinMaxValue:null,visualVariableSizeStops:null,visualVariableSizeUnitValue:null},optionalAttributes:{zoomRange:!1}}).createMeshInfo({color:L,
...S(d.outline,!!P.visualVariableSizeOutlineScaleStops),scaleInfo:null,effects:null})]:(I=[],"none"!==d.style&&(Q=Q.ensureInstance(c.Techniques.fill,{uniforms:{visualVariableColor:P.visualVariableColor,visualVariableOpacity:P.visualVariableOpacity},optionalAttributes:{zoomRange:!1}}).createMeshInfo({color:L,scaleInfo:null,effects:null}),I.push(Q)),d.outline&&I.push(...B(d.outline,D,!0)),d=I)}return d}function B(d,D,I){const {color:Q,style:L,width:P,cap:R,join:e}=d;var {schemaOptions:M}=D,{store:ca}=
M;M=[];var Z=I?{...x.noVisualVariables,visualVariableSizeScaleStops:D.uniforms.visualVariableSizeOutlineScaleStops}:D.uniforms;I={uniforms:{visualVariableColor:Z.visualVariableColor,visualVariableOpacity:Z.visualVariableOpacity,visualVariableSizeMinMaxValue:Z.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:Z.visualVariableSizeScaleStops,visualVariableSizeStops:Z.visualVariableSizeStops,visualVariableSizeUnitValue:Z.visualVariableSizeUnitValue},optionalAttributes:{zoomRange:!1}};Z={color:Q?.toArray()??
[0,0,0,0],width:P,referenceWidth:P,capType:R,joinType:e,miterLimit:d.miterLimit,hasSizeVV:E.hasSizeVVUniform(Z),effects:null,scaleInfo:null};null==L||"solid"===L?(ca=ca.ensureInstance(c.Techniques.line,I).createMeshInfo(Z),M.push(ca)):"none"!==L&&(ca=ca.ensureInstance(c.Techniques.texturedLine,I).createMeshInfo({...Z,offsetAlongLine:0,shouldScaleDash:!0,shouldSampleAlphaOnly:!1,isSDF:!0,sprite:{type:"sprite-rasterization-param",resource:{type:"dash",dashTemplate:A.slsDashToTemplateArray(L,R)},overrides:[]}}),
M.push(ca));if(null!=d.marker){ca=M.push;I=d.marker;const {uniforms:Y,schemaOptions:oa}=D;({store:D}=oa);D=D.ensureInstance(c.Techniques.marker,{uniforms:{visualVariableColor:Y.visualVariableColor,visualVariableOpacity:Y.visualVariableOpacity,visualVariableSizeMinMaxValue:Y.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:Y.visualVariableSizeScaleStops,visualVariableSizeStops:Y.visualVariableSizeStops,visualVariableSizeUnitValue:Y.visualVariableSizeUnitValue,visualVariableRotation:Y.visualVariableRotation},
optionalAttributes:{zoomRange:!1}});Z=O(I);const W=6*d.width,fa=I.color?.toArray()??d.color?.toArray()??[0,0,0,0],pa="cross"===I.style||"x"===I.style;switch(I.placement){case "begin-end":I=v.ExtremityPlacement.Both;break;case "begin":I=v.ExtremityPlacement.JustBegin;break;case "end":I=v.ExtremityPlacement.JustEnd;break;default:I=v.ExtremityPlacement.None}I={type:"cim-marker-placement-param",placement:{type:"CIMMarkerPlacementAtExtremities",angleToLine:!0,offset:0,extremityPlacement:I,offsetAlongLine:0},
overrides:[]};d=[D.createMeshInfo({type:"simple",color:fa,height:W,width:W,offsetX:0,offsetY:0,angle:0,alignment:E.hasRotationVVUniform(Y)?v.Alignment.MAP:v.Alignment.SCREEN,outlineColor:fa,outlineSize:pa?d.width:0,referenceSize:W/6,sprite:Z,overrideOutlineColor:pa&&null!=Y.visualVariableColor,hasSizeVV:E.hasSizeVVUniform(Y),placement:I,transforms:null,effects:null,scaleInfo:null,minPixelBuffer:x.getMaxSizeVVSize(Y)})];ca.call(M,...d)}return M}g.createDotDensityMeshSchemas=async function(d,D){var {schemaOptions:I}=
D;({store:I}=I);var Q=Array(r.dotDensityMaxFields),L=Array(r.dotDensityMaxFields/4);for(var P=0;P<r.dotDensityMaxFields;P++){const R=P<d.attributes.length?d.attributes[P].color:null;Q[P]=[0,0,0,0];f.writeColor(Q[P],R)}for(P=0;P<r.dotDensityMaxFields/4;P++)L[P]=[0,0,0,0],L[P][0]=4*P<d.attributes.length?1:0,L[P][1]=4*P+1<d.attributes.length?1:0,L[P][2]=4*P+2<d.attributes.length?1:0,L[P][3]=4*P+3<d.attributes.length?1:0;Q=I.ensureInstance(c.Techniques.dotDensity,{uniforms:{isActive:L,colors:Q,dotValue:d.dotValue,
dotScale:d.referenceScale,blending:d.dotBlendingEnabled,dotSize:d.dotSize,seed:d.seed},optionalAttributes:{}}).createMeshInfo({effects:null});I=[];L=new l({color:d.backgroundColor??[0,0,0,0],outline:null});L=await H(L,D);I.push(...L);I.push(Q);d.outline&&(d=B(d.outline,D,!0),I.push(...d));return I};g.createHeatmapMeshSchemas=async function(d,D){({store:D}=D);const {radius:I,minDensity:Q,maxDensity:L,referenceScale:P,field:R,valueExpression:e,colorStops:M}=d;d=m.generateGradient(M);return[D.ensureInstance(c.Techniques.heatmap,
{uniforms:{radius:n.pt2px(I),minDensity:Q,maxDensity:L,referenceScale:P,isFieldActive:!(!R&&!e),gradient:d,gradientHash:d.join(",")},optionalAttributes:{}}).createMeshInfo({effects:null})]};g.createLineInstance=B;g.createPieChartMeshSchemas=async function(d,D){var {store:I}=D;const Q=d.outline?.width||0,L=x.createVisualVariableUniforms(d);I=I.ensureInstance(c.Techniques.pieChart,{uniforms:{shader:{outlineWidth:Math.round(n.pt2px(Q)),defaultColor:p.premultiplyColor(d.defaultColor),outlineColor:p.premultiplyColor(d.outline?.color),
othersColor:p.premultiplyColor(d.othersCategory?.color),donutRatio:d.holePercentage,sectorThreshold:d.othersCategory?.threshold||0,colors:d.attributes.map(P=>p.premultiplyColor(P.color)),visualVariableOpacity:L.visualVariableOpacity,visualVariableSizeMinMaxValue:L.visualVariableSizeMinMaxValue,visualVariableSizeScaleStops:L.visualVariableSizeScaleStops,visualVariableSizeStops:L.visualVariableSizeStops,visualVariableSizeUnitValue:L.visualVariableSizeUnitValue,hittestUniforms:null},numberOfFields:d.attributes.length},
optionalAttributes:{}}).createMeshInfo({size:d.size,outlineWidth:Q,effects:null,scaleInfo:null,minPixelBuffer:x.getMaxSizeVVSize(L)});return[...(d.backgroundFillSymbol?await T(d.backgroundFillSymbol,{schemaOptions:D,path:"",uniforms:x.noVisualVariables}):[]),I]};g.createSymbolMeshSchemas=H;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schema/processor/MatcherSchema":function(){define(["exports","./VisualVariablesSchema","./symbols/SymbolSchema"],function(g,
k,n){async function m(t,h){var f=h.symbols;f=f.length?f[0]:null;h=k.createVisualVariableUniforms(h);return{type:"simple",meshes:await n.createSymbolMeshSchemas(f,{schemaOptions:t,uniforms:h,path:"renderer.symbol"})}}async function l(t,h){const f=k.createVisualVariableUniforms(h);return{type:"dot-density",meshes:await n.createDotDensityMeshSchemas(h,{schemaOptions:t,uniforms:f,path:"renderer.symbol"})}}async function z(t,h){const f=k.createVisualVariableUniforms(h);var r=h.backgroundFillSymbol,c=h.normalizationType;
c="log"===c?"esriNormalizeByLog":"percent-of-total"===c?"esriNormalizeByPercentOfTotal":"field"===c?"esriNormalizeByField":null;var p=h.classBreakInfos.map(async u=>({meshes:await n.createSymbolMeshSchemas(u.symbol,{path:`renderer-stop-${u.minValue}-${u.maxValue}`,schemaOptions:t,uniforms:f}),min:u.minValue,max:u.maxValue}));p=(await Promise.all(p)).sort((u,E)=>u.min-E.min);r=await n.createSymbolMeshSchemas(r,{schemaOptions:t,path:"renderer.backgroundFill",uniforms:{...k.noVisualVariables,visualVariableSizeOutlineScaleStops:f.visualVariableSizeOutlineScaleStops}});
const x=await n.createSymbolMeshSchemas(h.defaultSymbol,{schemaOptions:t,path:"renderer.defaultSymbol",uniforms:f});return{type:"interval",field:h.field,expression:h.valueExpression,backgroundFill:r,defaultSymbol:x,intervals:p,normalizationField:h.normalizationField,normalizationTotal:h.normalizationTotal,normalizationType:c,isMaxInclusive:h.isMaxInclusive}}async function w(t,h){const f=[],r=k.createVisualVariableUniforms(h),c=await n.createSymbolMeshSchemas(h.backgroundFillSymbol,{schemaOptions:t,
path:"renderer.backgroundFill",uniforms:{...k.noVisualVariables,visualVariableSizeOutlineScaleStops:r.visualVariableSizeOutlineScaleStops}}),p=await n.createSymbolMeshSchemas(h.defaultSymbol,{schemaOptions:t,path:"renderer.defaultSymbol",uniforms:r});for(const x of h.uniqueValueInfos??[]){const u=await n.createSymbolMeshSchemas(x.symbol,{path:`renderer-unique-value-${x.value}`,schemaOptions:t,uniforms:r});f.push({value:""+x.value,symbol:u})}return{type:"map",field:h.field,expression:h.valueExpression,
field2:h.field2,field3:h.field3,fieldDelimiter:h.fieldDelimiter,backgroundFill:c,defaultSymbol:p,map:f}}async function A(t,h){return{type:"heatmap",meshes:await n.createHeatmapMeshSchemas(h,t)}}async function v(t,h){return{type:"pie-chart",meshes:await n.createPieChartMeshSchemas(h,t)}}g.createMatcherSchema=async function(t,h){if(!h)return{type:"simple",meshes:[]};switch(h.type){case "simple":return m(t,h);case "dot-density":return l(t,h);case "class-breaks":return z(t,h);case "unique-value":return w(t,
h);case "dictionary":t=k.createVisualVariableUniforms(h);const f=h.scaleExpression;return{type:"dictionary",fieldMap:h.fieldMap,scaleExpression:null!=f&&"1"!==f?{valueExpressionInfo:{type:"CIMExpressionInfo",expression:h.scaleExpression,returnType:"Numeric"},defaultValue:1}:void 0,visualVariableUniforms:t};case "heatmap":return A(t,h);case "pie-chart":return v(t,h)}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/FeatureLayerAdapter":function(){define("exports ../../../../../core/has ../../../../../core/lang ../../../../../layers/support/arcgisLayerUrl ./featureReductionUtils ./featureServiceUtils ./floorFilterUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f){class r{constructor(c){this.layer=c}getLabelingDeconflictionInfo(c){const p=this.layer;c=v.getFeatureReductionDeconflictionEnabled(p,c)??v.getLayerDeconflictionEnabled(p);return[{vvEvaluators:{0:v.createLabelVVEvaluator(p.renderer)},deconflictionEnabled:c}]}async createServiceOptions(c){var p=this.layer;const {capabilities:x,editingInfo:u,objectIdField:E,typeIdField:H,globalIdField:O,datesInUnknownTimezone:J,dateFieldsTimeZone:S,orderBy:T,subtypeField:B,refreshInterval:d}=
p,D=p.fieldsIndex.toJSON(),I=A.getServiceGeometryType(p),Q=p.timeInfo?.toJSON(),L=p.spatialReference.toJSON(),P=p.types?.map(Z=>Z.toJSON()),R=n.clone(this.layer.parsedUrl);this.layer.dynamicDataSource&&(R.query={layer:JSON.stringify({source:this.layer.dynamicDataSource})});let e=this.layer.objectIdField;if(T?.length){var M=!T[0].valueExpression&&T[0].field;M&&(e=M)}M=null==u?.lastEditDate&&0<d;p=(M=!!k("featurelayer-snapshot-enabled")&&"point"===p.geometryType&&x?.query.supportsPagination&&!x?.operations.supportsEditing&&
!M)&&z.exceedsMinimumSnapshotCoverage(c,p.fullExtent);const ca=m.isHostedAgolService(R.path);c=c.spatialReference.toJSON();return{type:"feature-service",source:R,isSourceHosted:ca,orderByFields:e,outSpatialReference:c,metadata:{typeIdField:H??void 0,types:P,timeReferenceUnknownClient:J,dateFieldsTimeZone:S,subtypeField:B,globalIdField:O,fieldsIndex:D,geometryType:I,objectIdField:E,timeInfo:Q,spatialReference:L,outSpatialReference:c,subtypes:this.layer.subtypes?.map(Z=>Z.toJSON())},queryMetadata:{maxRecordCount:x.query.maxRecordCount,
supportsCompactGeometry:x.query.supportsCompactGeometry,supportsDefaultSpatialReference:x.query.supportsDefaultSpatialReference,supportsFormatPBF:x.query.supportsFormatPBF,supportsMaxRecordCountFactor:x.query.supportsMaxRecordCountFactor,supportsQuantization:x.query.supportsQuantization,lastEditDate:u?.lastEditDate?.getTime(),snapshotInfo:{supportsSnapshotMinThreshold:M,supportsSnapshotMaxThreshold:p,snapshotCountThresholds:{min:k("featurelayer-snapshot-point-min-threshold"),max:k("featurelayer-snapshot-point-max-threshold")}}}}}createSourceSchema(c,
p){const {apiKey:x,definitionExpression:u,displayFilterInfo:E,customParameters:H,gdbVersion:O,historicMoment:J,subtypeCode:S,subtypeField:T,timeExtent:B}=this.layer;return t.createFeatureSourceSchema({definitionExpression:u,displayFilterInfo:E,customParameters:H,gdbVersion:O,historicMoment:J,subtypeCode:S,subtypeField:T,timeExtent:B},c,p,x)}createProcessorSchema(c,p,x){const {fields:u,renderer:E,geometryType:H,labelingInfo:O,labelsVisible:J,orderBy:S,objectIdField:T,trackInfo:B}=this.layer,d={fields:u.map(D=>
D.toJSON()),renderer:E?.clone(),featureReduction:l.getEffectiveFeatureReduction(this.layer,p),geometryType:H,labelingInfo:O,labelsVisible:J,objectIdField:T,orderBy:S??"default",trackInfo:B};return h.createSimpleProcessorSchema(c,p,d,x)}get hasRequiredSupport(){return f.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}addFilters(c,p){return w.addFloorFilter(this.layer,c,p)}getUpdateHashProperties(c){return[()=>this.layer.apiKey,()=>this.layer.customParameters,()=>this.layer.definitionExpression,
()=>l.getEffectiveFeatureReduction(this.layer,c),()=>w.hasFloorFilter(this.layer,c)?c.floors:null,()=>this.layer.gdbVersion,()=>this.layer.historicMoment,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>this.layer.orderBy,()=>this.layer.outFields,()=>this.layer.renderer,()=>this.layer.subtypeCode,()=>this.layer.trackInfo]}}g.FeatureLayerAdapter=r;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/featureServiceUtils":function(){define(["exports",
"../../../../../core/has"],function(g,k){g.exceedsMinimumSnapshotCoverage=function(n,m){n=n.extent;n=m?.clone().intersection(n);n=null!=n?n.width*n.height:0;m=m?m.width*m.height:0;m=0===m?0:n/m;n=k("featurelayer-snapshot-point-coverage");return!isNaN(m)&&m>=n};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/floorFilterUtils":function(){define(["exports","../../../../../core/sql","../../../../../layers/support/FeatureFilter"],function(g,
k,n){function m(l,z,w){if(null==l.floorInfo||!w.floors?.length)return z;w=w.floors;const {floorField:A,viewAllLevelIds:v}=l.floorInfo;v.length&&(w=v);l=w.filter(t=>""!==t).map(t=>"'"+t+"'");l.push("''");z?.includes(A)&&(w=new RegExp("AND \\("+A+".*NULL\\)","g"),z=z.replace(w,""),w=new RegExp("\\("+A+".*NULL\\)","g"),z=z.replace(w,""),z=z.replaceAll(/\s+/g," ").trim());l=("("+A+" IN ({ids}) OR "+A+" IS NULL)").replace("{ids}",l.join(", "));return k.sqlAnd(z,l)}g.addFloorFilter=function(l,z,w){l=m(l,
z?.where,w);if(!l)return z;z??=new n;z.where=l;return z};g.hasFloorFilter=function(l,z){return null!=l.floorInfo&&(0<l.floorInfo.viewAllLevelIds.length||0<z.floors.length)};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/InMemoryLayerAdapter":function(){define("exports ../../../../../core/Error ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w,A){class v{constructor(t){this.layer=t}getLabelingDeconflictionInfo(t){const h=this.layer;t=l.getFeatureReductionDeconflictionEnabled(h,t)??l.getLayerDeconflictionEnabled(h);return[{vvEvaluators:{0:l.createLabelVVEvaluator(h.renderer)},deconflictionEnabled:t}]}async createServiceOptions(t){const h=this.layer,{capabilities:f,objectIdField:r}=h,c=h.fieldsIndex.toJSON(),p=m.getServiceGeometryType(h),x=h.timeInfo?.toJSON(),u=h.spatialReference.toJSON();if(!("openPorts"in h.source))throw new k("source-not-supported");
const E=await h.source.openPorts();t=t.spatialReference.toJSON();return{type:"memory",source:E,orderByFields:r,outSpatialReference:t,metadata:{fieldsIndex:c,geometryType:p,objectIdField:r,timeInfo:x,spatialReference:u,outSpatialReference:t,subtypes:null,subtypeField:null,globalIdField:null,typeIdField:null,types:null,timeReferenceUnknownClient:"datesInUnknownTimezone"in h?h.datesInUnknownTimezone:null,dateFieldsTimeZone:"dateFieldsTimeZone"in h?h.dateFieldsTimeZone:null},queryMetadata:{maxRecordCount:f.query.maxRecordCount,
supportsCompactGeometry:f.query.supportsCompactGeometry,supportsDefaultSpatialReference:f.query.supportsDefaultSpatialReference,supportsFormatPBF:f.query.supportsFormatPBF,supportsMaxRecordCountFactor:f.query.supportsMaxRecordCountFactor,supportsQuantization:f.query.supportsQuantization,lastEditDate:null,snapshotInfo:null}}}createSourceSchema(t,h){const {definitionExpression:f,timeExtent:r,displayFilterInfo:c}=this.layer;return z.createFeatureSourceSchema({customParameters:null,definitionExpression:f,
displayFilterInfo:c,timeExtent:r},t,h,null)}createProcessorSchema(t,h,f){const {fields:r,renderer:c,geometryType:p,labelingInfo:x,labelsVisible:u,orderBy:E,objectIdField:H}=this.layer;var O="trackInfo"in this.layer?this.layer.trackInfo:null;O={fields:r.map(J=>J.toJSON()),renderer:c?.clone(),featureReduction:n.getEffectiveFeatureReduction(this.layer,h),geometryType:p,labelingInfo:x,labelsVisible:u,objectIdField:H,orderBy:E??"default",trackInfo:O};return w.createSimpleProcessorSchema(t,h,O,f)}get hasRequiredSupport(){return A.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(t){return[()=>
this.layer.definitionExpression,()=>this.layer.displayFilterInfo,()=>this.layer.orderBy,()=>"outFields"in this.layer?this.layer.outFields:null,()=>this.layer.renderer,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>n.getEffectiveFeatureReduction(this.layer,t),()=>"trackInfo"in this.layer?this.layer.trackInfo:null]}}g.InMemoryLayerAdapter=v;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/KnowledgeGraphSublayerAdapter":function(){define("exports ../../../../../core/sql ../../../../../layers/knowledgeGraph/constants ../../../../../layers/support/FeatureFilter ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w,A,v,t){function h(r){return"link-chart"===r.parentCompositeLayer.type?"hidden"===r.parentCompositeLayer.linkChart?.linkChartProperties.nonspatialDataDisplay?.mode:!1}class f{constructor(r){this.layer=r}getLabelingDeconflictionInfo(r){const c=this.layer;r=w.getFeatureReductionDeconflictionEnabled(c,r)??w.getLayerDeconflictionEnabled(c);return[{vvEvaluators:{0:w.createLabelVVEvaluator(c.renderer)},deconflictionEnabled:r}]}async createServiceOptions(r){const c=this.layer,{capabilities:p,
objectIdField:x}=c,u=c.fieldsIndex.toJSON(),E=z.getServiceGeometryType(c),H=c.spatialReference.toJSON(),O=await c.source.openPorts();r=r.spatialReference.toJSON();return{type:"memory",source:O,orderByFields:x,outSpatialReference:r,metadata:{fieldsIndex:u,geometryType:E,objectIdField:x,spatialReference:H,outSpatialReference:r,globalIdField:null,subtypeField:null,subtypes:null,timeInfo:c.timeInfo?.toJSON(),timeReferenceUnknownClient:null,dateFieldsTimeZone:null,typeIdField:null,types:null},queryMetadata:{maxRecordCount:p.query.maxRecordCount,
supportsCompactGeometry:p.query.supportsCompactGeometry,supportsDefaultSpatialReference:p.query.supportsDefaultSpatialReference,supportsFormatPBF:p.query.supportsFormatPBF,supportsMaxRecordCountFactor:p.query.supportsMaxRecordCountFactor,supportsQuantization:p.query.supportsQuantization,lastEditDate:null,snapshotInfo:null}}}createSourceSchema(r,c){const {definitionExpression:p,displayFilterInfo:x}=this.layer;return A.createFeatureSourceSchema({definitionExpression:p,displayFilterInfo:x,customParameters:null},
r,c,null)}createProcessorSchema(r,c,p){const {fields:x,renderer:u,geometryType:E,labelingInfo:H,labelsVisible:O,objectIdField:J}=this.layer,S={fields:x.map(T=>T.toJSON()),renderer:u?.clone(),featureReduction:l.getEffectiveFeatureReduction(this.layer,c),geometryType:E,labelingInfo:H,labelsVisible:O,objectIdField:J,orderBy:"default"};return v.createSimpleProcessorSchema(r,c,S,p)}get hasRequiredSupport(){return t.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(r){return[()=>
this.layer.definitionExpression,()=>this.layer.renderer,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>l.getEffectiveFeatureReduction(this.layer,r),()=>h(this.layer)]}hasFilters(r){return h(this.layer)}addFilters(r,c){if(h(this.layer)){c=k.sqlAnd(r?.where,`${n.systemIsSpatialFieldName}=1`);if(!c)return r;r??=new m;r.where=c}return r}}g.KnowledgeGraphSublayerAdapter=f;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/knowledgeGraph/constants":function(){define(["exports"],
function(g){g.systemAggregationCountFieldName="ESRI__AggregationCount";g.systemDestinationIdFieldName="ESRI__DestID";g.systemIsSpatialFieldName="LC.ESRI__IsSpatial";g.systemLayoutGeometryFieldName="ESRI__LayoutGeometry";g.systemOidFieldName="ESRI__ID";g.systemOriginIdFieldName="ESRI__OriginID";Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/OGCFeatureLayerAdapter":function(){define("exports ../../../../../core/lang ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w,A){class v{constructor(t){this.layer=t}getLabelingDeconflictionInfo(t){const h=this.layer;t=l.getFeatureReductionDeconflictionEnabled(h,t)??l.getLayerDeconflictionEnabled(h);return[{vvEvaluators:{0:l.createLabelVVEvaluator(h.renderer)},deconflictionEnabled:t}]}async createServiceOptions(t){var h=this.layer;const {capabilities:f,objectIdField:r}=h,c=h.fieldsIndex.toJSON(),p=m.getServiceGeometryType(h),x=h.timeInfo?.toJSON(),u=h.spatialReference.toJSON();h=h.source.getSource();
const E=this.layer.objectIdField,H=k.clone(f);H.query.maxRecordCount=h.maxRecordCount;t=t.spatialReference.toJSON();return{type:"ogc",source:h,orderByFields:E,outSpatialReference:t,metadata:{fieldsIndex:c,geometryType:p,objectIdField:r,timeInfo:x,spatialReference:u,outSpatialReference:t,globalIdField:null,subtypeField:null,subtypes:null,timeReferenceUnknownClient:null,dateFieldsTimeZone:null,typeIdField:null,types:null},queryMetadata:{maxRecordCount:H.query.maxRecordCount,supportsCompactGeometry:H.query.supportsCompactGeometry,
supportsDefaultSpatialReference:H.query.supportsDefaultSpatialReference,supportsFormatPBF:H.query.supportsFormatPBF,supportsMaxRecordCountFactor:H.query.supportsMaxRecordCountFactor,supportsQuantization:H.query.supportsQuantization,lastEditDate:null,snapshotInfo:null}}}createSourceSchema(t,h){const {customParameters:f,timeExtent:r,apiKey:c}=this.layer;return z.createFeatureSourceSchema({customParameters:f,timeExtent:r},t,h,c)}createProcessorSchema(t,h,f){const {fields:r,renderer:c,geometryType:p,
labelingInfo:x,labelsVisible:u,orderBy:E,objectIdField:H}=this.layer,O={fields:r.map(J=>J.toJSON()),renderer:c?.clone(),featureReduction:n.getEffectiveFeatureReduction(this.layer,h),geometryType:p,labelingInfo:x,labelsVisible:u,objectIdField:H,orderBy:E??"default"};return w.createSimpleProcessorSchema(t,h,O,f)}get hasRequiredSupport(){return A.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(t){return[()=>this.layer.apiKey,()=>this.layer.customParameters,
()=>n.getEffectiveFeatureReduction(this.layer,t),()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>this.layer.orderBy,()=>this.layer.renderer]}}g.OGCFeatureLayerAdapter=v;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/OrientedImageryLayerAdapter":function(){define("exports ../../../../../core/has ../../../../../core/lang ../../../../../layers/support/arcgisLayerUrl ./featureReductionUtils ./featureServiceUtils ./floorFilterUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f){class r{constructor(c){this.layer=c}getLabelingDeconflictionInfo(c){const p=this.layer;c=v.getFeatureReductionDeconflictionEnabled(p,c)??v.getLayerDeconflictionEnabled(p);return[{vvEvaluators:{0:v.createLabelVVEvaluator(p.renderer)},deconflictionEnabled:c}]}async createServiceOptions(c){const p=this.layer,{capabilities:x,objectIdField:u,globalIdField:E,orderBy:H,refreshInterval:O}=p,J=p.fieldsIndex.toJSON(),S=A.getServiceGeometryType(p),T=p.timeInfo?.toJSON(),B=p.spatialReference.toJSON(),
d=n.clone(this.layer.parsedUrl);let D=this.layer.objectIdField;if(H?.length){var I=!H[0].valueExpression&&H[0].field;I&&(D=I)}I=0<O;const Q=(I=!!k("featurelayer-snapshot-enabled")&&"point"===p.geometryType&&x?.query.supportsPagination&&!x?.operations.supportsEditing&&!I)&&z.exceedsMinimumSnapshotCoverage(c,p.fullExtent),L=m.isHostedAgolService(d.path);c=c.spatialReference.toJSON();return{type:"feature-service",source:d,isSourceHosted:L,orderByFields:D,outSpatialReference:c,metadata:{globalIdField:E,
fieldsIndex:J,geometryType:S,objectIdField:u,timeInfo:T,spatialReference:B,outSpatialReference:c,timeReferenceUnknownClient:p.datesInUnknownTimezone,dateFieldsTimeZone:p.dateFieldsTimeZone,subtypeField:null,subtypes:null,typeIdField:null,types:null},queryMetadata:{maxRecordCount:x.query.maxRecordCount,supportsCompactGeometry:x.query.supportsCompactGeometry,supportsDefaultSpatialReference:x.query.supportsDefaultSpatialReference,supportsFormatPBF:x.query.supportsFormatPBF,supportsMaxRecordCountFactor:x.query.supportsMaxRecordCountFactor,
supportsQuantization:x.query.supportsQuantization,lastEditDate:null,snapshotInfo:{supportsSnapshotMinThreshold:I,supportsSnapshotMaxThreshold:Q,snapshotCountThresholds:{min:k("featurelayer-snapshot-point-min-threshold"),max:k("featurelayer-snapshot-point-max-threshold")}}}}}createSourceSchema(c,p){const {definitionExpression:x,displayFilterInfo:u,customParameters:E,timeExtent:H}=this.layer;return t.createFeatureSourceSchema({definitionExpression:x,displayFilterInfo:u,customParameters:E,timeExtent:H},
c,p,null)}createProcessorSchema(c,p,x){const {fields:u,renderer:E,geometryType:H,labelingInfo:O,labelsVisible:J,orderBy:S,objectIdField:T}=this.layer,B={fields:u.map(d=>d.toJSON()),renderer:E?.clone(),featureReduction:l.getEffectiveFeatureReduction(this.layer,p),geometryType:H,labelingInfo:O,labelsVisible:J,objectIdField:T,orderBy:S??"default"};return h.createSimpleProcessorSchema(c,p,B,x)}get hasRequiredSupport(){return f.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}addFilters(c,
p){return w.addFloorFilter(this.layer,c,p)}getUpdateHashProperties(c){return[()=>this.layer.outFields,()=>this.layer.orderBy,()=>this.layer.definitionExpression,()=>this.layer.renderer,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>l.getEffectiveFeatureReduction(this.layer,c),()=>this.layer.customParameters,()=>w.hasFloorFilter(this.layer,c)?c.floors:null]}}g.OrientedImageryLayerAdapter=r;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/ParquetLayerAdapter":function(){define("exports ../../../../../layers/support/parquetLayerUtils ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z,w){class A{constructor(v){this.layer=v}get hasRequiredSupport(){return w.isRendererSupported(this.layer.renderer)}get timeOptions(){return null}getLabelingDeconflictionInfo(v){const t=this.layer;v=l.getFeatureReductionDeconflictionEnabled(t,v)??l.getLayerDeconflictionEnabled(t);return[{vvEvaluators:{0:l.createLabelVVEvaluator(t.renderer)},deconflictionEnabled:v}]}getUpdateHashProperties(v){return[()=>this.layer.outFields,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,
()=>n.getEffectiveFeatureReduction(this.layer,v),()=>this.layer.customParameters,()=>this.layer.orderBy,()=>this.layer.renderer,()=>this.layer.popupTemplate]}async createServiceOptions(v){const t=m.getServiceGeometryType(this.layer);v=v.spatialReference.toJSON();return{type:"parquet",source:{urls:this.layer.urls.items},outSpatialReference:v,geometryInfo:k.toParquetGeometryInfoJSON(this.layer.source.geometryInfo),metadata:{spatialReference:this.layer.spatialReference,outSpatialReference:v,fieldsIndex:this.layer.fieldsIndex.toJSON(),
objectIdField:this.layer.objectIdField,geometryType:t,types:null,subtypes:null,timeInfo:null,typeIdField:null,subtypeField:null,globalIdField:null,timeReferenceUnknownClient:null,dateFieldsTimeZone:null}}}createSourceSchema(v,t){v=v.availableFields.includes("*")?this.layer.fields.map(h=>h.name):v.availableFields;return{type:"parquet",mutable:{sourceRefreshVersion:t,availableFields:v,dataFilter:{customParameters:this.layer.customParameters??null}}}}createProcessorSchema(v,t,h){const f={fields:this.layer.fields.map(r=>
r.toJSON()),renderer:this.layer.renderer?.clone(),featureReduction:n.getEffectiveFeatureReduction(this.layer,t),geometryType:this.layer.geometryType,labelingInfo:this.layer.labelingInfo,labelsVisible:this.layer.labelsVisible,objectIdField:this.layer.objectIdField,orderBy:this.layer.orderBy};return z.createSimpleProcessorSchema(v,t,f,h)}}g.ParquetLayerAdapter=A;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/parquetLayerUtils":function(){define("exports ../../core/Error ../../core/jsonMap ../../geometry/SpatialReference ./locationUtils ../../libs/parquet/parquet".split(" "),
function(g,k,n,m,l,z){function w(h){return t.toJSON(h)}function A(h){switch(h){case "Point":return"point";case "Polygon":return"polygon";case "MultiPolygon":return"polygon";case "LineString":return"polyline";case "MultiPoint":return"multipoint";default:return null}}function v(h){var f=h.tryReadEsriMetadata()?.multiscale,r=h.tryReadGeoMetadata();if(null!=r){h=r.primary_column;const {geometry_types:p,encoding:x,orientation:u,crs:E}=r.columns[h];r=new Set;for(var c of p){const H=A(c);H&&r.add(H)}if(1<
r.size)throw new k("unsupported","Parquet mixed geometry types are not support",{geometryTypes:r});c=1===r.size?r.values().next().value:null;r=(r=E?.id?.code)&&"number"===typeof r?new m({wkid:r}):null;return{type:"geometry",format:x,geometryType:c,orientation:u??null,primaryFieldName:h,spatialReference:r,multiscale:f}}f=l.inferLocationInfo(h.fields.map(p=>p.name));return{type:"location",latitudeFieldName:f.latitudeFieldName,longitudeFieldName:f.longitudeFieldName,spatialReference:m.WGS84}}const t=
new n.JSONMap({esriGeometryPoint:"point",esriGeometryPolygon:"polygon",esriGeometryPolyline:"polyline",esriGeometryMultipoint:"multipoint"});g.inferGeometrySource=v;g.inferParquetLoadOptions=async function(h){const f=await z.ParquetMetadata.create(h,()=>null),r=v(f);return{objectIdField:null,url:h,geometrySourceInfo:r,metadata:f}};g.parquetGeometryTypeKebabDict=t;g.toParquetGeometryInfoJSON=function(h){return"location"===h.type?{type:"location",geometryType:"esriGeometryPoint",spatialReference:"toJSON"in
h.spatialReference?h.spatialReference.toJSON():h.spatialReference,latitudeFieldName:h.latitudeFieldName,longitudeFieldName:h.longitudeFieldName}:{type:"geometry",geometryType:w(h.geometryType),spatialReference:h.spatialReference.toJSON(),format:h.format,primaryFieldName:h.primaryFieldName,multiscale:h.multiscale??null}};g.toParquetJSONGeometryType=w;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/layers/support/locationUtils":function(){define(["exports","./fieldUtils"],function(g,
k){const n="lat lat83 latitude latitude83 latdecdeg lat_dd y ycenter point_y".split(" "),m="lon lng lng83 long long83 longitude longitude83 longdecdeg long_dd x xcenter point_x".split(" ");g.inferLocationInfo=function(l,z,w){z=k.normalizeFieldName(z)?.toLowerCase();w=k.normalizeFieldName(w)?.toLowerCase();const A=l.map(v=>v.toLowerCase());z=z?l[A.indexOf(z)]:null;w=w?l[A.indexOf(w)]:null;return{longitudeFieldName:z||l[A.indexOf(m.find(v=>A.includes(v)))],latitudeFieldName:w||l[A.indexOf(n.find(v=>
A.includes(v)))]}};g.latitudeFieldNames=n;g.longitudeFieldNames=m;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/libs/parquet/parquet":function(){define(["exports","../../assets","../../request"],function(g,k,n){function m(a){const b=M[a];132>a||(M[a]=ca,ca=a);return b}function l(a){ca===M.length&&M.push(M.length+1);const b=ca;ca=M[b];M[b]=a;return b}function z(){if(null===Y||0===Y.byteLength)Y=new Uint8Array(e.memory.buffer);return Y}function w(a,b){a>>>=0;return Z.decode(z().subarray(a,
a+b))}function A(a,b){a>>>=0;return z().subarray(a/1,a/1+b)}function v(a,b,y,C){const G={a,b,cnt:1,dtor:y};a=(...U)=>{G.cnt++;const ha=G.a;G.a=0;try{return C(ha,G.b,...U)}finally{0===--G.cnt?(e.__wbindgen_export_1.get(G.dtor)(ha,G.b),oa.unregister(G)):G.a=ha}};a.original=G;oa.register(a,G,G);return a}function t(a,b,y){e._dyn_core__ops__function__FnMut__A____Output___R_as_wasm_bindgen__closure__WasmClosure___describe__invoke__h6f3c6e2a403d1e3d(a,b,l(y))}function h(a,b,y){if(void 0===y){y=fa.encode(a);
var C=b(y.length,1)>>>0;z().subarray(C,C+y.length).set(y);W=y.length;return C}C=a.length;b=b(C,1)>>>0;var G=z();let U=0;for(;U<C;U++){const ha=a.charCodeAt(U);if(127<ha)break;G[b+U]=ha}U!==C&&(0!==U&&(a=a.slice(U)),b=y(b,C,C=U+3*a.length,1)>>>0,G=z().subarray(b+U,b+C),a=pa(a,G),U+=a.written,b=y(b,C,U,1)>>>0);W=U;return b}function f(){if(null===ja||!0===ja.buffer.detached||void 0===ja.buffer.detached&&ja.buffer!==e.memory.buffer)ja=new DataView(e.memory.buffer);return ja}function r(a,b){try{return a.apply(this,
b)}catch(y){e.__wbindgen_exn_store(l(y))}}function c(){if(null===la||0===la.byteLength)la=new Float64Array(e.memory.buffer);return la}function p(){if(null===ma||0===ma.byteLength)ma=new Uint32Array(e.memory.buffer);return ma}function x(a,b){a>>>=0;const y=f(),C=[];for(let G=a;G<a+4*b;G+=4)C.push(m(y.getUint32(G,!0)));return C}function u(a,b){b=b(2*a.length,2)>>>0;if(null===na||0===na.byteLength)na=new Uint16Array(e.memory.buffer);na.set(a,b/2);W=a.length;return b}function E(a,b){if(!(a instanceof
b))throw Error(`expected instance of ${b.name}`);return a.ptr}function H(a,b){b=b(8*a.length,8)>>>0;c().set(a,b/8);W=a.length;return b}function O(a,b){b=b(4*a.length,4)>>>0;p().set(a,b/4);W=a.length;return b}function J(a){return void 0===a||null===a}function S(a,b){b=b(1*a.length,1)>>>0;z().set(a,b/1);W=a.length;return b}function T(a,b,y){a=h(a,e.__wbindgen_malloc,e.__wbindgen_realloc);b=e.readMetadata(a,W,l(b),l(y));return m(b)}async function B(a,b){if("function"===typeof Response&&a instanceof Response){if("function"===
typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(a,b)}catch(y){if("application/wasm"!=a.headers.get("Content-Type"))console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve Wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",y);else throw y;}a=await a.arrayBuffer();return await WebAssembly.instantiate(a,b)}b=await WebAssembly.instantiate(a,b);return b instanceof
WebAssembly.Instance?{instance:b,module:a}:b}function d(){const a={wbg:{}};a.wbg.__wbg_new_abda76e883ba8a5f=function(){return l(Error())};a.wbg.__wbg_stack_658279fe44541cf6=function(b,y){y=h(M[y].stack,e.__wbindgen_malloc,e.__wbindgen_realloc);const C=W;f().setInt32(b+4,C,!0);f().setInt32(b+0,y,!0)};a.wbg.__wbg_error_f851667af71bcfc6=function(b,y){let C,G;try{C=b,G=y,console.error(w(b,y))}finally{e.__wbindgen_free(C,G,1)}};a.wbg.__wbindgen_object_drop_ref=function(b){m(b)};a.wbg.__wbindgen_is_function=
function(b){return"function"===typeof M[b]};a.wbg.__wbg_self_3093d5d1f7bcb682=function(){return r(function(){return l(self.self)},arguments)};a.wbg.__wbg_window_3bcfc4d31bc012f8=function(){return r(function(){return l(window.window)},arguments)};a.wbg.__wbg_globalThis_86b222e13bdf32ed=function(){return r(function(){return l(globalThis.globalThis)},arguments)};a.wbg.__wbg_global_e5a3fe56f8be9485=function(){return r(function(){return l(global.global)},arguments)};a.wbg.__wbindgen_is_undefined=function(b){return void 0===
M[b]};a.wbg.__wbg_newnoargs_76313bd6ff35d0f2=function(b,y){b=new Function(w(b,y));return l(b)};a.wbg.__wbindgen_object_clone_ref=function(b){return l(M[b])};a.wbg.__wbindgen_number_new=function(b){return l(b)};a.wbg.__wbindgen_string_new=function(b,y){b=w(b,y);return l(b)};a.wbg.__wbg_call_1084a111329e68ce=function(){return r(function(b,y){b=M[b].call(M[y]);return l(b)},arguments)};a.wbg.__wbg_call_89af060b4e1523f2=function(){return r(function(b,y,C){b=M[b].call(M[y],M[C]);return l(b)},arguments)};
a.wbg.__wbg_call_7de908392845a9a5=function(){return r(function(b,y,C,G,U){b=M[b].call(M[y],M[C],M[G],M[U]);return l(b)},arguments)};a.wbg.__wbg_valueOf_563b3487b1b116aa=function(b){return M[b].valueOf()};a.wbg.__wbg_buffer_b7b08af79b0b0974=function(b){return l(M[b].buffer)};a.wbg.__wbg_new_b85e72ed1bfd57f9=function(b,y){try{var C=b;var G=y;const U=new Promise((ha,wa)=>{const Ba=C;C=0;try{e.wasm_bindgen__convert__closures__invoke2_mut__h367b7e3d952c2b06(Ba,G,l(ha),l(wa))}finally{C=Ba}});return l(U)}finally{C=
G=0}};a.wbg.__wbg_resolve_570458cb99d56a43=function(b){b=Promise.resolve(M[b]);return l(b)};a.wbg.__wbg_then_95e6edc0f89b73b1=function(b,y){b=M[b].then(M[y]);return l(b)};a.wbg.__wbg_then_876bb3c633745cc6=function(b,y,C){b=M[b].then(M[y],M[C]);return l(b)};a.wbg.__wbg_newwithbyteoffsetandlength_b5293b0eedbac651=function(b,y,C){b=new Int16Array(M[b],y>>>0,C>>>0);return l(b)};a.wbg.__wbg_new_ea1883e1e5e86686=function(b){b=new Uint8Array(M[b]);return l(b)};a.wbg.__wbg_newwithbyteoffsetandlength_874df3e29cb555f9=
function(b,y,C){b=new Uint32Array(M[b],y>>>0,C>>>0);return l(b)};a.wbg.__wbg_length_8339fcf5d8ecd12e=function(b){return M[b].length};a.wbg.__wbg_set_d1e79e2388520f18=function(b,y,C){M[b].set(M[y],C>>>0)};a.wbg.__wbindgen_throw=function(b,y){throw Error(w(b,y));};a.wbg.__wbindgen_memory=function(){return l(e.memory)};a.wbg.__wbindgen_array_new=function(){return l([])};a.wbg.__wbindgen_array_push=function(b,y){M[b].push(m(y))};a.wbg.__wbindgen_uint8_array_new=function(b,y){var C=A(b,y).slice();e.__wbindgen_free(b,
1*y,1);return l(C)};a.wbg.__wbg_queueMicrotask_48421b3cc9052b68=function(b){return l(M[b].queueMicrotask)};a.wbg.__wbindgen_cb_drop=function(b){b=m(b).original;return 1==b.cnt--?(b.a=0,!0):!1};a.wbg.__wbg_queueMicrotask_12a30234db4045d3=function(b){queueMicrotask(M[b])};a.wbg.__wbg_parquetchunk_new=function(b){b=Ka.__wrap(b);return l(b)};a.wbg.__wbg_parquetfile_new=function(b){b=Pa.__wrap(b);return l(b)};a.wbg.__wbg_filemetadata_new=function(b){b=ta.__wrap(b);return l(b)};a.wbg.__wbg_fieldmetadata_new=
function(b){b=ua.__wrap(b);return l(b)};a.wbg.__wbg_rowgroup_new=function(b){b=La.__wrap(b);return l(b)};a.wbg.__wbg_schemafield_unwrap=function(b){return xa.__unwrap(m(b))};a.wbg.__wbg_columndescriptor_new=function(b){b=ba.__wrap(b);return l(b)};a.wbg.__wbg_pageencodingdescriptor_new=function(b){b=Ma.__wrap(b);return l(b)};a.wbg.__wbindgen_closure_wrapper1827=function(b,y,C){b=v(b,y,163,t);return l(b)};return a}function D(a,b){e=a.exports;I.__wbindgen_wasm_module=b;Y=ma=na=la=ja=null;e.__wbindgen_start();
return e}async function I(a){if(void 0!==e)return e;"undefined"!==typeof a&&(Object.getPrototypeOf(a)===Object.prototype?{module_or_path:a}=a:console.warn("using deprecated parameters for the initialization function; pass a single object instead"));const b=d();if("string"===typeof a||"function"===typeof Request&&a instanceof Request||"function"===typeof URL&&a instanceof URL)a=fetch(a);const {instance:y,module:C}=await B(await a,b);return D(y,C)}async function Q(){Qa||=L();return Qa}async function L(){const a=
await Promise.resolve().then(()=>bb);await a.default({module_or_path:k.getAssetUrl("esri/libs/parquet/pkg/arcgis_parquet_bg.wasm")});return a}function P(a){switch(a){case "esriGeometryPoint":return ia.Point;case "esriGeometryPolygon":return ia.Polygon;case "esriGeometryPolyline":return ia.Polyline;case "esriGeometryMultipoint":return ia.Multipoint;default:throw Error(`InternalError: Found unexpected GeometryType: ${a}`);}}function R(a,b,y){const C=qa.new();C.geometryType=P(a.geometryType);if("location"===
a.type)C.latIndex=b.getFieldIndex(a.latitudeFieldName),C.lngIndex=b.getFieldIndex(a.longitudeFieldName);else{if(null==a.primaryFieldName)throw Error("InternalError: A primary field name or set of location fields must be defined");C.wkbIndex=b.getFieldIndex(a.primaryFieldName);if(a.multiscale){const G=F.new();for(const U of a.multiscale.levels){const [ha,wa]=U.transform.translate,[Ba,cb]=U.transform.scale,db=b.getFieldIndex(U.column);G.push(db,ha,wa,Ba,cb)}C.setMultiscaleInfo(G)}}C.inWkid=a.spatialReference.wkid;
y&&(C.outWkid=y.wkid);return C}let e;const M=Array(128).fill(void 0);M.push(void 0,null,!0,!1);let ca=M.length;const Z="undefined"!==typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available");}};"undefined"!==typeof TextDecoder&&Z.decode();let Y=null;const oa="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>{e.__wbindgen_export_1.get(a.dtor)(a.a,a.b)});let W=0;const fa="undefined"!==
typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available");}},pa="function"===typeof fa.encodeInto?function(a,b){return fa.encodeInto(a,b)}:function(a,b){const y=fa.encode(a);b.set(y);return{read:a.length,written:y.length}};let ja=null,la=null,ma=null,na=null;const da=Object.freeze({None:0,0:"None",Snappy:1,1:"Snappy"}),ia=Object.freeze({Point:0,0:"Point",Polygon:1,1:"Polygon",Polyline:2,2:"Polyline",Multipoint:3,3:"Multipoint"}),sa="esriFieldTypeSmallInteger esriFieldTypeInteger esriFieldTypeBigInteger esriFieldTypeSingle esriFieldTypeDouble esriFieldTypeLong esriFieldTypeString esriFieldTypeDate esriFieldTypeOID esriFieldTypeGeometry esriFieldTypeBlob esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeGlobalID esriFieldTypeXML esriFieldTypeDateOnly esriFieldTypeTimeOnly esriFieldTypeTimestampOffset".split(" "),
Ca="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_columndescriptor_free(a>>>0,1));class ba{static __wrap(a){a>>>=0;const b=Object.create(ba.prototype);b.__wbg_ptr=a;Ca.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ca.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_columndescriptor_free(a,0)}name(){let a,b;try{const G=e.__wbindgen_add_to_stack_pointer(-16);
e.columndescriptor_name(G,this.__wbg_ptr);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}physicalType(){let a,b;try{const G=e.__wbindgen_add_to_stack_pointer(-16);e.columndescriptor_physicalType(G,this.__wbg_ptr);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}logicalType(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);
e.columndescriptor_logicalType(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=w(a,b).slice(),e.__wbindgen_free(a,1*b,1));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}encodings(){try{const C=e.__wbindgen_add_to_stack_pointer(-16);e.columndescriptor_encodings(C,this.__wbg_ptr);var a=f().getInt32(C+0,!0),b=f().getInt32(C+4,!0),y=x(a,b).slice();e.__wbindgen_free(a,4*b,4);return y}finally{e.__wbindgen_add_to_stack_pointer(16)}}pageEncodings(){try{const y=
e.__wbindgen_add_to_stack_pointer(-16);e.columndescriptor_pageEncodings(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=x(a,b).slice(),e.__wbindgen_free(a,4*b,4));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}numValues(){return e.columndescriptor_numValues(this.__wbg_ptr)}compression(){let a,b;try{const G=e.__wbindgen_add_to_stack_pointer(-16);e.columndescriptor_compression(G,this.__wbg_ptr);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,
C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}compressedSize(){return e.columndescriptor_compressedSize(this.__wbg_ptr)}uncompressedSize(){return e.columndescriptor_uncompressedSize(this.__wbg_ptr)}nullCount(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.columndescriptor_nullCount(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getBigInt64(y+8,!0);return 0===a?void 0:b}finally{e.__wbindgen_add_to_stack_pointer(16)}}distinctCount(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);
e.columndescriptor_distinctCount(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getBigInt64(y+8,!0);return 0===a?void 0:b}finally{e.__wbindgen_add_to_stack_pointer(16)}}minValue(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.columndescriptor_minValue(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=A(a,b).slice(),e.__wbindgen_free(a,1*b,1));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}maxValue(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);
e.columndescriptor_maxValue(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=A(a,b).slice(),e.__wbindgen_free(a,1*b,1));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}}const Da="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_fieldmetadata_free(a>>>0,1));class ua{static __wrap(a){a>>>=0;const b=Object.create(ua.prototype);b.__wbg_ptr=a;Da.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=
this.__wbg_ptr;this.__wbg_ptr=0;Da.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_fieldmetadata_free(a,0)}get name(){let a,b;try{const G=e.__wbindgen_add_to_stack_pointer(-16);e.fieldmetadata_name(G,this.__wbg_ptr);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}get index(){return e.fieldmetadata_index(this.__wbg_ptr)}get type(){const a=e.fieldmetadata_esri_type(this.__wbg_ptr);
return sa[a]}get physicalType(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.fieldmetadata_physical_type(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=w(a,b).slice(),e.__wbindgen_free(a,1*b,1));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}get logicalType(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.fieldmetadata_logical_type(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=w(a,b).slice(),e.__wbindgen_free(a,
1*b,1));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}}const Ea="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_filemetadata_free(a>>>0,1));class ta{static __wrap(a){a>>>=0;const b=Object.create(ta.prototype);b.__wbg_ptr=a;Ea.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ea.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_filemetadata_free(a,0)}version(){return e.filemetadata_version(this.__wbg_ptr)}numRows(){return e.filemetadata_numRows(this.__wbg_ptr)>>>
0}numFields(){return e.filemetadata_numFields(this.__wbg_ptr)>>>0}numColumns(){return e.filemetadata_numColumns(this.__wbg_ptr)>>>0}createdBy(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.filemetadata_createdBy(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=w(a,b).slice(),e.__wbindgen_free(a,1*b,1));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}keyValueMetadata(a){try{const C=e.__wbindgen_add_to_stack_pointer(-16),G=h(a,e.__wbindgen_malloc,e.__wbindgen_realloc);
e.filemetadata_keyValueMetadata(C,this.__wbg_ptr,G,W);var b=f().getInt32(C+0,!0),y=f().getInt32(C+4,!0);let U;0!==b&&(U=w(b,y).slice(),e.__wbindgen_free(b,1*y,1));return U}finally{e.__wbindgen_add_to_stack_pointer(16)}}keys(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.filemetadata_keys(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);let C;0!==a&&(C=x(a,b).slice(),e.__wbindgen_free(a,4*b,4));return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}getFieldIndex(a){a=h(a,
e.__wbindgen_malloc,e.__wbindgen_realloc);a=e.filemetadata_getFieldIndex(this.__wbg_ptr,a,W);return 16777215===a?void 0:a}getFieldByIndex(a){a=e.filemetadata_getFieldByIndex(this.__wbg_ptr,a);return 0===a?void 0:ua.__wrap(a)}getFields(){try{const C=e.__wbindgen_add_to_stack_pointer(-16);e.filemetadata_getFields(C,this.__wbg_ptr);var a=f().getInt32(C+0,!0),b=f().getInt32(C+4,!0),y=x(a,b).slice();e.__wbindgen_free(a,4*b,4);return y}finally{e.__wbindgen_add_to_stack_pointer(16)}}}const Fa="undefined"===
typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_filewriter_free(a>>>0,1));class ya{static __wrap(a){a>>>=0;const b=Object.create(ya.prototype);b.__wbg_ptr=a;Fa.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Fa.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_filewriter_free(a,0)}static new(a,b){const y=(0,e.__wbindgen_malloc)(4*a.length,4)>>>0,C=f();for(let G=0;G<a.length;G++)C.setUint32(y+
4*G,l(a[G]),!0);W=a.length;a=e.filewriter_new(y,W,b);return ya.__wrap(a)}writeKeyValue(a,b){a=h(a,e.__wbindgen_malloc,e.__wbindgen_realloc);const y=W;b=h(b,e.__wbindgen_malloc,e.__wbindgen_realloc);e.filewriter_writeKeyValue(this.__wbg_ptr,a,y,b,W)}writeI32Page(a,b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,ka);var y=b.__destroy_into_raw();e.filewriter_writeI32Page(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeI64Page(a,
b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,Ga);var y=b.__destroy_into_raw();e.filewriter_writeI64Page(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeF32Page(a,b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,V);var y=b.__destroy_into_raw();e.filewriter_writeF32Page(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeF64Page(a,
b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,aa);var y=b.__destroy_into_raw();e.filewriter_writeF64Page(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeGeometryPage(a,b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,va);var y=b.__destroy_into_raw();e.filewriter_writeBytesPage(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeStringPage(a,
b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,Ha);var y=b.__destroy_into_raw();e.filewriter_writeBytesPage(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeBytesPage(a,b){try{const G=e.__wbindgen_add_to_stack_pointer(-16);E(b,N);var y=b.__destroy_into_raw();e.filewriter_writeBytesPage(G,this.__wbg_ptr,a,y);var C=f().getInt32(G+0,!0);if(f().getInt32(G+4,!0))throw m(C);}finally{e.__wbindgen_add_to_stack_pointer(16)}}finish(){try{const G=
this.__destroy_into_raw(),U=e.__wbindgen_add_to_stack_pointer(-16);e.filewriter_finish(U,G);var a=f().getInt32(U+0,!0),b=f().getInt32(U+4,!0),y=f().getInt32(U+8,!0);if(f().getInt32(U+12,!0))throw m(y);var C=A(a,b).slice();e.__wbindgen_free(a,1*b,1);return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}}const Ia="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_geometryinfodescriptor_free(a>>>0,1));class qa{static __wrap(a){a>>>=0;const b=
Object.create(qa.prototype);b.__wbg_ptr=a;Ia.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ia.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_geometryinfodescriptor_free(a,0)}get geometryType(){const a=e.__wbg_get_geometryinfodescriptor_geometryType(this.__wbg_ptr);return 4===a?void 0:a}set geometryType(a){e.__wbg_set_geometryinfodescriptor_geometryType(this.__wbg_ptr,J(a)?4:a)}get wkbIndex(){const a=e.__wbg_get_geometryinfodescriptor_wkbIndex(this.__wbg_ptr);
return 16777215===a?void 0:a}set wkbIndex(a){e.__wbg_set_geometryinfodescriptor_wkbIndex(this.__wbg_ptr,J(a)?16777215:a)}get lngIndex(){const a=e.__wbg_get_geometryinfodescriptor_lngIndex(this.__wbg_ptr);return 16777215===a?void 0:a}set lngIndex(a){e.__wbg_set_geometryinfodescriptor_lngIndex(this.__wbg_ptr,J(a)?16777215:a)}get latIndex(){const a=e.__wbg_get_geometryinfodescriptor_latIndex(this.__wbg_ptr);return 16777215===a?void 0:a}set latIndex(a){e.__wbg_set_geometryinfodescriptor_latIndex(this.__wbg_ptr,
J(a)?16777215:a)}get xIndex(){const a=e.__wbg_get_geometryinfodescriptor_xIndex(this.__wbg_ptr);return 16777215===a?void 0:a}set xIndex(a){e.__wbg_set_geometryinfodescriptor_xIndex(this.__wbg_ptr,J(a)?16777215:a)}get inWkid(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.__wbg_get_geometryinfodescriptor_inWkid(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);return 0===a?void 0:b>>>0}finally{e.__wbindgen_add_to_stack_pointer(16)}}set inWkid(a){e.__wbg_set_geometryinfodescriptor_inWkid(this.__wbg_ptr,
!J(a),J(a)?0:a)}get outWkid(){try{const y=e.__wbindgen_add_to_stack_pointer(-16);e.__wbg_get_geometryinfodescriptor_outWkid(y,this.__wbg_ptr);var a=f().getInt32(y+0,!0),b=f().getInt32(y+4,!0);return 0===a?void 0:b>>>0}finally{e.__wbindgen_add_to_stack_pointer(16)}}set outWkid(a){e.__wbg_set_geometryinfodescriptor_outWkid(this.__wbg_ptr,!J(a),J(a)?0:a)}static new(){const a=e.geometryinfodescriptor_new();return qa.__wrap(a)}setMultiscaleInfo(a){E(a,F);a=a.__destroy_into_raw();e.geometryinfodescriptor_setMultiscaleInfo(this.__wbg_ptr,
a)}}const q="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_multiscaleinfo_free(a>>>0,1));class F{static __wrap(a){a>>>=0;const b=Object.create(F.prototype);b.__wbg_ptr=a;q.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;q.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_multiscaleinfo_free(a,0)}static new(){const a=e.multiscaleinfo_new();return F.__wrap(a)}push(a,
b,y,C,G){e.multiscaleinfo_push(this.__wbg_ptr,a,b,y,C,G)}}const K="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuilderbytes_free(a>>>0,1));class N{static __wrap(a){a>>>=0;const b=Object.create(N.prototype);b.__wbg_ptr=a;K.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;K.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pagebuilderbytes_free(a,0)}static new(){const a=
e.pagebuilderbytes_new();return N.__wrap(a)}push(a){a=J(a)?0:S(a,e.__wbindgen_malloc);e.pagebuilderbytes_push(this.__wbg_ptr,a,W)}}const X="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuilderf32_free(a>>>0,1));class V{static __wrap(a){a>>>=0;const b=Object.create(V.prototype);b.__wbg_ptr=a;X.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;X.unregister(this);return a}free(){const a=
this.__destroy_into_raw();e.__wbg_pagebuilderf32_free(a,0)}static new(){const a=e.pagebuilderbytes_new();return V.__wrap(a)}push(a){e.pagebuilderf32_push(this.__wbg_ptr,!J(a),J(a)?0:a)}}const ea="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuilderf64_free(a>>>0,1));class aa{static __wrap(a){a>>>=0;const b=Object.create(aa.prototype);b.__wbg_ptr=a;ea.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;
this.__wbg_ptr=0;ea.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pagebuilderf64_free(a,0)}static new(){const a=e.multiscaleinfo_new();return aa.__wrap(a)}push(a){e.pagebuilderf64_push(this.__wbg_ptr,!J(a),J(a)?0:a)}}const ra="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuildergeometry_free(a>>>0,1));class va{static __wrap(a){a>>>=0;const b=Object.create(va.prototype);b.__wbg_ptr=a;ra.register(b,
b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;ra.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pagebuildergeometry_free(a,0)}static new(){const a=e.pagebuilderbytes_new();return va.__wrap(a)}writeXY(a,b){try{const C=e.__wbindgen_add_to_stack_pointer(-16);e.pagebuildergeometry_writeXY(C,this.__wbg_ptr,a,b);var y=f().getInt32(C+0,!0);if(f().getInt32(C+4,!0))throw m(y);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writePBF(a,b,y,C){try{const U=
e.__wbindgen_add_to_stack_pointer(-16),ha=H(a,e.__wbindgen_malloc);a=W;const wa=O(b,e.__wbindgen_malloc);e.pagebuildergeometry_writePBF(U,this.__wbg_ptr,ha,a,wa,W,y,C);var G=f().getInt32(U+0,!0);if(f().getInt32(U+4,!0))throw m(G);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writePolygon(a,b){try{const C=e.__wbindgen_add_to_stack_pointer(-16),G=H(a,e.__wbindgen_malloc);a=W;const U=O(b,e.__wbindgen_malloc);e.pagebuildergeometry_writePolygon(C,this.__wbg_ptr,G,a,U,W);var y=f().getInt32(C+0,!0);if(f().getInt32(C+
4,!0))throw m(y);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writePolyline(a,b){try{const C=e.__wbindgen_add_to_stack_pointer(-16),G=H(a,e.__wbindgen_malloc);a=W;const U=O(b,e.__wbindgen_malloc);e.pagebuildergeometry_writePolyline(C,this.__wbg_ptr,G,a,U,W);var y=f().getInt32(C+0,!0);if(f().getInt32(C+4,!0))throw m(y);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeMultipoint(a,b){try{const C=e.__wbindgen_add_to_stack_pointer(-16),G=H(a,e.__wbindgen_malloc);a=W;const U=O(b,e.__wbindgen_malloc);
e.pagebuildergeometry_writeMultipoint(C,this.__wbg_ptr,G,a,U,W);var y=f().getInt32(C+0,!0);if(f().getInt32(C+4,!0))throw m(y);}finally{e.__wbindgen_add_to_stack_pointer(16)}}writeNone(){e.pagebuildergeometry_writeNone(this.__wbg_ptr)}}const za="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuilderi32_free(a>>>0,1));class ka{static __wrap(a){a>>>=0;const b=Object.create(ka.prototype);b.__wbg_ptr=a;za.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=
this.__wbg_ptr;this.__wbg_ptr=0;za.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pagebuilderi32_free(a,0)}static new(){const a=e.pagebuilderbytes_new();return ka.__wrap(a)}push(a){e.pagebuilderi32_push(this.__wbg_ptr,!J(a),J(a)?0:a)}}const Ra="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuilderi64_free(a>>>0,1));class Ga{static __wrap(a){a>>>=0;const b=Object.create(Ga.prototype);b.__wbg_ptr=a;Ra.register(b,
b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ra.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pagebuilderi64_free(a,0)}static new(){const a=e.multiscaleinfo_new();return Ga.__wrap(a)}push(a){e.pagebuilderi64_push(this.__wbg_ptr,!J(a),J(a)?0:a)}}const Sa="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_pagebuilderstring_free(a>>>0,1));class Ha{static __wrap(a){a>>>=
0;const b=Object.create(Ha.prototype);b.__wbg_ptr=a;Sa.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Sa.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pagebuilderstring_free(a,0)}static new(){const a=e.pagebuilderbytes_new();return Ha.__wrap(a)}push(a){a=J(a)?0:h(a,e.__wbindgen_malloc,e.__wbindgen_realloc);e.pagebuilderstring_push(this.__wbg_ptr,a,W)}}const Ta="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>
{}}:new FinalizationRegistry(a=>e.__wbg_pageencodingdescriptor_free(a>>>0,1));class Ma{static __wrap(a){a>>>=0;const b=Object.create(Ma.prototype);b.__wbg_ptr=a;Ta.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ta.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_pageencodingdescriptor_free(a,0)}pageType(){let a,b;try{const G=e.__wbindgen_add_to_stack_pointer(-16);e.pageencodingdescriptor_pageType(G,this.__wbg_ptr);var y=f().getInt32(G+
0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}encoding(){let a,b;try{const G=e.__wbindgen_add_to_stack_pointer(-16);e.pageencodingdescriptor_encoding(G,this.__wbg_ptr);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}count(){return e.pageencodingdescriptor_count(this.__wbg_ptr)}}const Ua="undefined"===typeof FinalizationRegistry?
{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_parquetchunk_free(a>>>0,1));class Ka{static __wrap(a){a>>>=0;const b=Object.create(Ka.prototype);b.__wbg_ptr=a;Ua.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ua.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_parquetchunk_free(a,0)}size(){return e.parquetchunk_size(this.__wbg_ptr)>>>0}hasField(a){return 0!==e.parquetchunk_hasField(this.__wbg_ptr,a)}readX(a){return e.parquetchunk_readX(this.__wbg_ptr,
a)}readY(a){return e.parquetchunk_readY(this.__wbg_ptr,a)}readCoords(a){try{const C=e.__wbindgen_add_to_stack_pointer(-16);e.parquetchunk_readCoords(C,this.__wbg_ptr,a);var b=f().getInt32(C+0,!0),y=f().getInt32(C+4,!0);let G;0!==b&&(a=b,a>>>=0,G=c().subarray(a/8,a/8+y).slice(),e.__wbindgen_free(b,8*y,8));return G}finally{e.__wbindgen_add_to_stack_pointer(16)}}readLengths(a){try{const C=e.__wbindgen_add_to_stack_pointer(-16);e.parquetchunk_readLengths(C,this.__wbg_ptr,a);var b=f().getInt32(C+0,!0),
y=f().getInt32(C+4,!0);let G;0!==b&&(a=b,a>>>=0,G=p().subarray(a/4,a/4+y).slice(),e.__wbindgen_free(b,4*y,4));return G}finally{e.__wbindgen_add_to_stack_pointer(16)}}readGeometryTransformed(a,b,y,C,G){a=e.parquetchunk_readGeometryTransformed(this.__wbg_ptr,a,b,y,C,G);return 0===a?void 0:Na.__wrap(a)}boundsXMin(a){return e.parquetchunk_boundsXMin(this.__wbg_ptr,a)}boundsYMin(a){return e.parquetchunk_boundsYMin(this.__wbg_ptr,a)}boundsXMax(a){return e.parquetchunk_boundsXMax(this.__wbg_ptr,a)}boundsYMax(a){return e.parquetchunk_boundsYMax(this.__wbg_ptr,
a)}readAttribute(a,b){a=e.parquetchunk_readAttribute(this.__wbg_ptr,a,b);return m(a)}}const Va="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_parquetfile_free(a>>>0,1));let Pa=class a{static __wrap(b){b>>>=0;const y=Object.create(a.prototype);y.__wbg_ptr=b;Va.register(y,y.__wbg_ptr,y);return y}__destroy_into_raw(){const b=this.__wbg_ptr;this.__wbg_ptr=0;Va.unregister(this);return b}free(){const b=this.__destroy_into_raw();e.__wbg_parquetfile_free(b,
0)}metadata(){const b=e.parquetfile_metadata(this.__wbg_ptr);return ta.__wrap(b)}rowGroups(){try{const G=e.__wbindgen_add_to_stack_pointer(-16);e.parquetfile_rowGroups(G,this.__wbg_ptr);var b=f().getInt32(G+0,!0),y=f().getInt32(G+4,!0),C=x(b,y).slice();e.__wbindgen_free(b,4*y,4);return C}finally{e.__wbindgen_add_to_stack_pointer(16)}}readChunksWithCallback(b,y){b=u(b,e.__wbindgen_malloc);y=e.parquetfile_readChunksWithCallback(this.__wbg_ptr,b,W,l(y));return m(y)}readFirstChunk(b){b=u(b,e.__wbindgen_malloc);
b=e.parquetfile_readFirstChunk(this.__wbg_ptr,b,W);return m(b)}readAllChunks(b){b=u(b,e.__wbindgen_malloc);b=e.parquetfile_readAllChunks(this.__wbg_ptr,b,W);return m(b)}updateChunks(b){b=u(b,e.__wbindgen_malloc);b=e.parquetfile_updateChunks(this.__wbg_ptr,b,W);return m(b)}};const Wa="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_quantizedgeometry_free(a>>>0,1));class Na{static __wrap(a){a>>>=0;const b=Object.create(Na.prototype);b.__wbg_ptr=
a;Wa.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Wa.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_quantizedgeometry_free(a,0)}readCoordsUnsafe(){const a=e.quantizedgeometry_readCoordsUnsafe(this.__wbg_ptr);return m(a)}readLengthsUnsafe(){const a=e.quantizedgeometry_readLengthsUnsafe(this.__wbg_ptr);return m(a)}}const Xa="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>
e.__wbg_rangeproviderjs_free(a>>>0,1));class Ja{static __wrap(a){a>>>=0;const b=Object.create(Ja.prototype);b.__wbg_ptr=a;Xa.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Xa.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_rangeproviderjs_free(a,0)}static new(a,b){a=e.rangeproviderjs_new(l(a),l(b));return Ja.__wrap(a)}static withFetch(){const a=e.rangeproviderjs_withFetch();return Ja.__wrap(a)}}const Ya="undefined"===typeof FinalizationRegistry?
{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_rowgroup_free(a>>>0,1));class La{static __wrap(a){a>>>=0;const b=Object.create(La.prototype);b.__wbg_ptr=a;Ya.register(b,b.__wbg_ptr,b);return b}__destroy_into_raw(){const a=this.__wbg_ptr;this.__wbg_ptr=0;Ya.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_rowgroup_free(a,0)}columns(){try{const C=e.__wbindgen_add_to_stack_pointer(-16);e.rowgroup_columns(C,this.__wbg_ptr);var a=f().getInt32(C+0,!0),b=
f().getInt32(C+4,!0),y=x(a,b).slice();e.__wbindgen_free(a,4*b,4);return y}finally{e.__wbindgen_add_to_stack_pointer(16)}}}const Za="undefined"===typeof FinalizationRegistry?{register:()=>{},unregister:()=>{}}:new FinalizationRegistry(a=>e.__wbg_schemafield_free(a>>>0,1));class xa{static __wrap(a){a>>>=0;const b=Object.create(xa.prototype);b.__wbg_ptr=a;Za.register(b,b.__wbg_ptr,b);return b}static __unwrap(a){return a instanceof xa?a.__destroy_into_raw():0}__destroy_into_raw(){const a=this.__wbg_ptr;
this.__wbg_ptr=0;Za.unregister(this);return a}free(){const a=this.__destroy_into_raw();e.__wbg_schemafield_free(a,0)}static tryNew(a,b){try{const G=e.__wbindgen_add_to_stack_pointer(-16),U=h(a,e.__wbindgen_malloc,e.__wbindgen_realloc);a=W;const ha=h(b,e.__wbindgen_malloc,e.__wbindgen_realloc);e.schemafield_tryNew(G,U,a,ha,W);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);if(f().getInt32(G+8,!0))throw m(C);return xa.__wrap(y)}finally{e.__wbindgen_add_to_stack_pointer(16)}}name(){let a,b;try{const G=
e.__wbindgen_add_to_stack_pointer(-16);e.schemafield_name(G,this.__wbg_ptr);var y=f().getInt32(G+0,!0),C=f().getInt32(G+4,!0);a=y;b=C;return w(y,C)}finally{e.__wbindgen_add_to_stack_pointer(16),e.__wbindgen_free(a,b,1)}}}const bb=Object.freeze(Object.defineProperty({__proto__:null,ColumnDescriptor:ba,CompressMode:da,FieldMetadata:ua,FileMetadata:ta,FileWriter:ya,GeometryInfoDescriptor:qa,GeometryType:ia,MultiScaleInfo:F,PageBuilderBytes:N,PageBuilderF32:V,PageBuilderF64:aa,PageBuilderGeometry:va,
PageBuilderI32:ka,PageBuilderI64:Ga,PageBuilderString:Ha,PageEncodingDescriptor:Ma,ParquetChunk:Ka,ParquetFile:Pa,QuantizedGeometry:Na,RangeProviderJs:Ja,RowGroup:La,SchemaField:xa,default:I,enable_tracing:function(){e.enable_tracing()},initSync:function(a){if(void 0!==e)return e;"undefined"!==typeof a&&(Object.getPrototypeOf(a)===Object.prototype?{module:a}=a:console.warn("using deprecated parameters for `initSync()`; pass a single object instead"));var b=d();a instanceof WebAssembly.Module||(a=
new WebAssembly.Module(a));b=new WebAssembly.Instance(a,b);return D(b,a)},readFile:function(a,b,y,C,G){a=h(a,e.__wbindgen_malloc,e.__wbindgen_realloc);const U=W;E(C,ta);C=C.__destroy_into_raw();let ha=0;J(G)||(E(G,qa),ha=G.__destroy_into_raw());b=e.readFile(a,U,l(b),l(y),C,ha);return m(b)},readFileFromBinary:function(a,b){var y=0;J(a)||(E(a,qa),y=a.__destroy_into_raw());a=S(b,e.__wbindgen_malloc);y=e.readFileFromBinary(y,a,W);return m(y)},readMetadata:T,readMetadataFromFile:function(a){a=S(a,e.__wbindgen_malloc);
a=e.readMetadataFromFile(a,W);return m(a)}},Symbol.toStringTag,{value:"Module"}));let Qa=null;const $a=a=>async function(b,y,C){const G=a();({data:b}=await n(b,{responseType:"array-buffer",query:G,headers:{range:`bytes=${y}-${C}`}}));return b},ab=a=>async function(b){const y=a();({data:b}=await n(b,{responseType:"native",method:"head",query:y}));b=b.headers.get("Content-Length");if(null==b)throw Error("Unable to parse content length");return parseInt(b,10)};class Aa{static async create(a,b){a=await (await Q()).readMetadata(a,
$a(b),ab(b));return Aa.fromFileMetadata(a)}static fromFileMetadata(a){const b=[];for(let y=0;y<a.numFields();y++){const C=a.getFieldByIndex(y);b.push({name:C.name,type:C.type,alias:C.name,index:C.index});C.free()}return new Aa(a,b)}constructor(a,b){this._inner=a;this.fields=b}destroy(){this._inner.free()}[Symbol.dispose](){this.destroy()}get size(){return this._inner.numRows()}getFieldIndex(a){return this._inner.getFieldIndex(a)}tryReadGeoMetadata(){const a=this._inner.keyValueMetadata("geo");return null==
a?null:JSON.parse(a)}tryReadEsriMetadata(){const a=this._inner.keyValueMetadata("esri");return null==a?null:JSON.parse(a)}}class Oa{static async create(a,b){const y=await Q(),C=$a(b.getCustomParameters),G=ab(b.getCustomParameters),U=await T(a,C,G);b=R(b.geometryInfo,U,b.outSpatialReference);a=await y.readFile(a,C,G,U,b);return new Oa(a,Aa.fromFileMetadata(a.metadata()))}static async fromFile(a,b,y){const C=await Q(),G=await C.readMetadataFromFile(a);b=b?R(b,G,y):void 0;a=await C.readFileFromBinary(b,
a);return new Oa(a,Aa.fromFileMetadata(a.metadata()))}constructor(a,b){this.inner=a;this.metadata=b}destroy(){this.inner.free();this.metadata.destroy()}[Symbol.dispose](){this.destroy()}}g.ParquetFile=Oa;g.ParquetMetadata=Aa;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/StreamLayerAdapter":function(){define("exports ./featureReductionUtils ./geometryUtils ./labelingUtils ../schema/processor/SimpleProcessorSchema ../support/rendererUtils".split(" "),
function(g,k,n,m,l,z){class w{constructor(A){this.layer=A}getLabelingDeconflictionInfo(A){const v=this.layer;A=m.getFeatureReductionDeconflictionEnabled(v,A)??m.getLayerDeconflictionEnabled(v);return[{vvEvaluators:{0:m.createLabelVVEvaluator(v.renderer)},deconflictionEnabled:A}]}async createServiceOptions(A){var v=this.layer;const {objectIdField:t}=v,h=n.getServiceGeometryType(v),f=v.timeInfo?.toJSON()||null;v=v.spatialReference?v.spatialReference.toJSON():null;A=A.spatialReference.toJSON();return{type:"stream",
source:this.layer.parsedUrl,outSpatialReference:A,metadata:{fieldsIndex:this.layer.fieldsIndex.toJSON(),geometryType:h,objectIdField:t,timeInfo:f,timeReferenceUnknownClient:null,dateFieldsTimeZone:null,spatialReference:v,outSpatialReference:A,subtypeField:null,subtypes:null,globalIdField:null,typeIdField:null,types:null}}}createSourceSchema(A,v){const {definitionExpression:t,geometryDefinition:h,customParameters:f}=this.layer;return{type:"stream",mutable:{sourceRefreshVersion:v,availableFields:A.availableFields,
dataFilter:{geometryDefinition:h?.toJSON(),definitionExpression:t,customParameters:f??null,maxReconnectionAttempts:this.layer.maxReconnectionAttempts,maxReconnectionInterval:this.layer.maxReconnectionInterval,purgeOptions:this.layer.purgeOptions.toJSON()}}}}createProcessorSchema(A,v,t){const {fields:h,renderer:f,geometryType:r,labelingInfo:c,labelsVisible:p,objectIdField:x,trackInfo:u}=this.layer,E={fields:h.map(H=>H.toJSON()),renderer:f?.clone(),featureReduction:k.getEffectiveFeatureReduction(this.layer,
v),geometryType:r,labelingInfo:c,labelsVisible:p,objectIdField:x,orderBy:"default",trackInfo:u};return l.createSimpleProcessorSchema(A,v,E,t)}get hasRequiredSupport(){return z.isRendererSupported(this.layer.renderer)}get timeOptions(){return this.layer}getUpdateHashProperties(A){return[()=>this.layer.definitionExpression,()=>this.layer.renderer,()=>this.layer.labelsVisible?this.layer.labelingInfo:null,()=>k.getEffectiveFeatureReduction(this.layer,A),()=>this.layer.customParameters,()=>this.layer.geometryDefinition,
()=>this.layer.definitionExpression,()=>this.layer.trackInfo]}}g.StreamLayerAdapter=w;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/layerAdapters/SubtypeGroupLayerAdapter":function(){define("exports ../../../../../core/has ../../../../../core/lang ../../../../../core/mathUtils ../../../../../core/sql ../../../../../layers/support/arcgisLayerUrl ../../../../../layers/support/FeatureFilter ./featureServiceUtils ./floorFilterUtils ./geometryUtils ./labelingUtils ../schema/SourceSchema ../schema/processor/SubtypeProcessorSchema".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f,r){class c{constructor(p){this.layer=p}getLabelingDeconflictionInfo(p){return[{vvEvaluators:{},deconflictionEnabled:this.layer.sublayers.some(x=>h.getLayerDeconflictionEnabled(x))}]}async createServiceOptions(p){var x=this.layer;const {capabilities:u,datesInUnknownTimezone:E,dateFieldsTimeZone:H,editingInfo:O,globalIdField:J,objectIdField:S,refreshInterval:T,subtypeField:B}=x,d=x.fieldsIndex.toJSON(),D=t.getServiceGeometryType(x),I=x.timeInfo?.toJSON(),Q=x.spatialReference.toJSON(),
L=n.clone(this.layer.parsedUrl);var P=null==O?.lastEditDate&&0<T;x=(P=!!k("featurelayer-snapshot-enabled")&&"point"===x.geometryType&&u?.query.supportsPagination&&!u?.operations.supportsEditing&&!P)&&A.exceedsMinimumSnapshotCoverage(p,x.fullExtent);const R=z.isHostedAgolService(L.path);p=p.spatialReference.toJSON();return{type:"feature-service",source:L,isSourceHosted:R,orderByFields:S,outSpatialReference:p,metadata:{timeReferenceUnknownClient:E,dateFieldsTimeZone:H,subtypeField:B,globalIdField:J,
fieldsIndex:d,geometryType:D,objectIdField:S,timeInfo:I,spatialReference:Q,outSpatialReference:p,subtypes:this.layer.subtypes?.map(e=>e.toJSON()),typeIdField:null,types:null},queryMetadata:{maxRecordCount:u.query.maxRecordCount,supportsCompactGeometry:u.query.supportsCompactGeometry,supportsDefaultSpatialReference:u.query.supportsDefaultSpatialReference,supportsFormatPBF:u.query.supportsFormatPBF,supportsMaxRecordCountFactor:u.query.supportsMaxRecordCountFactor,supportsQuantization:u.query.supportsQuantization,
lastEditDate:O?.lastEditDate?.getTime(),snapshotInfo:{supportsSnapshotMinThreshold:P,supportsSnapshotMaxThreshold:x,snapshotCountThresholds:{min:k("featurelayer-snapshot-point-min-threshold"),max:k("featurelayer-snapshot-point-max-threshold")}}}}}createSourceSchema(p,x){const {definitionExpression:u,customParameters:E,gdbVersion:H,historicMoment:O,subtypeField:J,timeExtent:S,apiKey:T,displayFilterInfo:B}=this.layer,d={queryScaleRanges:this.layer.sublayers.items.map(D=>({subtypeCode:D.subtypeCode,
minScale:D.minScale,maxScale:D.maxScale})),definitionExpression:u,displayFilterInfo:B,customParameters:E,gdbVersion:H,historicMoment:O,subtypeField:J,timeExtent:S};return f.createFeatureSourceSchema(d,p,x,T)}createProcessorSchema(p,x,u){const E={subtypeField:this.layer.subtypeField,sublayers:Array.from(this.layer.sublayers,H=>({featureReduction:null,geometryType:this.layer.geometryType,labelingInfo:H.labelingInfo,labelsVisible:H.labelsVisible,renderer:H.renderer,subtypeCode:H.subtypeCode,orderBy:null}))};
return r.createSubtypeProcessorSchema(p,x,E,u)}addFilters(p,x){p=v.addFloorFilter(this.layer,p,x);var u=this.layer.sublayers.filter(E=>!(E.visible&&(0===E.minScale||m.floatEqualAbsolute(x.scale,E.minScale)||x.scale<E.minScale)&&(0===E.maxScale||m.floatEqualAbsolute(x.scale,E.maxScale)||x.scale>E.maxScale))).map(E=>E.subtypeCode);if(!u.length)return p;p??=new w;u=`NOT ${this.layer.subtypeField} IN (${u.join(",")})`;p.where=l.sqlAnd(p.where,u);return p}get hasRequiredSupport(){return!0}get timeOptions(){return this.layer}getUpdateHashProperties(p){return[()=>
this.layer.apiKey,()=>this.layer.customParameters,()=>this.layer.definitionExpression,()=>v.hasFloorFilter(this.layer,p)?p.floors:null,()=>this.layer.outFields,()=>this.layer.gdbVersion,()=>this.layer.historicMoment,()=>this.layer.sublayers.map(({renderer:x,labelsVisible:u,labelingInfo:E,visible:H,minScale:O,maxScale:J})=>({renderer:x,labelsVisible:u,labelingInfo:E,visible:H,minScale:O,maxScale:J}))]}setGraphicOrigin(p){var x=this.layer.fieldsIndex.get(this.layer.subtypeField);const u=p.attributes[x.name];
x=this.layer.sublayers.find(E=>E.subtypeCode===u);p.layer=p.sourceLayer=x}}g.SubtypeGroupLayerAdapter=c;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/features/schema/processor/SubtypeProcessorSchema":function(){define("exports ./LabelMatcherSchema ./MatcherSchema ./StorageSchema ./VisualVariablesSchema ../../../../../webgl/capabilities".split(" "),function(g,k,n,m,l,z){async function w(t,{subtypeField:h,sublayers:f}){const r=await Promise.all(f.map(({renderer:c})=>
n.createMatcherSchema(t,c)));return{type:"subtype",subtypeField:h,renderers:f.reduce((c,{subtypeCode:p},x)=>({...c,[p]:r[x]}),{})}}function A(t,h){const f=z.getWebGLCapabilities();return{type:"multi",filters:t.filters,capabilities:{maxTextureSize:f.maxTextureSize},keyField:h.subtypeField,target:"feature",bindings:h.sublayers.reduce((r,{renderer:c,subtypeCode:p})=>{c=m.createVVBindings(c);return{...r,[p]:c}},{})}}async function v(t,{subtypeField:h,sublayers:f}){const r=await Promise.all(f.map(c=>{const p=
l.createVisualVariableUniforms(c.renderer);return k.createLabelMatcherSchema(t,{...c,geometryType:c.geometryType??null},p)}));return{type:"subtype",subtypeField:h,renderers:f.reduce((c,{subtypeCode:p},x)=>({...c,[p]:r[x]}),{})}}g.createSubtypeProcessorSchema=async function(t,h,f,r){return{storage:A(h,f),mesh:{properties:{timeZone:h.timeZone,displayRefreshVersion:r,returnMeshObjectId:!1,sortKey:null,currentUser:h.currentUser},strategy:{type:"feature"},factory:{symbology:await w(t,f),labels:await v(t,
f)}},expressionProperties:{timeExtent:h.timeExtent?.toJSON()}}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/DebouncedFeatureOverride":function(){define(["exports"],function(g){class k{constructor(){this._commands=new Map;this._historicMoment=null}add(n){switch(n.type){case "override":return this._addOverride(n);case "override-by-id":return this._addOverrideById(n)}}toMessage(){const n={historicMoment:this._historicMoment,commands:{updateByIdWeak:[],
updateWeak:[],removeWeak:[],update:[],remove:[],release:[]}};for(const [m,l]of this._commands.entries())switch(l.type){case "override-update-by-id":n.commands.updateByIdWeak.push(m);break;case "override-update":l.isWeak?n.commands.updateWeak.push(l.feature):n.commands.update.push(l.feature);break;case "override-remove":l.isWeak?n.commands.removeWeak.push(m):n.commands.remove.push(m);break;case "override-release":n.commands.release.push(m)}return n}_addOverrideById(n){this._historicMoment=n.historicMoment;
for(const m of n.updates)this._commands.set(m,{type:"override-update-by-id",isWeak:n.isWeak});for(const m of n.removed)this._commands.set(m,{type:"override-remove",isWeak:n.isWeak})}_addOverride(n){this._historicMoment=n.historicMoment;for(const m of n.updates)this._commands.set(m.objectId,{type:"override-update",feature:m,isWeak:n.isWeak});for(const m of n.removed)this._commands.set(m,{type:"override-remove",isWeak:n.isWeak});for(const m of n.release)this._commands.set(m,{type:"override-release"})}}
g.DebouncedFeatureOverride=k;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/layers/support/handleNoEngineError":function(){define(["exports"],function(g){g.handleNoEngineError=async function(k,n){try{return await k}catch(m){if("no-queryEngine"!==m.name)throw m;return n}};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/2d/tiling/FeatureTileSubscriptionManager":function(){define(["exports","./TileKey"],function(g,k){function n(w,A){const v=
new Set;for(const t of w instanceof Set?w.values():w.keys())A.has(t)||v.add(t);return v}class m{constructor(w,A,v){v=v?w.getTileCoverage(v,0,!0,"closest"):null;w=w.getTileCoverage(A,0,!0,"closest");this._tileKeys=new Map;if(v)for(const t of v.keys())this._tileKeys.set(t.id,t);if(w)for(const t of w.keys())this._tileKeys.set(t.id,t)}get coverageSet(){return new Set(this._tileKeys.keys())}keys(){return this._tileKeys.values()}}class l{constructor(w){this.version=w}}class z{constructor(w){this._subscriptions=
new Map;this._visible=new Set;this._paused=new Set;this._version=0;this._config=w}destroy(){}get _coverageSet(){return this._coverage?.coverageSet??new Set}suspend(){this._suspendedOverage=this._coverage;this._coverage=null;this._updateSubscriptions()}resume(){null==this._coverage&&(this._coverage=this._suspendedOverage,this._suspendedOverage=null,this._updateSubscriptions())}update(w,A){this._version=(this._version+1)%Number.MAX_SAFE_INTEGER;this._updateCoverage(w,A);this._updateSubscriptions();
return new Set(this._visible)}_updateCoverage(w,A){this._coverage=new m(this._config.tileInfoView,w,A)}_updateSubscriptions(){var w=this._coverageSet;const A=this._updateVisibility();var v=n(A,w);const t=n(this._subscriptions,A),h=n(w,this._subscriptions);w=n(t,w);v=n(v,w);v=n(v,this._paused);this._visible=A;for(const f of h.values())this._subscriptions.set(f,new l(this._version));for(const f of v.values())this._paused.add(f);for(const f of w.values())this._subscriptions.delete(f),this._paused.delete(f);
(h.size||w.size||v.size)&&this._sendUpdateSubscriptions(h,w,v)}_sendUpdateSubscriptions(w,A,v){w=Array.from(w.values()).map(t=>({tileId:t,version:this._subscriptions.get(t).version}));this._config.updateSubscriptions({subscribe:w,unsubscribe:Array.from(A.values()),pause:Array.from(v.values())})}_updateVisibility(){const w=new Set,A=new Set;if(!this._coverage)return w;for(var v of this._coverage.keys())this._config.isDone(v)?w.add(v.id):this._addVisibleParent(w,A,v)||this._addVisibleChildren(w,v)||
w.add(v.id);v=new k(0,0,0,0);const t=new k(0,0,0,0);for(const h of A){v.id=h;for(const f of w)t.id=f,v.containsChild(t)&&w.delete(f)}return w}_addVisibleParent(w,A,v){let t=!1;for(const h of this._visible.values())(new k(h)).containsChild(v)&&(w.add(h),A.add(h),t=!0);return t}_addVisibleChildren(w,A){let v=!1;for(const t of this._visible.values()){const h=new k(t);A.containsChild(h)&&(w.add(t),v=!0)}return v}}g.FeatureTileSubscriptionManager=z;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},
"esri/views/layers/FeatureLayerView":function(){define("../../chunks/tslib.es6 ../../core/Error ../../core/has ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/sql ../../core/accessorSupport/decorators/property ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../layers/knowledgeGraph/constants ../../layers/support/displayFilterUtils ../../layers/support/FeatureEffect ../../layers/support/FeatureFilter ../../layers/support/featureLayerUtils ../../layers/support/fieldUtils ../../layers/support/floorFilterUtils ../../networks/support/networkFieldUtils ../../rest/support/Query ../../support/arcadeOnDemand ./support/popupUtils ./support/WhereClauseVisitor".split(" "),
function(g,k,n,m,l,z,w,A,v,t,h,f,r,c,p,x,u,E,H,O,J,S){return T=>{T=class extends T{constructor(...B){super(...B);this.layer=this.filter=this._updatingRequiredPromise=null;this.requiresCurrentUser=!1;this.requiredFields=[];this.view=null}initialize(){this.addHandles([z.watch(()=>{const B=this.layer,d=this.view;return[B&&"elevationInfo"in B?B.elevationInfo?.featureExpressionInfo:null,B&&"displayField"in B?B.displayField:null,B&&"timeInfo"in B&&B.timeInfo,B&&"renderer"in B&&B.renderer,B&&"labelingInfo"in
B&&B.labelingInfo,B&&"floorInfo"in B&&B.floorInfo,d?.requiredFieldsOptions?.featureTitleFields&&B&&"featureTitleFields"in B&&B.featureTitleFields,d?.requiredFieldsOptions?.utilityNetworkFields&&E.getUtilityNetworkFields(d,B),B.displayFilterInfo,this.displayFilterEnabled,this.filter,this.featureEffect,this.timeExtent,"knowledge-graph-sublayer"===B?.type&&"link-chart"===B.parentCompositeLayer.type&&B.parentCompositeLayer.linkChart?.linkChartProperties.nonspatialDataDisplay?.mode,"parquet"===B?.type&&
B.popupTemplate]},()=>this._handleChange(),z.syncAndInitial),z.on(()=>this.view?.floors,"change",()=>this._handleChange()),z.on(()=>this.layer.displayFilterInfo?.filters,"change",()=>this._handleChange()),z.on(()=>this.layer&&"sublayers"in this.layer?this.layer.sublayers:null,"change",()=>this._handleChange())])}get availableFields(){if(!this.layer)return[];const {layer:B,layer:{fieldsIndex:d},requiredFields:D}=this;return"outFields"in B&&B.outFields?x.fixFields(d,[...x.unpackFieldNames(d,B.outFields),
...D]):x.fixFields(d,D)}get displayFilterEnabled(){return(this.view?.displayFilterEnabled??!0)&&(!("displayFilterEnabled"in this.layer)||(this.layer?.displayFilterEnabled??!0))}get effectiveDisplayFilter(){const B=this.layer;return this.displayFilterEnabled&&B.displayFilterInfo?f.getEffectiveDisplayFilter(B.displayFilterInfo,this.view):null}get featureEffect(){return this.layer&&"featureEffect"in this.layer?this.layer.featureEffect:null}set featureEffect(B){this._override("featureEffect",B)}get maximumNumberOfFeatures(){return 0}set maximumNumberOfFeatures(B){m.getLogger(this).error("#maximumNumberOfFeatures\x3d",
"Setting maximum number of features is not supported")}get maximumNumberOfFeaturesExceeded(){return!1}get signedInUser(){return this.layer?.url?p.getSignedInUser(this.layer.url):Promise.resolve(null)}highlight(B,d){throw Error("missing implementation");}createQuery(){var B={outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference};B=null!=this.filter?this.filter.createQuery(B):new H(B);"floorInfo"in this.layer&&this.layer.floorInfo&&(B.where=w.sqlAnd(B.where,u.getFloorFilterClause(this)));
this.displayFilterEnabled&&(B.where=w.sqlAnd(B.where,this.effectiveDisplayFilter?.where));null!=this.timeExtent&&(B.timeExtent=null!=B.timeExtent?B.timeExtent.intersection(this.timeExtent):this.timeExtent.clone());return B}createAggregateQuery(){return new H({outFields:["*"],returnGeometry:!0,outSpatialReference:this.view.spatialReference})}queryFeatures(B,d){throw Error("missing implementation");}queryObjectIds(B,d){throw Error("missing implementation");}queryFeatureCount(B,d){throw Error("missing implementation");
}queryExtent(B,d){throw Error("missing implementation");}async fetchPopupFeaturesFromGraphics(B,d){this._validateFetchPopupFeatures(B,d);return this._fetchPopupFeatures(B,d)}_loadArcadeModules(B){return B.expressionInfos?.length||Array.isArray(B.content)&&B.content.some(d=>"expression"===d.type)?O.loadArcade():Promise.resolve()}_handleChange(){const B=Promise.all([this._updateRequiredFields(),this._updateClientWhereClauseRequirements()]).then(()=>{});this._set("_updatingRequiredPromise",B);B.then(()=>
{this._updatingRequiredPromise===B&&this._set("_updatingRequiredPromise",null)});return B}async _updateClientWhereClauseRequirements(){if(this.layer&&this.view){var {layer:B}=this,d=new S.WhereClauseVisitor(B.fieldsIndex);d.visitFilter(this.filter);"featureReduction"in B&&d.visitFeatureReduction(B.featureReduction);"labelingInfo"in B&&d.visitLabelingInfo(B.labelsVisible,B.labelingInfo);"trackInfo"in B&&d.visitTrackInfo(B.trackInfo);"2d"===this.view.type&&(d.visitFilter(this.featureEffect?.filter),
d.visitDisplayFilter(this.displayFilterEnabled,B.displayFilterInfo),"featureReduction"in B&&d.visitFeatureReduction(B.featureReduction));if("subtype-group"===B.type)for(const D of B.sublayers)d.visitLabelingInfo(D.labelsVisible,D.labelingInfo);try{const D=await d.finish();this._set("requiresCurrentUser",D.requiresCurrentUser)}catch(D){m.getLogger(this).error(D)}}}async _updateRequiredFields(){if(this.layer&&this.view){var B="3d"===this.view.type,{layer:d,layer:{fieldsIndex:D,objectIdField:I}}=this,
Q="renderer"in d&&d.renderer,L="orderBy"in d&&d.orderBy,P="featureReduction"in d?d.featureReduction:null,R=new Set;Q=[Q?Q.collectRequiredFields(R,D):null,x.collectLabelingFields(R,d),B&&"elevationInfo"in d?x.collectElevationFields(R,d):null,null!=this.filter?x.collectFilterFields(R,d,this.filter):null,B||null==this.featureEffect?null:x.collectFilterFields(R,d,this.featureEffect.filter),!B&&P?x.collectFeatureReductionFields(R,d,P):null,!B&&L?x.collectOrderByInfos(R,d,L):null];"timeInfo"in d&&d.timeInfo&&
this.timeExtent&&x.collectFields(R,d.fieldsIndex,[d.timeInfo.startField,d.timeInfo.endField]);"timeInfo"in d&&d.timeInfo&&"trackInfo"in d&&d.trackInfo&&({trackInfo:L}=d,x.collectFields(R,d.fieldsIndex,[d.timeInfo.trackIdField]),"feature"!==d.type&&"startTimeField"!==L.timeField||x.collectFields(R,d.fieldsIndex,[d.timeInfo.startField]),"endTimeField"===L.timeField&&x.collectFields(R,d.fieldsIndex,[d.timeInfo.endField]),await x.collectTrackInfoFields(R,d));"floorInfo"in d&&d.floorInfo&&x.collectFields(R,
d.fieldsIndex,[d.floorInfo.floorField]);"featureTitleFields"in d&&this.view?.requiredFieldsOptions?.featureTitleFields&&d.featureTitleFields&&x.collectFields(R,d.fieldsIndex,d.featureTitleFields);"feature"===d.type&&d.globalIdField&&this.view?.requiredFieldsOptions?.globalIdField&&x.collectFields(R,d.fieldsIndex,[d.globalIdField]);this.displayFilterEnabled&&Q.push(x.collectDisplayFilterFields(R,d,d.displayFilterInfo));"feature"===d.type&&B&&null!=d.infoFor3D&&(null==d.globalIdField&&m.getLogger(this).error("globalIdField missing on 3DObjectFeatureLayer"),
x.collectFields(R,d.fieldsIndex,[d.globalIdField]));"subtype-group"===d.type&&(x.collectField(R,D,d.subtypeField),L=d.sublayers.map(e=>Promise.all([e.renderer?.collectRequiredFields(R,D),x.collectLabelingFields(R,e)])),Q.push(Promise.all(L)));"catalog-footprint"===d.type&&d.parent&&(L=d.parent,x.collectFields(R,D,[L.itemNameField,L.itemSourceField,L.itemTypeField,L.maxScaleField,L.minScaleField]));"knowledge-graph-sublayer"===d.type&&"link-chart"===d.parentCompositeLayer.type&&x.collectField(R,D,
h.systemIsSpatialFieldName);"parquet"===d.type&&Q.push(J.getRequiredFields(d,d.popupTemplate).then(e=>{for(const M of e)R.add(M)}));Q=await Promise.allSettled(Q);x.collectField(R,D,I);B&&"displayField"in d&&d.displayField&&x.collectField(R,D,d.displayField);for(const e of Q)"rejected"===e.status&&m.getLogger(this).error(e.reason);B=Array.from(R).sort();this._set("requiredFields",B)}}_validateFetchPopupFeatures(B,d){if(null!=d)for(const D of B){B=D.origin&&"layer"in D.origin?D.origin.layer:D.layer;
if("popupEnabled"in B&&!B.popupEnabled)throw new k("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:B});if(D.isAggregate){const I="featureReduction"in B?B.featureReduction:null,Q="trackInfo"in B?B.trackInfo:null;if(null==I&&null==Q||null!=I&&!("popupTemplate"in I&&I.popupEnabled&&I.popupTemplate)||Q?.enabled&&!("popupTemplate"in Q&&Q.popupEnabled&&Q.popupTemplate))throw new k("featurelayerview:fetchPopupFeatures","Popups are disabled",{layer:B});}else if("popupTemplate"in B&&!J.getFetchPopupTemplate(B,
d))throw new k("featurelayerview:fetchPopupFeatures","Layer does not define a popup template",{layer:B});}}_popupFeatureHasRequiredFields(B,d){return x.featureHasFields(d,B)}async _fetchPopupFeatures(B,d){const D=Array(B.length),I=new Map,Q=await this._createPopupQuery(B.map(P=>P.origin?.layer??P.layer),d);for(let P=0;P<B.length;P++){const R=B[P];if(R.isAggregate){D[P]=R;continue}var L=R.origin?.layer??R.layer;if(!(L&&"popupEnabled"in L))continue;const e=x.unpackFieldNames(this.layer.fieldsIndex,
Q.outFields);L=J.getFetchPopupTemplate(L,d);if(null==L)continue;const M=await this._loadArcadeModules(L);l.throwIfAborted(d);M&&M.arcadeUtils.hasGeometryOperations(L)||!this._popupFeatureHasRequiredFields(R,e)?I.set(R.getObjectId(),{graphic:R,index:P}):D[P]=R}if("stream"===this.layer.type||"parquet"===this.layer.type||0===I.size)return D.filter(Boolean);Q.objectIds=Array.from(I.keys());try{const P=await this.layer.queryFeatures(Q,d);for(const R of P.features){const {graphic:{geometry:e,origin:M},
index:ca}=I.get(R.getObjectId());let Z;(Z=R).geometry||(Z.geometry=e);R.origin=M;D[ca]=R}}catch{}return D.filter(Boolean)}async _createPopupQuery(B,d){const D=this.layer.createQuery(),I=new Set;var Q=!1;B=B??[this.layer];for(const L of B)if("popupEnabled"in L&&(B=J.getFetchPopupTemplate(L,d),null!=B)){Q=await this._loadArcadeModules(B);l.throwIfAborted(d);Q=Q&&Q.arcadeUtils.hasGeometryOperations(B);Q=!("point"!==this.layer.geometryType&&!Q);B=await J.getRequiredFields(this.layer,B);l.throwIfAborted(d);
for(const P of B)I.add(P)}D.returnGeometry=Q;D.returnZ=Q;D.returnM=Q;D.outFields=Array.from(I);D.outSpatialReference=this.view.spatialReference;"floorInfo"in this.layer&&this.layer.floorInfo&&(d=u.getFloorFilterClause(this),null!=d&&(D.where=D.where?`(${D.where}) AND (${d})`:d));return D}canResume(){return!super.canResume()||null!=this.timeExtent&&this.timeExtent.isEmpty?!1:!0}getTest(){}get test(){}};g.__decorate([A.property()],T.prototype,"_updatingRequiredPromise",void 0);g.__decorate([A.property({readOnly:!0})],
T.prototype,"availableFields",null);g.__decorate([A.property({readOnly:!0})],T.prototype,"displayFilterEnabled",null);g.__decorate([A.property({readOnly:!0})],T.prototype,"effectiveDisplayFilter",null);g.__decorate([A.property({type:r})],T.prototype,"featureEffect",null);g.__decorate([A.property({type:c})],T.prototype,"filter",void 0);g.__decorate([A.property()],T.prototype,"layer",void 0);g.__decorate([A.property({type:Number})],T.prototype,"maximumNumberOfFeatures",null);g.__decorate([A.property({readOnly:!0,
type:Boolean})],T.prototype,"maximumNumberOfFeaturesExceeded",null);g.__decorate([A.property()],T.prototype,"requiresCurrentUser",void 0);g.__decorate([A.property({readOnly:!0})],T.prototype,"requiredFields",void 0);g.__decorate([A.property({readOnly:!0})],T.prototype,"signedInUser",null);g.__decorate([A.property()],T.prototype,"suspended",void 0);g.__decorate([A.property()],T.prototype,"view",void 0);return T=g.__decorate([t.subclass("esri.views.layers.FeatureLayerView")],T)}})},"esri/layers/support/floorFilterUtils":function(){define(["exports"],
function(g){function k(n,m){if(!n?.length)return null;n=n.filter(l=>""!==l).map(l=>`'${l}'`);n.push("''");return`${m} IN (${n.join(",")}) OR ${m} IS NULL`}g.getFloorFilterClause=function(n){const m=n.layer;return"floorInfo"in m&&m.floorInfo?.floorField&&"floors"in n.view?k(n.view.floors,m.floorInfo.floorField):null};g.getLayerFloorFilterClause=function(n,m){return"floorInfo"in m&&m.floorInfo?.floorField?k(n,m.floorInfo.floorField):null};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},
"esri/networks/support/networkFieldUtils":function(){define(["exports"],function(g){g.getAssociationsTableFields=function(k){const n=k?.fieldsIndex;return{fromNetworkSourceId:n?.get("fromnetworksourceid")?.name??"fromnetworksourceid",fromGlobalId:n?.get("fromglobalid")?.name??"fromglobalid",fromTerminalId:n?.get("fromterminalid")?.name??"fromterminalid",toNetworkSourceId:n?.get("tonetworksourceid")?.name??"tonetworksourceid",toGlobalId:n?.get("toglobalid")?.name??"toglobalid",toTerminalId:n?.get("toterminalid")?.name??
"toterminalid",status:n?.get("status")?.name??"status",associationType:n?.get("associationtype")?.name??"associationtype",isContentVisible:n?.get("iscontentvisible")?.name??"iscontentvisible",percentAlong:n?.get("percentalong")?.name??"percentalong",globalId:n?.get(k?.globalIdField??"globalid")?.name??"globalid"}};g.getUtilityNetworkFields=function(k,n){if("feature"!==n.type&&"subtype-group"!==n.type||!n.url)return[];k="utilityNetworks"in k.map?k.map.utilityNetworks??[]:[];for(var m of k)if(m.isUtilityLayer(n))return m=
n.fieldsIndex.get("assetgroup"),n=n.fieldsIndex.get("assettype"),[m?.name,n?.name].filter(l=>null!=l);return[]};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/popupUtils":function(){define(["exports","../../../layers/support/fieldUtils"],function(g,k){function n(m,l){return m.popupTemplate?m.popupTemplate:null!=l&&l.defaultPopupTemplateEnabled&&null!=m.defaultPopupTemplate?m.defaultPopupTemplate:null}g.getFetchPopupTemplate=n;g.getRequiredFields=async function(m,
l=m.popupTemplate){if(null==l)return[];const z=await l.getRequiredFields(m.fieldsIndex);({lastEditInfoEnabled:l}=l);const {objectIdField:w,typeIdField:A,globalIdField:v,relationships:t}=m;if(z.includes("*"))return["*"];l=l?k.getFeatureEditFields(m):[];const h=k.fixFields(m.fieldsIndex,[...z,...l]);A&&h.push(A);h&&w&&m.fieldsIndex?.has(w)&&!h.includes(w)&&h.push(w);h&&v&&m.fieldsIndex?.has(v)&&!h.includes(v)&&h.push(v);t&&t.forEach(f=>{({keyField:f}=f);h&&f&&m.fieldsIndex?.has(f)&&!h.includes(f)&&
h.push(f)});return h};g.hasPopupTemplate=function(m,l){return null!=n(m,{defaultPopupTemplateEnabled:l})};Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/support/WhereClauseVisitor":function(){define(["exports","../../../core/sql"],function(g,k){class n{constructor(m){this._fieldsIndex=m;this._clauses=[]}async finish(){return{requiresCurrentUser:(await Promise.all(this._clauses)).some(m=>m.currentUserRequired)}}visitClientWhereClause(m){m&&this._clauses.push(k.parseWhereClause(m,
this._fieldsIndex))}visitFeatureReduction(m){if(m)switch(m.type){case "binning":case "cluster":this.visitLabelingInfo(m.labelsVisible,m.labelingInfo)}}visitLabelingInfo(m,l){if(m&&null!=l)for(const z of l)this.visitClientWhereClause(z.where)}visitDisplayFilter(m,l){if(m)for(const z of l?.filters??[])this.visitClientWhereClause(z.where)}visitFilter(m){this.visitClientWhereClause(m?.where)}visitTrackInfo(m){null!=m&&(this.visitLabelingInfo(m?.latestObservations.labelsVisible,m?.latestObservations.labelingInfo),
this.visitLabelingInfo(m?.previousObservations.labelsVisible,m?.previousObservations.labelingInfo),this.visitLabelingInfo(m?.trackLines.labelsVisible,m?.trackLines.labelingInfo))}}g.WhereClauseVisitor=n;Object.defineProperty(g,Symbol.toStringTag,{value:"Module"})})},"esri/views/layers/RefreshableLayerView":function(){define("../../chunks/tslib.es6 ../../core/Logger ../../core/promiseUtils ../../core/reactiveUtils ../../core/has ../../core/RandomLCG ../../core/Error ../../core/accessorSupport/decorators/subclass".split(" "),
function(g,k,n,m,l,z,w,A){return v=>{v=class extends v{initialize(){this.addHandles(m.on(()=>this.layer,"refresh",t=>{this.doRefresh(t.dataChanged).catch(h=>{n.isAbortError(h)||k.getLogger(this).error(h)})}),"RefreshableLayerView")}};return v=g.__decorate([A.subclass("esri.views.layers.RefreshableLayerView")],v)}})},"*noref":1}});
define("../../../chunks/tslib.es6 ../../../AggregateGraphic ../../../Graphic ../../../TrackGraphic ../../../core/arrayUtils ../../../core/Collection ../../../core/compilerUtils ../../../core/Error ../../../core/handleUtils ../../../core/has ../../../core/Logger ../../../core/maybe ../../../core/object ../../../core/promiseUtils ../../../core/reactiveUtils ../../../core/sql ../../../core/accessorSupport/decorators/property ../../../core/accessorSupport/decorators/subclass ../../../core/support/UpdatingHandles ../../../geometry/Extent ../../../layers/effects/FeatureEffectView ../../../layers/graphics/featureConversionUtils ../../../layers/support/FeatureFilter ../../../layers/support/featureLayerUtils ../../../layers/support/fieldUtils ../../../layers/support/layerUtils ../../../layers/support/timeSupport ../../../rest/support/AggregateFeatureSet ../../../rest/support/AttributeBinsFeatureSet ../../../rest/support/AttributeBinsQuery ../../../rest/support/FeatureSet ../../../rest/support/Query ./LayerView2D ./features/FeatureContainer ./features/FeaturePipelineWorkerProxy ./features/FeatureSourceEventLog ./features/layerAdapters/CatalogFootprintLayerAdapter ./features/layerAdapters/FeatureLayerAdapter ./features/layerAdapters/InMemoryLayerAdapter ./features/layerAdapters/KnowledgeGraphSublayerAdapter ./features/layerAdapters/OGCFeatureLayerAdapter ./features/layerAdapters/OrientedImageryLayerAdapter ./features/layerAdapters/ParquetLayerAdapter ./features/layerAdapters/StreamLayerAdapter ./features/layerAdapters/SubtypeGroupLayerAdapter ./features/schema/processor/symbols/ComplexSymbolSchema ./support/DebouncedFeatureOverride ./support/FeatureCommandQueue ./support/handleNoEngineError ./support/util ../tiling/FeatureTileSubscriptionManager ../../layers/FeatureLayerView ../../layers/LayerView ../../layers/RefreshableLayerView ../../support/HighlightDefaults".split(" "),function(g,
k,n,m,l,z,w,A,v,t,h,f,r,c,p,x,u,E,H,O,J,S,T,B,d,D,I,Q,L,P,R,e,M,ca,Z,Y,oa,W,fa,pa,ja,la,ma,na,da,ia,sa,Ca,ba,Da,ua,Ea,ta,Fa,ya){function Ia(q,F){const K=new Set;q&&q.forEach(N=>K.add(N));F&&F.forEach(N=>K.add(N));return K.has("*")?["*"]:Array.from(K)}function qa(q,F){return v.handlesGroup(q.map(K=>p.watch(()=>{const N=K();return N&&"object"===typeof N?"getTime"in N&&"function"===typeof N.getTime?N.getTime():JSON.stringify(N):N},F)))}M=class extends Ea(Fa(M.LayerView2DMixin(ta))){constructor(){super(...arguments);
this._commandsQueue=new Ca.FeatureCommandQueue({process:q=>{switch(q.type){case "override-batch":return this._doOverride(q);case "update":return this._doUpdate();case "highlight":return this._updateHighlights()}}});this._visibilityOverrides=new Set;this._lastAvailableFields=[];this._lastTargetState=null;this.eventLog=new Y.FeatureSourceEventLog;this._displayRefreshVersion=this._sourceRefreshVersion=1;this._pipelineUpdating=!1;this._editUpdatingHandles=new H.UpdatingHandles;this._fields=null;this._sourceUpdating=
!1;this.featureEffectView=new J}destroy(){this._workerProxy?.destroy();this._workerAttached.reject(c.createAbortError());this._commandsQueue.destroy()}initialize(){this._workerAttached=c.createResolver();c.ignoreAbortErrors(this._workerAttached.promise);this.addResolvingPromise(this._initProxy());this.featureEffectView.featureEffect=this.featureEffect;this.featureEffectView.endTransition()}async _initProxy(){var q=this.layer;if("isTable"in q&&q.isTable)throw new A("featurelayerview:table-not-supported",
"table feature layer can't be displayed",{layer:q});if(("feature"===q.type||"subtype-group"===q.type)&&!1===D.getEffectiveLayerCapabilities(q)?.operations.supportsQuery)throw new A("featurelayerview:query-not-supported","layer view requires a layer with query capability",{layer:q});this._workerProxy&&this._workerProxy.destroy();q=this._createClientOptions();this._workerProxy=await Z.createFeaturePipelineWorkerProxy(q)}async _attachProxy(){const q={service:await this.layerAdapter.createServiceOptions(this.view),
tileInfoJSON:this.view?.featuresTilingScheme?.tileInfo?.toJSON()};let F=[];Array.isArray(q.service.source)&&(F=q.service.source);try{await this._workerProxy.pipeline.onAttach(q,{transferList:F}),this._workerAttached.resolve()}catch(K){this._workerAttached.reject(c.createAbortError()),c.throwIfNotAbortError(K)}}async _detachProxy(){return this._workerProxy.pipeline.onDetach()}async getWorker(){await this._workerAttached.promise;return this._workerProxy}get dataUpdating(){return this._sourceUpdating||
this._editUpdatingHandles.updating}get effectiveDisplayFilterClause(){const q=this.effectiveDisplayFilter?.where??null;return q&&this.hasHighlight?x.sqlOr(q,x.sqlIn(this.layer.objectIdField,this.highlightIds)):q}get hasAllFeatures(){return this.layer.visible&&!this.suspended&&this.eventLog.hasAllData&&this.eventLog.willQueryAllFeatures}get hasAllFeaturesInView(){var q=this.effectiveDisplayFilter?.where||null;q=!this.eventLog.willQueryAllFeatures&&null!=q&&"1\x3d1"!==q;return this.layer.visible&&!this.suspended&&
this.eventLog.hasAllData&&!q}get hasFullGeometries(){return this.layer.visible&&!this.suspended&&this.eventLog.hasAllData&&this.eventLog.willQueryFullResolutionGeometry}get labelingCollisionInfos(){const q=this.layerAdapter.getLabelingDeconflictionInfo(this.view),F=this.layer.geometryType,K=!this.suspended;return q.map(({vvEvaluators:N,deconflictionEnabled:X})=>({container:this.featureContainer,vvEvaluators:N,deconflictionEnabled:X,geometryType:F,visible:K}))}get layerAdapter(){switch(this.layer.type){case "feature":return"memory"===
this.layer.source.type?new fa.InMemoryLayerAdapter(this.layer):new W.FeatureLayerAdapter(this.layer);case "geojson":case "csv":case "wfs":return new fa.InMemoryLayerAdapter(this.layer);case "parquet":return new ma.ParquetLayerAdapter(this.layer);case "subtype-group":return new da.SubtypeGroupLayerAdapter(this.layer);case "ogc-feature":return new ja.OGCFeatureLayerAdapter(this.layer);case "stream":return new na.StreamLayerAdapter(this.layer);case "oriented-imagery":return new la.OrientedImageryLayerAdapter(this.layer);
case "knowledge-graph-sublayer":return new pa.KnowledgeGraphSublayerAdapter(this.layer);case "catalog-footprint":return new oa.CatalogFootprintLayerAdapter(this.layer);default:w.neverReached(this.layer)}return null}get timeExtent(){return I.combineTimeExtent(this.layerAdapter.timeOptions,this.view?.timeExtent,this._get("timeExtent"))}getDisplayStatistics(q,F){return this.featureContainer?.getDisplayStatistics(q,F)}async queryHeatmapStatistics(q){return(await this.getWorker()).pipeline.queryHeatmapStatistics(q)}highlight(q,
F){let K;q instanceof n?K=[q.getObjectId()]:"number"===typeof q||"string"===typeof q?K=[q]:z.isCollection(q)&&0<q.length?K=q.map(V=>V?.getObjectId()).toArray():Array.isArray(q)&&0<q.length&&(K="number"===typeof q[0]||"string"===typeof q[0]?q:q.map(V=>V?.getObjectId()));const N=K?.filter(l.isSome);if(!N?.length)return v.makeHandle();const X=F?.name??ya.defaultHighlightName;this._addHighlights(N,X);return v.makeHandle(()=>!this.destroyed&&this._removeHighlights(N,X))}async hitTest(q,F){F=await this.featureContainer.hitTest(F);
if(0===F.length)return null;const K=await this.getWorker(),{features:N,aggregates:X,tracks:V}=await K.pipeline.getDisplayFeatures(F),ea=this.featureContainer.getSortKeys(F);F=({displayId:aa},{displayId:ra})=>ea.has(aa)&&ea.has(ra)?ea.get(aa)-ea.get(ra):aa-ra;N.sort(F).reverse();X.sort(F).reverse();return[...X.map(aa=>this._createGraphicHit(q,k.fromJSON(aa))),...V.map(aa=>this._createGraphicHit(q,m.fromJSON(aa))),...N.map(aa=>this._createGraphicHit(q,n.fromJSON(aa)))]}async queryStatistics(){const q=
await this.getWorker();return ba.handleNoEngineError(q.pipeline.queryStatistics(),{featureCount:0,ringCount:0,vertexCount:0})}async querySummaryStatistics(q,F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};q=N.features.executeQueryForSummaryStatistics(this._cleanUpQuery(q),F,K);return ba.handleNoEngineError(q,{})}async queryAggregateSummaryStatistics(q,F,K){F={...F,scale:this.view.scale};q=(await this.getWorker()).aggregates.executeQueryForSummaryStatistics(this._cleanUpAggregateQuery(q),
F,K);return ba.handleNoEngineError(q,{})}async queryUniqueValues(q,F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};q=N.features.executeQueryForUniqueValues(this._cleanUpQuery(q),F,K);return ba.handleNoEngineError(q,{uniqueValueInfos:[]})}async queryAggregateUniqueValues(q,F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};q=N.aggregates.executeQueryForUniqueValues(this._cleanUpAggregateQuery(q),F,K);return ba.handleNoEngineError(q,{uniqueValueInfos:[]})}async queryClassBreaks(q,
F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};q=N.features.executeQueryForClassBreaks(this._cleanUpQuery(q),F,K);return ba.handleNoEngineError(q,{classBreakInfos:[]})}async queryAggregateClassBreaks(q,F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};q=N.aggregates.executeQueryForClassBreaks(this._cleanUpAggregateQuery(q),F,K);return ba.handleNoEngineError(q,{classBreakInfos:[]})}async queryHistogram(q,F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};
q=N.features.executeQueryForHistogram(this._cleanUpQuery(q),F,K);return ba.handleNoEngineError(q,{bins:[],maxValue:null,minValue:null,normalizationTotal:null})}async queryAggregateHistogram(q,F,K){const N=await this.getWorker();F={...F,scale:this.view.scale};q=N.aggregates.executeQueryForHistogram(this._cleanUpAggregateQuery(q),F,K);return ba.handleNoEngineError(q,{bins:[],maxValue:null,minValue:null,normalizationTotal:null})}queryFeatures(q,F){return this.queryFeaturesJSON(q,F).then(K=>{K=R.fromJSON(K);
K.features.forEach(N=>this._setLayersForFeature(N));return K})}async queryVisibleFeatures(q,F){q=(await this.getWorker()).pipeline.queryVisibleFeatures(this._cleanUpQuery(q),F);q=await ba.handleNoEngineError(q,{features:[]});q=R.fromJSON(q);q.features.forEach(K=>this._setLayersForFeature(K));return q}async queryAggregates(q,F){q=(await this.getWorker()).aggregates.executeQuery(this._cleanUpAggregateQuery(q),F);q=await ba.handleNoEngineError(q,{features:[]});q=Q.fromJSON(q);q.features.forEach(K=>this._setLayersForFeature(K));
return q}async queryAggregateIds(q,F){q=(await this.getWorker()).aggregates.executeQueryForIds(this._cleanUpAggregateQuery(q),F);return ba.handleNoEngineError(q,[])}async queryAggregateCount(q,F){q=(await this.getWorker()).aggregates.executeQueryForCount(this._cleanUpAggregateQuery(q),F);return ba.handleNoEngineError(q,0)}async queryAggregateJSON(q,F){q=(await this.getWorker()).aggregates.executeQuery(this._cleanUpAggregateQuery(q),F);return ba.handleNoEngineError(q,{features:[]})}async queryFeaturesJSON(q,
F){q=(await this.getWorker()).features.executeQuery(this._cleanUpQuery(q),F);return ba.handleNoEngineError(q,{features:[]})}async queryObjectIds(q,F){q=(await this.getWorker()).features.executeQueryForIds(this._cleanUpQuery(q),F);return ba.handleNoEngineError(q,[])}async queryFeatureCount(q,F){q=(await this.getWorker()).features.executeQueryForCount(this._cleanUpQuery(q),F);return ba.handleNoEngineError(q,0)}async queryExtent(q,F){q=(await this.getWorker()).features.executeQueryForExtent(this._cleanUpQuery(q),
F);q=await ba.handleNoEngineError(q,{count:0,extent:null});return{count:q.count,extent:O.fromJSON(q.extent)}}async queryAttributeBins(q,F){q=(await this.getWorker()).features.executeAttributeBinsQuery(this._cleanUpAttributeBinsQuery(q),F);q=await ba.handleNoEngineError(q,{features:[]});return L.fromJSON(q)}async getSampleFeatures(q){return(await this.getWorker()).pipeline.getSampleFeatures(q)}setVisibility(q,F){F?this._visibilityOverrides.delete(q):this._visibilityOverrides.add(q);this._update()}update(q){this._subscriptionManager&&
(this.view.animation&&!this._lastTargetState&&(this._lastTargetState=q.state.clone()),!this.view.animation&&this._lastTargetState&&(this._lastTargetState=null),q=this._subscriptionManager.update(q.targetState,this._lastTargetState),this.featureContainer.setVisibleTiles(q))}attach(){t("esri-2d-update-debug")&&console.debug("FeatureLayerView2D.attach");c.ignoreAbortErrors(this._updatingHandles.addPromise(this._workerAttached.promise));c.ignoreAbortErrors(this._attachProxy());this.featureContainer=new ca.FeatureContainer(this);
this.container.addChild(this.featureContainer);this.view.timeline.record(`${this.layer.title} (FeatureLayer) Attach`);this._subscriptionManager=new ua.FeatureTileSubscriptionManager({tileInfoView:this.view.featuresTilingScheme,updateSubscriptions:q=>{this.featureContainer.updateSubscriptions(q);c.ignoreAbortErrors(this._updatingHandles.addPromise(this.getWorker().then(F=>F.pipeline.updateSubscriptions(q))))},isDone:q=>this.featureContainer.isDone(q)});this.requestUpdate();this.addAttachHandles([qa([()=>
this._displayRefreshVersion,()=>this.layer.displayFilterInfo,()=>this.timeExtent,()=>this.clips,()=>this.filter,()=>this.effectiveDisplayFilterClause,()=>this.featureEffect,()=>this._sourceRefreshVersion,()=>this.view.timeZone,()=>this.view.timeExtent,...this.layerAdapter.getUpdateHashProperties(this.view)],()=>this._update()),p.watch(()=>this.updateSuspended,q=>{q||(this._subscriptionManager.resume(),this.view.labelManager.requestUpdate())}),p.watch(()=>this.visible,q=>{this.view.labelManager.requestUpdate()})]);
this._update();"stream"!==this.layer.type&&"parquet"!==this.layer.type&&"catalog-footprint"!==this.layer.type&&this.addAttachHandles(this.layer.on("edits",q=>this._editUpdatingHandles.addPromise(this._edit(q))))}detach(){t("esri-2d-update-debug")&&console.debug("FeatureLayerView2D.detach");this._detachProxy();this._fields=null;this.featureContainer.destroy();this.featureContainer=null;this._commandsQueue.clear();this.container.removeAllChildren();this._subscriptionManager=f.destroyMaybe(this._subscriptionManager);
this._workerProxy.pipeline.onDetach();this._workerAttached=c.createResolver();c.ignoreAbortErrors(this._workerAttached.promise);this._lastAvailableFields=[];this._lastSchema=null}viewChange(){this.requestUpdate()}moveEnd(){this.requestUpdate()}addOverrides(q){return this._commandsQueue.push({type:"override",options:{...q,release:[]}})}removeOverrides(q){for(const F of q)if(null==F)throw new A("featurelayerview:bad-override","Tried to remove an override for an invalid objectId",{objectId:F});return this._commandsQueue.push({type:"override",
options:{added:[],updated:[],removed:[],release:q,isWeak:!1,historicMoment:null}})}isUpdating(){const q="renderer"in this.layer&&null!=this.layer.renderer,F=this._commandsQueue.updateTracking.updating,K=null!=this._updatingRequiredPromise,N=this.featureContainer.updatingHandles.updating,X=this.updateRequested||q&&(F||K)||N||this._pipelineUpdating||this.dataUpdating;if(t("esri-2d-log-updating")){console.log(`Updating FLV2D (${this.layer.id}): ${X}\n  -> updateRequested ${this.updateRequested}\n  -> hasRenderer ${q}\n  -> updatingRequiredFields ${K}\n  -> hasPendingCommand ${F}\n  -> dataUpdating ${this.dataUpdating}\n  -> processing ${this._pipelineUpdating}\n  -> updatingContainer ${N}\n`);
for(const V of this.featureContainer.subscriptions())console.log(`    -> Tile[${V.id}] Done: ${V.done}`)}return X}_createClientOptions(){const q=this;return{get container(){return q.featureContainer},setUpdating:F=>{this._set("_pipelineUpdating",F.pipeline);this._set("_sourceUpdating",F.source)},emitEvent:F=>{this.emit(F.name,F.event)},get eventLog(){return q.eventLog},fetch:async F=>{if(t("esri-2d-stabilize-glyphs")){const K=[];for(const N of F)K.push(await q.view.stage.painter.textureManager.rasterizeItem(N));
return K}return Promise.all(F.map(K=>q.view.stage.painter.textureManager.rasterizeItem(K)))},fetchDictionary:F=>Promise.all(F.map(K=>this._fetchDictionaryRequest(K)))}}async _fetchDictionaryRequest(q){try{if("subtype-group"===this.layer.type)throw Error("InternalError: SubtypeGroupLayer does not support dictionary renderer");const F=this.layer.renderer;if(!F||"dictionary"!==F.type)throw Error("InternalError: Expected layer to have a DictionaryRenderer");const K=this._lastSchema.processor.mesh.factory.symbology;
if("dictionary"!==K.type)throw Error("InternalError: Expected schema to be of type 'dictionary'");const N={cimAnalyzer:this.view.stage.cimAnalyzer,cimResourceManager:this.view.stage.painter.textureManager.resourceManager,store:this.featureContainer.instanceStore,scaleExpression:K.scaleExpression};this._fields||(this._fields=this.layer.fields.map(ea=>ea.toJSON()));const X=K.visualVariableUniforms,V=await F.getSymbolAsync(q.feature,{fields:this._fields});return V&&V.data?{type:"dictionary-response",
meshes:await ia.createComplexSymbolInstances(V.data,{uniforms:X,path:"renderer",schemaOptions:N})}:{type:"dictionary-response",meshes:[]}}catch(F){return{type:"dictionary-response",meshes:[]}}}_cleanUpQuery(q){q=e.from(q)||this.createQuery();q.outSpatialReference||(q.outSpatialReference=this.view.spatialReference);return q.toJSON()}_cleanUpAttributeBinsQuery(q){q=P.from(q);q.outSpatialReference||(q.outSpatialReference=this.view.spatialReference);return q.toJSON()}_cleanUpAggregateQuery(q){q=e.from(q)||
this.createAggregateQuery();q.outSpatialReference||(q.outSpatialReference=this.view.spatialReference);const F=q.objectIds??[];for(const K of q.aggregateIds??[])F.push(K);q.objectIds=F;q.aggregateIds=[];return q.toJSON()}async _update(){return this._commandsQueue.push({type:"update"})}_edit(q){return this.updateSuspended?(this._subscriptionManager.suspend(),Promise.resolve()):this._commandsQueue.push({type:"edit",event:q})}async doRefresh(q){this.attached&&(this.updateSuspended&&q||(q?this.incrementSourceRefreshVersion():
this.incrementDisplayRefreshVersion()))}incrementSourceRefreshVersion(){this._sourceRefreshVersion=(this._sourceRefreshVersion+1)%4294967294+1}incrementDisplayRefreshVersion(){this._displayRefreshVersion=(this._displayRefreshVersion+1)%4294967294+1}async _resolveIdenifiers(q){const F=[];var K=[];for(var N of q)null!=N.objectId&&-1!==N.objectId?F.push(N.objectId):null!=N.globalId?K.push(N.globalId):h.getLogger(this).warn("mapview-apply-edits","A feature identifier must contain either a GlobalId or ObjectId. Ignoring",
{identifier:N});N=(q="globalIdField"in this.layer&&this.layer.globalIdField)&&this.availableFields.includes(q);if(K.length&&!N)return h.getLogger(this).error(new A("mapview-apply-edits",`Editing the specified service requires the layer's globalIdField, ${q} to be included the layer's outFields for updates to be reflected on the map`)),F;if(K.length){K=await this._workerProxy.pipeline.getObjectIdsFromGlobalIds(K);for(const X of K)F.push(X)}return F}_resolveOverrides(q){const F=Da.toJSONGeometryType(this.layer.geometryType),
K=this.layer.objectIdField,N=[];for(var X of q.added){const V=S.convertFromFeature(X,F,!1,!1,K);if(null==V.objectId)throw new A("featurelayerview:bad-override","Feature does not have an objectId",{feature:X});N.push(V)}for(const V of q.updated){X=S.convertFromFeature(V,F,!1,!1,K);if(null==X.objectId)throw new A("featurelayerview:bad-override","Feature does not have an objectId",{feature:V});N.push(X)}for(const V of q.removed)if(null==V)throw new A("featurelayerview:bad-override","Tried to remove an invalid objectId",
{objectId:V});return{type:"override",updates:N,removed:q.removed,release:q.release,isWeak:q.isWeak??!1,historicMoment:q.historicMoment??null}}async _resolveEdit(q){const F=this.layer,K=q.historicMoment?.getTime()??null;var N="layerId"in F&&q.editedFeatures?.find(aa=>aa.layerId===F.layerId);if(N&&this._canEditByFeature(N)){const {adds:aa,deletes:ra,updates:va}=N.editedFeatures,za=this.layer.objectIdField;q=va.map(ka=>ka.current);N=ra.map(ka=>"attributes"in ka?{objectId:za?ka.attributes[za]:null}:ka);
N=await this._resolveIdenifiers(N);return this._resolveOverrides({added:aa,updated:q,removed:N,historicMoment:K,isWeak:!0,release:[]})}const [X,V,ea]=await Promise.all([this._resolveIdenifiers(q.addedFeatures),this._resolveIdenifiers(q.updatedFeatures),this._resolveIdenifiers(q.deletedFeatures)]);return{type:"override-by-id",updates:[...X,...V],removed:ea,historicMoment:K,isWeak:!0}}_canEditByFeature(q){const {adds:F,updates:K}=q.editedFeatures;return F.every(N=>this.view.spatialReference.equals(N.geometry?.spatialReference))&&
K.every(N=>this.view.spatialReference.equals(N.current.geometry?.spatialReference))}async _doUpdate(){"featureReduction"in this.layer&&this.layer.featureReduction&&this.layer.featureReduction!==this._lastFeatureReduction&&(this.layer.featureReduction=this.layer.featureReduction?.clone(),this._lastFeatureReduction=this.layer.featureReduction);try{if(await Promise.allSettled([this._handleChange(),B.checkServiceCurrentUserSupport(this.layer)]),!this.destroyed&&this.layerAdapter?.hasRequiredSupport&&
this._subscriptionManager){var q=this.featureContainer.instanceStore;this.featureContainer.attributeView.lockTextureUploads();q.updateStart();var F=this.featureEffect,K={store:q,cimAnalyzer:this.view.stage.cimAnalyzer,cimResourceManager:this.view.stage.painter.textureManager.resourceManager,scaleExpression:void 0},N=await this._createViewSchemaConfig(),X={source:this.layerAdapter.createSourceSchema(N,this._sourceRefreshVersion),processor:await this.layerAdapter.createProcessorSchema(K,N,this._displayRefreshVersion)},
V=r.notDeepEqual(this._lastSchema?.source.mutable,X.source.mutable)||r.notDeepEqual(this._lastSchema?.processor,X.processor);if(V){this._lastSchema=X;this._fields=null;var ea=Math.round(performance.now());t("esri-2d-update-debug")&&console.debug(`Id[${this.layer.uid}] Version[${ea}] FeatureLayerView2D._doUpdate`,{changes:V});await (await this.getWorker()).pipeline.updateSchema(X,ea);q.updateEnd();this.featureEffectView.featureEffect=F;this.featureEffectView.endTransition();this.featureContainer.restartAllAnimations();
this.featureContainer.attributeView.unlockTextureUploads();this.featureContainer.trySwapRenderState();this.featureContainer.requestRender();t("esri-2d-update-debug")&&console.debug(`Version[${ea}] FeatureLayerView2D.updateEnd`);this.requestUpdate()}else this.featureContainer.requestRender(),this.featureContainer.attributeView.unlockTextureUploads(),q.updateEnd(),this.featureEffectView.featureEffect=F}}catch(aa){t("esri-2d-update-debug")&&console.error("Encountered an error during update",aa)}}async _doOverride(q){const F=
await this.getWorker();try{for(const K of q.messages)switch(K.type){case "edit":const N=new sa.DebouncedFeatureOverride;N.add(await this._resolveEdit(K.event));await F.pipeline.onOverride(N.toMessage());break;case "override":const X=new sa.DebouncedFeatureOverride;X.add(this._resolveOverrides(K.options));await F.pipeline.onOverride(X.toMessage())}}catch(K){c.isAbortError(K)}}_getEffectiveAvailableFields(q){this._lastAvailableFields=q=Ia(this._lastAvailableFields,q);return d.packFields(this.layer.fieldsIndex,
q)}async _createViewSchemaConfig(){const q=this.requiresCurrentUser?await this.signedInUser:null;var F=this.view,K=this.layerAdapter,N=this.timeExtent,X=this._visibilityOverrides,V=this.filter,ea=this.effectiveDisplayFilterClause;V&&=V.clone();const aa=null!=V?V.timeExtent:null;if(N=null!=N&&null!=aa?N.intersection(aa):N||aa)V??=new T,V.timeExtent=N;V=K.addFilters?.(V,F)??V;ea&&(V??=new T,V.where=x.sqlAnd(V.where,ea));F=V?.toJSON()??null;X.size&&(F??=(new T).toJSON(),F.hiddenIds=Array.from(X));X=
this.featureEffect?.filter?.toJSON()??null;X=[F,X];return{availableFields:this._getEffectiveAvailableFields(this.availableFields),displayFilterEnabled:this.displayFilterEnabled,filters:X,scale:this.view.scale,timeZone:this.view.timeZone,timeExtent:this.view.timeExtent,currentUser:q}}_processHighlight(){this._commandsQueue.push({type:"highlight"})}async _updateHighlights(){var q=this._getHighlights();const F=await this.getWorker();this.destroyed||(q=F.pipeline.updateHighlight({highlights:q}).catch(K=>
{c.isAbortError(K)||h.getLogger(this).error(K)}),this._updatingHandles.addPromise(q))}_setLayersForFeature(q){q.layer=q.sourceLayer=this.layer;this.layerAdapter.setGraphicOrigin&&this.layerAdapter.setGraphicOrigin(q)}_createGraphicHit(q,F){this._setLayersForFeature(F);null!=F.geometry&&(F.geometry.spatialReference=this.view.spatialReference);return{type:"graphic",graphic:F,layer:this.layer,mapPoint:q}}};g.__decorate([u.property()],M.prototype,"_commandsQueue",void 0);g.__decorate([u.property()],M.prototype,
"_sourceRefreshVersion",void 0);g.__decorate([u.property()],M.prototype,"_displayRefreshVersion",void 0);g.__decorate([u.property({readOnly:!0})],M.prototype,"_pipelineUpdating",void 0);g.__decorate([u.property()],M.prototype,"_sourceUpdating",void 0);g.__decorate([u.property({readOnly:!0})],M.prototype,"dataUpdating",null);g.__decorate([u.property({readOnly:!0})],M.prototype,"effectiveDisplayFilterClause",null);g.__decorate([u.property({readOnly:!0})],M.prototype,"hasAllFeatures",null);g.__decorate([u.property({readOnly:!0})],
M.prototype,"hasAllFeaturesInView",null);g.__decorate([u.property({readOnly:!0})],M.prototype,"hasFullGeometries",null);g.__decorate([u.property()],M.prototype,"featureEffectView",void 0);g.__decorate([u.property()],M.prototype,"labelingCollisionInfos",null);g.__decorate([u.property()],M.prototype,"layerAdapter",null);g.__decorate([u.property({readOnly:!0})],M.prototype,"timeExtent",null);g.__decorate([u.property()],M.prototype,"updating",void 0);return M=g.__decorate([E.subclass("esri.views.2d.layers.FeatureLayerView2D")],
M)});