// All material copyright Esri, All Rights Reserved, unless otherwise specified.
// See https://js.arcgis.com/4.32/esri/copyright.txt for details.
//>>built
require({cache:{"esri/widgets/Search/css":function(){define(["exports"],function(b){b.css={base:"esri-search",autocomplete:"esri-search__autocomplete",dropdown:"esri-search__dropdown",container:"esri-search__container",form:"esri-search__form"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchResultRenderer":function(){define("../../chunks/tslib.es6 ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../Widget ./searchResultRendererCSS ./SearchViewModel ../support/globalCss ../support/decorators/accessibleHandler ../support/decorators/messageBundle ../support/jsxFactory ../support/widgetUtils".split(" "),
function(b,e,c,x,t,m,y,n,v,k,D,w,E,X){c=class extends y{constructor(l,P){super(l,P);this.messages=null;this.showMoreResultsOpen=!1;this.viewModel=null}destroy(){this.viewModel=null}render(){const l={[n.css.showMoreResults]:this.showMoreResultsOpen};return E.tsx("div",{class:this.classes(n.css.base,k.globalCss.widget)},E.tsx("div",{class:this.classes(n.css.moreResults,l),key:"esri-search-renderer__container"},this._renderSearchResultName(),this._renderMoreResults()))}_renderMoreResults(){return E.tsx("div",
{key:"esri-search-renderer__more-results"},this._renderMoreResultsButton(),this._renderMoreResultsLists())}_renderSearchResultName(){return E.tsx("div",{class:n.css.moreResultsItem,key:"esri-search-renderer__result-name"},this.viewModel?.selectedResult?.name||"")}_renderMoreResultsLists(){var {viewModel:l}=this;if(!l)return[];if(2>(l.resultCount??0))return null;l=l.results?.map(P=>this._renderMoreResultsList(P));return E.tsx("div",{class:n.css.moreResultsList,key:"esri-search-renderer__more-results-container"},
l)}_renderMoreResultsButton(){const {messages:l,viewModel:P}=this;return!P||2>(P.resultCount??0)?null:E.tsx("div",{class:n.css.moreResultsItem,key:"esri-search-renderer__more-results-button"},E.tsx("a",{bind:this,class:k.globalCss.anchor,href:"#",onclick:this._showMoreResultsClick,onkeydown:this._showMoreResultsClick},this.showMoreResultsOpen?l.hideMoreResults:l.showMoreResults))}_renderMoreResultsHeader(l,P){return E.tsx("div",{class:n.css.moreResultsListHeader,key:`esri-search-result-renderer__header-${P}`},
l)}_renderMoreResultsList(l){var {results:P}=l,z=P?.length??0;const u=0<z;var q=this.viewModel?.selectedResult;z=1===z&&P[0]===q;q=this._getSourceName(l.source,l.sourceIndex);q=1<(this.viewModel?.results?.length??0)&&!z?this._renderMoreResultsHeader(q,l.sourceIndex):null;P=u&&P.map((M,Q)=>this._renderMoreResultsListItem(M,Q));P=u&&!z?E.tsx("ul",{key:`esri-search-result-renderer__list-${l.sourceIndex}`},P):null;return u?E.tsx("div",{key:`esri-search-result-renderer__results-${l.sourceIndex}`},q,P):
null}_renderMoreResultsListItem(l,P){return l!==this.viewModel?.selectedResult?E.tsx("li",{key:`esri-search-result-renderer__list-item-${P}`},E.tsx("a",{bind:this,class:k.globalCss.anchor,"data-result":l,href:"#",onclick:this._selectResultClick,onkeydown:this._selectResultClick,tabIndex:0},l.name)):null}_showMoreResultsClick(l){l.preventDefault();this.showMoreResultsOpen=!this.showMoreResultsOpen;(l=this.viewModel?.view?.popup)&&"reposition"in l&&l.reposition()}_selectResultClick(l){l.preventDefault();
l=l.currentTarget["data-result"];this.viewModel?.select(l)}_getSourceName(l,P){return P===v.ALL_INDEX?this.messages.all:l.name}};b.__decorate([e.property(),w.messageBundle("esri/widgets/Search/t9n/Search")],c.prototype,"messages",void 0);b.__decorate([e.property()],c.prototype,"showMoreResultsOpen",void 0);b.__decorate([e.property()],c.prototype,"viewModel",void 0);b.__decorate([D.accessibleHandler()],c.prototype,"_showMoreResultsClick",null);b.__decorate([D.accessibleHandler()],c.prototype,"_selectResultClick",
null);return c=b.__decorate([m.subclass("esri.widgets.Search.SearchResultRenderer")],c)})},"esri/widgets/Search/searchResultRendererCSS":function(){define(["exports"],function(b){b.css={base:"esri-search-result-renderer",showMoreResults:"esri-search-result-renderer__more-results--show-more-results",moreResults:"esri-search-result-renderer__more-results",moreResultsList:"esri-search-result-renderer__more-results-list",moreResultsHeader:"esri-search-result-renderer__more-results-header",moreResultsItem:"esri-search-result-renderer__more-results-item",
moreResultsListHeader:"esri-search-result-renderer__more-results-list-header"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/SearchViewModel":function(){define("../../chunks/tslib.es6 ../../assets ../../config ../../Graphic ../../PopupTemplate ../../core/Accessor ../../core/arrayUtils ../../core/Collection ../../core/Error ../../core/Evented ../../core/Logger ../../core/maybe ../../core/promiseUtils ../../core/reactiveUtils ../../core/accessorSupport/decorators/property ../../core/has ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ../../geometry/support/geometryUtils ../../intl/locale ../../intl/messages ../../portal/Portal ../../symbols/PictureMarkerSymbol ../../symbols/SimpleFillSymbol ../../symbols/SimpleLineSymbol ../../symbols/TextSymbol ../../views/support/layerViewUtils ./LayerSearchSource ./LocatorSearchSource ./SearchSource ./support/locatorUtils ../support/geolocationUtils ../support/GoTo".split(" "),
function(b,e,c,x,t,m,y,n,v,k,D,w,E,X,l,P,z,u,q,M,Q,Y,K,ba,f,A,F,L,R,U,O,p,C,B){function H(a,d){return a.hasOwnProperty(d)&&null!=a[d]&&""!==a[d]}const N=n.ofType({key:a=>a.layer?"layer":"locator",base:O,typeMap:{layer:R,locator:U}}),V=q.WGS84,I=/<[\s\S]*?>/g;m=class extends B(k.EventedMixin(m)){constructor(a){super(a);this._updatingPromise=this._searching=this._gotoController=null;this._createdFeatureLayers=[];this.autoSelect=this.autoNavigate=!0;this.defaultPopupTemplate=null;this.defaultSources=
new N;this.defaultSymbols={point:new ba({url:e.getAssetUrl("esri/images/search/search-symbol-32.png"),size:24,width:24,height:24}),polyline:new A({color:[130,130,130,1],width:2}),polygon:new f({color:[235,235,235,.4],outline:{color:[130,130,130,1],width:2}})};this.includeDefaultSources=!0;this.maxInputLength=128;this.maxSuggestions=this.maxResults=6;this.messages=null;this.minSuggestCharacters=3;this.popupEnabled=!0;this.popupTemplate=null;this.portal=K.getDefault();this.resultCount=null;this.resultGraphicEnabled=
!0;this.selectedSuggestion=this.results=this.resultGraphic=null;this.searchAllEnabled=!0;this.selectedResult=null;this.sources=new N;this.suggestionDelay=350;this.suggestions=this.suggestionCount=null;this.suggestionsEnabled=!0;this.view=null}initialize(){const a=async()=>{const d=await Y.fetchMessageBundle("esri/widgets/Search/t9n/Search");this.messages=d;this.defaultPopupTemplate=new t({title:d.searchResult,content:"{Match_addr}"})};a();this.addHandles([X.watch(()=>[this.includeDefaultSources,this.view,
this.portal],()=>this._update(),X.initial),Q.onLocaleChange(a)])}destroy(){this._destroyFeatureLayers();this._abortGoTo();this.clearGraphics()}get activeSource(){return this.allSources.at(this.activeSourceIndex)??null}get activeSourceIndex(){return 1!==this.allSources.length&&this.searchAllEnabled?-1:0}set activeSourceIndex(a){this._overrideIfSome("activeSourceIndex",a)}get allPlaceholder(){return this.messages?.allPlaceholder}set allPlaceholder(a){this._overrideIfSome("allPlaceholder",a)}get allSources(){const {sources:a,
defaultSources:d,includeDefaultSources:h}=this,g="function"===typeof h?h.call(null,{sources:a,defaultSources:d}):h?d.concat(a):a,r=this._get("allSources")||new N;r.removeAll();r.addMany(g.filter(Boolean));return r}get locationEnabled(){return this._get("locationEnabled")||C.supported()}set locationEnabled(a){if(void 0===a)this._clearOverride("locationEnabled");else{var d=C.supported();if(a&&!d){const h=new v("locationEnabled:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});
D.getLogger(this).error(h)}this._override("locationEnabled",!!a&&d)}}get placeholder(){const {allSources:a,activeSourceIndex:d,allPlaceholder:h}=this;return-1===d?h??"":a.at(d)?.placeholder??""}set searchTerm(a){this._set("searchTerm",a||"");this.clearGraphics();this.selectedSuggestion&&this.selectedSuggestion.text!==a&&this._set("selectedSuggestion",null);""===a&&this._clear()}get searchTerm(){return this._get("searchTerm")||""}get state(){return this._searching?"searching":this.updating?"loading":
0===this.allSources.length?"disabled":"ready"}get updating(){return null!=this._updatingPromise}clear(){this.searchTerm=""}clearGraphics(){this._removeHighlight();this._closePopup();const {view:a,resultGraphic:d}=this;a&&d&&a.graphics.remove(d);this._set("resultGraphic",null)}search(a,d){this.emit("search-start");this.clearGraphics();const h=this._createSuggestionForSearch(a);return this._searching=a=(async()=>{try{await this.when();const g=await this._getResultsFromSources(h,d);if(d?.signal?.aborted)return null;
const r={activeSourceIndex:this.activeSourceIndex,searchTerm:h.text??"",numResults:0,numErrors:0,errors:[],results:[]};this._formatResponse(r,g,h);const G=this._getFirstResult(r.results),S=(h.location&&G?G.name:h.text)?.replace(I,"");this._set("searchTerm",S);(h.key&&"number"===typeof h.sourceIndex||h.location)&&this._set("selectedSuggestion",h);this._set("results",r.results);this._set("resultCount",r.results.reduce((W,Z)=>W+(Z.results?.length??0),0));this.emit("search-complete",r);await this._selectFirstResult(G);
return r}finally{this._clearSearching()}})()}async searchNearby(a){if(!this.locationEnabled){var d=new v("searchNearby:geolocation-unsupported","Geolocation API is unsupported.",{geolocation:navigator.geolocation});D.getLogger(this).error(d);throw d;}return this._searching=d=(async()=>{try{const h=await C.getCurrentPosition(),g=await C.positionToPoint({position:h,view:this.view},a);return await this.search(g,a)}finally{this._clearSearching()}})()}async select(a){this.clearGraphics();if(!a)throw a=
new v("select:missing-parameter","Cannot select without a searchResult.",{searchResult:a}),D.getLogger(this).error(a),a;const {view:d}=this,h=H(a,"sourceIndex")?a.sourceIndex:this._getSourceIndexOfResult(a),g=null!=h?this.allSources.at(h):null;if(!g)throw a=new v("select:missing-source","Cannot select without a source.",{source:g}),D.getLogger(this).error(a),a;var r=g instanceof R?this._getLayerSourcePopupTemplate(g):g.popupTemplate,G=g.resultSymbol||this._getDefaultSymbol(a);const S=H(g,"resultGraphicEnabled")?
g.resultGraphicEnabled:this.resultGraphicEnabled;var W=H(g,"autoNavigate")?g.autoNavigate:this.autoNavigate,Z=H(g,"popupEnabled")?g.popupEnabled:this.popupEnabled;const J=Z?r||this.popupTemplate||this.defaultPopupTemplate:null,{feature:T}=a;if(!T)throw a=new v("select:missing-feature","Cannot select without a feature.",{feature:T}),D.getLogger(this).error(a),a;const {attributes:fa,geometry:da,layer:aa,sourceLayer:ca}=T;r=da?M.getPointFromGeometry(da):null;r={layerViewQuery:this._getLayerView(T),elevationQuery:d&&
null!=r?M.getPointWithElevation(r,d):Promise.resolve(r)};var ea=await E.eachAlways(r);r=ea.layerViewQuery.value;ea=ea.elevationQuery.value;G instanceof F&&(G.text=a.name);W=d&&W?a.target||a.extent:null;await (null!=W?this._goToSearchResult(W):Promise.resolve());G=r?T:new x({geometry:da,symbol:G,attributes:fa,layer:aa,sourceLayer:ca,popupTemplate:J});(Z=(W=d?.popup)&&Z&&G.getEffectivePopupTemplate(W.defaultPopupTemplateEnabled))&&await d.openPopup({features:[G],location:ea});r&&L.highlightsSupported(r)&&
!Z&&this._highlightFeature({graphic:G,layerView:r});!r&&S&&d&&d.graphics.push(G);this._setResultFloor(a);this._set("selectedResult",a);this._set("resultGraphic",G);this.emit("select-result",{result:a,source:g,sourceIndex:h});return a}async suggest(a,d,h){a=a||this.searchTerm;this.emit("suggest-start",{searchTerm:a});await this._suggestTimer(d,h);d=await this._suggestImmediate(a,h);this._set("suggestions",d?.results);this._set("suggestionCount",d?.results.reduce((g,r)=>g+(r.results?.length??0),0)??
null);this.emit("suggest-complete",d);return d}async when(){await X.whenOnce(()=>!this.updating)}async _update(){const {portal:a,view:d}=this;if(this.includeDefaultSources){const h=this._updatingPromise=E.eachAlways([a?.load(),d?.when()]);if(this.destroyed)return;await h;if(h!==this._updatingPromise)return}await X.whenOnce(()=>this.messages);this.destroyed||this._updateDefaultSources();this._updatingPromise=null}_clearSearching(){this._searching=null}_convertHelperServices(){const a=this.portal?.helperServices?.geocode;
return a?a.map(d=>{if(!1!==d.placefinding){var h=c.apiKey&&p.isArcGISWorldGeocoder(d.url)?{url:p.meteredArcGISLocatorUrl}:null;d=U.fromJSON({...d,...h});h=d.url;if(p.isArcGISWorldGeocoder(h)||p.isProxiedArcGISWorldGeocoder(h)||p.isMeteredArcGISWorldGeocoder(h)){h=d.outFields??["Addr_type","Match_addr","StAddr","City"];const g=(d.placeholder||this.messages?.placeholder)??"",r="number"===typeof d.defaultZoomScale?d.defaultZoomScale:2500;d.singleLineFieldName="SingleLine";d.outFields=h;d.placeholder=
g;d.defaultZoomScale=r}if(d.singleLineFieldName)return d}}).filter(y.isSome):[]}_destroyFeatureLayers(){this._createdFeatureLayers.forEach(a=>a?.destroy());this._createdFeatureLayers=[]}_getLayerSources(a,d){const h=this.view?.map;return a.map(g=>{const r=h.findLayerById(g.id);if(r){g=this._getLayerJSON(g);var G=R.fromJSON(g);G.placeholder=d;this._getLayer(r,g).then(S=>{G.layer=S});return G}}).filter(y.isSome).toArray()}_getTableSources(a,d){const h=this.view?.map;return a.map(g=>{if(g.id){var r=
h.findTableById(g.id);if(r){g=this._getLayerJSON(g);var G=R.fromJSON(g);G.placeholder=d;this._getLayer(r,g).then(S=>{G.layer=S});return G}}}).filter(y.isSome).toArray()}_convertApplicationProperties(){var a=this.view?.map?.applicationProperties?.viewing?.search;if(!a)return[];const {enabled:d,hintText:h,layers:g,tables:r}=a;if(!d)return[];a=this._getLayerSources(g,h);const G=this._getTableSources(r,h);return[...a,...G]}async _getSubLayer(a,d){await a.load();if(!a.allSublayers)throw Error();a=a.allSublayers.find(h=>
h.id===d.subLayer);if(!a)throw Error();a=await a.createFeatureLayer?.();if(!a)throw Error();this._createdFeatureLayers.push(a);return a}async _getBuildingSubLayer(a,d){await a.load();a=a.allSublayers.find(h=>h.id===d.subLayer);if("building-component"!==a?.type)throw Error();await a.load();if(null==a.associatedLayer)throw Error();await a.associatedLayer.load();return a}async _getLayer(a,d){if("feature"===a.type||"scene"===a.type||"csv"===a.type||"geojson"===a.type||"ogc-feature"===a.type)return a;
if("map-image"===a.type)try{return await this._getSubLayer(a,d)}catch(h){return a=new v("search:create-featurelayer","Could not create a FeatureLayer from the MapImageLayer",{layer:a}),D.getLogger(this).error(a),null}return"building-scene"===a.type?this._getBuildingSubLayer(a,d):null}_getLayerJSON(a){return"function"===typeof a.toJSON?a.toJSON():a}_updateDefaultSources(){const {defaultSources:a,includeDefaultSources:d}=this;this._destroyFeatureLayers();a.removeAll();d&&a.addMany([...this._convertApplicationProperties(),
...this._convertHelperServices()])}_abortGoTo(){this._gotoController&&this._gotoController.abort();this._gotoController=null}_clear(){this._abortGoTo();this._set("resultCount",null);this._set("results",null);this._set("suggestions",null);this._set("suggestionCount",null);this._set("selectedResult",null);this._set("selectedSuggestion",null);this.emit("search-clear")}_closePopup(){const a=this.view?.popup,{resultGraphic:d}=this;if(a&&d){var h="selectedFeature"in a,g=h?a.selectedFeature:null;h&&g&&g===
d&&a.close()}}_suggestTimer(a,d){return E.after(null!=a?a:this.suggestionDelay,null,d?.signal)}_createLocationForSearch(a){return a instanceof x&&a.geometry?M.getPointFromGeometry(a.geometry):a instanceof u?a:Array.isArray(a)&&2===a.length?new u({longitude:a[0],latitude:a[1]}):null}_createSuggestionForSearch(a){if(a&&H(a,"key")&&H(a,"text")&&H(a,"sourceIndex"))return a;const d=this._createLocationForSearch(a),h="string"===typeof a?a:this.searchTerm,{selectedSuggestion:g,selectedResult:r}=this,G=(a=
!a&&g&&r)&&g.location;return a&&g.key===r.key&&g.sourceIndex===r.sourceIndex||G?g:{location:d,text:d?"":h,sourceIndex:null,key:null}}_getFirstResult(a){return w.mappedFind(a,({results:d})=>d?.[0])??null}async _selectFirstResult(a){return this.autoSelect&&a?this.select(a):null}async _suggestImmediate(a,d){await this.when();const h=await this._getSuggestionsFromSources(a,d);if(d?.signal?.aborted)return null;a={activeSourceIndex:this.activeSourceIndex,searchTerm:a??"",numResults:0,numErrors:0,errors:[],
results:[]};this._formatResponse(a,h);return a}_formatSourceResponse(a,d,h){const g=d?.value||[];d=d?.error;const r=this.allSources.at(h);d?(a.errors.push({sourceIndex:h,source:r,error:d}),D.getLogger(this).error(d),a.numErrors++):(a.results.push({sourceIndex:h,source:r,results:g}),a.numResults+=g.length)}_formatResponse(a,d,h){if(d)if(-1===a.activeSourceIndex){const g=h&&H(h,"sourceIndex")&&-1!==h.sourceIndex?h.sourceIndex:void 0;d.forEach((r,G)=>{this._formatSourceResponse(a,r,void 0!==g?g:G)})}else this._formatSourceResponse(a,
d[0],a.activeSourceIndex)}async _getResultsFromSources(a,d){var {allSources:h}=this;const g=!a.location&&H(a,"sourceIndex")?a.sourceIndex:this.activeSourceIndex,r=[];if(!h.length)throw h=new v("search:no-sources-defined","At least one source is required.",{allSources:h}),D.getLogger(this).error(h),h;-1===g?h.forEach((G,S)=>{r.push(this._getResultsFromSource(a,S,d))}):r.push(this._getResultsFromSource(a,g,d));return E.eachAlways(r)}async _getSuggestionsFromSources(a,d){const {allSources:h,activeSourceIndex:g}=
this,r=[];if(!h.length){const G=new v("suggest:no-sources-defined","At least one source is required.",{allSources:h});D.getLogger(this).error(G);throw G;}-1===g?h.forEach((G,S)=>{r.push(this._getSuggestionsFromSource(a,S,d))}):r.push(this._getSuggestionsFromSource(a,g,d));return E.eachAlways(r)}async _getResultsFromSource(a,d,h){const g=null!=d?this.allSources.at(d):null;if(!g)return null;const {location:r=null}=a,G=this.view?.spatialReference||V,S=H(g,"maxResults")?g.maxResults:this.maxResults,W=
g instanceof R&&H(g,"exactMatch")?g.exactMatch:!1,{view:Z}=this;return g.getResults?.({view:Z,sourceIndex:d,location:r,suggestResult:a,spatialReference:G,exactMatch:W,maxResults:S},h)}async _getSuggestionsFromSource(a,d,h){const g=this.allSources.at(d);if(!g)return null;a??="";var r=H(g,"suggestionsEnabled")?g.suggestionsEnabled:this.suggestionsEnabled,G=a?.length,S=H(g,"minSuggestCharacters")?g.minSuggestCharacters:this.minSuggestCharacters;if(r&&a.trim()&&G>=S){r=this.view?.spatialReference||V;
G=H(g,"maxSuggestions")?g.maxSuggestions:this.maxSuggestions;({view:S}=this);const W=g instanceof R&&H(g,"exactMatch")?g.exactMatch:!1;return g.getSuggestions?.({view:S,sourceIndex:d,suggestTerm:a,spatialReference:r,maxSuggestions:G,exactMatch:W},h)}return null}_getLayerSourcePopupTemplate(a){const {layer:d}=a;if(d)return H(a,"popupTemplate")?a.popupTemplate:d.popupTemplate}_getSourceIndexOfResult(a){return w.mappedFind(this.results??[],({results:d,sourceIndex:h})=>d?.includes(a)?h:null)??null}async _goToSearchResult(a){this._abortGoTo();
var d=new AbortController;this._gotoController=d;d={target:{target:a},options:{signal:d.signal}};a||(d.options.animate=!1);await this.callGoTo(d);this._gotoController=null}_getDefaultSymbol(a){const {defaultSymbols:d}=this;a=a.feature?.geometry;if(null==a)return null;switch(a.type){case "point":case "multipoint":return d.point;case "polyline":return d.polyline;case "extent":case "polygon":return d.polygon;default:return null}}_removeHighlight(){this.removeHandles("highlight")}async _getLayerView(a){const {view:d}=
this;if(!a||!d||"building-component"===a.layer?.type||"subtype-sublayer"===a.layer?.type)return null;({layer:a}=a);if(!a)return null;await d.when();return d.whenLayerView(a)}_highlightFeature(a){const {graphic:d,layerView:h}=a,{attributes:g,layer:r}=d;({objectIdField:a}=r);a=h.highlight((a&&g?.[a])??null??d);this.addHandles(a,"highlight")}_setResultFloor(a){const {view:d}=this;var h=a.feature?.attributes;(a=a.feature?.sourceLayer)&&"floorInfo"in a&&a?.floorInfo?.floorField&&h&&(h=h[a.floorInfo.floorField],
d?.emit("select-result-floor",h))}};m.ALL_INDEX=-1;b.__decorate([l.property()],m.prototype,"_searching",void 0);b.__decorate([l.property()],m.prototype,"_updatingPromise",void 0);b.__decorate([l.property({readOnly:!0,value:null})],m.prototype,"activeSource",null);b.__decorate([l.property()],m.prototype,"activeSourceIndex",null);b.__decorate([l.property()],m.prototype,"allPlaceholder",null);b.__decorate([l.property({readOnly:!0})],m.prototype,"allSources",null);b.__decorate([l.property()],m.prototype,
"autoNavigate",void 0);b.__decorate([l.property()],m.prototype,"autoSelect",void 0);b.__decorate([l.property({type:t})],m.prototype,"defaultPopupTemplate",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"defaultSources",void 0);b.__decorate([l.property()],m.prototype,"defaultSymbols",void 0);b.__decorate([l.property()],m.prototype,"includeDefaultSources",void 0);b.__decorate([l.property()],m.prototype,"locationEnabled",null);b.__decorate([l.property()],m.prototype,"maxInputLength",void 0);
b.__decorate([l.property()],m.prototype,"maxResults",void 0);b.__decorate([l.property()],m.prototype,"maxSuggestions",void 0);b.__decorate([l.property()],m.prototype,"messages",void 0);b.__decorate([l.property()],m.prototype,"minSuggestCharacters",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"placeholder",null);b.__decorate([l.property()],m.prototype,"popupEnabled",void 0);b.__decorate([l.property({type:t})],m.prototype,"popupTemplate",void 0);b.__decorate([l.property({type:K})],m.prototype,
"portal",void 0);b.__decorate([l.property()],m.prototype,"resultCount",void 0);b.__decorate([l.property()],m.prototype,"resultGraphicEnabled",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"resultGraphic",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"results",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"selectedSuggestion",void 0);b.__decorate([l.property()],m.prototype,"searchAllEnabled",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"selectedResult",
void 0);b.__decorate([l.property()],m.prototype,"searchTerm",null);b.__decorate([l.property({type:N})],m.prototype,"sources",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"state",null);b.__decorate([l.property()],m.prototype,"suggestionDelay",void 0);b.__decorate([l.property()],m.prototype,"suggestionCount",void 0);b.__decorate([l.property({readOnly:!0})],m.prototype,"suggestions",void 0);b.__decorate([l.property()],m.prototype,"suggestionsEnabled",void 0);b.__decorate([l.property({readOnly:!0})],
m.prototype,"updating",null);b.__decorate([l.property()],m.prototype,"view",void 0);b.__decorate([l.property()],m.prototype,"clear",null);return m=b.__decorate([z.subclass("esri.widgets.Search.SearchViewModel")],m)})},"esri/geometry/support/geometryUtils":function(){define(["exports","../Extent","./scaleUtils"],function(b,e,c){function x(t,m,y){const n=t.hasZ?t.z:void 0;if(m?.map)return(null!=y?c.getExtentForScale(m,y):m.extent).clone().centerAt(t).set({zmax:n,zmin:n});const {x:v,y:k,spatialReference:D}=
t;return new e({xmin:v-.25,ymin:k-.25,xmax:v+.25,ymax:k+.25,spatialReference:D,zmin:n,zmax:n})}b.createExtentFromGeometry=function(t,m,y){switch(t?.type){case "extent":return t;case "multipoint":case "polygon":case "polyline":return t.extent;case "point":return x(t,m,y);default:return null}};b.createExtentFromPoint=x;b.getPointFromGeometry=function(t){switch(t?.type){case "point":return t;case "extent":return t.center;case "polygon":return t.centroid;case "multipoint":case "polyline":return t.extent?.center;
default:return null}};b.getPointWithElevation=async function(t,m){if(t.hasZ||"2d"===m.type)return t;const y=m.map?.ground;if(!y?.layers.length)return t;({geometry:t}=await y.queryElevation(t,{cache:m.basemapTerrain?.elevationQueryCache}));return t};b.scaleExtent=function(t,m,y){return x(t.center,m,y)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LayerSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/layerSearchUtils".split(" "),
function(b,e,c,x,t,m,y,n){var v;x=v=class extends y{constructor(k){super(k);this.suggestionTemplate=this.searchTemplate=this.searchFields=this.orderByFields=this.exactMatch=this.displayField=null;this.getResults=(D,w)=>n.getResults({source:this,...D},w);this.getSuggestions=(D,w)=>n.getSuggestions({source:this,...D},w)}set layer(k){this._set("layer",k);k&&k.load().catch(()=>{})}get name(){return this._getLayerTitle()??""}set name(k){this._overrideIfSome("name",k)}clone(){return new v({autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?e.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,displayField:this.displayField,
exactMatch:this.exactMatch,layer:this.layer,searchFields:this.searchFields?e.clone(this.searchFields):null,suggestionTemplate:this.suggestionTemplate,zoomScale:this.zoomScale})}_getFirstStringField(){return this.layer.fieldsIndex?.fields.find(k=>"string"===k.type)?.name??""}_getDisplayField(){return this.displayField||this.layer.displayField||this._getFirstStringField()}_getSearchFieldsString(){const {layer:k,searchFields:D}=this;return k.loaded?`: ${(D||[this._getDisplayField()]).map(w=>k.getField(w)?.alias||
w).join(", ")}`:""}_getLayerTitle(){var {layer:k}=this;if(k&&({title:k}=k,k))return`${k}${this._getSearchFieldsString()}`}};b.__decorate([c.property({json:{read:{source:"field.name"},write:{target:"field.name"}}})],x.prototype,"displayField",void 0);b.__decorate([c.property({json:{read:{source:"field.exactMatch"},write:{target:"field.exactMatch"}}})],x.prototype,"exactMatch",void 0);b.__decorate([c.property({value:null})],x.prototype,"layer",null);b.__decorate([c.property()],x.prototype,"name",null);
b.__decorate([c.property({type:[String],json:{write:!0}})],x.prototype,"orderByFields",void 0);b.__decorate([c.property()],x.prototype,"searchFields",void 0);b.__decorate([c.property()],x.prototype,"searchTemplate",void 0);b.__decorate([c.property()],x.prototype,"suggestionTemplate",void 0);return x=v=b.__decorate([m.subclass("esri.widgets.Search.LayerSearchSource")],x)})},"esri/widgets/Search/SearchSource":function(){define("../../chunks/tslib.es6 ../../PopupTemplate ../../core/Identifiable ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,x,t,m,y,n,v){c=class extends c.IdentifiableMixin(x){constructor(k){super(k);this.outFields=this.minSuggestCharacters=this.maxSuggestions=this.maxResults=this.getSuggestions=this.getResults=this.filter=this.autoNavigate=null;this.placeholder="";this.popupTemplate=this.popupEnabled=null;this.prefix="";this.suggestionsEnabled=this.resultSymbol=this.resultGraphicEnabled=null;this.suffix="";this.withinViewEnabled=!1;this.zoomScale=null}};b.__decorate([t.property()],c.prototype,"autoNavigate",
void 0);b.__decorate([t.property()],c.prototype,"filter",void 0);b.__decorate([t.property()],c.prototype,"getResults",void 0);b.__decorate([t.property()],c.prototype,"getSuggestions",void 0);b.__decorate([t.property()],c.prototype,"maxResults",void 0);b.__decorate([t.property()],c.prototype,"maxSuggestions",void 0);b.__decorate([t.property()],c.prototype,"minSuggestCharacters",void 0);b.__decorate([t.property()],c.prototype,"outFields",void 0);b.__decorate([t.property()],c.prototype,"placeholder",
void 0);b.__decorate([t.property()],c.prototype,"popupEnabled",void 0);b.__decorate([t.property({type:e})],c.prototype,"popupTemplate",void 0);b.__decorate([t.property()],c.prototype,"prefix",void 0);b.__decorate([t.property()],c.prototype,"resultGraphicEnabled",void 0);b.__decorate([t.property()],c.prototype,"resultSymbol",void 0);b.__decorate([t.property()],c.prototype,"suggestionsEnabled",void 0);b.__decorate([t.property()],c.prototype,"suffix",void 0);b.__decorate([t.property()],c.prototype,"withinViewEnabled",
void 0);b.__decorate([t.property()],c.prototype,"zoomScale",void 0);return c=b.__decorate([v.subclass("esri.widgets.Search.SearchSource")],c)})},"esri/widgets/Search/support/layerSearchUtils":function(){define("exports ../../../intl ../../../core/Error ../../../core/has ../../../core/lang ../../../core/Logger ../../../core/maybe ../../../core/unitUtils ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/support/FullTextSearch ../../../intl/substitute ../../../intl/date".split(" "),
function(b,e,c,x,t,m,y,n,v,k,D,w,E){function X(p,C){const {filter:B,withinViewEnabled:H}=p;p=C?.extent;return B?.geometry??(H&&p?p:void 0)}async function l(p){p&&await p.load()}function P(p,C){return(p=p?.indexes)&&C?.length?p.filter(B=>"FullText"===B.indexType).some(B=>{const H=B.fields?.split(",").map(N=>N.trim().toLowerCase())||[];return C.every(N=>H.includes(N.toLowerCase()))}):!1}function z({text:p,searchFields:C}){return p.trim().split(" ").filter(B=>!!B.trim()).map(B=>new D({onFields:C,searchTerm:B,
searchType:"prefix"}))}function u(p){return p?.fieldsIndex?.fields?.find(C=>"string"===C.type)?.name??""}function q(p,C){return p&&C?.length?C.every(B=>!!p.getField(B)):!1}function M({codedValues:p},C,B){return y.mappedFind(p??[],H=>{var N=H.name;N=B?N:N.toLowerCase();return(B?C:C.toLowerCase())===N?H.code.toString():null})??null}function Q(p,C){return(C=C?.where)?`(${p}) AND (${C})`:p}function Y({currentTerm:p,field:C,filter:B,exactMatch:H,url:N,type:V}){var I=C?.type;C=C?.name;if("string"===I||
"date"===I||"global-id"===I){if(I=N=R.test(N??""))a:{for(I=0;I<p.length;I++)if(255<p.charCodeAt(I)){I=!0;break a}I=!1}I=I?"N":"";if(H&&"search"===V)return Q(`${C} = ${I}'${p}'`,B);if(N)return Q(`${C} LIKE ${I}${`'${p}%'`}`,B);H=`LOWER(${C})`;p=p.toLowerCase();return Q(`${H} LIKE ${I}${`'${p}%'`}`,B)}return"oid"===I||"small-integer"===I||"integer"===I||"single"===I||"double"===I?(p=Number(p),isNaN(p)?null:Q(`${C} = ${p}`,B)):Q(`${C} = ${p}`,B)}function K({searchTerm:p,layer:C,searchFields:B,filter:H,
exactMatch:N,query:V,type:I}){const {definitionExpression:a,url:d}=C;let h="";!V.fullText&&p&&B&&B.forEach(g=>{var r=C.getField(g);g=((g=C.getFieldDomain?.(g,{excludeImpliedDomains:x("esri-widget-legacy-field-domain-calculation")}))&&"coded-value"===g.type?M(g,p,N):null)||p||null;null!==g&&(r=Y({currentTerm:g,field:r,filter:H,exactMatch:N,url:d,type:I}))&&(h+=h?` OR (${r})`:`(${r})`)});return a&&h?`(${a}) AND (${h})`:a||h}function ba(p,C){let B=null;({codedValues:p}=p);p&&p.length&&p.some(H=>H.code===
C?(B=H.name,!0):!1);return B}function f(p,C){return p[C]??p[Object.keys(p).find(B=>B.toLowerCase()===C.toLowerCase())]}function A(p,C,B){const H=p.sourceLayer,{attributes:N}=p;p=H.getFieldDomain?.(B,{feature:p,excludeImpliedDomains:x("esri-widget-legacy-field-domain-calculation")});return C?w.substitute(C,N):B&&N?(C=H.getField(B),B=f(N,B),null==B?"":p&&"coded-value"===p.type?ba(p,B)??"":"date"===C?.type?E.formatDate(new Date(B)):"number"===typeof B?B.toString():"string"!==typeof B?"":B.trim()):""}
function F(p,C,B,H){return p.features.map(N=>{var V=N.sourceLayer,{attributes:I}=N;({objectIdField:V}=V);I=V?I[V]:null;return{text:A(N,C.suggestionTemplate,H),key:I,sourceIndex:B}})}function L(p,C,B,H,N,V,I){return p.features.map(a=>{var d=V;const h=a.clone(),g=a.sourceLayer;var r=g?.objectIdField;r=r?a.attributes[r]:null;const G=A(a,B.searchTemplate,N);null!=d&&null!=g&&null!=g.minScale&&null!=g.maxScale&&(g.minScale&&g.minScale<d?d=g.minScale:g.maxScale&&g.maxScale>d&&(d=g.maxScale));d=h.geometry?
k.createExtentFromGeometry(h.geometry,C??void 0,d??void 0):void 0;d="number"===typeof I&&d?k.scaleExtent(t.clone(d),C??void 0,I):d;a=a.clone();null!=d&&(a.geometry=v.fromExtent(d));return{extent:d,target:a,feature:h,key:r,name:G,sourceIndex:H}})}const R=/https?:\/\/services.*\.arcgis\.com/i,U=/(?:\{([^}]+)\})/g,O=()=>m.getLogger("esri.widgets.Search.support.layerSearchUtils");b.createFullTextSearchInfos=z;b.getResults=function(p,C){const {exactMatch:B=!1,location:H,maxResults:N,spatialReference:V,
source:I,sourceIndex:a,suggestResult:d,view:h}=p,{layer:g,filter:r,zoomScale:G}=I,S=h?.scale,W=X(I,h),Z=C?.signal;return l(g).then(()=>{const J=g.popupTemplate;return J?J.getRequiredFields(g.fieldsIndex):null}).then(J=>{const {objectIdField:T,returnZ:fa}=g,da=I.displayField||I.layer.displayField||u(I.layer);if(!g.getField(da))throw O().error("invalid-field: displayField is invalid."),new c("getResults():invalid-field","displayField is invalid.");J=J?.length?J:[da];var aa=I.outFields||J;J=aa&&aa.includes("*");
aa.includes(T)||J||aa.push(T);g.floorInfo?.floorField&&aa.push(g.floorInfo.floorField);if(!J&&!q(g,aa))throw O().error("invalid-field: outField is invalid."),new c("getResults():invalid-field","outField is invalid.");J=g.createQuery();var {orderByFields:ca}=I;ca&&(J.orderByFields=ca);V&&(J.outSpatialReference=V,ca=1/n.getMetersPerUnitForSR(V))&&(J.maxAllowableOffset=ca);ca="mesh"===g.geometryType||"multipatch"===g.geometryType;J.returnZ=g.capabilities?.data?.supportsZ&&!ca&&!1!==fa;J.returnGeometry=
!0;J.multipatchOption=ca?"xyFootprint":null;aa&&(J.outFields=aa);if(H)J.geometry=H;else if(d.key)J.objectIds=[d.key];else{aa=I.searchFields||[da];if(!q(g,aa))throw O().error("invalid-field: search field is invalid."),new c("getResults():invalid-field","search field is invalid.");(g?.capabilities?.query?.supportsPagination??!1)&&(J.num=N);W&&(J.geometry=W);if(!d.text?.trim())return[];ca=d.text;const {prefix:ea="",suffix:ha=""}=I,ia=`${ea}${ca}${ha}`.replaceAll("'","''");(g?.capabilities?.query?.supportsFullTextSearch??
!1)&&P(g,aa)&&!B&&ca&&(J.fullText=z({text:ca,searchFields:aa}));aa=K({searchTerm:ia,layer:g,searchFields:aa,filter:r,exactMatch:B,query:J,type:"search"});J.where=aa;if(!J.fullText&&!J.where)return[]}return g.queryFeatures(J,{signal:Z}).then(ea=>L(ea,h,I,a,da,S,G))})};b.getSuggestions=function(p,C){const {source:B,spatialReference:H,view:N,suggestTerm:V,maxSuggestions:I,sourceIndex:a,exactMatch:d}=p,{layer:h,filter:g}=B,r=C?.signal,G=X(B,N);return l(h).then(()=>{if(!(h?.capabilities?.query?.supportsPagination??
!1))return[];const S=B.displayField||B.layer.displayField||u(B.layer);var W=B.searchFields||[S];const Z=[];B.suggestionTemplate?B.suggestionTemplate.replaceAll(U,(ca,ea)=>{Z.push(ea);return ca}):Z.push(S);var J=Z&&Z.includes("*");Z.includes(h.objectIdField)||J||Z.push(h.objectIdField);var T=!!h.getField(S);J=J||q(h,Z);const fa=q(h,W);if(!T)throw O().error("invalid-field: displayField is invalid."),new c("getSuggestions():invalid-field","displayField is invalid.");if(!J)throw O().error("invalid-field: outField is invalid."),
new c("getSuggestions():invalid-field","outField is invalid.");if(!fa)throw O().error("invalid-field: search field is invalid."),new c("getSuggestions():invalid-field","search field is invalid.");T=h.createQuery();({orderByFields:J}=B);J&&(T.orderByFields=J);T.outSpatialReference=H;T.returnGeometry=!1;T.num=I;T.outFields=Z;G&&(T.geometry=G);if(!V.trim())return[];const {prefix:da="",suffix:aa=""}=B;J=`${da}${V}${aa}`.replaceAll("'","''");(h?.capabilities?.query?.supportsFullTextSearch??!1)&&P(h,W)&&
!d&&V&&(T.fullText=z({text:V,searchFields:W}));W=K({searchTerm:J,layer:h,searchFields:W,filter:g,exactMatch:d,query:T,type:"suggest"});T.where=W;return T.fullText||T.where?h.queryFeatures(T,{signal:r}).then(ca=>F(ca,B,a,S)):[]})};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/widgets/Search/LocatorSearchSource":function(){define("../../chunks/tslib.es6 ../../core/lang ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/accessorSupport/decorators/subclass ./SearchSource ./support/locatorUtils".split(" "),
function(b,e,c,x,t,m,y,n){var v;x=v=class extends y{constructor(k){super(k);this.defaultZoomScale=this.countryCode=this.categories=this.apiKey=null;this.localSearchDisabled=!1;this.locationType=null;this.searchTemplate=this.placeholder=this.name="";this.zoomScale=this.url=this.suggestionsEnabled=this.singleLineFieldName=null;this.getResults=(D,w)=>n.getResults({source:this,...D},w);this.getSuggestions=(D,w)=>n.getSuggestions({source:this,...D},w)}clone(){return new v({apiKey:this.apiKey,autoNavigate:this.autoNavigate,
filter:this.filter,maxResults:this.maxResults,maxSuggestions:this.maxSuggestions,minSuggestCharacters:this.minSuggestCharacters,outFields:this.outFields?e.clone(this.outFields):null,placeholder:this.placeholder,popupEnabled:this.popupEnabled,prefix:this.prefix,resultGraphicEnabled:this.resultGraphicEnabled,resultSymbol:this.resultSymbol?this.resultSymbol.clone():null,suggestionsEnabled:this.suggestionsEnabled,suffix:this.suffix,withinViewEnabled:this.withinViewEnabled,categories:this.categories?e.clone(this.categories):
null,countryCode:this.countryCode,locationType:this.locationType,searchTemplate:this.searchTemplate,singleLineFieldName:this.singleLineFieldName,zoomScale:this.zoomScale})}};b.__decorate([c.property()],x.prototype,"apiKey",void 0);b.__decorate([c.property()],x.prototype,"categories",void 0);b.__decorate([c.property()],x.prototype,"countryCode",void 0);b.__decorate([c.property({json:{write:!0}})],x.prototype,"defaultZoomScale",void 0);b.__decorate([c.property()],x.prototype,"localSearchDisabled",void 0);
b.__decorate([c.property()],x.prototype,"locationType",void 0);b.__decorate([c.property({json:{write:!0}})],x.prototype,"name",void 0);b.__decorate([c.property({json:{write:!0}})],x.prototype,"placeholder",void 0);b.__decorate([c.property()],x.prototype,"searchTemplate",void 0);b.__decorate([c.property({json:{write:!0}})],x.prototype,"singleLineFieldName",void 0);b.__decorate([c.property({json:{read:{source:"suggest"},write:{target:"suggest"}}})],x.prototype,"suggestionsEnabled",void 0);b.__decorate([c.property({json:{write:!0}})],
x.prototype,"url",void 0);b.__decorate([c.property({json:{write:!0}})],x.prototype,"zoomScale",void 0);return x=v=b.__decorate([m.subclass("esri.widgets.Search.LocatorSearchSource")],x)})},"esri/widgets/Search/support/locatorUtils":function(){define("exports ../../../Graphic ../../../geometry/Polygon ../../../geometry/support/geometryUtils ../../../rest/locator/addressToLocations ../../../rest/locator/locationToAddress ../../../rest/locator/suggestLocations ../../../rest/support/AddressToLocationsParameters ../../../rest/support/LocationToAddressParameters ../../../rest/support/SuggestLocationsParameters".split(" "),
function(b,e,c,x,t,m,y,n,v,k){function D(z,u){if(u.localSearchDisabled)return null;u=z?.scale;return"number"===typeof u&&3E5>=u?z?.extent?.center:null}async function w(z,u){const {source:q,spatialReference:M,location:Q,sourceIndex:Y,view:K}=z,{apiKey:ba,url:f,zoomScale:A,defaultZoomScale:F}=q;if(null==f)return[];z=K?.scale;u=u?.signal;const L=new v({location:Q});ba&&(L.apiKey=ba);M&&(L.outSpatialReference=M);try{const R=await m.locationToAddress(f,L,{signal:u});return P([R],{sourceIndex:Y,scale:z,
view:K,zoomScale:A,defaultZoomScale:F})}catch(R){return[]}}function E(z,u){const {filter:q,withinViewEnabled:M}=z;z=u?.extent;const Q=q?.geometry;return(u=Q?x.createExtentFromGeometry(Q,u??void 0,u?.scale):void 0)||(M&&z?z:void 0)}async function X(z,u){const {source:q,suggestResult:M,spatialReference:Q,view:Y,maxResults:K,sourceIndex:ba}=z,f=q?.zoomScale,A=q?.defaultZoomScale;if(!M.text?.trim())return null;z=`${!M.key&&q.prefix?q.prefix:""}${M.text}${!M.key&&q.suffix?q.suffix:""}`;const F=new n,{apiKey:L,
url:R}=q,U=Y?.scale;var O=E(q,Y);u=u?.signal;L&&(F.apiKey=L);if(!R)return null;q.categories&&(F.categories=q.categories);q.locationType&&(F.locationType=q.locationType);Q&&(F.outSpatialReference=Q);const p=D(Y,q);p&&(F.location=p);F.maxLocations=K;O&&(F.searchExtent=O);q.countryCode&&(F.countryCode=q.countryCode);({key:O}=M);const C=`${O}`;O&&(F.magicKey=C);F.address={};F.address[q.singleLineFieldName||"Single Line Input"]=z;q.outFields&&(F.outFields=q.outFields);return t.addressToLocations(R,F,{signal:u}).then(B=>
P(B,{key:C,scale:U,sourceIndex:ba,view:Y,zoomScale:f,defaultZoomScale:A}))}function l(z,u){return z.map(q=>({text:q.text,key:q.magicKey,sourceIndex:u}))}function P(z,u){return z.filter(Boolean).map(q=>{const {key:M,scale:Q,sourceIndex:Y,view:K,zoomScale:ba,defaultZoomScale:f}=u,{attributes:A,extent:F,location:L,address:R}=q;q=new e({geometry:L,attributes:A});var U=F||L,O=U?x.createExtentFromGeometry(U,K??void 0,Q??void 0):void 0;U=O?"number"===typeof ba?x.scaleExtent(O,K??void 0,ba):"number"===typeof f&&
"point"===U?.type?x.scaleExtent(O,K??void 0,f):O:null;O=L?`${L.x},${L.y}`:"";O=R||O;const p=q.clone();null!=U&&(p.geometry=c.fromExtent(U));return{extent:U,feature:q,target:p,key:M,name:O,sourceIndex:Y}})}b.getLocation=D;b.getResults=function(z,u){return z.location?w(z,u):X(z,u)};b.getSuggestions=async function(z,u){const {source:q,spatialReference:M,view:Q,suggestTerm:Y,maxSuggestions:K,sourceIndex:ba}=z;z=new k;const {apiKey:f,url:A}=q,F=E(q,Q);u=u?.signal;if(!A)return null;f&&(z.apiKey=f);q.categories&&
(z.categories=q.categories);M&&(z.outSpatialReference=M);const L=D(Q,q);L&&(z.location=L);if(!Y.trim())return null;const {prefix:R="",suffix:U=""}=q;z.text=`${R}${Y}${U}`;F&&(z.searchExtent=F);z.maxSuggestions=K;q.countryCode&&(z.countryCode=q.countryCode);return y.suggestLocations(A,z,{signal:u}).then(O=>l(O,ba))};b.isArcGISWorldGeocoder=function(z){return z?/(?:arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(z):!1};b.isMeteredArcGISWorldGeocoder=function(z){return z?/(?:geocode-api\.arcgis\.com\/arcgis\/rest\/services\/world\/geocodeserver).*/i.test(z):
!1};b.isProxiedArcGISWorldGeocoder=function(z){return z?/(?:\/servers\/[\da-z.-]+\/rest\/services\/world\/geocodeserver).*/i.test(z):!1};b.meteredArcGISLocatorUrl="https://geocode-api.arcgis.com/arcgis/rest/services/World/GeocodeServer";Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/addressToLocations":function(){define("exports ../../request ../utils ./utils ../support/AddressCandidate ../support/AddressToLocationsParameters".split(" "),function(b,e,c,x,t,m){function y({data:n}){if(!n)return[];
const {candidates:v,spatialReference:k}=n;return v?v.map(D=>{if(D){var {extent:w,location:E}=D,X=w?x.isValidExtent(w):!0;if(x.isValidLocation(E)&&X)return w&&(w.spatialReference=k),E&&(E.spatialReference=k),t.fromJSON(D)}}):[]}b.addressToLocations=async function(n,v,k){v=m.from(v);n=c.parseUrl(n);const {address:D,...w}=v.toJSON();v=c.encode({...n.query,...D,...w,f:"json"});k=c.asValidOptions(v,k);return e(`${n.path}/findAddressCandidates`,k).then(y)};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},
"esri/rest/locator/utils":function(){define(["exports"],function(b){b.isValidExtent=function(e){return e&&"number"===typeof e.xmin&&"number"===typeof e.ymin&&"number"===typeof e.xmax&&"number"===typeof e.ymax};b.isValidLocation=function(e){return!!e&&"number"===typeof e.x&&"number"===typeof e.y};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/AddressCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point".split(" "),
function(b,e,c,x,t,m,y,n,v){e=class extends e{constructor(k){super(k);this.score=this.location=this.extent=this.attributes=this.address=null}};b.__decorate([c.property({type:String,json:{write:!0}})],e.prototype,"address",void 0);b.__decorate([c.property({type:Object,json:{write:!0}})],e.prototype,"attributes",void 0);b.__decorate([c.property({type:n,json:{write:!0}})],e.prototype,"extent",void 0);b.__decorate([c.property({type:v,json:{write:!0}})],e.prototype,"location",void 0);b.__decorate([c.property({type:Number,
json:{write:!0}})],e.prototype,"score",void 0);return e=b.__decorate([y.subclass("esri.rest.support.AddressCandidate")],e)})},"esri/rest/support/AddressToLocationsParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ./commonProperties".split(" "),
function(b,e,c,x,t,m,y,n,v,k,D){e=class extends e{constructor(w){super(w);this.searchExtent=this.outSpatialReference=this.outFields=this.maxLocations=this.magicKey=this.locationType=this.location=this.forStorage=this.countryCode=this.categories=this.apiKey=this.address=null}};b.__decorate([c.property({type:Object,json:{write:!0}})],e.prototype,"address",void 0);b.__decorate([c.property(D.apiKey)],e.prototype,"apiKey",void 0);b.__decorate([c.property({type:[String],json:{read:{source:"category",reader:w=>
w?w.split(","):null},write:{target:"category",writer:(w,E)=>{E.category=w?w.join(","):null}}}})],e.prototype,"categories",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],e.prototype,"countryCode",void 0);b.__decorate([c.property({type:Boolean,json:{write:!0}})],e.prototype,"forStorage",void 0);b.__decorate([c.property({type:v,json:{write:{writer:(w,E)=>{E.location=w?w.clone().normalize():null}}}})],e.prototype,"location",void 0);b.__decorate([c.property({type:["rooftop","street"],
json:{write:!0}})],e.prototype,"locationType",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],e.prototype,"magicKey",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],e.prototype,"maxLocations",void 0);b.__decorate([c.property({type:[String],json:{write:{writer:(w,E)=>{E.outFields=w?w.join(","):null}}}})],e.prototype,"outFields",void 0);b.__decorate([c.property({type:k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],e.prototype,"outSpatialReference",void 0);
b.__decorate([c.property({type:n,json:{write:{writer:(w,E)=>{w=w?w.shiftCentralMeridian():null;E.searchExtent=w}}}})],e.prototype,"searchExtent",void 0);e=b.__decorate([y.subclass("esri.rest.support.AddressToLocationsParameters")],e);e.from=x.ensureType(e);return e})},"esri/rest/support/commonProperties":function(){define(["exports"],function(b){b.apiKey={type:String,json:{read:{source:"token"},write:{target:"token"}}};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/locator/locationToAddress":function(){define(["exports",
"../../request","../utils","../support/AddressCandidate","../support/LocationToAddressParameters"],function(b,e,c,x,t){function m({data:y}){if(y){var {address:n,location:v}=y;return x.fromJSON({address:n?.Match_addr||"",attributes:n||{},location:v,score:100})}}b.locationToAddress=async function(y,n,v){n=t.from(n);y=c.parseUrl(y);n={...n.toJSON(),f:"json"};n=c.encode({...y.query,...n});v=c.asValidOptions(n,v);return e(`${y.path}/reverseGeocode`,v).then(m)};Object.defineProperty(b,Symbol.toStringTag,
{value:"Module"})})},"esri/rest/support/LocationToAddressParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Point ../../geometry/SpatialReference ./commonProperties".split(" "),function(b,e,c,x,t,m,y,n,v,k){e=class extends e{constructor(D){super(D);this.outSpatialReference=this.locationType=
this.location=this.apiKey=null}};b.__decorate([c.property(k.apiKey)],e.prototype,"apiKey",void 0);b.__decorate([c.property({type:n,json:{write:{writer:(D,w)=>{D=D?D.clone().normalize():null;w.location=void 0!==D?D:null}}}})],e.prototype,"location",void 0);b.__decorate([c.property({type:["street","rooftop"],json:{write:!0}})],e.prototype,"locationType",void 0);b.__decorate([c.property({type:v,json:{read:{source:"outSR"},write:{target:"outSR"}}})],e.prototype,"outSpatialReference",void 0);e=b.__decorate([y.subclass("esri.rest.support.LocationToAddressParameters")],
e);e.from=x.ensureType(e);return e})},"esri/rest/locator/suggestLocations":function(){define(["exports","../../request","../utils","../support/SuggestionCandidate","../support/SuggestLocationsParameters"],function(b,e,c,x,t){function m(y){({data:y}=y);if(!y)return[];({suggestions:y}=y);return y?y.map(n=>new x(n)):[]}b.suggestLocations=async function(y,n,v){y=c.parseUrl(y);n=t.from(n);n={...n.toJSON(),f:"json"};n=c.encode({...y.query,...n});v=c.asValidOptions(n,v);return e(`${y.path}/suggest`,v).then(m)};
Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/SuggestionCandidate":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),function(b,e,c,x,t,m,y){e=class extends e{constructor(n){super(n);this.text=this.magicKey=this.isCollection=null}};b.__decorate([c.property({type:Boolean,json:{write:!0}})],
e.prototype,"isCollection",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],e.prototype,"magicKey",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],e.prototype,"text",void 0);return e=b.__decorate([y.subclass("esri.rest.support.SuggestionCandidate")],e)})},"esri/rest/support/SuggestLocationsParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/accessorSupport/ensureType ../../core/has ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/Extent ../../geometry/Point ../../geometry/SpatialReference ./commonProperties".split(" "),
function(b,e,c,x,t,m,y,n,v,k,D){e=class extends e{constructor(w){super(w);this.text=this.searchExtent=this.outSpatialReference=this.maxSuggestions=this.location=this.countryCode=this.categories=this.apiKey=null}};b.__decorate([c.property(D.apiKey)],e.prototype,"apiKey",void 0);b.__decorate([c.property({type:[String],json:{read:{source:"category",reader:w=>w?w.split(","):null},write:{target:"category",writer:(w,E)=>{E.category=w?w.join(","):null}}}})],e.prototype,"categories",void 0);b.__decorate([c.property({type:String,
json:{write:!0}})],e.prototype,"countryCode",void 0);b.__decorate([c.property({type:v,json:{write:{writer:(w,E)=>{E.location=w?w.clone().normalize():null}}}})],e.prototype,"location",void 0);b.__decorate([c.property({type:Number,json:{write:!0}})],e.prototype,"maxSuggestions",void 0);b.__decorate([c.property({type:k,json:{read:{source:"outSR"},write:{target:"outSR"}}})],e.prototype,"outSpatialReference",void 0);b.__decorate([c.property({type:n,json:{write:{writer:(w,E)=>{w=w?w.shiftCentralMeridian():
null;E.searchExtent=JSON.stringify(w)}}}})],e.prototype,"searchExtent",void 0);b.__decorate([c.property({type:String,json:{write:!0}})],e.prototype,"text",void 0);e=b.__decorate([y.subclass("esri.rest.support.SuggestLocationsParameters")],e);e.from=x.ensureType(e);return e})},"esri/widgets/support/geolocationUtils":function(){define("exports ../../config ../../core/Error ../../core/has ../../core/Logger ../../geometry/Point ../../geometry/support/webMercatorUtils ../../portal/Portal ../../rest/geometryService/project ../../rest/support/ProjectParameters".split(" "),
function(b,e,c,x,t,m,y,n,v,k){function D(u){var q=u&&u.coords||{};q={accuracy:q.accuracy,altitude:q.altitude,altitudeAccuracy:q.altitudeAccuracy,heading:q.heading,latitude:q.latitude,longitude:q.longitude,speed:q.speed,toJSON(){return{}}};return u?{coords:q,timestamp:u.timestamp,toJSON(){return{}}}:u}function w({longitude:u,latitude:q,altitude:M}){return new m({longitude:u,latitude:q,z:M||void 0,spatialReference:{wkid:4326}})}function E(u,q,M){if(!q)return Promise.resolve(u);const Q=q.spatialReference;
return Q.isWGS84?Promise.resolve(u):Q.isWebMercator?Promise.resolve(y.geographicToWebMercator(u)):X(M).then(Y=>{if(!Y)throw new c("geometry-service:missing-url","Geometry service URL is missing");const K=new k({geometries:[u],outSpatialReference:Q});return v.project(Y,K,M).then(ba=>ba[0])})}function X(u){if(e.geometryServiceUrl)return Promise.resolve(e.geometryServiceUrl);const q=n.getDefault();return q.load(u).catch(()=>{}).then(()=>q.helperServices?.geometry?.url)}const l=()=>t.getLogger("esri.widgets.support.geolocationUtils"),
P={maximumAge:0,timeout:15E3,enableHighAccuracy:!0};let z;b.getCurrentPosition=function(u){u??=P;return new Promise((q,M)=>{setTimeout(()=>M(new c("geolocation:timeout","getting the current geolocation position timed out")),15E3);navigator.geolocation.getCurrentPosition(q,M,u??void 0)})};b.overridePositionToPoint=function(u){z=u};b.positionToPoint=function(u,q){if(z)return z(u,q);const {position:M,view:Q}=u;u=D(M)?.coords;if(!u)throw new c("geometry-service:no-coords","Geolocation has no coordinates");
u=w(u);return E(u,Q,q)};b.supported=function(){var u=!!x("esri-geolocation");u||l().warn("geolocation-unsupported","Geolocation unsupported.");u&&((u=window.isSecureContext)||l().warnOnce("insecure-context","Geolocation requires a secure origin."));return u};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/geometryService/project":function(){define("exports ../../request ../../core/accessorSupport/ensureType ../../geometry/support/jsonUtils ../utils ./utils ../support/ProjectParameters".split(" "),
function(b,e,c,x,t,m,y){const n=c.ensureType(y);b.project=async function(v,k,D){k=n(k);v=t.parseUrl(v);const w={...v.query,f:"json",...k.toJSON()},E=k.outSpatialReference,X=x.getJsonType(k.geometries[0]);k=t.asValidOptions(w,D);return e(v.path+"/project",k).then(({data:{geometries:l}})=>m.decodeGeometries(l,X,E))};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"esri/rest/support/ProjectParameters":function(){define("../../chunks/tslib.es6 ../../core/JSONSupport ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass ../../geometry/SpatialReference ../../geometry/support/jsonUtils ../../geometry/support/spatialReferenceUtils".split(" "),
function(b,e,c,x,t,m,y,n,v,k){e=class extends e{constructor(D){super(D);this.geometries=[];this.transformForward=this.transformation=this.outSpatialReference=null}toJSON(){const D=this.geometries.map(X=>X.toJSON()),w=this.geometries[0],E={};E.outSR=k.srToRESTValue(this.outSpatialReference);E.inSR=k.srToRESTValue(w.spatialReference);E.geometries=JSON.stringify({geometryType:v.getJsonType(w),geometries:D});this.transformation&&(E.transformation=this.transformation.wkid||JSON.stringify(this.transformation));
null!=this.transformForward&&(E.transformForward=this.transformForward);return E}};b.__decorate([c.property()],e.prototype,"geometries",void 0);b.__decorate([c.property({type:n,json:{read:{source:"outSR"}}})],e.prototype,"outSpatialReference",void 0);b.__decorate([c.property()],e.prototype,"transformation",void 0);b.__decorate([c.property()],e.prototype,"transformForward",void 0);return e=b.__decorate([y.subclass("esri.rest.support.ProjectParameters")],e)})},"esri/widgets/support/GoTo":function(){define("../../chunks/tslib.es6 ../../core/maybe ../../core/accessorSupport/decorators/property ../../core/has ../../core/Logger ../../core/RandomLCG ../../core/accessorSupport/decorators/subclass".split(" "),
function(b,e,c,x,t,m,y){return n=>{n=class extends n{constructor(...v){super(...v);this.view=this.goToOverride=null}callGoTo(v){const {view:k}=this;e.assertIsSome(k);return this.goToOverride?this.goToOverride(k,v):k.goTo(v.target,v.options)}};b.__decorate([c.property()],n.prototype,"goToOverride",void 0);b.__decorate([c.property()],n.prototype,"view",void 0);return n=b.__decorate([y.subclass("esri.widgets.support.GoTo")],n)}})},"esri/widgets/support/globalCss":function(){define(["exports"],function(b){b.globalCss=
{anchor:"esri-widget__anchor",anchorDisabled:"esri-widget__anchor--disabled",button:"esri-button",buttonDisabled:"esri-button--disabled",buttonHalf:"esri-button--half",buttonSecondary:"esri-button--secondary",buttonSmall:"esri-button--small",buttonTertiary:"esri-button--tertiary",buttonThird:"esri-button--third",disabled:"esri-disabled",empty:"esri-widget__content--empty",emptyIllustration:"esri-widget__content-illustration--empty",heading:"esri-widget__heading",hidden:"esri-hidden",input:"esri-input",
interactive:"esri-interactive",loader:"esri-widget__loader",loaderAnimation:"esri-widget__loader-animation",loaderText:"esri-widget__loader-text",menu:"esri-menu",menuHeader:"esri-menu__header",menuItem:"esri-menu__list-item",menuItemActive:"esri-menu__list-item--active",menuItemFocus:"esri-menu__list-item--focus",menuList:"esri-menu__list",panel:"esri-widget--panel",panelHeightOnly:"esri-widget--panel-height-only",primaryTick:"primary-tick",primaryTickAmPm:"primary-tick__ampm",primaryTickLabel:"primary-tick__label",
rotating:"esri-rotating",secondaryTick:"secondary-tick",select:"esri-select",table:"esri-widget__table",widget:"esri-widget",widgetButton:"esri-widget--button",widgetButtonActive:"esri-widget--button-active",widgetDisabled:"esri-widget--disabled"};Object.defineProperty(b,Symbol.toStringTag,{value:"Module"})})},"*noref":1}});
define("require ../chunks/tslib.es6 ../intl ../core/deprecate ../core/Logger ../core/maybe ../core/promiseUtils ../core/reactiveUtils ../core/scheduling ../core/accessorSupport/decorators/property ../core/has ../core/RandomLCG ../core/accessorSupport/decorators/subclass ./Widget ./Search/css ./Search/SearchResultRenderer ./Search/SearchViewModel ../chunks/componentsUtils ./support/globalCss ./support/widgetUtils ./support/decorators/messageBundle ./support/decorators/vmEvent ./support/jsxFactory ../intl/substitute".split(" "),function(b,
e,c,x,t,m,y,n,v,k,D,w,E,X,l,P,z,u,q,M,Q,Y,K,ba){c=class extends X{constructor(f,A){super(f,A);this._currentLocationValue=`${this.id}-search-use-current-location`;this._focusAbortController=this._autocompleteNode=null;this._searchResultRenderer=new P;this._searchController=this._suggestController=null;this._lastSearchTerm="";this.disabled=this._showNoResults=this._locateFailed=!1;this.messagesCommon=this.messages=null;this.viewModel=new z;this._renderSearchResultsContent=()=>this._searchResultRenderer;
this.addHandles([n.watch(()=>this.viewModel,F=>this._searchResultRenderer.viewModel=F,n.initial),n.watch(()=>this.viewModel.results,()=>this._searchResultRenderer.showMoreResultsOpen=!1),n.watch(()=>this.viewModel?.defaultPopupTemplate,F=>{F&&(F.content=this._renderSearchResultsContent)},n.initial)])}loadDependencies(){return u.loadCalciteComponents({autocomplete:()=>new Promise((f,A)=>b(["../chunks/index52"],f,A)),"autocomplete-item-group":()=>new Promise((f,A)=>b(["../chunks/index53"],f,A)),"autocomplete-item":()=>
new Promise((f,A)=>b(["../chunks/index54"],f,A)),button:()=>new Promise((f,A)=>b(["../chunks/index2"],f,A)),dropdown:()=>new Promise((f,A)=>b(["../chunks/index24"],f,A)),"dropdown-group":()=>new Promise((f,A)=>b(["../chunks/index25"],f,A)),"dropdown-item":()=>new Promise((f,A)=>b(["../chunks/index26"],f,A)),notice:()=>new Promise((f,A)=>b(["../chunks/index6"],f,A))})}destroy(){this._cancelQueries();this._searchResultRenderer=m.destroyMaybe(this._searchResultRenderer);this._focusAbortController?.abort()}get _isDisabled(){const {state:f}=
this.viewModel;return"disabled"===f||"loading"===f||this.disabled}get _showCurrentLocation(){return this.locationEnabled&&!this.searchTerm?.trim()}get _effectiveActiveMenu(){const {activeMenu:f}=this;return this._isDisabled?"none":"warning"===f?"suggestion":f}get activeMenu(){return"none"}set activeMenu(f){"warning"===f&&x.deprecatedPropertyValue(t.getLogger(this),"activeMenu","warning",{replacement:"Use the value 'suggestion' instead",version:"4.32",warnOnce:!0});this._overrideIfSome("activeMenu",
f)}get activeSource(){return this.viewModel?.activeSource}get activeSourceIndex(){return this.viewModel.activeSourceIndex}set activeSourceIndex(f){this.viewModel.activeSourceIndex=f}get allPlaceholder(){return this.viewModel.allPlaceholder}set allPlaceholder(f){this.viewModel.allPlaceholder=f}get allSources(){return this.viewModel.allSources}get autoNavigate(){return this.viewModel.autoNavigate}set autoNavigate(f){this.viewModel.autoNavigate=f}get autoSelect(){return this.viewModel.autoSelect}set autoSelect(f){this.viewModel.autoSelect=
f}get defaultSources(){return this.viewModel.defaultSources}get goToOverride(){return this.viewModel.goToOverride}set goToOverride(f){this.viewModel.goToOverride=f}get icon(){return"search"}set icon(f){this._overrideIfSome("icon",f)}get includeDefaultSources(){return this.viewModel.includeDefaultSources}set includeDefaultSources(f){this.viewModel.includeDefaultSources=f}get label(){return this.messages?.widgetLabel??""}set label(f){this._overrideIfSome("label",f)}get locationEnabled(){return this.viewModel.locationEnabled}set locationEnabled(f){this.viewModel.locationEnabled=
f}get maxResults(){return this.viewModel.maxResults}set maxResults(f){this.viewModel.maxResults=f}get maxSuggestions(){return this.viewModel.maxSuggestions}set maxSuggestions(f){this.viewModel.maxSuggestions=f}get minSuggestCharacters(){return this.viewModel.minSuggestCharacters}set minSuggestCharacters(f){this.viewModel.minSuggestCharacters=f}get popupEnabled(){return this.viewModel.popupEnabled}set popupEnabled(f){this.viewModel.popupEnabled=f}get popupTemplate(){return this.viewModel.popupTemplate}set popupTemplate(f){this.viewModel.popupTemplate=
f}get portal(){return this.viewModel?.portal}set portal(f){this.viewModel&&(this.viewModel.portal=f)}get resultGraphic(){return this.viewModel.resultGraphic}set resultGraphic(f){this.viewModel.resultGraphic=f}get resultGraphicEnabled(){return this.viewModel.resultGraphicEnabled}set resultGraphicEnabled(f){this.viewModel.resultGraphicEnabled=f}get results(){return this.viewModel.results}get searchAllEnabled(){return this.viewModel.searchAllEnabled}set searchAllEnabled(f){this.viewModel.searchAllEnabled=
f}get searchTerm(){return this.viewModel.searchTerm}set searchTerm(f){this.viewModel.searchTerm=f}get selectedResult(){return this.viewModel.selectedResult}get sources(){return this.viewModel.sources}set sources(f){this.viewModel.sources=f}get suggestions(){return this.viewModel.suggestions}get suggestionsEnabled(){return this.viewModel.suggestionsEnabled}set suggestionsEnabled(f){this.viewModel.suggestionsEnabled=f}get view(){return this.viewModel.view}set view(f){this.viewModel.view=f}clear(){this._locateFailed=
!1;this.viewModel.clear()}focus(){this._handleFocus();this._emitFocus()}blur(){this._autocompleteNode?.blur();this._emitBlur()}async search(f){this._cancelQueries();const A=new AbortController,{signal:F}=A;this._searchController=A;try{const L=await this.viewModel.search(f,{signal:F});if(this._searchController===A)return L?.numResults||(this._showNoResults=!0,this.activeMenu="suggestion"),this._searchController=null,L}catch(L){this._searchController===A&&(this._searchController=null)}}async suggest(f){this._cancelSuggest();
const A=new AbortController,{signal:F}=A;this._suggestController=A;try{const L=await this.viewModel.suggest(f,null,{signal:F});if(this._suggestController===A)return this._suggestController=null,L?.numResults&&(this.activeMenu="suggestion",this._scrollToTopSuggestion()),L}catch(L){return this._suggestController!==A?null:this._suggestController=null}}render(){return K.tsx("div",{class:this.classes(l.css.base,q.globalCss.widget)},K.tsx("div",{class:l.css.container},this._renderSourcesMenu(),this._renderForm()))}_handleInputKeydown(f){"Tab"===
f.key&&this._cancelSuggest()}_emitFocus(){this.emit("search-focus")}_emitBlur(){this.emit("search-blur")}async _handleFocus(){this._focusAbortController?.abort();this._focusAbortController=new AbortController;await y.ignoreAbortErrors(v.waitAnimationFrame(this._focusAbortController.signal));this._autocompleteNode?.setFocus()}_renderSourcesMenu(){const {messages:f,_isDisabled:A,_effectiveActiveMenu:F}=this,{allSources:L,searchAllEnabled:R}=this.viewModel;return 1<L.length?K.tsx("calcite-dropdown",
{bind:this,class:l.css.dropdown,disabled:A,open:"source"===F,overlayPositioning:"fixed",onCalciteDropdownClose:this._handleSourceClose,onCalciteDropdownOpen:this._handleSourceOpen,onCalciteDropdownSelect:this._handleSourceSelect},K.tsx("calcite-button",{appearance:"outline-fill",iconStart:"caret-down",kind:"neutral",label:f.searchIn,slot:"trigger"}),K.tsx("calcite-dropdown-group",{groupTitle:f.searchIn},R?this._renderSource(z.ALL_INDEX):null,L.map((U,O)=>this._renderSource(O)).toArray())):null}_renderUseCurrentLocation(){const {_currentLocationValue:f}=
this;return K.tsx("calcite-autocomplete-item",{heading:this.messages.useCurrentLocation,iconStart:"gps-on",key:f,value:f})}_handleAutocompleteCreate(f){this._autocompleteNode=f}_handleCalciteAutocompleteTextInput(f){f=f.target.inputValue;f!==this.viewModel.searchTerm&&((this.viewModel.searchTerm=f)||this.clear(),this.suggest())}_handleAutocompleteOpen(){this.activeMenu="suggestion"}_handleAutocompleteClose(){"suggestion"===this.activeMenu&&(this.activeMenu="none")}_handleCalciteAutocompleteChange(f){const A=
f.target.value;A===this._currentLocationValue?this._useCurrentLocation():(f=this.viewModel.suggestions?.flatMap(F=>F.results??[])?.find(F=>`${F.key}`===`${A}`))&&this.search(f)}_renderAutocomplete(){const {_effectiveActiveMenu:f,messages:A,_isDisabled:F}=this,{maxInputLength:L,placeholder:R,searchTerm:U,state:O}=this.viewModel;return K.tsx("calcite-autocomplete",{afterCreate:this._handleAutocompleteCreate,autocomplete:"off",bind:this,class:l.css.autocomplete,disabled:F,icon:this.icon,inputValue:U,
label:this.label??A.searchButtonTitle??"",loading:"searching"===O,maxLength:L,name:this.id,onblur:this._emitBlur,onfocus:this._emitFocus,onkeydown:this._handleInputKeydown,open:"suggestion"===f,overlayPositioning:"fixed",placeholder:R,title:U?"":R,onCalciteAutocompleteChange:this._handleCalciteAutocompleteChange,onCalciteAutocompleteClose:this._handleAutocompleteClose,onCalciteAutocompleteOpen:this._handleAutocompleteOpen,onCalciteAutocompleteTextChange:this._handleCalciteAutocompleteTextInput,onCalciteAutocompleteTextInput:this._handleCalciteAutocompleteTextInput},
this._renderSuggestions(),this._renderNotices())}_renderForm(){return K.tsx("form",{bind:this,class:l.css.form,disabled:this._isDisabled,key:l.css.form,onsubmit:this._formSubmit,role:"search"},this._renderAutocomplete())}_renderSuggestGroup(f){return f.results?.map(A=>this._renderSuggestion(A))}_renderSuggestions(){const {suggestions:f}=this.viewModel;return this._showNoResults?null:this._showCurrentLocation?this._renderUseCurrentLocation():f?.map(A=>this._renderSuggestResults(A))}_renderSuggestResults(f){const {allSources:A,
activeSourceIndex:F}=this.viewModel,{sourceIndex:L}=f,R=f.results?.length,U=1<A.length&&F===z.ALL_INDEX,O=this._getSourceName(L);return R&&U?K.tsx("calcite-autocomplete-item-group",{heading:O,key:`suggestion-group-${O}-${L}`},this._renderSuggestGroup(f)):this._renderSuggestGroup(f)}_renderSuggestion(f){return K.tsx("calcite-autocomplete-item",{heading:f.text??this.messages.untitledResult,key:`suggestion_${f.key}`,value:`${f.key}`})}_renderSource(f){const A=this._getSourceName(f);return K.tsx("calcite-dropdown-item",
{"data-source-index":`${f}`,key:`source-${A}-${f}`,selected:f===this.viewModel.activeSourceIndex},A)}_renderNoResultsWarning(f){const {messages:A}=this;f=f?ba.substitute(A.noResultsFoundForValue,{value:`"${f}"`}):A.noResultsFound;return K.tsx("calcite-notice",{icon:"exclamation-mark-triangle",key:"no-results-warning",kind:"warning",open:!0,slot:"content-bottom"},K.tsx("div",{slot:"title"},A.noResults),K.tsx("div",{slot:"message"},f))}_renderLocateError(){return K.tsx("calcite-notice",{icon:"exclamation-mark-circle",
key:"locate-warning",kind:"danger",open:!0,slot:"content-bottom"},K.tsx("div",{slot:"message"},this.messages.locateError))}_renderNotices(){return this._locateFailed?this._renderLocateError():this._showNoResults?this._renderNoResultsWarning(this._lastSearchTerm??this.viewModel.searchTerm):null}async _useCurrentLocation(){this._cancelQueries();const f=new AbortController,{signal:A}=f;this._searchController=f;try{await this.viewModel.searchNearby({signal:A})}catch(F){y.isAbortError(F)||(this._locateFailed=
!0)}finally{this._searchController=null}}_handleSourceOpen(){this.activeMenu="source"}_handleSourceClose(){"source"===this.activeMenu&&(this.activeMenu="none")}_handleSourceSelect(f){if(f=f.target.selectedItems[0].getAttribute("data-source-index"))this.viewModel.activeSourceIndex=parseInt(f,10)}_cancelSuggest(){this.activeMenu="none";this._showNoResults=this._locateFailed=!1;this._suggestController=m.abortMaybe(this._suggestController)}_cancelQueries(){this._cancelSuggest();this._searchController=
m.abortMaybe(this._searchController)}_scrollToTopSuggestion(){this._autocompleteNode?.scrollContentTo({top:0})}_formSubmit(f){f.preventDefault();this.activeMenu="none";(this._lastSearchTerm=this.searchTerm)&&this.search()}_getSourceName(f){const {messages:A}=this;var {allSources:F}=this.viewModel;F=F.at(f);return f===z.ALL_INDEX?A.all:F?.name||A.untitledSource}};e.__decorate([k.property()],c.prototype,"_locateFailed",void 0);e.__decorate([k.property()],c.prototype,"_showNoResults",void 0);e.__decorate([k.property()],
c.prototype,"_isDisabled",null);e.__decorate([k.property()],c.prototype,"_showCurrentLocation",null);e.__decorate([k.property()],c.prototype,"_effectiveActiveMenu",null);e.__decorate([k.property()],c.prototype,"activeMenu",null);e.__decorate([k.property({readOnly:!0})],c.prototype,"activeSource",null);e.__decorate([k.property()],c.prototype,"activeSourceIndex",null);e.__decorate([k.property()],c.prototype,"allPlaceholder",null);e.__decorate([k.property({readOnly:!0})],c.prototype,"allSources",null);
e.__decorate([k.property()],c.prototype,"autoNavigate",null);e.__decorate([k.property()],c.prototype,"autoSelect",null);e.__decorate([k.property({readOnly:!0})],c.prototype,"defaultSources",null);e.__decorate([k.property()],c.prototype,"disabled",void 0);e.__decorate([k.property()],c.prototype,"goToOverride",null);e.__decorate([k.property()],c.prototype,"icon",null);e.__decorate([k.property()],c.prototype,"includeDefaultSources",null);e.__decorate([k.property()],c.prototype,"label",null);e.__decorate([k.property()],
c.prototype,"locationEnabled",null);e.__decorate([k.property()],c.prototype,"maxResults",null);e.__decorate([k.property()],c.prototype,"maxSuggestions",null);e.__decorate([k.property(),Q.messageBundle("esri/widgets/Search/t9n/Search")],c.prototype,"messages",void 0);e.__decorate([k.property(),Q.messageBundle("esri/t9n/common")],c.prototype,"messagesCommon",void 0);e.__decorate([k.property()],c.prototype,"minSuggestCharacters",null);e.__decorate([k.property()],c.prototype,"popupEnabled",null);e.__decorate([k.property()],
c.prototype,"popupTemplate",null);e.__decorate([k.property()],c.prototype,"portal",null);e.__decorate([k.property()],c.prototype,"resultGraphic",null);e.__decorate([k.property()],c.prototype,"resultGraphicEnabled",null);e.__decorate([k.property({readOnly:!0})],c.prototype,"results",null);e.__decorate([k.property()],c.prototype,"searchAllEnabled",null);e.__decorate([k.property()],c.prototype,"searchTerm",null);e.__decorate([k.property({readOnly:!0})],c.prototype,"selectedResult",null);e.__decorate([k.property()],
c.prototype,"sources",null);e.__decorate([k.property({readOnly:!0})],c.prototype,"suggestions",null);e.__decorate([k.property()],c.prototype,"suggestionsEnabled",null);e.__decorate([k.property()],c.prototype,"view",null);e.__decorate([Y.vmEvent("search-complete search-clear search-start select-result suggest-start suggest-complete".split(" ")),k.property({type:z})],c.prototype,"viewModel",void 0);return c=e.__decorate([E.subclass("esri.widgets.Search")],c)});